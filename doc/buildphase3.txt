Phase #3, chapter 7 of LFS 10.1 guide

Prep to chroot
chown -R root:root $LFS/{usr,lib,lib64,var,etc,bin,sbin,tools}
mkdir -pv $LFS/{dev,proc,sys,run}
mknod -m 600 $LFS/dev/console c 5 1
mknod -m 666 $LFS/dev/null c 1 3
mount --bind /dev $LFS/dev
mount --bind /dev/pts $LFS/dev/pts
mount -t proc proc $LFS/proc
mount -t sysfs sysfs $LFS/sys
mount -t tmpfs tmpfs $LFS/run

chroot "$LFS" /usr/bin/env -i HOME=/root TERM="$TERM" PS1='(lfs chroot) \u:\w\$ ' PATH=/osbt/bin:/bin:/usr/bin:/sbin:/usr/sbin /bin/bash --login +h

Create hierarchy
mkdir -p /{boot,home,mnt,srv}
mkdir -p /lib/firmware
mkdir -p /media/{floppy,cdrom}
mkdir -p /usr/{bin,include,lib,obj,sbin,src}
mkdir -p /usr/share/{color,dict,doc,info,locale,man}
mkdir -p /usr/share/{misc,terminfo,zoneinfo}
mkdir -p /usr/share/man/man{1..8}
mkdir -p /var/{cache,log,mail,spool}
mkdir -p /var/lib/misc
ln -sf /run /var/run
ln -sf /run/lock /var/lock
install -d -m 0750 /root
install -d -m 1777 /tmp /var/tmp
ln -s /proc/self/mounts /etc/mtab

Copy src/etc/{passwd,groups,hosts} into /etc

touch /var/log/{btmp,lastlog,faillog,wtmp}
chgrp utmp /var/log/lastlog
chmod 664  /var/log/lastlog
chmod 600  /var/log/btmp

libstdc++ from GCC, pass2
mkdir /usr/obj/{gcc,libgcc}
ln -s /usr/src/bin/gcc/dist/libgcc/gthr-posix.h /usr/obj/libgcc/gthr-default.h
cd /usr/obj/gcc
/usr/src/bin/gcc/dist/libstdc++-v3/configure CXXFLAGS="-g -O2 -D_GNU_SOURCE" --prefix=/usr --disable-multilib --disable-nls --host=$(uname -m)-lfs-linux-gnu --disable-libstdcxx-pch --libdir=/usr/lib64
config.log should reference thread_header='gthr-posix.h'

gettext
./configure --disable-shared
make
cp -v gettext-tools/src/{msgfmt,msgmerge,xgettext} /usr/bin

bison
configure --prefix=/osbt
