2021-02-01  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/ftp.c (getreply): Fix possible buffer overflow (backport
	from OpenBSD); reported by O. Bittner, D. Maier, M. Munier,
	J. Beier of SecT, TU Berlin.

2021-01-29  Simon Josefsson  <simon@josefsson.org>

	ping6: Don't allow unprivileged users to flood ping.

	* ping/ping6.c (parse_opt): For non-root users, limit interval
	like ping.c to avoid DoS.  Reported in
	<https://bugs.debian.org/926750>.
	* ping/ping_common.h (PING_MIN_USER_INTERVAL): Add.
	* ping/ping.c (MIN_USER_INTERVAL): Remove, replaced by
	PING_MIN_USER_INTERVAL.
	(parse_opt): Update use.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	* telnet/commands.c (logoutcmd): Renamed from logout.  Conflicts
	with system utmp.h's logout(3).
	(cmdtab): Use logoutcmd instead of logout.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	* tests/libls.sh (LSDIR): Fix parallel testing.  Found on Guix and
	Debian, solution is to not use CWD as test directory for libls.
	Inspired by trivial patch by Guillem Jover <guillem@hadrons.org>.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	ping, ping6: Fix unchecked setuid return.

	* ping/ping.c (main): Fail if setuid fail.  Trivial patch from
	Jayakrishna Vadayath <jvadayat@asu.edu>.
	* ping/ping6.c (main): Likewise.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	* tests/hostname.sh: Use uname as fallback if system lack hostname
	command.  Only require mktemp when running root test.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	* tests/hostname.sh: Use system hostname, not system uname, for
	comparison.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	* configure.ac: Don't call gl_FUNC_READLINE.  Not needed since we
	now use readline gnulib module.

2021-01-28  Simon Josefsson  <simon@josefsson.org>

	Fix link failure with absent -lutil on Solaris 10.

	* configure.ac (LIBUTIL): Prefer PTY_LIBS in Makefile.am over
	adding -lutil for pty-functions.
	* src/Makefile.am (LDADD): Add PTY_LIB.
	* telnetd/Makefile.am (LDADD): Likewise.
	* tests/Makefile.am (identify_LDADD): Likewise.

2021-01-27  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (buildreq): Add gzip and xz.

2021-01-27  Simon Josefsson  <simon@josefsson.org>

	* .gitignore: Rewrite to use leading / for most top-level files,
	and general update.

2021-01-26  Simon Josefsson  <simon@josefsson.org>

	Sync release process with gnulib approach.

	* NEWS: Fix syntax to conform to gnulib release-prep rules.
	* cfg.mk: Drop news-check-regexp.
	* bootstrap.conf (gnulib_modules): Use readme-release.  Drop now
	implicit announce-gen, gnupload and maintainer-makefile.
	* bootstrap.conf (bootstrap_epilogue): Add function, fixing
	README-release.
	* gl/top/README-release.diff: Add file.
	* .gitignore: Add README-release.
	* cfg.mk (exclude_file_name_regexp--sc_trailing_blank): Add, for
	README-release.diff.
	* configure.ac (AC_INIT): Don't use sed-expression, it is
	incompatible with gnulib's do-release-commit-and-tag.
	* cfg.mk (git-version-gen-tag-sed-script): Drop.
	* .prev-version: Add file, indicating 1.9.4 as previous release.
	* README-alpha (Release procedures): Removed, replaced by
	README-release.
	* cfg.mk (release-prep-hook): Don't disable it, we now support it.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	Silence 'make syntax-check'.

	* libls/ls.c: Don't include <intprops.h> if we are not using it.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	Don't use deprecated gnulib module 'gettext' and replace
	readline.m4 with gnulib readline module.

	* bootstrap.conf (gnulib_modules): Remove gettext.  Add readline.
	* am/readline.m4: Remove file.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	Only do what git-version-gen recommends regarding .version.

	* Makefile.am (DISTCLEANFILES): Don't distclean
	$(top_builddir)/.version.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	Fix hostname.sh to not call system hostname, and improve
	diagnostics.

	* tests/hostname.sh: Fix typo.  Improve output on failures.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	Fix 'make check' on broken platforms without /etc/protocols.

	* tests/traceroute-localhost.sh: Skip test if /etc/protocols
	doesn't exist, copied from existing code in tests/inetd.sh.
	* tests/ping-localhost.sh: Likewise.

2021-01-25  Simon Josefsson  <simon@josefsson.org>

	git-version-gen: Sync with git-version-gen usage instructions.

	* Makefile.am (EXTRA_DIST): Add.
	(BUILT_SOURCES): Use srcdir.
	(.version): Likewise.

2021-01-24  Simon Josefsson  <simon@josefsson.org>

	* configure.ac: Fix disabling when all rcmd is missing.
	* configure.ac: Warn when rcmd is missing.
	* README-alpha (Prerequisites): Mention xz, for dist.

2021-01-24  Simon Josefsson  <simon@josefsson.org>

	Build/doc fixes.

	* README-alpha (Checking Out the Sources): Use git URL mentioned
	on Savannah page.
	(Prerequisites): Add bash, gcc, ncurses.
	* bootstrap: Updated from gnulib.

2020-11-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (AC_PREREQ): Require autoconf 2.64, caused
	by changes in Gnulib.

2020-06-05  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/system/linux.c (linux_if_nameindex): New, incompatible
	signature of contemporary Gnulib function read_file().

2020-05-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* whois/data.h (hide_strings): Add Brazilian pattern.
	* whois/ip6_del_list: Update with more ranges.

2020-05-08  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Delegation list for IPv6 ranges.

	* whois/.gitignore: Add `ip6_del.h'.
	* whois/Makefile.am (BUILT_SOURCES): Add `ip6_del.h'.
	(EXTRA_DIST): Add `ip6_del_list', `ip6_del.h', `make_ip6_del.pl'.
	(noinst_HEADERS): Add `ip6_del.h'.
	(ip6_del.h): New target.
	* whois/data.h (ip6_assign): New array.
	* whois/ip6_del_list: New file.
	* whois/make_ip6_del.pl: New file.
	* whois/whois.c (whichwhois): Regard absence of period, colon,
	and hyphen as evidence of NSI NIC or ASN.  Test for this and for
	email address before any test for numeric addressing.  Implement
	code for IPv6 delegation matching, to be triggered by the presence
	of a colon in the given query string.

2020-05-07  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Tweak command line arguments.

	* whois/whois.c (whichwhois): Skip any single character token,
	as it must be a search directive for a server.  Prune the known
	IPv6 delegations to reflect only the valid one.  Use ARIN as
	default IPv6 serving instance, since the old 6BONE server is no
	longer responsive.

2020-05-07  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Improved hiding of legal disclaimers.

	* whois/as_del_list: Two additional delegations.
	* whois/data.h (hide_strings): Add string patterns for present
	day services at ARIN, LACNIC, and RIPE.
	* whois/whois.c (do_query): After successful location of a stop
	pattern, go back into search state, instead of cancelling further
	matching.  The service at ARIN inserts identical disclaimer at
	the beginning, as well as at the end of a response.

2020-05-06  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2020-04-27  Tim RÃ¼hsen  <tim.ruehsen@gmx.de>

	telnet: Use memove for overlapping memory instead of strncpy.

	Overlapping source and destination buffers are not supported
	by strncpy and give undefined results.

	7.24.2.3 of ISO/IEC 9899:201x:
	"If  copying  takes  place  between  objects  thatoverlap,
	the behavior is undefined."

	* telnet/commands.c (cmds): Use memove for overlapping memory
	instead of strncpy.

2020-04-12  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Delegation of IP and AS.

	Attempt improving the list of IP range delegation within the scope
	of old A-class ranges.  The intention is to establish as many
	ranges of width 22, or wider, and also to verify old claims.

	* whois/as_del_list: Update and correct existing AS range
	delegations, and add a few more, random but existing.
	* whois/ip_del_list: Add a large number of delegations within
	former A-class ranges, and correct two erroneous instances.
	* whois/whois.c (whereas): Raise the upper limit of known ASN.
	(queryformat): Rewrite query statement intended for ARIN.

2020-04-06  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Include ERX ranges for APNIC.

	The content of the following web page was scanned to identify
	the ranges within old B-classes that were assigned to APNIC
	by the ERX project, Early Registration Transfer.  After some
	cross checking, a few intermediate ranges for other registars
	were included for better resolution.
	https://www.apnic.net/manage-ip/manage-historical-resources/erx-project/erx-transfer-to-apnic/

	* whois/ip_del_list: Add a large amount of APNIC address ranges.

2020-04-05  Mats Erik Andersson  <gnu@gisladisker.se>

	Support for libidn2 in addition to libidn.

	* am/libidn.m4 (have_IDN2, have_IDN): New local variables.
	Detect presence of libidn2 by checking for `idn2_to_ascii_lz',
	but still aim at backwards compatibility.  Detect header file
	`idna.h' as well as `idn2.h', but prefer libidn2 to libidn,
	should both libraries be detected.
	* configure.ac (--with-idn): Mention that IDN2 is acceptable.
	(idn_link): New variable.
	(ftp_PROPS, ping_PROPS, talk_PROPS, telnet_PROPS, tftp_PROPS)
	(traceroute_PROPS): Update these to state `idn', or `idn2'.

	* ftp/ftp.c [HAVE_IDN2_H && HAVE_IDN2]: Include `idn2.h'.
	[(!HAVE_IDN2_H || !HAVE_IDN2) && HAVE_IDNA_H]: Include `idna.h'.
	(hookup) [HAVE_IDN || HAVE_IDN2]: Use compatibility function
	idna_to_ascii_lz().
	* ping/libping.c (ping_set_dest): Likewise.
	* ping/ping6.c (ping_set_dest): Likewise.
	* src/tftp.c (resolve_name): Likewise.
	* src/traceroute.c (main): Likewise.
	* talk/get_addrs.c (get_addrs)
	[HAVE_DECL_GETADDRINFO || HAVE_IDN || HAVE_IDN2]: Declare ERR.
	[HAVE_IDN || HAVE_IDN2]: Likewise.
	* telnet/commands.c (tn): Declare HOSTTMP.  Likewise.

2020-04-04  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping6.c (print_packet_too_big): Use %u when printing MTU.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	uucpd: Fix buffer overflows.

	This fixes several missing string termination issues with strncpy.
	Also REMOTEHOST of size NI_MAXHOST was strcpy'ed into LINE, which
	just had 32 bytes on the stack.

	* src/uucpd.c (SCPYN): Promote macro to global scope, but expand
	its action by writing the final NUL character.
	(dologin): Increase size of LINE.  Use existing macro SCPYN
	instead of strncpy.
	[PATH_LASTLOG && HAVE_STRUCT_LASTLOG]: Delete local macro SCPYN.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	uucpd: Fix heap buffer overflow.

	Usernames >= 56 bytes would overflow the char arrays Username and
	Logname.  This change mitigates this, but still silently truncates
	these arrays.  Silent truncation should be checked throughout the
	code, possibly within a more comprehensive code review.

	* src/uucpd.c (Username, Logname): Increase size to 72 bytes.
	(doit): Use snprintf instead of sprintf.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnet: Use strdup instead malloc+strcpy.

	* telnet/commands.c (tn): Assign HOSTNAME using strdup().

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnet: Fix -Wsign-compare in suboption.

	* telnet/telnet.c (suboption): Explicitly cast sizeof() to int.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnetd: Silence -Wimplicit-fallthrough.

	* telnetd/state.c (willoption): Squeelch warning.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnetd: Silence unused warning for getterminaltype.

	* telnetd/utility.c (getterminaltype): Squeelch warning.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Silence -Wimplicit-fallthrough warning.

	* ftp/domacro.c (domacro): Squeelch warning.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Silence -Wimplicit-fallthrough.

	* ftp/cmds.c (domap): Squeelch warning.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Fix multipliers for M(ega) and G(iga).

	This is *not* a fix as the comment accidentally states.  It is to
	silence -Wimplicit-fallthrough and to avoid multiple
	multiplications in case of a non-optimized build.  The HASHBYTES
	type needs to be reviewed later as g/G only allows digits 1 and 2
	without integer overflow, which is undefined behavior.

	* ftp/cmds.c (sethash): Remove cascaded multiplications.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Fix return value of remglob.

	* ftp/cmds.c (remglob): Switch roles of old values after NULL check.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Fix possible buffer overflow.

	* ftp/ftp.c (hookup): Terminate string after strncpy.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftp: Fix two misuses of strncpy (read buffer overflow).

	* ftp/ftp.c (pswitch): Correctly set the terminating NUL.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	talk: Fix uninitialized variable NREADY.

	* talk/ctl_transact.c (ctl_transact): Initialize NREADY to 0.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	whois: Silence -Wimplicit-fallthrough.

	* whois/whois.c (main): Squeelch warning.

2020-02-29  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ping, ping6: Silence -Wimplicit-fallthrough.

	* ping/ping.c (parse_opt): Squeelch warning.
	* ping/ping6.c (parse_opt): Likewise.

2020-02-17  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ping6: Fix memleak in ping_set_dest.

	* ping/ping6.c (ping_set_dest): New function signature.
	Rearrange code to avoid memory leak.
	* ping/ping6.h (ping_set_dest): Change signature in declaration.

2020-02-17  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ping: Fix memleak in ping_set_dest.

	* ping/libping.c (ping_set_dest): New function signature.
	Rearrange code to avoid memory leak.
	[HAVE_DECL_GETADDRINFO]: Rename P as RHOST.
	* ping/ping.h (ping_set_dest): Change signature in declaration.

2020-02-16  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	libls: Remove unused variable kflag.

	* libls/ls.c (ls_main): Remove unused variable.

2020-02-16  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	ftpd: Fix multiple definition (GCC 10).

	* ftpd/extern.h (errcatch): Declare as extern.
	* ftpd/ftpd.c (errcatch): Define variable.

2020-02-16  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnetd: Fix multiple definition (GCC 10).

	* telnetd/utility.c (not42): Declare as extern.

2020-02-16  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	* src/rcp.c (tolocal): Remove unused variable LEN.

2020-02-16  Tim RÃ¼hsen <tim.ruehsen@gmx.de>

	telnet: Fix silent truncation (off-by-one check)

	If the DISPLAY variable had exactly 44 bytes, the SE byte (end sub
	negotiation) was silently truncated.  This concerns CVE-2019-0053.

	* telnet/telnet.c (suboption): Add case of equality in conditional,
	supplementing strict inequality.

2020-02-21  Mats Erik Andersson  <gnu@gisladisker.se>

	Various compiler warnings, getting closer to `-Werror'.

	* libls/print.c (printlong): The functions major() and minor() have
	no portable value type, so cast as `int'.

	* ping/ping.c (decode_type): Initialize HOSTNAME to NULL.

	* src/hostname.c (parse_opt, main) <SET_NAME_ACTION>: The prototype
	of sethostname() is not portable, so cast as `void *'.  Do this
	also on both members in a conditional clause.
	* src/logger.c (parse_level): Cast PRIORITYNAMES and FACILITYNAMES
	as `CODE *', since BSD-systems assign these a constant type.
	* src/syslogd.c (textpri, cfline): Likewise.
	* src/rcp.c (source, rsource): Type length of `stat.st_mode' is not
	portable, so cast as `int'.
	* src/traceroute.c (trace_write): Make loop variable I unsigned.

2020-02-20  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd, rshd: Avoid false failure message.

	* src/rexecd.c (doit) [HAVE_SETLOGIN]: Only call setsid() in case
	the session leader is different from the present process.
	* src/rshd.c (doit) [HAVE_SETLOGIN]: Likewise.

2020-02-20  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Recursive reception was broken.

	The commit 67b49c54 broke the use case of locally receiving
	multiple files for a recursive copying action.  This was found
	and established by Zhixiong Chi.  Now revert the relevant part
	of the old commit, as the suggested patch is nearly a verbatim
	change back.  The differences await further analysis.
	Original report is contained in:
	https://lists.gnu.org/archive/html/bug-inetutils/2019-12/msg00000.html

	* src/rcp.c (sink) [targisdir]: Revert to the legacy, and functional,
	implementation of string allocation.

2020-02-10  Mats Erik Andersson  <gnu@gisladisker.se>

	Simplify coding of test program `runtime-ipv6', by using
	standard getopt() library function, thus making the code
	self sufficient.

	* tests/runtime-ipv6.c: Migrate away from argp_parse() to
	standard getopt().  Let environment variable VERBOSE contribute
	a short message in case the program tests successfully.
	Also use AI_NUMERICSERV for completeness.

2020-02-09  Mats Erik Andersson  <gnu@gisladisker.se>

	test-snprintf: New test program.

	An implementation dependent feature of snprintf() is tested.
	The BSD unices and OpenSolaris relatives are known to be more
	forgiving, than is Linux/glibc and kfreebsd/glibc.  The issue
	was brought to our attention by Zhixiong Chi in:
	https://lists.gnu.org/archive/html/bug-inetutils/2019-05/msg00002.html

	* tests/test-snprintf.c: New file.
	* tests/Makefile.am (check_PROGRAMS, TESTS): Add `test-snprintf'.
	* tests/.gitignore: Likewise.

2020-02-04  Mats Erik Andersson  <gnu@gisladisker.se>

	Buffer overflow in tftp and tftpd.
	Recent versions of Gnu libc and Gcc are injecting buffer checks
	into strcpy().  Both executables, tftp and tftpd, are effectively
	copying into a formally declared `char th_msg[1]', ignorant of
	the underlying buffer being of size PKTSIZE.
	Problem was reported by Mike Gilbert and Ricardo Ribalda Delgado:
	https://lists.gnu.org/archive/html/bug-inetutils/2017-12/msg00001.html
	https://lists.gnu.org/archive/html/bug-inetutils/2019-07/msg00002.html

	* src/tftp.c (nak): Replace strcpy() by memcpy(), after the
	needed calculation of string length.
	* src/tftpd.c (nak): Likewise.

	* tests/tftp.sh: New compound test with multiple requests.

2020-02-03  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: AUDA services Australia.
	Update server name.  Forwarded from Adam King:
	https://lists.gnu.org/archive/html/bug-inetutils/2018-07/msg00001.html

	* whois/tld_serv_list (.au): Update server, now at AUDA.

2020-02-03  Mats Erik Andersson  <gnu@gisladisker.se>

	Better portability for BSD install.
	Install hooks for programs that require root ownership, were written
	with GNU install in mind.  Reported and suggested by Bill Cole:
	https://lists.gnu.org/archive/html/bug-inetutils/2018-07/msg00005.html

	* ping/Makefile.am (install-ping-hook): Place program switches
	to INSTALL_PROGRAM before file argument, thus helping BSD install.
	Rewrite failure comment, and add exit error code.
	* src/Makefile.am (install-traceroute-hook, install-rsh-hook)
	(install-rlogin-hook, install-rcp-hook): Likewise.

2020-02-01  Mats Erik Andersson  <gnu@gisladisker.se>

	tests: Less system logging.

	* tests/ftp-localhost.sh (LOGGING): New variable.  Let the server
	program do system logging only if LOGGING has been defined.
	* tests/tftp.sh (LOGGING): Likewise.  Add a test case where a
	non-existing file is requested.  Check that the number of tries
	and of successes agree in order to suppress the final text.

	* README: Add some remarks on our testing abilities.

2020-01-31  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: IP delegation update.

	* whois/ip_del_list: Update with entries as stated by IANA
	with publication date 2019-12-27.

2020-01-31  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Failure of service name.
	The IANA has made badly founded changes to the list of port names,
	promoting `nicname' and introducing the aliases list `Who Is',
	thus making `Who' and `Is' into functional services, and also
	loosing `whois'.  Some systems were careless enough to adopt
	this badly wrought change.  Reported by Shahab Vahedi in:
	https://lists.gnu.org/archive/html/bug-inetutils/2020-01/msg00023.html

	* whois/whois.c (openconn): Fall back to service `nicname',
	should `whois' fail.

2020-01-29  Mats Erik Andersson  <gnu@gisladisker.se>

	More work on CVE-2019-0053.
	Telnet protocol messages must not be corrupted when buffer
	overflows are detected, but should be reported as errors.

	* telnet/telnet.c (suboption): Check that prepared protocol
	message in fact fits in intermediary buffer without truncation.
	Tweak indentation for visibility of protocol elements in snprintf.

	Allocate space also for final NUL-character.

	* telnetd/telnetd.c (telnetdrun): Increase DATA string size by one.
	* telnetd/termstat.c (localstat, flowstat, clientstat): Likewise.

	Insufficiently declared length of string variable.

	* telnetd/utility.c (printsub): Declare TBUF with maximal extent.

2020-01-28  Mats Erik Andersson  <gnu@gisladisker.se>

	Better test coverage, mostly IPv6.

	* tests/ftp-localhost.sh [TEST_IPV6 && TARGET6]: Add the possible
	test cases that existed for IPv4, but did not for IPv6.
	[do_transfer]: Explicitly remove copied $PUTME for reliability.
	[TEST_IPV6 && TARGET6 && do_transfer]: New test for name mapping.
	* tests/syslogd.sh [do_unix_socket || do_inet_socket]: Do priority
	`notice' for each of local socket, IPv4 socket, and IPv6 socket,
	as is applicable.
	(COUNT_WRAP): Reworked calculation on grounds as above.
	[do_inet_socket && TEST_IPV6 && TARGET6]: Test facilities `user.info'
	and `user.debug' with IPv6.
	* tests/tftp.sh (do_secure_setting): Test all of $ADDRESSES.

	* tests/.gitignore: Add runtime-ipv6 to list.

2020-01-27  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability to an old Solaris shell.

	* tests/tools.sh.in (EGREP, FGREP, RUNTIME_IPV4, RUNTIME_IPV6):
	Inside parameter substitution, put value between quotes, since
	some old shells stumble on non-quoted space characters.
	* tests/ifconfig.sh (evaluation of FORMAT): Likewise.

	Make sure that scripts are individually executable.

	* tests/ftp-parser.sh (EXEEXT): Test empty before reading tools.sh.
	* tests/libls.sh (EXEEXT): Likewise.
	* tests/ifconfig_modes.sh: Read tools.sh.

2020-01-26  Mats Erik Andersson  <gnu@gisladisker.se>

	Examination of testing scripts.

	* tests/ftp-localhost.sh [TEST_IPV4 && TARGET]: Implement one
	additional level of indentation in this large text block.
	Some additional fixes of indentation and improved readability.

	* tests/inetd.sh: Improve regex when refusing test directories.
	* tests/syslogd.sh: Likewise.
	* tests/ping-localhost.sh: Use back quotes for portability.
	* tests/traceroute-localhost.sh: Likewise.

2020-01-24  Mats Erik Andersson  <gnu@gisladisker.se>

	runtime-ipv6: Implicit dependency on services file.
	In a chrooted test environment, access to a particular
	resource like /etc/services, need not be granted.

	* tests/runtime-ipv6.c: Replace symbolic service name `tftp'
	by a numerical and harmless port string.

2020-01-24  Mats Erik Andersson  <gnu@gisladisker.se>

	Separation of test cases according to IPv4, and to IPv6.
	The two precious macros TEST_IPV4 and TEST_IPV6 are controlling
	whether the indicated address family is checked in our tests.
	Test coverage is left unequal.

	* configure.ac (TEST_IPV4): New macro.  The new switch
	`--disable-ipv4' suppresses IPv4 during target `check'.
	* tests/Makefile.am (tools_subst): Replace @TEST_IPV4@.
	* tests/tools.sh.in (TEST_IPV4, RUNTIME_IPV4, RUNTIME_IPV6):
	New variables.
	(TEST_IPV4, TEST_IPV6): If either is `auto', make a runtime check
	for availability, and set to `no' in case of failure.

	* tests/runtime-ipv6.c: Implement switches `-4' and `-6', making
	it possible to test for either address family at runtime.
	[EAI_NODATA]: Return this error in a corner case, or else EAI_FAIL.

	* tests/ftp-localhost.sh: Remove code now existing in tools.sh.in.
	Separate existing test cases according to IPv4 and IPv6, by means
	of conditionals with TEST_IPV4 and TARGET, or TEST_IPV6 and TARGET6.
	[TEST_IPV4 = TEST_IPV6 = no]: Skip test.
	* tests/ping-localhost.sh: Likewise.
	* tests/syslogd.sh: Likewise.
	* tests/telnet-localhost.sh: Likewise.
	* tests/tftp.sh: Likewise.

	* tests/ifconfig.sh [TEST_IPV4 = no]: Skip test.
	* tests/inetd.sh (TARGET6): New variable.
	[TEST_IPV4 = TEST_IPV6 = no]: Skip test.
	Implement subcases for IPv6, and condition old cases on TEST_IPV4.
	* tests/traceroute-localhost.sh [TEST_IPV4 = no]: Skip test.
	[TEST_IPV4 && TARGET]: Condition each case completely.

2020-01-22  Mats Erik Andersson  <gnu@gisladisker.se>

	Correctly detect presence of IPv6.

	* tests/runtime-ipv6.c [AI_ADDRCONFIG] (hints.ai_flags):
	Add AI_ADDRCONFIG for better selectivity.

2020-01-20  Mats Erik Andersson  <gnu@gisladisker.se>

	Test robustly in absence of IPv6.
	For systems without functional IPv6 addressing at runtime,
	suppress this address family in our tests, whenever IPv6 was
	configured as autodetected.  Helpful answer by Bruno Haible
	originating from effects in a Raspbian system:
	https://lists.gnu.org/archive/html/bug-inetutils/2020-01/msg00021.html

	* tests/Makefile.am (check_PROGRAMS): Add `runtime-ipv6'.
	* tests/ftp-localhost.sh (RUNTIME_IPV6): New variable.
	[TEST_IPV6 == auto]: Set TEST_IPV6 to `no' when runtime presence
	of IPv6 is in the negative.  Thus effectively inhibiting all use
	within this script of IPv6 addresses.
	* tests/ping-localhost.sh: Likewise.
	* tests/syslogd.sh: Likewise.
	* tests/telnet-localhost.sh: Likewise.
	* tests/tftp.sh: Likewise.
	* tests/runtime-ipv6.c: New file.

	* configure.ac (AC_ISC_POSIX): Delete obsolete test.

2020-01-18  Mats Erik Andersson  <gnu@gisladisker.se>

	Minor portability glitches in Solaris and in AIX.

	* am/libcurses.m4 (IU_LIB_TERMCAP) [!_XOPEN_CURSES]: Conditionally
	include the header <term.h>.
	* telnet/telnet.c [HAVE_CURSES_TGETENT & !_XOPEN_CURSES]: Likewise.
	* telnetd/utility.c [HAVE_CURSES_TGETENT & !_XOPEN_CURSES]: Likewise.

	* ftp/ftp.c (h_errno): Delete declaration, not in use.
	* ftpd/ftpd.c (FTP_NAMES): Assign a value to this macro.

2020-01-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Make test of ftp-parser slightly more forgiving.  Darwin systems
	might prepend a path stem to local directory.  Assaf Gordon reported
	https://lists.gnu.org/archive/html/bug-inetutils/2020-01/msg00005.html

	* tests/ftp-parser.sh: Check number of responses to mixed command
	list, and extract any prepended path resulting from `lcd'.
	(DIR_STEM): New variable.  This modifies matching test after `lpwd'.

2020-01-13  Mats Erik Andersson  <gnu@gisladisker.se>

	The Gnulib module `regex' requires linking that was not made
	explicit in our source.  Discovered by Bruno Haible with AIX 7.2.
	https://lists.gnu.org/archive/html/bug-inetutils/2020-01/msg00012.html

	* talkd/Makefile.am (LD_ADD): Add $(LIBTHREAD) and $(LIB_MBRTOWC).

2020-01-13  Mats Erik Andersson  <gnu@gisladisker.se>

	Attempt to build correctly on Cygwin, new and old. Reported
	and suggested by Bruno Haible in
	https://lists.gnu.org/archive/html/bug-inetutils/2020-01/msg00013.html

	* configure.ac: Check for header <arpa/tftp.h>.  When it is
	missing disable the targets `tftp', and `tftpd'.
	* am/enable.m4 (IU_ENABLE_FOO): Append $EXEEXT to `target_BUILD'.

2020-01-12  Mats Erik Andersson  <gnu@gisladisker.se>

	Suppress building of remote execution commands on systems that
	offer no rcmd functionality.  This happens with embedded systems
	like Alpine Linux and musl libc, as reported by Assaf Gordon and
	Bruno Haible.

	* configure.ac: Check for function rcmd().  Disable building
	of `rcp', `rlogin', and `rsh' when no rcmd variant is present.
	(WITH_RCMD): New precompiler macro.

2020-01-11  Mats Erik Andersson  <gnu@gisladisker.se>

	The glibc manual page for ether address specifies <netinet/ether.h>.
	Use this for GNU/Linux in the hope of resolving also musl libc, as
	used with Alpine Linux.  Reported by Bruno Haible.

	* ifconfig/system/linux.c [HAVE_NETINET_ETHER_H]: Include the
	library header <netinet/ether.h> instead of the system specific
	header <linux/if_ether.h>.

2020-01-11  Mats Erik Andersson  <gnu@gisladisker.se>

	Consistent use of `grep' tools in scripts.

	* configure.ac (EGREP, FGREP): New and precious variables.
	* tests/Makefile.am (tools_subst): Replace @EGREP@ and @FGREP@.
	* tests/ftp-parser.sh (reply): Use $EGREP to detect size in answer,
	and apply a single, alternating regex.
	* tests/ifconfig_modes.sh: Replace all `grep' by $GREP.
	* tests/inetd.sh: Likewise.
	* tests/libls.sh: Likewise.  Drop unused `-e' flag.
	* tests/syslogd.sh: Likewise.  Use `$FGREP -f' instead of
	non-portable `$GREP -f'.  In two cases where `grep' needed
	multiple regexes, use $EGREP and alternating regexes.
	* tests/tools.sh.in (EGREP, FGREP): New variables.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	telnet: Validate supplied environment variables. CVE-2019-0053
	* telnet/telnet.c (suboption): Use snprintf instead of sprintf.
	* telnet/utilities.c (printsub): Likewise.

2020-01-01  Guillem Jover  <guillem@hadrons.org>  (tiny change)

	* ping/ping_echo.c (struct icmp_diag): Fix typo.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	* NEWS: Document user-visible changes since last release.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	* THANKS: Credit Mats.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	* cfg.mk: Silence 'make syntax-check'.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	* bootstrap: Updated from gnulib.

2020-01-01  Simon Josefsson  <simon@josefsson.org>

	* telnet/telnet.c (telsnd): Telnet -E(no escape) is treating
	_POSIX_VDISABLE char as escape.
	Reported by Mikhail Bychek <mikhail.bychek@sputnix.ru>.

2018-11-12  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/tftpd.c (main): Add LOG_NDELAY to openlog().  The file
	descriptor for logging must be active before chrooting happens.

2018-11-09  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

	* configure.ac (AC_PREREQ): Require autoconf 2.63.  Gnulib needs
	a more recent version due to demands put forward by libtool.

2018-09-06  Simon Josefsson  <simon@josefsson.org>

	* README-alpha (Development): Remove broken links.

	* bootstrap: Updated from gnulib.

2017-07-10  Omer Anson <oaanson@gmail.com>  (tiny change)

	* src/hostname.c (parse_file): Free name and allocate one extra
	byte for it.

2017-07-10  Omer Anson <oaanson@gmail.com>  (tiny change)

	* src/hostname.c (set_name): Handle case when hostname_new is
	NULL.

2017-07-10  Omer Anson <oaanson@gmail.com>  (tiny change)

	* ftpd/ftpd.c (options) <max-timeout>: Mention mandatory argument.

2017-06-22  Omer Anson <oaanson@gmail.com>  (tiny change)

	* ftp/main.c (main): Don't assume that uninitialized argv[argv] is
	NULL.

2017-03-04  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Use tty, not pty on Solaris.
	Setting of terminal attributes as well setting of window size
	must be done via the slave descriptor, not the master descriptor.

	* telnetd/term.c [SOLARIS || SOLARIS10] (set_termbuf):
	New variables NAME, TTY.  A call to ptsname() reveals whether
	`pty' is a master.  Then open that file, update TTY, and call
	_term_setattr().
	[SOLARIS || SOLARIS10] (init_termbuf): Simplify to use a single
	call to _term_getattr(), similar to set_termbuf().
	* telnetd/termstat.c: Include <fcntl.h>.
	[TIOCSWINSZ && (SOLARIS || SOLARIS10)] (clientstat) <TELOPT_NAWS>:
	New variables NAME, TTY.  Similar mechanism as above, but call
	ioctl with window size.
	[TIOCSWINSZ && (SOLARIS || SOLARIS10)] (defer_terminit): Likewise.

2017-03-03  Mats Erik Andersson  <gnu@gisladisker.se>

	Test utility displays some termcaps.

	* tests/Makefile.am (identify_LDADD): Set to contain
	`$(top_builddir)/lib/libgnu.a' and `$(LIBUTIL)'.
	* tests/identify.c: Include <string.h>.
	[HAVE_TERMIOS_H]: Include <errno.h>, <termios.h>, <pty.h>.
	[HAVE_TERMIOS_H && HAVE_FCNTL_H]: Include <fcntl.h>.
	[HAVE_TCGETATTR] (test_flag): New macro.
	[HAVE_TCGETATTR] (do_termcap): New function.
	[HAVE_TCGETATTR] (main): Call do_termcap().

2017-03-02  Fredrik Fornwall  <fredrik@fornwall.net>  (tiny change)

	ftp: Portability to Android.
	Without a check for HAVE_DECL_GETPASS and without making a
	local function declaration, the implicit declaration causes
	crashes on 64-bit systems lacking declared getpass(), such
	as Android.  Reported in:
	http://lists.gnu.org/archive/html/bug-inetutils/2016-10/msg00000.html

	* ftp/cmds.c [!HAVE_DECL_GETPASS] (user, account): Declare getpass()
	as external function.
	* ftp/ftp.c (login): Likewise.

2017-03-02  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Update Canadian TLD server.
	Old host name no longer exists.  Reported by Neil Mayhem:
	http://lists.gnu.org/archive/html/bug-inetutils/2017-01/msg00000.html

	* whois/tld_serv_list (.ca): New host 'whois.cira.ca'.

2017-02-27  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Portability of TTY termcap to Solaris systems.

	* telnetd/term.c: Include header <fcntl.h>.
	[SOLARIS10 || SOLARIS] (init_termbuf): If applicable, open
	the slave TTY and extract terminal capabilities, since these
	systems do not assign a line discipline to the master PTY.
	New variables NAME and TTY.

2017-02-27  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Portable option debugging.
	BSD systems assign IAC and _POSIX_VDISABLE the common decimal
	value 255. Hence the NVT enforces value duplication more often
	during their transmission, than GNU and Solaris systems do.

	* telnetd/utility.c (printsub) <LM_SLC>: Increase suboption
	pointer I sufficiently to counteract duplication.  This has
	to distinguish between in/out/none.  In recursive mode,
	suppress newline at the end of suboption printing.

	* telnetd/slc.c (send_slc) <SLC_EC, SLC_EL, SLC_EW, SLC_RP>
	<SLC_LNEXT>: Editing characters are reported using SLC_DEFAULT
	rather than ignored due to SLC_NOSUPPORT, when they are not
	supported locally.  This conforms with RFC 1184, section 2.4.
	The test for support checks the set 'current', not 'defset',
	which fits the wording found in RFC 1184.

2017-02-23  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Scrub USER from environment.
	Discard the environment variable USER.  It will later be set
	properly for autologin, but at least one BSD system passes
	a preset value when telnetd starts, a value which will cause
	rejected login when autologin is not in effect.

	* telnetd/telnetd.c (telnetd_setup): Unset environment
	variable USER before calling getterminaltype().

2017-02-21  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2017-02-21  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Debugging of mainly line mode options.

	* telnetd/telnetd.c (telnetd_run): Assemble flow control data
	in new string variable DATA, then send it and include for debug
	reporting in category 'options'.
	* telnetd/termstat.c (localstat, flowstat, clientstat): Likewise,
	also for line mode data.

	* telnetd/utility.c (printsub) <LM_MODE>: Test TBUF[0]
	to calculate replacement string, since TBUF[1] is not
	guaranteed to be initialized by the preceding snprintf().

2016-05-23  Mats Erik Andersson  <gnu@gisladisker.se>

	hostname: Avoid a trailing space.
	Suppress the space character after the last presented IP number.
	Problem reported by Terje Strand in
	http://lists.gnu.org/archive/html/bug-inetutils/2016-04/msg00001.html

	* src/hostname.c (get_ip_addresses): Emit a space character
	only in case a further IP address will be printed.

2016-02-16  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Subprivileged use case.
	A fallback for ICMP tracing relevant to GNU/Linux is implemented,
	allowing a rudimentary but suid-less use case.  The ability to
	identify intermediary hosts is missing, due to the crippled
	capability of receiving ICMP packets other than ICMP_ECHOREPLY.

	* src/traceroute.c (struct trace): New member `no_ident'.
	(trace_init): Initiate `t->no_ident'.
	<type TRACE_ICMP or TRACE_UDP>: In case a raw socket for an ICMP
	protocol fails, fall back to a datagram socket.
	(trace_read) <type TRACE_ICMP>: Short circuit `ic->icmp_id != pid'
	with the conditional `t->no_ident == 0'.
	(trace_write) <type TRACE_ICMP>: New variable I.  Initialize HDR
	to its full extent.  If `t->no_ident' is non-zero, insert our
	intended target as payload of HDR for trace identification.

2016-02-12  Mats Erik Andersson  <gnu@gisladisker.se>

	ping: Implement subprivileged echo method.
	Add fallback code usable by GNU/Linux to create a datagram
	socket for sending ICMP ECHOREQUEST.  The change is related
	to issue #37252.

	* ping/libping.c (useless_ident): New variable.
	(ping_init): When a raw socket fails, fall back to a datagram
	socket.  In case of success, increase `useless_ident' since
	the kernel choses a packet identity, overwriting our choice.
	(my_echo_reply, ping_recv): Short circuit the tests for packet
	identity with the value of `useless_identity'.

2016-02-09  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (missing ipv6 or icmp6): Disable `ping6' using
	the macro IU_DISABLE_TARGET.

2016-01-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Allow remote user in command.
	Ability implemented after a query by Andreas Adamcik, on the
	legacy use of getlogin() versus the more admitting getuid().

	* ftp/ftp.c (hookup): Check for an embedded at-sign in the input
	variable `host', keeping the rightmost part.  New variable P.
	(login): Likewise, but also using the string part to the left of
	the last at-sign as remote user name.

	* doc/inetutils.texi (ftp invocation): Document this ability.
	* NEWS: Likewise.

2016-01-22  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2015-12-29  Mats Erik Andersson  <gnu@gisladisker.se>

	tests/ftp-localhost.sh: Incomplete error handling.
	The use of sysctl(8) with option `set -e` active during
	script execution needs a robust exception handler.
	Reported by Ingo BrÃ¼ckl in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-12/msg00000.html

	* tests/ftp-localhost.sh: Locate sysctl(8) using `command`
	with an augmented search path.  When computing VALUE_V6ONLY
	in a subshell, add a short circuit with `true` to prevent
	interruption of the test script.
	(SYSCTL): New variable.

2015-10-08  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Redefine faulty macro LOG_MAKEPRI whenever needed.
	Systems with Glibc header file <syslog.h> prior to 2.17,
	are not correctly defining the helper macro LOG_MAKEPRI.
	This effects our syslog service whenever it receives kernel
	messages from a remote host.  The issue was mentioned in
	Debian's BTS as report #729666.

	* src/logprio.h [LOG_MAKEPRI]: Check that the macro does
	not shift the first argument.  If it does, undefine it and
	apply our corrected definition.
	* src/syslogd.c [LOG_MAKEPRI]: Likewise.  Display a precompiler
	warning to the effect that we have diagnosed an issue.

2015-09-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* doc/inetutils.texi (ifconfig invocation): New chapter.

2015-08-19  Mats Erik Andersson  <gnu@gisladisker.se>

	AIX systems have a system call send_file().  Rename our calls.
	* src/tftp.c (send_file): Rename to...
	(tftp_sendfile): ... this.
	(put): Call tftp_sendfile, not send_file.
	* src/tftpd.c (send_file): Rename to...
	(tftpd_sendfile): ... this.
	(formats): List tftpd_sendfile call, not send_file.

2015-08-15  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Premature connection closure.
	When many connections are attempted in quick succession,
	a substantial number of them are cancelled.  This does not
	appear for manual use cases, but for contrived automated
	set-ups.  The cause seems to be a change in the evaluation
	of pty_read(), which was done to coincide with the condition
	in use by the original BSD implementation.  Issue reported and
	suggested by Chris Severance in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-07/msg00006.html

	* telnetd/telnetd.c (telnetd_run): Break the loop only by the
	stronger condition `pty_read() < 0', i.e., only on non-masked
	read errors.  This reverts a change introduced in 2015-03-15.
	* telnetd/utility.c (pty_read): Add a comment that the read
	errors EWOULDBLOCK, EAGAIN, and EIO are treated specially.

2015-08-07  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Statistics for BSD systems.

	* ifconfig/system/bsd.c (system_fh_ifstat_query)
	(get_if_data_by_name, system_fh_missing_stat): New functions.
	(_IU_DECLARE2): New macro.
	(system_fh_rx_bytes, system_fh_rx_dropped, system_fh_rx_errors)
	(system_fh_rx_packets, system_fh_tx_bytes, system_fh_tx_errors)
	(system_fh_tx_packets, system_fh_collisions): New functions
	defined using _IU_DECLARE2.
	(system_fh_tx_dropped): New function.
	* ifconfig/system/bsd.h (_IU_CAT2, _IU_DCL, _IU_EXTRN): New
	macros identical to those in `ifconfig/system/linux.h'.
	(SYSTEM_FORMAT_HANDLER) <ifstat?, collisions, rxbytes>
	<rxdropped, rxerrors, rxfifoerr, rxframeerr, rxpackets>
	<txbytes, txcarrier, txdropped, txerrors, txfifoerr, txpackets>:
	New handler hooks.
	(system_fh_ifstat_query, system_fh_missing_stat): New prototypes.
	(system_fh_rx_bytes, system_fh_tx_bytes, system_fh_rx_dropped)
	(system_fh_tx_dropped, system_fh_rx_errors, system_fh_tx_errors)
	(system_fh_rx_packets, system_fh_tx_packets, system_fh_collisions):
	New prototypes generated by _IU_EXTERN.

2015-08-02  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Verbose report on changed flags.

	* ifconfig/changeif.c (set_flags): In verbose report mode,
	compose a message to name those flags that were set, and
	also those that were cleared.

2015-08-01  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Apply flags correctly.
	When finalizing actions, some flags could be forgotten.
	In particular, the flag 'up' was ignored whenever an
	address was assigned at the same time.  This is related
	to the fact that an invocation only effecting interface
	flags, still resulted in a full printout if interface
	status.  This latter behaviour differs from all other
	implementations and is rather annoying.  The issue was
	detected and reported by Hans-Peter Budek in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-07/msg00000.html

	* ifconfig/options.c (pending_setflags, pending_clrflags):
	Define as static variables.
	(pending_valid): New variable.
	(argp_options) <message 'up'>: Delete the claim that 'up' be
	a default action together with address.
	(parse_opt_set_flag): When `ifp' exists, update `ifp->valid'
	with IF_VALID_FLAGS.  Otherwise, update `pending_valid'.
	(parse_opt_finalize): If `ifp' exists and `pending_valid` is
	set, then update `ifp->valid'.  The update of `ifp->setflags'
	and `ifp->clrflags' is performed independently of assigning
	an output format, as the latter would cause a printout also
	when only some flag is being altered.
	* ifconfig/options.h (IF_VALID_FLAGS): New macro.
	(IF_VALID_HWADDR): Updated value.
	(pending_setflags. pending_clrflags): Removed declaration.

2015-07-30  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: A work-around specific to GNU/Hurd.
	This system uses a mixture of BSD definitions
	and GNU/Linux interfaces.  In particular, some
	care is needed to check interface hardware type.

	* ifconfig/system/hurd.c (_ARP_MASK): New macro.
	(arphrd_symbols): Apply _ARP_MASK to each member `value'.

2015-07-25  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Symbolic name as peer address.

	* ifconfig/changeif.c (set_dstaddr): Adapt code block used
	by set_address(), thereby first using either getaddrinfo()
	or gethostbyname() to resolve a possibly symbolic peer
	destination, then setting the established address.

2015-07-25  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Support changing of hardware address.
	Implement the setting of link level addresses
	for systems running GNU/Linux.

	* ifconfig/changeif.c [HAVE_NETINET_ETHER_H]: Include
	header <netinet/ether.h>.
	(set_hwaddr): New function.
	(configure_if): Call set_hwaddr() whenever `ifp->valid'
	contains IF_VALID_HWADDR.
	* ifconfig/options.c (ifconfig_initializer): Add a further
	NULL at the end.
	(parse_opt_set_hwaddr): New function built by the generic
	macro PARSE_OPT_SET_ADDR.
	* ifconfig/options.h (struct ifconfig): Define IF_VALID_HWADDR
	and add a new member `hwaddr'.
	(parse_opt_set_hwaddr): New prototype.

	* ifconfig/system/linux.c (system_help): Add parsed option
	`ether|hwaddr|lladdr MACADDR'.
	(system_parse_opt_rest): New enum value EXPECT_HWADDR.  Insert
	this into the parser, triggering on all the keywords `ether',
	`hwaddr', and `lladdr' for best portability.

2015-07-21  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Implement a hardware list for BSD systems.
	Patterned on the hardware recognition already in use
	by GNU/Linux, use a similar mechanism for all of BSD.

	* ifconfig/system/bsd.c (print_hwaddr_ether): New function.
	(ift_symbols): New variable.
	(ift_findvalue): New function.
	(system_fh_hwaddr_query, system_fh_hwaddr)
	(system_fh_hwtype_query, system_fh_hwtype): Adjust mechanisms
	to use the table `ift_symbols' via ift_findvalue().


	ifconfig: Report tunnels in two more formats.

	* ifconfig/options.c (formats) <gnu-one-entry format>:
	Add two entries for the endpoints of tunnels.
	<osf format>: Add a line to display tunnels.


	ifconfig: Add a missing interface flag.

	* ifconfig/flags.c [IFF_CANTCONFIG] (if_flags): Add the
	extended interface flag `CANTCONFIG'.

2015-07-20  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: More info on tunnel interfaces.

	* ifconfig/options.c (formats) <net-tools format>: Add
	destination address for point-to-point interfaces.  It is
	present in some other formats.
	<unix format>: Display tunnel addresses for p-t-p interfaces.
	<osf format>: Add destination address for p-t-p interfaces
	and hardware type and hardware address for any device.

	* ifconfig/system/bsd.c (system_fh_brdaddr_query): Check
	that IFF_BROADCAST is set and access the relevant member
	`fp->ifa_broadaddr'.
	(system_fh_brdaddr): Check for set IFF_BROADCAST.
	(system_fh_tunnel_query, system_fh_tundst, system_fh_tunsrc):
	New functions.
	* ifconfig/system/bsd.h (SYSTEM_FORMAT_HANDLER): Add the
	keys `tunnel?', `tundst', and `tunsrc'.
	(system_fh_tunnel_query, system_fh_tundst, system_fh_tunsrc):
	New prototypes.

2015-07-18  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Integer overflow.
	During transmission of large files, size exceeding 2GB,
	a long integer variable overflows.  Issue reported and
	identified by Wenlin Kang in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-07/msg00004.html

	* src/rcp.c (sink): Change SIZE to have type `off_t'.

2015-07-18  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Improve the support for GNU/Hurd.
	Add system specific abilities, including parsing of command
	line and hardware addresses.

	* ifconfig/system.h [__GNU__]: Include "system/hurd.h".
	* ifconfig/system.c [__GNU__]: Include "system/hurd.c".
	* ifconfig/system/Makefile.am (noinst_HEADERS): Add the
	files `hurd.h' and `hurd.c'.
	* ifconfig/system/hurd.h, ifconfig/system/hurd.c: New files.

	* ifconfig/system/generic.c: Include <unused-parameter.h>.
	(system_parse_opt, system_parse_opt_rest, system_configure):
	Apply _GL_UNUSED_PARAMETER to all arguments, as these functions
	are placeholders and no-ops.

2015-07-17  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Sporadically appearing regression.
	Device flags are sometimes calculated before their
	query using SIOCGIFFLAGS.  First observed on GNU/Hurd.

	* ifconfig/printif.c (fh_brdaddr_query, fh_dstaddr_query):
	Execute ioctl(SIOCGIFFLAGS) before calculating UFLAGS.

2015-05-27  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (ACLOCAL_AMFLAGS): New variable.

2015-06-06  Guillem Jover  <guillem@hadrons.org>

	* ftp/cmds.c (setpeer): Misspelled message.

2015-05-22  Guillem Jover  <guillem@hadrons.org>

	libls: Alignment issue on sparc systems.
	The test suite executed by Debian's build daemon
	uncovered a failure on sparc due to incomplete
	alignment on word boundaries.

	* libls/fts.c (ALIGNBYTES, ALIGN): New macros.
	(fts_alloc): Add ALIGNBYTES to the size being allocated
	to P, a structure FTSENT.  Then compose the assignment of
	`P->fts_statp' with macro ALIGN to force correct alignment
	for the pointer to `struct stat'.

2015-05-19  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Fix BSD-specific interface access.
	Recently FreeBSD abandoned support for ioctl calls
	with SIOCGIFNETMASK and SIOCGIFBRDADDR.  Instead the
	use of `struct ifaddrs' is the only mechanism.  This
	had already been put to use in other cases, and is
	portably available in all BSD flavours.

	* ifconfig/system/bsd.c (system_fh_brdaddr_query)
	(system_fh_brdaddr, system_fh_netmask_query, system_fh_netmask):
	New functions.
	* ifconfig/system/bsd.h (SYSTEM_FORMAT_HANDLER): Add the new
	functions to this list, thus replacing the default handlers.
	Also add their prototypes.

2015-05-18  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Accept named, non-numerical ports.

	* ftp/cmds.c (setpeer): Test whether port string looks
	numerical.  Perform a look-up in the contrary case.

2015-05-17  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Regression during interface selection.
	Without arguments, ifconfig is expected to print status
	of all interfaces that are in state `UP'.  The mechanism
	to detect this state was corrupted when 32-bit flags were
	implemented.  The issue was reported by Juergen Daubert in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-05/msg00002.html

	* ifconfig/printif.c (fh_ifdisplay_query): Logically invert
	every use of N.
	[SIOCGIFFLAGS] (fh_ifdisplay_query): Calculate UFLAGS after
	executing `ioctl(SIOCGIFFLAGS)', since only then is the value
	of `form->ifr->ifr_flags' valid.  This side effect of ioctl()
	was not taken into account in previously committed code with
	32-bit flags.

2015-05-13  Guillem Jover  <guillem@hadrons.org>

	ping, ping6: Always use line buffered output.
	When stdout is redirected, libc will change the stream to
	be fully buffered.  Suppress this, gaining the standard
	behaviour of other implementations.  Issue was first reported
	as a wishlist bug of Debian: https://bugs.debian.org/782727.

	* ping/ping.c (main): Request line buffering on stdout, adding
	a call to setvbuf().
	* ping/ping6.c (main): Likewise.

2015-05-12  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Add announce-gen.

2015-05-02  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/inetd.sh (PASSWD, PWDDB, PROTOCOLS): New variables.
	Check for system files required by `inetd'.  Skip test when
	not found, which can happen in incomplete chroots.

2015-04-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftpd/conf.c, ftpd/ftpd.c, ifconfig/system/bsd.c,
	ifconfig/system/linux.c, libtelnet/encrypt.c: Remove
	duplicate semicolon.

2015-04-16  Mats Erik Andersson  <gnu@gisladisker.se>

	* cfg.mk (git-version-gen-tag-sed-script): New variable using
	the same sed script as found in `configure.ac'.  It is needed
	to get a more reliable target `dist'.

	* tests/.gitignore: Add some generated test products.

2015-04-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.
	* doc/.gitignore: Add `/gendocs_template_min'.  The file
	is added during bootstrap.

2015-04-09  Mats Erik Andersson  <gnu@gisladisker.se>

	Incomplete test of syslogd.
	Whenever message passing via local socket is disabled,
	the wrapping test caused a false negative.  Fix this by
	letting it fall back to an INET socket.

	* tests/syslogd.sh: Include the `wrapping message' whenever
	either of $do_unix_socket or $do_inet_socket is true.  Fix the
	counter COUNT_WRAP to be set under the same prerequisite only.

2015-04-08  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Overlapping string locations.
	Configuration lines with leading white space are normalized
	by copying a string to an overlapping location.  Issue found
	by Alex Kost and reported to us in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-04/msg00001.html

	* src/syslogd.c (load_conffile): Declare P in smallest
	possible code block.  Use `memmove' instead of `strcpy'
	to neutralize the effects of overlapping locations.

	* tests/syslogd.sh: Add a new test case, checking resistance
	to leading white space and wrapped lines in configuration file.
	(OUT_NOTICE, COUNT_NOTICE, wrapped, COUNT_WRAP): New variables.

2015-04-02  Mats Erik Andersson  <gnu@gisladisker.se>

	Testing of inetd service.

	* tests/inetd.sh: In verbose mode, report the value of USER.
	Include a printout of the configuration file when the SIGHUP
	test loop fails.

2015-03-31  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Re-order chapters.

2015-03-30  Mats Erik Andersson  <gnu@gisladisker.se>

	Texinfo: Slight reordering of nodes.
	This makes all chapters consistent in themselves.

	* doc/inetutils.texi: Put direntry `dnsdomainname' first in
	dircategory `Individual utilities', for alphabetic reasons.
	Interchange nodes `dnsdomainname invocation' and `hostname
	invocation' in response to that change.
	(ftp invocation): In sub-menu, move `The .netrc file' to be
	last entry in the list.  Move the node `Ftp environment' from
	last to third relative position in this chapter.  Position
	three comes from the ordering in the established sub-menu.

2015-03-30  Mats Erik Andersson  <gnu@gisladisker.se>

	Texinfo: Improve typeset output.

	* doc/inetutils.texi: Replace all @smallexample by @example.
	(inetd invocation): Make the multi-line example two spaces
	narrower in order to fit into a rendered PDF page.
	(tftpd invocation): Rephrase a sentence for easier line breaks,
	thus avoiding text extending into the right margin.

2015-03-21  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability of time format string.

	* telnetd/utility.c (_var_short_name) <case 'd'>: Change `%P'
	to `%p' in format string for strftime(), as the former is a
	GNU exclusive extension of no portability at all.  Another
	conversion specifier `%l' is not POSIX conforming, but seems
	to be generally supported, so it is left untouched.

2015-03-20  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Texinfo documentation.

	* doc/inetutils.texi (telnetd invocation): Add a section
	on the use of replacement tokens in the execution string.

2015-03-19  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Enable autologin in legacy mode.
	Without Kerberos authentication the autologin code was not
	determining what user name to hand over to the login service.
	Adding the user name, when applicable, resolves the issue.
	Bug was reported by Kuaikuai Wu in
	http://lists.gnu.org/archive/html/bug-inetutils/2014-12/msg00010.html

	* telnetd/telnetd.c [SOLARIS10] (login_invocation):
	Add device path "-d %L" and user name "%U", the latter
	in the form of an else clause to the selector "%?u".
	[!SOLARIS10] (login_invocation): Likewise for "%U" only.

	* telnetd/utility.c (getterminaltype): Change the paramater
	name `user_name' to `uname', as the former shadows a precious
	and global variable name.
	(_var_short_name) <case 'L'>: New case, returning full path
	to the PTY device assigned to client.
	<case 'U'>: New case, returning a copy of the environment
	variable USER, or an empty string.

2015-03-16  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Honour host aliases.
	While establishing the connection, do not replace the desired
	peer name with its canonical name.  This prevents correct use
	of the netrc file.  Bug reported by John Sullivan in
	http://lists.gnu.org/archive/html/bug-inetutils/2015-02/msg00000.html

	* ftp/cmds.c (setpeer): Do not assign value from hookup()
	to HOST.  Instead, only test if it is non-null.

2015-03-15  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Suppress PTY packet data.
	The server is receiving PTY input in packet mode, but is not
	properly discarding PIOCPKT_DATA before handing over input
	to the network socket.  Do this correctly.

	* telnetd/telnetd.c (telnet_run) <input from pty>: Break the
	loop also if pty_read() returns zero.  Add a final call to
	pty_get_char() before ending FD_ISSET(pty, &ibits).  This call
	was mistakenly located within the subcase where TIOCPKT_NOSTOP
	or TIOCPKT_DOSTOP is handled.

2015-03-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Complaints during IPv6-less testing.
	Unused IPv6 directives cause logged complaints by inetd.

	* tests/ftp-localhost.sh: Add a tcp6 listener to `inetd.conf'
	only if TEST_IPV6 is not `no'.
	* tests/tftp.sh: Likewise with udp6.

2015-03-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Build failures while IPv6 is disabled.

	* configure.ac (ENABLE_hstrerror): New conditional variable.

	* src/rlogind.c [IPV6] (checkhost): Move right parenthesis
	outside of precompiler conditional.

	* telnetd/Makefile.am [ENABLE_hstrerror]: Add $(LIBRESOLV)
	to LDADD.  With IPv6 disabled, the code in `telnetd/telnetd.c'
	uses hstrerror(), so Solaris must link against libresolv.

2015-02-28  Mats Erik Andersson  <gnu@gisladisker.se>

	Fully configure testing without IPv6.
	Pick up testing addresses for IP and IPv6 at configuration time.
	Now a BSD jail can successfully test all network services.

	* configure.ac (TARGET, TARGET6): New precious variables.  Set their
	default values.
	* tests/Makefile.am (tools_subst): Add TARGET and TARGET to substi-
	tution rules.
	* tests/tools.sh.in (TARGET, TARGET6): New variables.

	* tests/ifconfig.sh (TARGET, target): New variables.
	(find_lo_addr): Replace hardcoded `127.0.0.1' with `$target'.
	* tests/ping-localhost.sh <ping6>: Add a test `$TEST_IPV6 != no'.
	* tests/syslogd.sh (TARGET6): Remove surrounding brackets.
	<$TEST_IPV6 != no>: Enclose `$TARGET6' in brackets for `$LOGGER'.

2015-02-27  Mats Erik Andersson  <gnu@gisladisker.se>

	Allow testing without IPv6.
	Configuration with `--disable-ipv6' as well as individual
	tests with `TEST_IPV6=no' need to avoid mandatory IPv6.

	* configure.ac (TEST_IPV6): New precious variable.
	* tests/Makefile.am (tools_subst): Add substitution of TEST_IPV6.
	* tests/tools.sh.in (TEST_IPV6): New variable.

	* tests/ftp-localhost.sh: Check `$TEST_IPV6 != no' before adding
	any test cases with IPv6 addressing.
	* tests/syslogd.sh: Likewise.
	* tests/telnet-localhost.sh: Likewise.
	(TARGET46): New variable, defaulting to `::ffff:$TARGET'.

	* tests/tftp.sh (TARGET, TARGET6): New variables.
	<$ADDRESSES = sense>: Compute this case before building a default
	address list.  Add switch `-a' when executing $IFCONFIG.
	(ADDRESSES): Start with TARGET, add TARGET6 if `$TEST_IPV6 != no'.

2015-01-31  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet: Printing of uninitialized characters.
	When preparing submodes of linemode for presentation, in case
	no submode is set, the string to be printed might make use of
	uninitialized string content, in an otherwise sane call to
	fprintf().  This is in error already in the legacy code.

	* telnet/utilities.c (printsub) <LM_MODE>: Test TBUF[0]
	to calculate replacement string, since TBUF[1] is not
	guaranteed to be initialized by the preceding sprintf().

2015-01-30  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2015-01-20  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Incomplete processing of PTY data.
	The reception of SIGCHLD can make the transfer of data from
	the PTY stream to the client side's network stream incomplete.
	The problem was raised as Debian Bug #607415, but is applicable
	also here, due to a common origin.  A setting with the option
	`-E /some/script' displays this error irregularly.

	* telnetd/telnetd.c (pending_sigchld): New variable.
	(telnetd_setup): Call setsig() when assigning SIGCHLD.  Set the
	action to chld_is_done().
	(telnetd_run) <I/O-loop>: If pending_sigchld is set, flush the
	network output buffer and exit the loop with cleanup(SIGCHLD).
	(chld_is_done): New function, used as signal action.

	* telnetd/utility.c (pty_read) <DEBUG>: Set consistent text
	prefixes in output.
	(printdata): Cast char array value as `unsigned char' to avoid
	an implicit cast as integer, implied in the format string `%02x'.

2015-01-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* telnetd/state.c (dooption) : Remove outdated and misnamed
	ifdef on TELOPT_ENVIRON.
	(suboption): Remove outdated ifdef on TELOPT_NEW_ENVIRON.
	(send_status) <DEBUG>: Pass only the suboption payload into
	printsub(), by stepping over IAC+SB in the string buffer.
	* telnetd/utility.c (printsub) <default>: When an unexpected
	mode must be reported numerically, print the correct byte in
	pointer[0], not some other pseudo-random value.

2014-11-11  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2014-11-11  Mats Erik Andersson  <gnu@gisladisker.se>

	ping: Fix testing when ping6 is not built.
	Reported by jb999 in bug-inetutils.

	* tests/ping-localhost.sh: Bracket test clauses to
	conform with intuitive logic and precedence rules.

2014-10-17  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd, logger: Incomplete range checking.

	* src/logger.c (IU_MAX_FAC): Delete macro.
	(decode): Use LOG_FACMASK in range checking.  The use of
	numeric facilities was broken for the most part.

	* src/logprio.h [!LOG_MAKEPRI] (LOG_MAKEPRI): Change to
	a portable and correct definition.
	[!INTERNAL_MARK] (INTERNAL_MARK): Adjust to the corrected
	behaviour of LOG_MAKEPRI.

	* src/syslogd.c [!LOG_MAKEPRI] (LOG_MAKEPRI): Change to
	a portable and correct definition.
	(printline): Reset `pri' to DEFUPRI whenever the facility
	is non-existent.  This protects against CVE-2014-3684.
	Make a three bit shift of LOG_KERN for code consistency.
	(cfline): After decoding priority, check also upper limit.
	Likewise for facility, and update `facilities_seen' only
	after a completed range error check.

	* tests/syslogd.sh (OUT_UNOTICE, OUT_LOCAL0): New variables.
	(COUNT4, COUNT5, COUNT4_notice, COUNT4_illegal, COUNT5_user)
	(COUNT5_local): Likewise.
	Add three new configuration stanzas to initial setup, all with
	invalid information.  In the second setup, capture facility
	`info' exactly, and make a new `notice' also exact.  Add a
	further file in the conf-directory, specifying capture of
	`local0.=notice'.  Add five new test messages using Unix
	socket, intending to detect more accurately the handling of
	priorities, numerical as well as illegal or default values.

2014-08-29  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/libls.sh: Add a dummy execution of $LS in order
	to avoid a false negative caused by code coverage runs.

2014-08-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/libls.sh <VERBOSE>: Execute `set -x'.
	(REPLY_a1, REPLY_A1, diff): Changed.  Update the check
	based on these, thus avoiding `sed -n '$='' which could
	not be trusted on NixOS' build daemon.

2014-08-11  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/libls.sh: Improve failure diagnostic when testing
	the switches `-a' and `-A'.  The build daemon at NixOS had
	an issue during this subcase.

2014-08-03  Mats Erik Andersson  <gnu@gisladisker.se>

	Support libshishi with Sun Studio.

	* configure.ac <shishi>: Call AC_SEARCH_LIBS, not AC_CHECK_LIB,
	when looking for libshishi.  This allows the C-compiler from
	Sun Studio 12.1 to correctly detect and build shishi support.

2014-08-02  Mats Erik Andersson  <gnu@gisladisker.se>

	More tests for better code coverage.

	* tests/Makefile.am [ENABLE_libls] (dist_check_SCRIPTS):
	Add `libls.sh'.
	[ENABLE_ftp] (dist_check_SCRIPTS): Add `ftp-parser.sh'.
	* tests/ftp-parser.sh: New script.
	* tests/ifconfig.sh: Add more test cases.
	* tests/libls.sh: New script.

	* ifconfig/options.c (formats): Add format `?' as a synonym
	for format `help'.

2014-08-01  Mats Erik Andersson  <gnu@gisladisker.se>

	ping, ping6: Repair pattern production.
	A pattern stated on the command line was never made
	productive, instead only nulls were inserted to the
	correct length.

	* ping/ping.c, ping/ping6.c (pattern_len): Set to MAXPATTERN.
	(parse_opt): Size of PATTERN is now MAXPATTERN.

	* ping/ping_common.h (MAXPATTERN): New macro.
	* ping/ping_common.c (init_data_buffer): Increment I before
	checking for end of pattern.  This avoids an insertion of
	the closing null character.
	(decode_pattern): Remove _GL_UNUSED_PARAMETER on `pattern_data'.
	Insert scanned data C into pattern buffer.

2014-08-01  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftp/ftp.c (ptransfer): Change BS to be of type float.
	Improve readability by having speed estimates printed
	as `Mbytes/s', `kbytes/s', or `bytes/s' as suitable.

2014-07-30  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/utility.c (nextitem, netclear, printoption, printsub)
	(printdata): Remove register keyword usage.

	(printsub): Don't add integer to string to try and skip quote.

2014-07-28  Giuseppe Scrivano  <gscrivan@redhat.com>

	* tests/ls.c: Include <config.h> not "config.h".

2014-07-26  Mats Erik Andersson  <gnu@gisladisker.se>

	whois: Cooperate with misbehaving servers.
	Some servers, like "whois.ripe.net", "whois.arin.net",
	and "whois.eu", partially abort communication when the
	socket is closed for writing.  Report by Alexander Zubkov:
	<http://lists.gnu.org/archive/html/bug-inetutils/2014-07/msg00003.html>.

	* whois/whois.c (gwhois_argp_options): Increase GRP
	and insert a separating subheader.
	(do_query): Remove call to shutdown().  The alternate
	and much similar lookup call query_crsnic() did not
	half-close the socket for writing.

	* doc/inetutils.texi (whois invocation): Add a section
	about environment variables accessed by `whois'.

2014-07-22  Mats Erik Andersson  <gnu@gisladisker.se>

	libls: Inconsistent options.
	The options '-l', '-m' and '-n' were not overruling each
	other in the expected manner.  Build `ls' from `libls' for
	testing purposes, but do not install it.

	* configure.ac (enable_libls): Set to `no' when testing
	against `ac_cv_func_fchdir' fails.  Publish with AC_SUBST.
	[ENABLE_libls]: New variable.
	* summary.sh.in (libls_BUILD, libls_PROPS, enable_libls):
	Detect these; report whether `libls' is being built.

	* libls/ls.c (ls_main) <'l' || 'm' || 'n'>: Reset missing
	flags correctly, in order that '-l', '-m' and '-n' overrule
	each other on the command line.

	* tests/Makefile.am [ENABLE_libls] (noinst_PROGRAMS): Add `ls'.
	[ENABLE_libls] (ls_LDADD): New variable.
	* tests/ls.c: New file.

2014-07-17  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability of canonical host name.
	In response to a numerical address, getaddrinfo()
	does not populate `ai_canonname' by necessity.

	* ftp/ftp.c (hookup): Copy `RES->ai_canonname' only
	if set.  Copy from RHOST otherwise.
	* ping/libping.c (ping_set_dest): Likewise; with P.
	* ping/ping6.c (ping_set_dest): Likewise, with RHOST.
	* src/traceroute.c (main): Likewise.

2014-07-16  Mats Erik Andersson  <gnu@gisladisker.se>

	Handle access timing in fractions of a second.

	* configure.ac (HAVE_STRUCT_STAT_ST_ATIM_TV_NSEC)
	(HAVE_STRUCT_STAT_ST_ATIM_TV_USEC, HAVE_STRUCT_STAT_ST_CTIM_TV_NSEC)
	(HAVE_STRUCT_STAT_ST_CTIM_TV_USEC, HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC)
	(HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC): Check for existing time field
	for sub-second timing in `struct stat'.
	(HAVE_STRUCT_STAT_ST_BLKSTAT): Make the macro functional!

	* libls/cmp.c (modcmp) [HAVE_STRUCT_STAT_ST_MTIM_TV_NSEC]
	[HAVE_STRUCT_STAT_ST_MTIM_TV_USEC]: Compare in sub-seconds.
	(acccmp) [HAVE_STRUCT_STAT_ST_ATIM_TV_NSEC]
	[HAVE_STRUCT_STAT_ST_ATIM_TV_USEC]: Likewise.
	(statmod) [HAVE_STRUCT_STAT_ST_CTIM_TV_NSEC]
	[HAVE_STRUCT_STAT_CT_MTIM_TV_USEC]: Likewise
	(revmodcmp, revaccmp, revstatmod, revsizecmp): Replace code
	by a simple sign change of modcmp(), acccmp(), etcetera.

	* src/rcp.c [HAVE_STAT_ST_MTIMESPEC || HAVE_STAT_ST_MTIME_USEC]
	(write_stat_time): Remove unused and obsolete code.
	[HAVE_STRUCT_STAT_ST_ATIM_NSEC || HAVE_STRUCT_STAT_ST_ATIM_USEC]
	[HAVE_STRUCT_STAT_ST_MTIM_NSEC || HAVE_STRUCT_STAT_ST_MTIM_USEC]
	(write_stat_time): Code portably for sub-second accuracy.

2014-07-14  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Hash command semantic.
	Toggle hash state when argument is not set, only then.

	* ftp/cmds.c (sethash): Activate marker when a numeric
	argument is found; toggle when no argument is present.
	A non-numeric argument leads to status reporting only.

2014-06-05  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Alternate selection of .netrc file.

	* ftp/ftp_var.h (netrc): New variable.
	* ftp/main.c (argp_options) <-N/--netrc>: New option.
	(parse_opt) <'N'>: New case.
	(main): Initialize `netrc'.
	* ftp/ruserpass.c (remote_userpass): If `netrc' is NULL,
	check NETRC in environment.  Whenever `netrc' has content,
	us it instead of `~/.netrc'.  Once CFILE is valid, make
	sure that the file location is a regular file, otherwise
	returning to the interpreter.

	* tests/ftp-localhost.sh: Two new test cases, checking the
	functionality of NETRC in environment, and the option `-N'.

2014-05-16  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Size multipliers for hash increments.

	* ftp/cmds.c (sethash): New variable P.  Detect and
	apply multipliers when setting the increment size for
	hash markers, i.e., allow commands like "hash 32m".

2014-04-29  Mats Erik Andersson  <gnu@gisladisker.se>

	hostname: Degenerate cases.
	Better replies when name resolution fails.

	* configure.ac: Remove check for gethostname in libresolv.
	If hstrerror is missing, check for it in libresolv.
	(LIBRESOLV): New variable published using AC_SUBST.

	* src/Makefile.am (hostname_LDADD): New variable.

	* src/hostname.c (get_name): Call puts() only if NAME
	carries some content.  Will, most importantly, reply
	with an empty string, not an empty line, when no aliases
	are found.
	(get_aliases): Return an empty string when the host's
	name cannot be resolved.
	(get_fqdn): Fall back to the system reported hostname
	when name resolution fails.
	[HAVE_HSTRERROR] (get_ip_addresses): Exit with an error
	when name resolution fails.

	* tests/hostname.sh: Check availability of mktemp.
	(posttest): New function, used as trap.
	<root execution>: New test case with switch '-F'.

2014-04-26  Mats Erik Andersson  <gnu@gisladisker.se>

	libinetutils: Skeletal preparations for Heimdal.

	* configure.ac <krb5>: Disable rlogind and rshd.
	(KERBEROS_VERSION): Publish it using AC_SUBST.

	* libinetutils/kerberos5.c: New file, mostly copied
	in from `shishi.c' as a guide.

	* libinetutils/Makefile.am (libinetutils_a_SOURCES):
	Remove `des_rw.c', and add `kerberos5.c'.

	* libinetutils/kcmd.c: Remove support for KRB4, replacing
	all macros KERBEROS by KRB5.
	[KRB5]: Include <krb5.h> and "kerberos5_def.h".
	[KRB5] (kcmd): Update declarations, and make small,
	obvious adaptions to Kerberos5.
	(kcmd): Refactor steps common to SHISHI and KRB5, such as
	protocol exchange and address resolution.  They differ at
	the end, calling shishi_auth() or kerberos_auth().

2014-04-25  Mats Erik Andersson  <gnu@gisladisker.se>

	Begin support for Heimdal's Kerberos.
	Very incomplete code for `rsh', but a needed start.

	* libinetutils/kerberos5_def.h: New file.

	* libinetutils/krcmd.c: Remove support for KRB4, replacing
	most macros KERBEROS by KRB5.
	[KRB5]: Include <krb5.h> and "kerberos5_def.h".
	[KRB5] (kcmd, krcmd, krcmd_mutual): Update declarations,
	and make small, obvious adaptions to Kerberos5.
	[KRB5] (krcmd_mutual): Update value of AUTHOPTS.

	* libinetutils/Makefile.am (noinst_HEADERS):
	Add `kerberos5_def.h'.

	* src/rsh.c: Replace macro KERBEROS by KRB5, temporarily
	making an exception in some code related to encryption.
	[KRB5]: Include <krb5.h> and "kerberos5_def.h".
	[KRB5] (ctx, keyblock, server): New variables.
	[KRB5 && ENCRYPTION] (parse_opt) <case 'x'>: Remove
	call to des_set_key().
	[KRB5 || SHISHI] (main): Refactor code for port lookup
	and command string generation, since Kerberos5 and Shishi
	have common traits.
	[KRB5] (main): Adapt to new signatures of krcmd() and
	krcmd_mutual().  Initialize `ctx', and reimplement realm
	lookup using Kerberos5 API.

2014-04-25  Mats Erik Andersson  <gnu@gisladisker.se>

	Silence warnings with libshishi.

	* libinetutils/kcmd.c [KERBEROS || SHISHI] (kcmd):
	Declare realm argument as `const char *'.
	* libinetutils/krcmd.c [KERBEROS || SHISHI]
	(kcmd, krcmd, krcmd_mutual): Likewise.
	* libinetutils/shishi.c [SHISHI] (shishi_auth): Likewise.
	* libinetutils/shishi_def.h [SHISHI] (shishi_auth, krcmd)
	(krcmd_mutual): Likewise.
	* src/rcp.c [KERBEROS || SHISHI] (dest_realm): Likewise.
	* src/rlogin.c [KERBEROS || SHISHI] (dest_realm): Likewise.
	* src/rsh.c [KERBEROS || SHISHI] (dest_realm): Likewise.

	* src/rlogind.c (rlogind_auth): Initialize HOSTNAME.

2014-03-28  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Local time option.

	* src/syslogd.c (set_local_time): New variable.
	(option enum): Remove OPT_PIDFILE.
	(argp_options) <pidfile>: New alias 'P'.
	<-T/--local-time>: New option.
	(parse_opt) <case 'P'>: Replaces OPT_PIDFILE.
	<case 'T'>: New case.
	(logmsg): If `set_local_time' is set, use NOW to generate
	a time stamp, not the initial portion of the message.

2014-03-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Parse address family.
	Allow for address family argument on supported systems.

	* ifconfig/system/bsd.c (system_parse_opt_rest): New enum
	values EXPECT_COMMAND and EXPECT_AF.  Use the first to detect
	`create' and `destroy', but claiming lack of support.  Accept
	`inet' as family, but reject `inet6'.  Rewrite return status.
	* ifconfig/system/linux.c (system_parse_opt_rest): Rename
	enum value EXPECT_INET to EXPECT_AF.  Detect family `inet6',
	but reject it.
	* ifconfig/system/solaris.c (system_parse_opt_rest): New enum
	value EXPECT_AF.  Accept `inet' as address family argument,
	but reject `inet6'.  Rewrite return status.

2014-03-20  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Command line parsing.
	Implement flag parsing for BSD and Solaris.
	Accept only changeable flags on GNU/Linux.

	* ifconfig/system/linux.c (system_parse_opt_rest):
	Accept only masks which correspond to changeable flags,
	using IU_IFF_CANTCHANGE.
	* ifconfig/system/bsd.c, ifconfig/system/solaris.c
	(system_parse_opt_rest): New variables MASK and REV.
	Check if the command line argument can be interpreted
	as a changeable flag argument.

2014-03-15  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Changeable flags on GNU/Linux.

	* ifconfig/flags.h (IU_IFF_CANTCHANGE): Remove IFF_POINTOPOINT,
	IFF_ALLMULTI, IFF_BROADCAST, IFF_MULTICAST, and IFF_PROMISC,
	since they are changeable on GNU/Linux, and they are included
	natively in IFF_CANTCHANGE on other systems.

2014-03-13  Mats Erik Andersson  <gnu@gisladisker.se>

	logger: Source address resolution.

	* src/logger.c (open_socket) [HAVE_DECL_GETADDRINFO]
	<source is set>: Delete resolver hint for numeric address.

2014-03-10  Mats Erik Andersson  <gnu@gisladisker.se>

	hostname: Sanity checks in corner cases.

	* src/hostname.c (get_name): Use reply from get_fqdn()
	only if it gave a host name, not the artificial "(none)".
	(set_name): Reject an empty host name.
	(parse_file): Initialize NAME.  Improve error message
	when getline() claims empty input.  Break out of loop
	only if sscanf() produced a printable string.

2014-02-22  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Allow flags richer than 16 bits.
	Systems like GNU/kFreeBSD and FreeBSD use two `short int'
	to represent interface flags.  Adapt to this fact.

	* ifconfig/changeif.c (set_flags): Apply mask 0xffff to flags.
	[ifr_flagshigh]: Calculate flag changes also on ifr_flagshigh.
	* ifconfig/flags.c [IFF_PPROMISC] (if_flags): Add user land
	setable flag "PROMISC".
	[IFF_MONITOR] (if_flags): Add flag "MONITOR".
	[IFF_STATICARP] (if_flags): Add flag "STATICARP".
	[IFF_STATICARP] (flag_char_tab): Add short flag 's'.
	[IFF_MONITOR] (flag_char_tab): Add short flag 'm'.
	* ifconfig/options.c (formats) <unix>: Print flags numerically
	using format string "%x".
	* ifconfig/printif.c (put_flags): Change signature.  New type
	of F is `unsigned int'.  New variable UFLAGS.  Work with UFLAGS,
	not `flags'.
	(put_flags_short): New signature.
	[SIOCGIFFLAGS] (fh_ifdisplay_query, fh_brdaddr_query)
	(fh_dstaddr_query, fh_flags): New variable UFLAGS, replacing
	`form->ifr->ifr_flags'.
	* ifconfig/printif.h (put_flags): Change prototype.

2014-02-15  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: No listing of unchangeable flags.

	* ifconfig/flags.h [!IFF_CANTCHANGE]: Define it as naught.
	(IU_IFF_CANTCHANGE): New macro.
	* ifconfig/flags.c (if_list_flags): Do not list flags that
	are known to give constant properties.  New macro FLAGS_COMMENT.
	Add its contents to the end of the requested flags listing.
	Skip a named flag if it matches IU_IFF_CANTCHANGE.  Also skip
	flags named like 'link2/altphys', since their components
	do appear in the listing.


	Portability issues in test script.

	* tests/ifconfig_modes.sh (MTU): Set to 1324 initially,
	to get above 1280 needed for IPv6 compatibility.
	The switch '-o' of uname is not portable.

2014-02-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/ifconfig_modes.sh: Add test case to explain
	failures to automatically bring the interface up at
	an address change.  GNU/Linux is affected by this.

2014-02-14  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/flags.c (if_list_flags): Increment counter
	only in the for-statement; update the insertion of list
	delimiters.  Each second flag name was falsely scrubbed.

2014-02-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Script for testing of ifconfig's modes.
	Will document all tested features.

	* tests/ifconfig_modes.sh: New file.  Intentionally
	without execution bit, and not for automatic testing.
	* tests/Makefile.am (EXTRA_DIST): Add `ifconfig_modes.sh`.

2014-02-12  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/options.c (formats): Add format `check'
	as a synonym for `check-existence'.

2014-02-09  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Detect one-time passwords.
	RFC 2228 reserves response code 336 for replies
	used with challange-response authentication.

	* ftp/cmds.c (user): React to response code 336 within
	FTP command `USER', print its message, and possibly
	discard an already supplied password.
	* ftp/ftp.c (login): Likewise.

2014-02-09  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Parse commands of RFC 2228.
	Tokens are implemented, but no actions.

	* ftpd/ftpcmd.y (ADAT, AUTH, CCC, CONF, ENC, MIC, PBSZ)
	(PROT): New tokens.
	(cmdtab): New entries `ADAT', `AUTH', `CCC', `CONF', `ENC',
	`MIC', `PBSZ', and `PROT'.  All are marked as unimplemented.

2013-12-23  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi (rsh invocation): Use @item for first entry
	in @table.

2013-12-19  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2013-12-13  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Follow RFC 2577 by default.
	Prevent user name guessing as standard, but offer
	an option to keep the more informational responses.

	* ftpd/extern.h (logged_in): Remove unused variable.
	(rfc2577): New variable.
	(struct credentials): New component DELAYED_REJECT.
	* ftpd/ftpd.c (rfc2577): New variable.
	(OPT_NONRFC2577): New enum value.
	(options): New option `--non-rfc2577'.
	(parse_opt) <case OPT_NONRFC2577>: Reset `rfc2577'.
	(user): New variable RET.  After auth_user(), display
	messages in the old manner only if `rfc2577' is not set,
	or if guest access is being requested.  Otherwise, update
	`cred.delayed_reject' for later access.
	(end_login): Reset `pcred->delayed_reject'.
	(pass): On returning from auth_pass(), check also
	`cred.delayed_reject' to minimize the amount of user
	information returned to the client.


	ftpd: The standard protocol in RFC 959 demands
	that a client be informed before closing down.

	* ftpd/ftpd.c (pass) <repeated login failures>:
	Send a reply message 421 before closing connection.

2013-12-10  Mats Erik Andersson  <gnu@gisladisker.se>

	inetd: Logging of resolution and binding errors.

	* src/inetd.c (setup): Alternate syslog format,
	and debug message, when a service node has been set.
	(expand_enter): Likewise, adding debug message.


	ftp: Trivial misspelling.  Reported by Joe Steffee in
	<http://lists.gnu.org/archive/html/bug-inetutils/2013-11/msg00000.html>.

	* ftp/ftp.c (hookup): Spell `response' correctly.

2013-11-28  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind, telnet, telnetd: Modify exit status.

	* src/rlogind.c (rlogind_mainloop): Delay cleanup()
	call until libshishi has torn down its structures.
	(cleanup): New variable STATUS.  If `signo' is SIGCHLD,
	call waitpid() to reap the waiting child process and
	use its return status for the whole server's status.
	Waiting for the child resolves a race condition when
	tearing down the pseudo-terminal pair, since the slave
	now is gone when the master side is being closed down.

	* telnet/commands.c (tn): Use exit status 0 when setjmp()
	manages to execute telnet().  Otherwise, keep 1.
	(command) [unix || __unix || __unix__]: Enclose the
	complete else-block within preprocessor conditionals.

	* telnetd/pty.c (cleanup): Let STATUS have full scope
	in this function, and use it for exit().  Execute waitpid()
	only if `sig' is SIGCHLD, and update STATUS for later use.
	On SIGHUP, set STATUS to success, which happens only at
	reception of TELOPT_LOGOUT from client.
	* telnetd/state.c (dooption) <TELOPT_LOGOUT>: Call cleanup()
	with argument SIGHUP, since the client willingly leaves off.

2013-11-24  Mats Erik Andersson  <gnu@gisladisker.se>

	inetd: Ensure successful daemon mode.

	* src/inetd.c (main) <!debug>: Abort with a syslog message,
	should daemon() return unsuccessfully.
	* libinetutils/daemon.c (waitdaemon): Return with failure,
	should chdir("/") fail.


	Check all calls to chdir.

	* src/rshd.c (doit): Make a syslog error message and abort
	execution, should chdir("/") fail.
	* src/uucpd.c (doit): Abort with a message to stderr,
	should chdir("/") fail.

2013-11-23  Mats Erik Andersson  <gnu@gisladisker.se>

	Check all returns from fgets.
	Handle every failed fgets() with care.

	* ftp/cmds.c (user): Set account string to empty when
	fgets() fails.
	* src/rexec.c (main): Likewise for password string.
	* src/tftp.c (get_args): Call makeargv() only on successful
	call to fgets().  Otherwise, instantiate a trivial command
	list containing command name only.
	* telnet/commands.c (setescape): Leave escape character
	unchanged when fgets() fails.
	(tn) <get host>: Call makeargv() only for successful fgets().
	Otherwise, print a message and rely on later usage printout.
	(command): Print a line feed at EOF on stream error.

2013-11-15  Mats Erik Andersson  <gnu@gisladisker.se>

	tftp: Buffer size checking.
	Hardened builds need a helping hand in interpreting
	a bogus array length.

	* src/tftp.c (makerequest): New variables ARGLEN, LEN.
	Use them in calculating available space for file name.
	[HAVE_STRUCT_TFTPHDR_TH_U]: Calculate CP using an offset
	argument.  Needed to prevent false negatives from stack
	allocation protectors.

2013-11-05  Mats Erik Andersson  <gnu@gisladisker.se>

	Improve detection of readline.

	* am/readline.m4 (gl_FUNC_READLINE): Check for libedit
	with AC_LIB_LINKFLAGS_BODY and with AC_CACHE_CHECK.
	<readline in libreadline>: Ignore <editline/readline.h>.
	<readline in libedit>: Prefer <editline/readline.h>.
	Define HAVE_READLINE if readline() was located in one of
	the libraries, and if its use had not been disabled.
	Define HAVE_LIBREADLINE and HAVE_LIBEDIT if it was found
	in the corresponding library.
	* ftp/Makefile.am (LDADD): Remove $(LIBGLOB), $(LIBTERMCAP).
	The latter is handled by LIBREADLINE.

	* configure.ac (ftp_PROPS): Do not add $LIBTERMCAP.

2013-10-16  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd, talkd: Act on failed read_utmp.

	* src/syslogd.c (wallmsg)
	[UTMP_NAME_FUNCTION || !HAVE_GETUTXENT]: Check call
	to read_utmp() for failure, filing an error massage.
	* talkd/process.c (find_user) [!HAVE_GETUTXUSER]:
	Likewise, then returning FAILED.

	rsh: Symbolic descriptor name.

	* src/rsh.d (talk): Use STDOUT_FILENO and STDERR_FILENO
	as arguments to write().

2013-10-16  Mats Erik Andersson  <gnu@gisladisker.se>

	rsh: Kill child process after SIGPIPE.
	The default action for SIGPIPE will leave the
	child process running.  This caused, until now
	and including legacy implementations, blocking
	of stdin, and to conditionally leave also the
	remote server running.

	* src/rsh.c (end_of_pipe): New variable.
	(sigpipe): New function.
	(talk) [HAVE_SIGACTION]: New variable SA.
	<parent process>: Assign a signal handler to SIGPIPE.
	Add `&& !end_of_pipe' to the loop condition, so that
	talk() returns after SIGPIPE.  The child process will
	then be killed at the end of main().

2013-10-06  Mats Erik Andersson  <gnu@gisladisker.se>

	rsh: Detach input stream.
	The option `-n/--no-input' was incomplete.

	* src/rsh.c (main) <try_connect && null_input_option>:
	Call shutdown(SHUT_WR) on socket REM.
	(talk): Use symbolic macro SHUT_WR in shutdown().

	* doc/inetutils.texi (rsh invocation) <option '-n'>:
	Give an accurate description, forgetting about stderr.


	rshd: Better adaption to BSD.

	* src/rshd.c (doit): Use SHUT_RDWR in shutdown().
	(doit) [SHISHI] <verify checksum>: Rename local PORT
	to PPORT, since is shadows a variable of wider scope.
	(doit): Delay the call of setpgid() to also execute
	in the child process when PAM is supported.
	(doit) [HAVE_SETLOGIN]: Call setsid() and setlogin().
	Replace conditional `BSD > 43' with HAVE_SETLOGIN for
	better precision.
	[!HAVE_SETLOGIN]: Keep old call to setpgid().

2013-10-06  Mats Erik Andersson  <gnu@gisladisker.se>

	rexec: No echoing of passwords.

	* src/rexec.c: Include <termios.h>.
	(main) <password is '-'>: Call isatty().  If this
	is a terminal, print `Password:' and disable echo
	while reading password string.
	(do_rexec) <FD_ISSET(STDIN_FD)>: Write input from
	client to the outgoing socket SOCK.  This restores
	the ability to transfer contents to the server.


	rexecd: Better adaption to BSD.

	* configure.ac: Check for function setlogin.
	* src/rexecd.c (doit) [HAVE_SETLOGIN]: Before
	setting underpriviledged user, call setlogin().
	(doit) <with error port && child process>:
	Close PV[1], which is duplicate of stderr.
	[HAVE_SETLOGIN]: Call setsid(), not setpgid().

2013-10-03  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (HAVE_SYSLOG_INTERNAL): Remove
	a misplaced character.

	* am/libcurses.m4 (IU_LIB_TERMCAP): Rework the
	message in AC_MSG_CHECKING() and always call
	AC_MSG_RESULT().

2013-10-02  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Capture syntax errors.
	Scanner and parser are insufficiently trimmed to
	each other, producing duplicate and inconclusive
	diagnostic messages.

	* ftpd/ftpcmd.y (yylex) <STR1 || ZSTR1 || dostr1>:
	Remove a break at the end, continue into ZSTR2.
	This allows detection of syntax errors.  A test
	case is `quote site chmod 0750' by a client.
	(yylex): Call yyerror() only if `yynerrs' is zero.
	Otherwise both scanner and parser would send error
	messages to the client.  Specify an explicit message
	in this call to yyerror().
	(yyerror): Use parameter `s' in reply message, but
	keep a default message in case `s' is empty.  This
	passes on any diagnostic message from the parser.

2013-09-26  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Implement FEAT and OPTS.
	Add two commands in accordance with RFC 2389.

	* ftpd/ftpcmd.y (cmdtab, sitetab): Change to static.
	(extlist): New variable, listing command extensions.
	(FEAT, OPTS): New tokens.
	(cmd) <FEAT || FEAT STRING || OPTS || OPTS STRING>:
	New cases.
	(cmdtab): Put commands in the order of RFC 959.
	Add FEAT and OPTS.
	(sitetab): Use lexicographic order.

2013-09-26  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Abort transfer in ascii mode.
	If the local ascii file causes a seek failure,
	then tell the server to abort transmission.

	* ftp/ftp.c (sendrequest) <restart_point && (STOR || APPE)>:
	Change RC to off_t.  On seek failure, send ABOR command,
	and get the reply.
	(recvrequest) <TYPE_A && restart_point>: Reset `errno'.
	<label done>: Send ABOR command, get reply.  Produce correct
	error message if stepping through the local file gave EOF.


	ftpd: Error message after seek failure.
	The standard RFC 1123 introduced a better error code 554
	to be used when a restart command is not successful.

	* ftpd/ftpd.c (retrieve) <restart_point && TYPE_A>: Reply
	with error code 554 if EOF was reach while seeking in file.
	<restart_point && !TYPE_I>: Likewise when lseek() gave EINVAL.
	(store) <restart_point>: Likewise for both modes.

2013-09-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Setting of idle time.
	The command to change idle time was broken.

	* ftpd/ftpcmd.y (cmd) <SITE IDLE NUMBER>: The token IDLE
	must go before `check_login' to avoid a lookahead syntax
	error.  Adjust the parameter reference for `check_login'.

2013-09-19  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Status and medium reports on BSD.

	* ifconfig/options.c (formats) <gnu, net-tools, unix>:
	Add medium and status to printout.
	* ifconfig/printif.c (format_handles): Add keys
	`media?', `media', `status?', and `status'.
	(fh_media_query, fh_media, fh_status_query, fh_status):
	New functions.
	* ifconfig/printif.h (fh_media_query, fh_media)
	(fh_status_query, fh_status): New declarations.

	* ifconfig/system/bsd.c: Include <net/if_media.h>.
	(ifm) [SIOCGIFMEDIA]: New variable.
	(media_descr): New variable.
	(subtype_descr) [IFM_SUBTYPE_DESCRIPTIONS]: Likewise.
	(ethernet_descr) [IFM_SUBTYPE_ETHERNET_DESCRIPTIONS]:
	Likewise.
	(subtype_shared_descr) [IFM_SUBTYPE_SHARED_DESCRIPTIONS]:
	Likewise.
	(option_descr): Likewise.
	(status_descr) [IFM_STATUS_DESCRIPTION]: Likewise.
	(system_fh_media_query, system_fh_media)
	(system_fh_status_query, system_fh_status): New functions.
	* ifconfig/system/bsd.h (SYSTEM_FORMAT_HANDLER):
	Add keys `media?', `media', `status?', and `status'.
	(system_fh_media_query)
	(system_fh_media, system_fh_status_quey, system_fh_status):
	New declarations.

2013-09-18  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Added the
	sc_cast_of_x_alloc_return_value, sc_copyright_check,
	sc_program_name, sc_prohibit_always_true_header_tests,
	sc_prohibit_assert_without_use, sc_prohibit_doubled_word,
	sc_prohibit_error_without_use, sc_prohibit_have_config_h,
	sc_prohibit_magic_number_exit, sc_prohibit_strncpy,
	sc_prohibit_undesirable_word_seq, sc_prohibit_xalloc_without_use
	to list.

2013-09-15  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet: Uninitialized array of pointers.
	Contemporary tgetent() emulations are known to ignore
	the scratch buffer, as well as fill it in (contrary to
	claim in manual page).  Account for this.

	* telnet/telnet.c (mklist): Return quickly in case of
	an empty first parameter `buf'.  Carefully initialize
	`*ARGVP' to NULL at every stage.


	Harmless memory leak in test program.

	* tests/localhost.c: Include <stdlib.h>.
	(main): Remove `const' on P, and it free after use.

2013-09-12  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac: Add a relevant comment where AC_DEFINE
	and AH_TEMPLATE offered only the text `FIXME'.

	* am/result.m4 (IU_RESULT_ACTIONS): Build a relevant
	comment better than `FIXME'.

2013-09-10  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Rare memory leak.

	* ftp/ruserpass.c (remote_userpass) <missing domain>:
	Assign empty string to MYDOMAIN, do not allocate.
	The standard use is to set MYDOMAIN pointing into
	MYNAME without allocation.  Do assignment of TMP
	before if-clause.

2013-09-08  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Guard buffer size.
	An evil SHELL in environment would overflow a buffer.

	* ftp/cmds.c (shell): Step over a slash in NAMEP
	only if one was found.  Use strncat() with correct
	length parameter, instead of strcat().


	Minor coding issues.

	* ftp/ftp.c (pswitch) <struct comvars>: Declare array
	sizes for `nti[]' and `nto[]' to be identical to those
	of `ntin[]' and `ntout[]'.

	* ftp/ftp_var.h (stringbase, argbuf, argbase):
	Remove declarations.
	* ftp/main.c (argbase, argbuf, atringbase):
	New static string variables.

	* telnet/Makefile.am: Add @PATHDEFS_MAKE@.
	(AM_CPPFLAGS): Add $(PATHDEF_BSHELL).
	* telnet/commands.c (shell): Use PATH_BSHELL as default
	shell.  Put assignment before if-clause.

2013-09-08  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Legacy use with GNU/kFreeBSD.

	* configure.ac: Check for header <netinet/ether.h>.

	* ifconfig/system.c [__DragonFly || __FreeBSD__ ||
	__FreeBSD_kernel__ || __NetBSD__ || __OpenBSD__]:
	Add __FreeBSD_kernel__ to conditional.
	* ifconfig/system.h [__DragonFly || __FreeBSD__ ||
	__FreeBSD_kernel__ || __NetBSD__ || __OpenBSD__]:
	Likewise.
	* ifconfig/system/bsd.c [HAVE_NETINET_ETHER_H]:
	Include <netinet/ether.h>.
	* ifconfig/system/bsd.h (IU_BSD_TYPE)
	[__FreeBSD_kernel__]: Assign value to macro.

	* tests/ifconfig.sh: Add an informational check
	whether the legacy form `ifconfig lo0' works.

2013-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Remove line length limit.
	Once the argument parsing routine is rewritten
	to work with dynamic memory, the length limit
	on input lines can be removed in its entirety.

	* ftp/extern.h (slurpstring): Remove declaration.
	* ftp/ftp_var.h (argbuf): Change to string pointer.
	(MAXMARGV) [!MAXMARGV]: New macro.
	(margv): Change array length to MAXMARGV.

	* ftp/main.c (slurpstring): Declare as static.
	(main): Initalize `argbuf' to NULL.
	(cmdscanner): Remove check whether `line' exceeds
	MAXLINE in length.
	(slrflag): Declare as static.
	(makeargv): Free and allocate `argbuf' at entry.
	Insert a condition to ensure that at most MAXMARGV
	arguments are located, thus avoiding an overflow.

	* ftp/ruserpass.c (tokval): Change array length
	to BUFSIZ.

2013-09-06  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Macro execution and allocation.
	During macro execution, string parsing and
	substitution is rewritten to use dynamically
	allocated memory.

	* ftp/domacro.c (lengthen): New static function.
	(domacro): New variables ALLOCFLG, LINE2LEN.
	New label END_EXEC.  The variable LINE2 is no
	longer allocated, instead it stores the previous
	global `line' for repeated access.  A temporary
	string pointer `line' is dynamically allocated
	and is adjusted using lengthen().  Recovery from
	allocation failures jump to END_EXEC.  `line' is
	restored from LINE2 before exiting.

2013-09-05  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Minor allocation issues.
	Fix issues related to the global variable `line'.

	* ftp/cmds.c (another): New variable NEW.  Assign
	outcome of realloc() to NEW, to better avoid memory
	leakage.  Determine new size with `linelen'.
	(confirm): Rename LINE to INPUT, which does not
	shadow the global variable `line'.

	* ftp/domacro.c: Include <stdlib.h>.
	(domacro): Change LINE2 to a string pointer.
	Assign LINE2 using strdup(), freeing it later.

	* ftp/ftp.c (login) <execution of macro `init'>:
	Allocate MAXLINE bytes; set `linelen'.

	* ftp/ftp_var.h (linelen): New variable.

	* ftp/main.c (main): Reset `line', `linelen'.
	(cmdscanner): Remove LEN, using `linelen' instead.

2013-09-05  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Macro execution segfaults.
	Abort macro execution when command is ambiguous,
	is invalid, or if the control connection has been
	lost.  Otherwise segmentation faults can happen
	when the macro includes further commands.

	* ftp/domacro.c (domacro) <ambiguous, invalid>
	<not connected>: Reset LOOPFLG and break loop.
	Error message gives name of offending command.

2013-09-03  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Avoid numeric size of char array.

	* ftp/cmds.c (macdef): Use sizeof() to avoid size
	knowledge about arrays `struct macel.mac_name'
	or `macbuf'.
	* ftp/domacro.c (domacro): Likewise.
	* ftp/ruserpass.c (remote_userpass): Likewise.
	Change type of I to size_t.

	* doc/inetutils.texi <ftp invocation>: Mention
	restriction on macro naming.

2013-08-31  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/syslogd.sh: Lengthen sleeping periods.
	Add better diagnostics when some test case fails.

2013-08-31  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftpd/ftpd.c (statcmd): Report session timeout.

2013-08-31  Mats Erik Andersson  <gnu@gisladisker.se>

	Support BSD libedit.  (Used on GNU/kFreeBSD.)

	* am/readline.m4 (gl_FUNC_READLINE): Check for headers
	before library linkage.  Check for header file variants
	<editline/readline.h> and <editline/history.h>.
	While testing linking against libreadline and libedit,
	conditionally use HAVE_*_READLINE_H to include the
	correct header file.

	* ftp/cmds.c, ftp/main.c
	[!HAVE_READLINE_READLINE_H && HAVE_EDITLINE_READLINE_H]:
	Include <editline/readline.h>
	[!HAVE_READLINE_HISTORY_H && HAVE_EDITLINE_HISTORY_H]:
	Include <editline/history.h>

2013-08-30  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2013-08-29  Mats Erik Andersson  <gnu@gisladisker.se>

	Handle socket debugging.

	* ftp/ftp.c (initconn) <passivemode>: Suppress error
	message for errno EACCES while setting SO_DEBUG.  This is
	a minor part of debug mode, and denial is system dependent.
	Else report using error(), not perror().  Add DEBUG to text.
	<label noport>: Likewise.

	* src/inetd.c (setup): Likewise.

	* src/rsh.c (main) <try_connect && debug_option>:
	Improve error message to mention DEBUG.

2013-08-28  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: New command `lpwd'.

	* ftp/cmds.c: Include "xgetcwd.h".
	(lcd): Remove external prototype of xgetcwd().
	(lpwd): New function.
	* ftp/cmdtab.c (lpwdhelp): New variable.
	(cmdtab): Add entry for `lpwd'.
	* ftp/extern.h (lpwd): New prototype.

	* ftp/main.c (argp_options) <-d/--debug>:
	Improve relevance of help message.

2013-08-28  Mats Erik Andersson  <gnu@gisladisker.se>

	Identification of unices.  Check `__unix' and
	`__unix__' in addition to `unix'.  This is needed
	for `ftp' with GCC on NetBSD, OpenBSD.  Both macros
	are necessary to distinguish AIX and HP-UX!

	* ftp/cmds.c (setpeer)
	[(unix || __unix || __unix__) && (NBBY==8)]: Add
	macros __unix and __unix__ in conditional; this
	sends initial SYST request from NetBSD and OpenBSD.

	* ftpd/ftpcmd.y (cmd) [unix || __unix || __unix__]:
	Likewise; announce system as UNIX.

	* telnet/commands.c (Togglelist, filestuff)
	[(unix || __unix || __unix__) && TN3270]: Likewise.
	(status, transcomhelp)
	[(unix || __unix || __unix__) && TN3270]: Likewise.
	(zhelp) [unix || __unix || __unix__]: Likewise.
	(cmdtab) [unix || __unix || __unix__]
	<cases "transcom", "z">: Likewise.
	(command) [unix || __unix || __unix__] <!top>:
	Likewise; ignore SIGINT and SIGQUIT.
	* telnet/main.c (argp_options)
	[(unix || __unix || __unix__) && TN3270]: Likewise.
	(parse_opt) [(unix || __unix || __unix__) && TN3270]
	<case 't'>: Likewise.
	* telnet/telnet.c [unix || __unix || __unix__]:
	Likewise; include <signal.h>.
	(Scheduler) [(unix || __unix || __unix__) && TN3270]:
	Likewise.
	* telnet/tn3270.c (HaveInput, cursesdata, sigiocount)
	(tline, transcom) [(unix || __unix || __unix__) && TN3270]:
	Likewise.
	(init_3270, inputAvailable, DataToTerminal, Finish3270)
	(settranscom) [(unix || __unix || __unix__) && TN3270]:
	Likewise.
	* telnet/utilities.c (EmptyTerminal)
	[unix || __unix || __unix__]: Likewise; handle fdset.

	Check macro `__sun' to detect Solaris.  Possibly
	the code is portable also to Solaris Studio.

	* ifconfig/system.c [!__linux__]: Check macro  __sun,
	not the less portable __sun__.
	* ifconfig/system.h [!__linux__]: Likewise.
	* ping/ping6.c: Likewise.


	Helper program for identifying build environments.

	* tests/identify.c: New file.
	* tests/Makefile.am (noinst_PROGRAMS, identify_LDADD):
	New variables.

2013-08-28  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Secrecy in debug mode.

	* ftp/ftp.c (command) <debug>: Insert a missing `else'.
	This avoids displaying the password in clear text.
	Problem introduced in a change made 2013-05-17.

2013-08-25  Mats Erik Andersson  <gnu@gisladisker.se>

	False negative while testing syslogd.

	* tests/syslogd.sh (iu_socklen_max): Do not accept
	`GNU/kFreeBSD' as a system supporting unix sockets
	of length 108.

2013-08-18  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/Makefile.am (check_PROGRAMS) [ENABLE_inetd]:
	Add tcpget.
	* tests/inetd.sh (TARGET, TCPGET): New variables.
	(TELNET): Remove variable.
	Remove check for tty.  Use TARGET for host addressing.
	Use `tcpget' instead of `telnet', which allows the
	test to be performed by build robots.
	* tests/tcpget.c: New file.

2013-08-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/inetd.sh: Skip test in absence of assigned TTY.
	This is needed due to the use of a built `telnet'.

2013-08-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/inetd.sh (write_conf): Use numerical address
	for localhost.  This avoids dependency on system set-up.

2013-08-14  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/inetd.sh: New file.
	* tests/Makefile.am (dist_check_SCRIPTS)
	[ENABLE_inetd && ENABLE_telnet]: Add inetd.sh.

	* tests/telnet-localhost.sh: Set service node
	to $TARGET and $TARGET6 in inetd configuration.

	* tests/utmp.sh: Call $SED, not `sed'.

2013-08-09  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/syslogd.c (argp_options): Improve `mark' text.
	(logmsg) [INTERNAL_MARK]: Compute facility from
	macro INTERNAL_MARK for better consistency.

2013-07-20  Mats Erik Andersson  <gnu@gisladisker.se>

	talkd: Small audit of ACL.

	* talkd/acl.c (struct netdef): Let `ipaddr' and
	`netmask' be of type in_addr_t for better
	architecture independence.
	(netdef_parse): Likewise for IPADDR, NETMASK.
	(acl_match): Likewise for IP.  When checking
	address matches, make a bitwise AND of
	`net->ipaddr' with `net->netmask'.

	* talkd/talkd.c (main): Call openlog() before read_acl().
	(talkd_init): Delete call to openlog().

2013-07-13  Mats Erik Andersson  <gnu@gisladisker.se>

	talkd: Less ACL-logging.

	* talkd/process.c (process_request): File only
	a single syslog message when acl_match() denies
	access, by checking for message type LOOK_UP.

2013-07-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2013-07-11  Mats Erik Andersson  <gnu@gisladisker.se>

	talk, talkd: Convenience changes.

	* talk/display.c (display) <'^D'>: Clear both
	local windows, but render the character as
	notification on the remote terminal.

	* talkd/process.c (process_request) <ANNOUNCE>:
	If logging is set and reply is successful, make
	a syslog note about the participants.
	<LOOK_UP>: Likewise.

2013-07-04  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Gateway selection.
	Make `-g' additive in repeated use to better
	conform with other implementations.

	* src/traceroute.c (parse_opt) [IP_OPTIONS] <'g'>:
	Append `arg' to `opt_gateways' if the latter has
	already been assigned a value.

2013-06-28  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Portability of PID range.
	FreeBSD uses process ID beyond 65535.

	* src/traceroute.c (main): Only keep lower
	16 bits of getpid().  A larger identity span
	cannot be accommodated into the payload.

2013-06-27  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Require host name.

	* src/rshd.c (reverse_required): New variable.
	(options): New option `-r/--reverse-required'.
	(parse_opt) <'r'>: New case.
	(doit) <reverse_required>: New exit path for
	clients whose IP addresses have no host name.

2013-06-26  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Error handling.

	* src/rlogind.c (rlogind_auth) <reverse_required>:
	Call fatal() on failure to reverse resolve the address.
	Lower syslog severity to LOG_NOTICE.
	(rlogind_mainloop): Lower severity to LOG_ERR.

2013-06-24  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Reverse resolution of client.

	* telnetd/telnetd.c (telnetd_setup) [IPV6]
	<reverse_lookup>: The comparison of a full
	`struct sockaddr' always fails.  Thus compare
	only `struct in_addr', or `struct in6_addr'.
	Short-circuit test for differing families.
	In case of failure, call fatal(), not exit().
	[!IPV6] <reverse_lookup>: Call fatal(), not exit().

2013-06-24  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Portability of banner.

	* telnetd/telnetd.c (print_hostinfo): Use NVT
	conformant substring for second newline "\r\n".
	* telnetd/telnet.h (UNAME_IM_SUFFIX) [HAVE_UNAME]:
	Likewise.  Use place holder `%l' for name of server.

2013-06-23  Mats Erik Andersson  <gnu@gisladisker.se>

	Portable use of uname().  POSIX states non-negative
	status on success.  Solaris returns positive value.

	* ftpd/ftpcmd.y <cmd> [HAVE_UNAME]: Set string
	value if uname() returns a non-negative value.
	* telnetd/telnetd.c (print_hostinfo) [HAVE_UNAME]:
	Likewise.


	ftpd: Prevent disclosure of system version.

	* ftpd/extern.h (no_version): New declaration.
	* ftpd/ftpcmd <cmd>: Display system name and
	release identifier only if `!no_version' is true.
	* ftpd.c (no_version): Declare as global,
	not static.

2013-06-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* CHECKLIST: New documentation file.
	* Makefile.am (EXTRA_DIST): Add CHECKLIST.

2013-06-12  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Group name matching.
	Support group membership matching in the files
	`/etc/ftpusers' and `/etc/ftpchroot'.

	* bootstrap.conf (gnulib_modules): Add mgetgroups.
	* ftpd/conf.c: Include <stdlib.h>, <pwd.h>, <grp.h>,
	and <mgetgroups.h>.
	(checkuser): New variables NGROUPS, GROUPS, PWD.
	New code blocks for extracting and matching against
	group names given on input line.

	* doc/inetutils.texi <ftpd invocation>:
	New section on the file format of `/etc/ftpusers'.

2013-06-11  Mats Erik Andersson  <gnu@gisladisker.se>

	* paths (PATH_NOLOGIN): Change default value to
	`/etc/nologin' for best portability.
	* README: Add some observations on hard-coded
	file locations.

2013-06-11  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Erroneous access check.
	The result of a user name match in PATH_FTPUSERS
	is never applied.

	* ftpd/auth.c (auth_user): Immediately return with
	an error when a user is denied access based on an
	entry in PATH_FTPUSERS.


	ftpd: Better name matching mechanism.

	* ftpd/conf.c: Include <ctype.h>.
	(checkuser): Accept an input line without final
	newline.  Allow initial blanks on input line.
	For better portability, allow trailing text
	separated from user name by blanks.

	* doc/inetutils.texi <ftpd invocation>: Better
	exposure of ftpchroot effects.

2013-06-08  Mats Erik Andersson  <gnu@gisladisker.se>

	logger: Flexibel UNIX socket name.

	* src/logger.c (open_socket): Call strchr()
	to check if `host' contains a slash anywhere.
	Then it names a UNIX socket.

2013-05-29  Mats Erik Andersson  <gnu@gisladisker.se>

	tests: Directory loading in syslogd.

	* tests/syslogd.sh (CONFD): New variable.
	(IU_OPTIONS): Add directory setting `--rcdir'.
	<reloaded configuration>: Move directive for
	severity `debug' to a file in $CONFD.

	* src/syslogd.c (main) <NoDetach>: Mention the
	process ID when telling about debug signal USR1.

2013-05-29  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Load configuration from directory.
	Code suggested by Guillem Jover <guillem@hadrons.org>
	<http://lists.gnu.org/archive/html/bug-inetutils/2009-12/msg00054.html>.
	Minor changes with failure tracking.

	* paths (PATH_LOGCONFD): New variable.
	* src/Makefile.am (AM_CPPFLAGS): Add $(PATHDEF_LOGCONFD).
	* src/syslogd.c: Include <dirent.h>.
	(ConfDir): New variable.
	(argp_options): New option `-D/--rcdir'.
	(parse_opt) <'D'>: New case.
	(load_confdir): New function.
	(init): New variable RET.  Call load_confdir(),
	making sure that failures are reported.

2013-05-29  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Refactor loading of configuration file.
	Code outlined by Guillem Jover <guillem@hadrons.org>
	<http://lists.gnu.org/archive/html/bug-inetutils/2009-12/msg00053.html>.
	Added an important correction to the legacy code
	for building linked lists of logging files.

	* src/syslogd.c (load_conffile): New function.
	First build a new structure `struct filed' from
	input line, then incorporate it into `*nextp'.
	(init): Refactor code for loading a configuration
	file, moving it to load_conffile().
	New variable RC.  Remove CF, P, LINE_MAX, CBUF,
	CLINE, and CONT_LINE.
	Register an additional error message, should loading
	have been incomplete.

2013-05-27  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Check account locking and expiration.

	* src/rshd.c [HAVE_SHADOW_H]: Include <shadow.h>.
	(DAY) [!DAY]: New macro.
	(doit): Multiple, minor changes to error strings.
	[!WITH_PAM]: New checks of account being either
	locked, or expired.  The code tests HAVE_GETSPNAM
	and HAVE_STRUCT_PASSWD_PW_EXPIRE for system quirks.

2013-05-22  Mats Erik Andersson  <gnu@gisladisker.se>

	libinetutils: Clarify Kerberos dependency.

	* libinetutils/kcmd.c [KERBEROS || SHISHI]:
	Condition file content on KERBEROS, not KRB4.


	Mixed compiler warnings.

	* ftpd/ftpcmd.y (cmd) <EPRT>: Remove the suffix `LL'
	on constants, which enforces an unwanted cast.
	(host_port): Likewise.

	* libinetutils/kcmd.c (kcmd): Cast a string length
	computation as int, used for format precision.

	* libls/print.c (printlong): Cast nlink_t as int.

	* libtelnet/kerberos5.c (Data): Cast CD as `char *'
	for use by strlen().

	* src/rexecd.c (get_user_password) [!WITH_PAM]:
	Declare only in absence of WITH_PAM.
	(doit) [!WITH_PAM]: Declare NAMEP and PW_PASSWORD.
	(rexec_conv) [WITH_PAM]: Identify `data' as unused.
	* src/rlogin.c (writer) <!escapechar>: Disambiguate
	conditional statements inside a braced block.
	* src/rsh.c: Include <unused-parameter.h>.  Remove
	inclusion of "xalloc.h".
	(parse_opt): Identify `state' as unused.
	* src/rshd.c (doit) [SHISHI]: Declare ERR_MSG as a
	constant array.

	* telnet/commands.c (tn) [HAVE_IDN]: Declare HOSTTMP.

2013-05-22  Mats Erik Andersson  <gnu@gisladisker.se>

	* libtelnet/encrypt.c: Include <unused-parameter.h>.
	(encrypt_start, encrypt_request_start): Mark all
	parameters with _GL_UNUSED_PARAMETER.
	* libtelnet/kerberos5.c: Include <unused-parameter.h>.
	(kerberos5_init, kerberos5_status): Param `ap' is unused.
	* libtelnet/shishi.c: Include <unused-parameter.h>.
	(krb5shishi_init, krb5shishi_status): `ap' is unused.
	(krb5shishi_cleanup): Likewise.  Delete variable SUBKEY.

2013-05-18  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: Portability of enctype_names.

	* configure.ac (HAVE_CONST_CHAR_ENCTYPE_NAMES):
	Check if <arpa/telnet.h> declares enctype_names
	as `const char []'.
	* libtelnet/encrypt.c (enctype_names)
	[HAVE_CONST_CHAR_ENCTYPE_NAMES]: Declare as
	constant array.

2013-05-17  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: Selected compiler warnings.

	* libtelnet/auth.c (auth_send): Cast sizeof() as int.
	(auth_name): Remove AP.  Make SAVENAME a char array.
	Cast sizeof() as int.  Rewrite debug message for
	overflowing name.
	* libtelnet/enc_des.c (FB64_IV, FB64_IV_OK)
	(FB64_IV_BAD): Make definitions conditional.
	(fb64_session): Cast `key->length' as size_t.
	* libtelnet/encrypt.c (encrypt_is): Do assignment
	before if-statament.  Use format `%p' with pointer.
	(encrypt_reply): Likewise.
	(encrypt_start): Use separate assigment.
	(encrypt_keyid): Likewise.  Delete STRP and CP.
	(encrypt_start_output): Use separate assignment.
	(encrypt_send_request_end): Remove ENCRYPT and DECRYPT.

	* libtelnet/kerberos5.c (kerberos5_is_auth): Make static.
	(kerberos5_is_forward) [FORWARD]: Likewise.
	* libtelnet/shishi.c (Data): Third argument is `void *'.
	Cast as `char *' for strlen().
	(shishi_init_key) [ENCRYPTION]: Make static.  Cast result
	from shishi_key_value() as `unsigned char *'.
	(krb5shishi_reply): shishi_ap_rep_verify_der() needs a cast
	as `char *'.
	(krb5shishi_status): Delete RC.
	(krb5shishi_is_auth): Make static.  Delete KEY2.
	shishi_ap_req_der_set() needs cast as `char *'.

	* telnet/authenc.c (telnet_getenv): Do not cast `val'.

2013-05-17  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp, telnet: Erase passwords after use.

	* ftp/cmds.c (user): Erase password string after getpass().
	(account): Likewise, for account password.
	* ftp/ftp.c (login): Erase passwords after last use.
	(command): Print fake account password as debug text.

	* telnet/authenc.c (telnet_gets): Do assignment before
	if-statement.  Erase string found by getpass().

2013-05-17  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: Let input to printsub functions remain
	typed as `unsigned char *', but use `char *' for all
	printable output.

	* libtelnet/auth-proto.h (auth_printsub, auth_sendname)
	(kerberos4_printsub, kerberos5_printsub)
	krb5shishi_printsub): Update signatures.
	* libtelnet/auth.h (TN_Authenticator): Update `*printsub'.
	* libtelnet/enc-proto.h (encrypt_printsub, krbdes_printsub)
	(cfb64_printsub, ofb64_printsub): Update signatures.
	* libtelnet/encrypt.h (Encryptions): Update `*printsub'.

	* libtelnet/auth.c (auth_sendname): Rename first argument
	and change to `char *'.  New variable CP.
	(auth_gen_printsub): Change third argument and variables
	CP and TBUF to `char *'.
	(auth_printsub): Change third argument to `char *'.
	* libtelnet/enc_des.c (fb64_printsub, cfb64_printsub)
	(ofb64_printsub): Likewise.
	* libtelnet/encrypt.c (encrypt_gen_printsub)
	(encrypt_printsub): Likewise.
	* libtelnet/kerberos.c (kerberos4_printsub): Likewise.
	* libtelnet/kerberos5.c (kerberos5_printsub): Likewise.
	* libtelnet/shishi.c (krb5shisih_printsub): Likewise.

	* telnetd/utility.c (printsub) [AUTHENTICATION || ENCRYPTION]:
	Change BUF to `char *'.

2013-05-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Report client's principal name.

	* src/rshd.c (rprincipal): New variable.
	(doit) [SHISHI] <use_kerberos>: Set `rprincipal'
	using shishi_encticketpart_clientrealm().
	[KRB5] <use_kerberos>: New calls to krb5_kuserok()
	and krb5_unparse_name().
	(doit): Report success to syslog using `rprincipal'.

2013-05-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Report client's principal name.

	* libinetutils/shishi_def.h (struct auth_data):
	New member `rprincipal'.
	* src/rlogind.c (struct auth_data) [!SHISHI]:
	Likewise.
	(do_krb5_login) [KRB5]: Delete NAME.  Assign value
	to `ap->rprincipal' using previous krb5_unparse_name().
	(do_shishi_login) [SHISHI]:
	Call shishi_encticketpart_clientrealm() to set
	`ad->rprincipal'.  Let the syslog message mention
	the client's principal name, instead of remote name.

	rlogind: Login options for Solaris again!

	* src/rlogind.c (exec_login) [SOLARIS10 || SOLARIS]:
	Make option orders roughly similar.  Add option `-d'.
	<authenticated> [KERBEROS || SHISHI]: Add option `-u'
	with remote client's principal name.  Depending on
	`kerberos', let `-s' take argument `krlogin' or `rlogin'.

2013-05-15  Mats Erik Andersson  <gnu@gisladisker.se>

	Audit of login options.

	* configure.ac (SOLARIS10): Replace previous
	macro SOLARIS11.
	* src/rlogind.c (exec_login) [SOLARIS10]:
	Use previous Solaris settings.
	[SOLARIS]: Simplified setting.
	* telnetd/telnetd.c (login_invocation)
	[SOLARIS10 || SOLARIS]: Likewise, as two cases!

2013-05-14  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Silence unwanted debugging.

	* telnetd/telnetd.h (enum debug_mode): Add `debug_encr'.
	* telnetd/telnetd.c (debug_mode): Add member `encr'.
	* telnetd/utility.c (printsub): Return immediately if
	the option is TELOPT_AUTHENTICATION or TELOPT_ENCRYPT
	and the corresponding debug level is unset.

	telnetd: Logging of failed command line options.

	* telnetd/telnetd.c (main): Call openlog() before
	argp_parse().  Facility is now correct!
	(parse_linemode): Send a log notice
	about parsing failure; the client receives stderr!
	(parse_authmode) [AUTHENTICATION]: Likewise.
	(parse_debug_level): Likewise.

2013-05-14  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: The list of authentication names is
	allowed to contain NULL entries.  Prevent access
	to such entries.

	* libtelnet/auth.c: Position some assignments before
	the corresponding if-statement.
	(auth_init) [AUTHENTICATION]: Check that AUTHTYPE_NAME()
	is non-NULL before referencing it.
	(auth_disable_name, getauthmask, auth_onoff, auth_send)
	[AUTHENTICATION]: Likewise.

	* telnet/utilities.c (printsub) [AUTHENTICATION]: Likewise.
	* telnetd/utility.c (printsub) [AUTHENTICATION]: Likewise.

2013-05-13  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: Make availibility of DES_OFB64 in addition
	to DES_CFB64 independent of host system.

	* libtelnet/encryption.h (ENCTYPE_DES_OFB64)
	[ENCRYPTION]: Define if missing.
	(ENCTYPE_CNT, ENCTYPE_NAME_OK) [ENCRYPTION]:
	Always redefine.

	* libtelnet/encryption.c [ENCRYPTION]: Undefine
	ENCRYPT_NAMES before including <arpa/telnet.h>.
	(enctype_names) [ENCRYPTION]: New array variable.
	(encrypt_is, encrypt_reply, encrypt_start) [ENCRYPTION]:
	Before printing encryption type, check that ENCTYPE_NAME()
	is non-null in addition to checking only ENCTYPE_NAME_OK().

	* telnet/utilities.c (printsub) [ENCRYPTION]: Likewise.
	* telnetd/utility.c (printsub) [ENCRYPTION]: Likewise.

2013-05-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac <*olaris*>: New test for subcase
	`*olaris*11'.  Define SOLARIS11 for matches.

	* telnetd/telnetd.c (login_invocation)
	[SOLARIS && SOLARIS11]: Add `-p' to old value.

	* src/rlogind.c (exec_login) <authenticated>
	[SOLARIS]: Change service to `-s krlogin' in
	argument list to execle().

2013-05-09  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/logger.c (parse_level): Rename PRI to PRIO,
	so as not to shadow the global variable.  Initiate
	value to LOG_NOTICE, not to LOG_EMERG.

2013-05-08  Mats Erik Andersson  <gnu@gisladisker.se>

	libtelnet: Parity adjust non-DES key.

	* libtelnet/enc_des.c (des_parity, des_check_parity)
	(des_set_parity) [AUTHENTICATION && ENCRYPTION]
	[DES_ENCRYPTION || SHISHI]: New static functions.
	(fb64_session) [AUTHENTICATION && ENCRYPTION]:
	New variables OFFSET and DERIVED_KEY.  Accept keys
	of type SK_OTHER and adjust parity in a partitioned
	copy of the authentication key, as RFC 2952 suggests.

	Self-documenting array length.

	* libtelnet/enc_des.c (shishi_des_ecb_encrypt)
	[AUTHENTICATION && ENCRYPTION && SHISHI]:
	Use sizeof(Block) as array size.
	(fb64_start) [AUTHENTICATION && ENCRYPTION && SHISHI]:
	Likewise.

2013-05-07  Mats Erik Andersson  <gnu@gisladisker.se>

	configure.ac: Minor clean-up.

	* am/config_paths.m4 (IU_CONFIG_PATHS):
	Replace obsolete AC_HELP_STRING by AS_HELP_STRING.
	* am/libcurses.m4 (IU_LIB_NCURSES): Likewise.
	* am/readline.m4 (gl_FUNC_READLINE): Likewise.
	* configure.ac: Likewise.  Use AC_CONFIG_HEADERS
	instead of AC_CONFIG_HEADER.  Call AM_PROG_AR,
	but protect its use by means of m4_ifdef.
	(AM_INIT_AUTOMAKE): Add `-Wall' and `-Werror'.
	Remove second call to the same macro.

2013-05-01  Mats Erik Andersson  <gnu@gisladisker.se>

	* libtelnet/enc_des.c: Convert K&R style declarations
	to ISO C89.  Do assignments before return statements.
	(fb64_stream_iv, fb64_init, fb64_is, fb64_reply)
	(fb64_stream_key, fb64_keyid): Declare as static.
	(shishi_des_ecb_encrypt) [SHISHI]: Declare as static.
	Declare all three string arguments using `unsigned char'.
	When calling shishi_des(), cast third and sixth arguments
	as `const char *'.
	(fb64_start): Remove variable B.  Change X to size_t.
	(fb64_is): Remove B and X.
	(fb64_reply): Remove B, P, and X.

2013-04-30  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Account expiration.
	Better explanation, make it work also for BSD.

	* configure.ac (HAVE_STRUCT_PASSWD_PW_EXPIRE)
	(HAVE_STRUCT_PASSWD_PW_CHANGE): Check if `struct passwd'
	has members pw_expire and pw_change.

	* ftpd/extern.h (struct credentials): New member `expired'.
	(AUTH_EXPIRED_NOT, AUTH_EXPIRED_ACCT, AUTH_EXPIRED_PASS):
	New macros.
	* ftpd/ftpd.c (pass) <failed authentication>:
	If `cred.message' is empty, check `cred.expired' for
	further reasons of failure.
	* ftpd/auth.c (auth_user): Reset `pcred->expired'.
	(sgetcred): [HAVE_GETSPNAM && HAVE_SHADOW_H]:
	Separate account and password expiration into distinct
	checks, updating `pcred->expired'.  Use shadow password
	only in absence of all expiration.
	[HAVE_STRUCT_PASSWD_PW_EXPIRE]: New code block.

2013-04-26  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Make encryption portable.

	* src/rcp.c (main) [KERBEROS || SHISHI]: The encryption
	switch `-x' does not belong in the remote command string.
	It is must only be passed to `rsh'.  Remove the special
	command string claimed for all Kerberos variants.

2013-04-25  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Attempt to mend recurring test failures.
	The autobuilder Hydra is fairly often reporting
	failures for `tests/syslogd.sh' on GNU/Linux,
	appearing after configuration reload and then
	blocking INET socket messages.

	* src/syslogd.c (create_inet_socket): Set SO_REUSEADDR
	before IPV6_V6ONLY.
	* tests/syslogd.sh <reloaded configuration>: Remove
	blocker `user.none' on file `$OUT'.

2013-04-23  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac <libidn detection>: Replace by a call
	to IU_CHECK_LIBIDN.
	* am/libidn.m4 (IU_CHECK_LIBIDN): New file, new macro.

	* am/krb5.m4 (IU_CHECK_KRB5): Detect res_query using
	AC_SEARCH_LIBS for better portability to BSD.
	Set KRB5_IMPL to `krb5-config' if krb5-config is
	available to provide compiler flags.  If KRB5_PREFIX
	is `yes' and krb5-config does not exist, use the
	location `-I/usr/include/krb5' for KRB5_CFLAGS.
	Do not add $KRB4_LIBS to KRB5_LIBS when detecting
	either `MIT' or `Heimdal'.

2013-04-19  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind, rshd: Diagnostics with libshishi.

	* src/rlogind.c (do_shishi_login) [SHISHI && WITH_PAM]:
	Assign an error message when do_pam_check() fails.
	* src/rshd.c (doit) [SHISHI && !ENCRYPTION]:
	Abort with an error message when encryption was requested
	by the client, but is not present in the server.

2013-04-17  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind, rshd: Set realm with Kerberos5.

	* src/rlogind.c (do_krb5_login) [KRB5}: Declare SERVER
	with larger scope.  If `servername' has content, then
	call krb5_set_default_realm() with supporting code.
	* src/rshd.c (doit) [KRB5] <use_kerberos>: Likewise.

2013-04-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rlogind.c (parse_opt) [KERBEROS || SHISHI]
	<'k'>: Remove unused code checking `arg'.
	(do_krb_login) [KRB5]: Remove `else', which prevents
	later error message extraction.
	[SHISHI]: Likewise.

2013-04-11  Mats Erik Andersson  <gnu@gisladisker.se>

	Working distcheck target.

	* Makefile.am (BUILT_SOURCES): Replace $(top_srcdir)
	by $(top_builddir).
	(DISTCLEANFILES): Add `$(top_builddir)/.version' to list.
	($(top_builddir)/.version): Move target to build directory.

2013-04-11  Mats Erik Andersson  <gnu@gisladisker.se>

	Summary printout is a config.status command.

	* configure.ac (AC_CONFIG_FILES): Add summary.sh to list.
	(AC_CONFIG_COMMANDS): New command `summary'.
	(AC_MSG_NOTICE) <summary>: Removed.
	* .gitignore: Add summary.sh to list.
	* Makefile.am (EXTRA_DIST): Add summary.sh.in.
	* summary.sh.in: New file.
	* am/enable.m4 (IU_ENABLE_FOO): Publish `$1_PROPS'
	and `enable_$1' via AC_SUBST.

2013-04-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* doc/inetutils.texi <main menu>: Order invocation
	nodes in lexicographical order.
	<ping6 invocation>: New node.

2013-04-09  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet, telnetd: Termcap buffer length recommendation.

	* telnet/telnet.c (termbuf): Increase length to 2048,
	and initialize to zero.
	(init_term) [HAVE_TGETENT]: Handle case `err == 1',
	since it can only happen here.
	* telnetd/utility.c (terminaltypeok) [HAVE_TGETENT]:
	Declare BUF.  Call tgetent() to decide return status.
	[!HAVE_GETENT]: Always return 1, lacking the knowledge
	to make any other decision relvant for return status.

	telnetd, libtelnet: Buffer overflow prevention.

	* telnetd/telnetd.h (getterminaltype): New signature.
	* telnetd/telnetd.c (telnetd_setup): Add buffer
	length in call getterminaltype().
	* telnetd/utility.c (getterminaltype): New second
	argument `size_t len'.  Pass `len' to auth_wait().
	* libtelnet/auth-proto.h (auth_wait): New signature.
	(kerberos4_status) [KRB4]: Likewise.
	(kerberos5_status) [KRB5]: Likewise.
	(krb5shishi_status) [SHISHI]: Likewise.
	* libtelnet/auth.h (typedef TN_Authenticator):
	New signature of member `*status'.
	* libtelnet/auth.c (auth_wait): New parameter `len'.
	Pass `len' in the call *authenticated->status().
	* libtelnet/kerberos.c (kerberos4_status): New third
	argument `size_t len'.  Call strncpy().
	* libtelnet/kerberos5.c (kerberos5_status): Likewise.
	* libtelnet/shishi.c (krb5shishi_status): Likewise.
	(krb5shishi_is_auth): Type CNAMEREALMLEN as size_t.

	libtelnet: Minor warnings for casts.

	* libtelnet/encrypt.h (typedef Session_Key)
	[!HAVE_ARPA_TELNET_H_SESSION_KEY]: Make `data' a
	const char pointer.
	* libtelnet/encrypt.c (EncryptDisable): Cast second
	argument in genget() as `char **'.  Cast argument
	to Ambiguous() as `char *'.
	(EncryptType): Likewise.

2013-04-05  Mats Erik Andersson  <gnu@gisladisker.se>

	talk: Non-ASCII characters.

	* talk/display.c: Include <ctype.h>.
	(display): Check printability with isprint().
	Prevent sign extension of char as integer.

2013-04-05  Mats Erik Andersson  <gnu@gisladisker.se>

	talk: Address resolution.

	* talk/get_addrs.c (get_addrs): Implement resolver
	using getaddrinfo().  This is now the preferred method.
	[HAVE_DECL_GETADDRINFO || defined HAVE_IDN]:
	Declare ERR with larger scope.
	[HAVE_DECL_GETADDRINFO]: New variables HINTS, RES, AI.
	Call getaddrinfo() for LHOST and RHOST.
	[HAVE_DECL_GETADDRINFO && AI_IDN]: Add AI_IDN to
	`hints.ai_flags'.

2013-04-04  Mats Erik Andersson  <gnu@gisladisker.se>

	More IDN support for clients.

	* configure.ac <summary>: Uppdate ftp_PROPS,
	talk_PROPS, telnet_PROPS, and tftp_PROPS using
	LIBIDN.
	* ftp/Makefile.am (AM_CPPFLAGS): Add $(INCIDN).
	(LDADD): Add $(LIBIDN).
	* talk/Makefile.am, telnet/Makefile.am
	(AM_CPPFLAGS, LDADD): Likewise.
	* src/Makefile.am (tftp_LDADD): Add $(LIBIDN).

	* ftp/ftp.c [HAVE_IDNA_H]: Include <idna.h>.
	(hookup): New variable RHOST.  Use RHOST in
	getaddrinfo().
	[HAVE_IDN]: Call idna_to_ascii_lz().
	[!HAVE_IDN]: Strdup `host' as RHOST.
	[AI_IDN]: Add to `hints.ai_flags'.
	[AI_CANONIDN]: Likewise.
	* ftp/main.c [HAVE_LOCALE_H]: Include <locale.h>.
	(main) [HAVE_SETLOCALE]: Call setlocale().

	* ping/libping.c (ping_set_dest) [AI_CANONIDN]:
	Add to `hints.ai_flags' independently if AI_IDN.
	* ping/ping6.c (ping_set_dest): Set AI_CANONNAME
	on `hints.ai_flags'.  Strdup `result->ai_canonname'
	to `ping->ping_hostname'.
	[AI_CANONIDN]: Add to `hints.ai_flags'.

	* src/tftp.c [HAVE_LOCALE_H]: Include <locale.h>.
	[HAVE_IDNA_H]: Include <idna.h>.
	(main) [HAVE_SETLOCALE): Call setlocale().
	(resolve_name): New variable RNAME.  Use RNAME
	with getaddrinfo().
	[HAVE_IDN]: Call idna_to_ascii_lz().
	[AI_IDN]: Add to `hints.ai_flags'.
	[AI_CANONIDN]: Add to `hints.ai_flags'.

	* talk/get_addrs.c [HAVE_IDNA_H]: Include <idna.h>.
	(get_addrs): New variables LHOST, RHOST.  Use these
	for address resolution with gethostbyname().
	[HAVE_IDN]: Call idna_to_ascii_lz() twice.
	* talk/talk.c [HAVE_LOCALE_H]: Include <locale.h>.
	(main) [HAVE_SETLOCALE]: Call setlocale().

	* telnet/commands.c [HAVE_IDNA_H]: Include <idna.h>.
	(tn): New variable HOSTTMP.
	[HAVE_IDN]: Call idna_to_ascii_lz() and let HOSTP
	be identical to HOSTTMP if the call was successful.
	Free HOSTTMP after use.
	[IPV6 && AI_IDN]: Set `hints.ai_flags' to AI_IDN.
	* telnet/main.c [HAVE_LOCALE_H]: Include <locale.h>.
	(main) [HAVE_SETLOCALE]: Call setlocale().

2013-03-30  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac <summary>: New variables `*_PROPS'
	for each targeted executable.  Set the likes of
	`ftp_PROPS' and use them to simplify output.

2013-03-28  Mats Erik Andersson  <gnu@gisladisker.se>

	Let Telnet client override Kerberos5 realm.

	* libtelnet/kerberos5.c (dest_realm): Rename from
	previous `telnet_krb5_realm'.
	* telnet/main.c (dest_realm) [KERBEROS || SHISHI]:
	Expand scope from KRB4 to KERBEROS.
	(argp_options) [KERBEROS || SHISHI] <-k/--realm>:
	Likewise.
	(parse_opt) [AUTHENTICATION && (KERBEROS || SHISHI)]
	<case 'k'>: Likewise.

2013-03-28  Mats Erik Andersson  <gnu@gisladisker.se>

	Partial adaptions to Kerberos5, sufficient
	to do some build and runtime testing, but
	without encryption.

	* configure.ac <KERBEROS_VERSION == krb5>:
	Disable `rcp', `rlogin', and `rsh'.
	* libinetutils/des_rw.c [ENCRYPTION && KRB4]:
	Replace KERBEROS by KRB4 in guard.
	* libinetutils/kcmd.c, libinetutils/krcmd.c:
	Likewise.
	* src/rlogind.c [KRB5 && HAVE_COM_ERR_H]:
	Include <com_err.h>.
	(do_krb5_login) [KRB5]: Insert prototype.
	* src/rshd.c [KRB4]: Replace previous KERBEROS
	by KRB4 throughout.
	[KRB5 && HAVE_KRB5_H]: Include <krb5.h>.
	[KRB5 && HAVE_COM_ERR_H]: Include <com_err.h>.
	(doit) [KRB5]: New partial template code and
	related variables for later refinement.
	[KERBEROS]: Set FROMADDR using memcpy().
	[ENCRYPTION && (KERBEROS || SHISHI)]: Call dup2()
	with macros STDIN_FILENO and STDOUT_FILENO.

	Replace obsolete interfaces.

	* libtelnet/kerberos5.c (encryption_init)
	[ENCRYPTION]: Call krb5_auth_con_getsendsubkey().
	(kerberos5_is_auth): New variable VALID.
	Call krb5_auth_con_getrecvsubkey().

	* src/rlogind.c (do_shishi_login) [SHISHI]:
	Test macro ENCRYPT_IO when calling syslog().

	* configure.ac <rsh summary>: Use $rsh_BUILD.

2013-03-22  Mats Erik Andersson  <gnu@gisladisker.se>

	Detection of Kerberos5.

	* configure.ac: Only search for Kerberos headers
	if they were explicitly requested.
	* telnet/utilities.c (printsub)
	[AUTHENTICATION || ENCRYPTION]: Define BUF if
	either macro is defined.
	* telnetd/utility.c (printsub): Likewise.

2013-03-21  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Portability of PAM to Solaris.

	* ftpd/pam.c: Include <unistd.h>.
	(TTY_FORMAT): New macro.
	(pam_user): New variable TTY_NAME.  Set PAM_TTY by calling
	pam_set_item() with a value constructed from getpid().

2013-03-19  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Support PAM beyond Linux-PAM.

	* configure.ac (FTPD_LIBPAM): Set to $LIBPAM
	for all PAM implementations.
	* ftpd/auth.c (auth_user) <default case>
	[WITH_PAM && !WITH_LINUX_PAM]: Call pam_user()
	if preceding tests were passed and if `auth_type'
	is AUTH_TYPE_PAM.
	(auth_pass) [WITH_PAM] <AUTH_TYPE_PAM>: Relax old
	conditioning on WITH_LINUX_PAM.
	* ftpd/extern.h (pam_user, pam_pass, pam_end_login)
	[WITH_PAM]: Likewise.
	* ftpd/ftpd.c (options) [WITH_PAM] <pam>: Likewise.
	(parse_opt) <pam> [WITH_PAM]: Likewise.
	(end_login) [WITH_PAM]: Likewise, use of pam_end_login().
	* ftpd/pam.c [WITH_PAM]: Likewise, entire file.
	(PAM_conv) <PAM_PROMPT_ECHO_OFF> [!WITH_LINUX_PAM]:
	Return PAM_CRED_INSUFFICIENT.
	(pam_doit) <failed pam_authenticate> [!WITH_LINUX_PAM]:
	Check for status PAM_CRED_INSUFFICIENT with empty
	password.

	* ftpd/ftpd.c (doc) [WITH_PAM]: Mention PAM service
	name 'ftp' in text.
	(options) [WITH_KERBEROS5] <kerberos5>: Correct
	misspelled authentication name.

2013-03-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Incomplete source route security.
	The protection against IPOPT_LSRR was not
	enforced during Kerberised execution.

	* src/rlogind.c (prevent_routing) [IP_OPTIONS]:
	New function, broken out of old code.  Replace
	socket number 0 by a parameter `fd', which makes
	certain that daemon-mode is examined correctly.
	(rlogind_auth) [IP_OPTIONS]: Call prevent_routing()
	early on, before code path separation for Kerberos.

2013-03-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Differentiate PAM services.

	* src/rshd.c (service) [WITH_PAM]: New variable.
	(doc) [WITH_PAM && (KERBEROS || SHISHI)]:
	Mention `krsh' in description.
	(doit) [WITH_PAM && (KERBEROS || SHISHI)]:
	Set PAM service type to "krsh" for kerberised action,
	and "rsh" otherwise.
	[WITH_PAM]: Pass `service' to pam_start() and to
	pam_set_item(PAM_TTY).
	(rsh_conv) [WITH_PAM]: Add _GL_UNUSED_PARAMETER to the
	function parameter `data'.

2013-03-14  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: PAM support with libshishi.

	* src/rlogind.c (doc) [WITH_PAM && SHISHI]:
	Mention `krlogin' in description.
	(do_pam_check) [WITH_PAM]: New function,
	refactored from previous code in do_rlogin().
	(do_rlogin) [WITH_PAM]: Remove variable USER.
	Replace code block by a call to do_pam_check()
	for service `rlogin'.
	(do_shishi_login) [SHISHI && WITH_PAM]:
	Call do_pam_check() for service `krlogin'.

2013-03-14  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rlogind.c (do_shishi_login) [SHISHI]:
	Do not free the static pointer PWD!
	Call getpwnam() for verification that local
	user exists.  Add check to prevent root access
	unless the flag `allow_root' is set.
	Call shishi_ap_done() before sending a log report.

2013-03-13  Guillem Jover  <guillem@hadrons.org>

	Use standard suid-mode for install.

	* ping/Makefile.am (SUIDMODE): Change mode to `4755'.
	* src/Makefile.am (SUIDMODE): Likewise.

2013-03-13  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Initial PAM support.
	New code for plain authentication only.

	* configure.ac <rlogind summary>: Report PAM.
	* src/Makefile.am (rlogind_LDADD): Add $(LIBPAM)
	and $(LIBDL).
	* src/rlogind.c [HAVE_SECURITY_PAM_APPL_H]:
	Include <security/pam_appl.h>.
	(pam_rc, pam_handle, pam_conv) [WITH_PAM]:
	New variables.
	(rlogin_conv) [WITH_PAM]: New function.
	(doc) [WITH_PAM]: Add info to string.
	(do_rlogin) [WITH_PAM]: New variable USER.
	New code block.
	(fatal) [WITH_PAM]: Call pam_end().

	* src/rlogind.c (rlogind_auth)
	[!HAVE_DECL_GETADDRINFO || !HAVE_DECL_NAMEINFO]:
	Use ADDRP only within this condition.

2013-03-11  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Functional option `--target-directory'.
	Implement the missing case where `-d' is given
	an argument.

	* src/rcp.c (target): New variable.
	(parse_opt) <'d'>: If `arg' has contents, copy it
	to `target'.
	(main): Only one command line argument is needed for
	calls with set `target'.  If `target' is not set,
	extract it from the very last command line argument,
	and decrease `argc' to reflect this action.  Apply
	colon() and verify() to `target'.
	(toremote): Extract host and user name from `target'.
	Let I loop until `argc', since `argc' no longer includes
	the target directory.
	(tolocal): New variable VECT.  Loop I until `argc'.
	Exchange `target' for `argv[argc - 1]'.  Fix VECT to
	be a short array with `target', and apply it to sink().

2013-03-09  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Portability fixes.

	* src/rcp.c: Include <stdint.h>.
	(options): Make argument to `-d' optional, since
	the remote server need that form of invocation.
	(source): Use format "%jd" and cast as intmax_t
	to work around buggy library modes, which otherwise
	are missing the last string argument.

2013-03-08  Mats Erik Andersson  <gnu@gisladisker.se>

	* bootstrap: Updated from gnulib.

2013-03-07  Mats Erik Andersson  <gnu@gisladisker.se>

	Relax setuid demands.

	* src/rcp.c (effuid): New variable.
	(main): Set `effuid' by calling geteuid().
	Remove test on non-zero geteuid().
	(toremote): If `rem < 0' and `errno == EACCES',
	then report failure to access privileged port.
	(tolocal): Use argument `effuid' for seteuid().
	* src/rlogin.c (main): Remove test on non-zero
	geteuid().  If `rem < 0' and `errno == EACCES',
	then report failure to access privileged port.
	* src/rsh.c (main): Likewise.

	* ping/libping.c (ping_init): Let error message
	mention privileges, instead of non-root access.

	Avoid assignment inside if-clauses, as per GCS.

	* src/rcp.c (main, tolocal, source, rsource, sink)
	(allocbuf): Assign to variables first, then test
	their values in an if-clause.
	* src/rlogin.c (main, get_window_size, getescape):
	Likewise.
	* src/rlogind.c (rlogind_auth, do_krb5_login)
	(protocol): Likewise.
	* src/rsh.c (main, talk, copyargs): Likewise.
	* src/rshd.c (doit): Likewise.

2013-03-02  Mats Erik Andersson  <gnu@gisladisker.se>

	Make the FTP transfer test somewhat robuster.

	* tests/ftp-localhost.sh <set-up of DLDIR>:
	Reset do_transfer as `false' before probing.
	Add `/tmp' as a candidate subdirectory.
	Set do_transfer to `true' only with a confirmed
	writable directory.  Exit with status 99, should
	TRANSFERTEST be set, but directory search fails.

2013-02-24  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Log selectively on program name.

	* src/syslogd.c (selector): New variable.
	(struct filed): New members `f_progname' and
	`f_prognlen'.
	(logmsg): Filter on committing program name if
	`f->f_progname' has been set for this file.
	(init): Free `f->f_progname' and `selector'.
	Capture program name selector while parsing.
	(cfline): If `selector' is set, indicate its value
	in debug printing, and copy it to `f->f_progname',
	also setting `f->f_prognlen'.

	* doc/inetutils.texi (syslogd invocation): Update.

2013-02-23  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Portably restart signals.  Necessary
	for Solaris.

	* src/syslogd.c (main) [HAVE_SIGACTION]:
	New variable SA.  Use sigaction() to install
	dispositions for SIGALRM, SIGUSR1, and SIGHUP.
	(domark) [!HAVE_SIGACTION]: Reactivate SIGALRM.
	(dbg_toggle) [!HAVE_SIGACTION]: Reactivate SIGUSR1.
	(trigger_restart) [!HAVE_SIGACTION]:
	Reactivate SIGHUP.

	* src/syslogd.c (printline): Use an else-block to
	prevent duplicate messages when `force_sync' is set.

2013-02-21  Mats Erik Andersson  <gnu@gisladisker.se>

	libls: Allow repeated invokations.  Remove exit()
	in this library.  Repair numerical stats.

	* libls/ls.c (ls_main): Clear `output', all option
	flags `f_*', and `optind' to handle correctly repeated
	invokations.  Replace exit() with return().
	<case 'l'>: Do not reset `f_numericonly'.
	<default case>: Return with value from usage().
	(travers): Replace exit() by return() and set `rval'.
	(display): Initialise USER and GROUP to NULL.
	Replace exit() with return().
	* libls/util.c (usage): Return type `int'.
	Replace exit() with return().
	* libls/extern.h (usage): Update.

	* libls/ls.c (ls_main, traverse, display):
	Pull variable assignment out of if-statement.

2013-01-25  Mats Erik Andersson  <gnu@gisladisker.se>

	libls: Use __opendir2() if present.

	* configure.ac: Check for __opendir2, not opendir2.

	* libls/fts.c (fts_build) [HAVE___OPENDIR2]:
	Change conditional test for declaration of OFLAG.
	Initialise OFLAG only with DTF_NODUP, and add
	DTF_REWIND and DTF_HIDEW conditionally.
	Remove macro opendir2.  Assign DIRP from either
	__opendir2() or opendir().  Then test DIRP.

2013-01-22  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Loose source routing.

	* src/traceroute.c [HAVE_NETINET_IP_VAR_H]:
	Include <netinet/ip_var.h>.
	(len_ip_opts, ip_opts, opt_gateways) [IP_OPTIONS]:
	New variables.
	(argp_options) [IP_OPTIONS]: New option `-g/--gateways'.
	(parse_opt) [IP_OPTIONS] <'g'>: New case.
	(main): Call trace_ip_opts().
	(trace_init) [IP_OPTIONS]: If `len_ip_opts' is positive,
	call setsockopt(IP_OPTIONS).
	(trace_ip_opts): New function.

	traceroute: Settable maximal hop count.

	* src/traceroute.c (argp_options): New option `-m/--max-hop'.
	(parse_opt) <'m'>: New case.
	(main): Exit with EXIT_FAILURE if HOP exceeds `opt_max_hops'.

2013-01-21  Guillem Jover  <guillem@hadrons.org>

	Cleanup automake variables.

	* ftp/Makefile.am (AM_CPPFLAGS): Consume depreciated
	macro INCLUDES.
	* ftpd/Makefile.am, ifconfig/Makefile.am,
	libinetutils/Makefile.am: Likewise.
	* libls/Makefile.am (AM_CPPFLAGS): Rename INCLUDES.
	* libtelnet/Makefile.am: Likewise.
	* ping/Makefile.am (AM_CPPFLAGS): Likewise.
	(LDADD): New macro.
	(ping_LDADD): Simplify using LDADD.
	(ping6_LDADD): Remove.
	* src/Makefile.am (AM_CPPFLAGS): Consume INCLUDES.
	* talkd/Makefile.am, telnet/Makefile.am,
	telnetd/Makefile.am: Likewise.
	* talk/Makefile.am (AM_CPPFLAGS): Rename INCLUDES.
	* whois/Makefile.am: Likewise.

2013-01-21  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (AM_C_PROTOTYPES): Remove obsolete macro.
	Not supported by automake-1.13.

2013-01-17  Mats Erik Andersson  <gnu@gisladisker.se>

	ping6: Setting of tclass and flowinfo.

	* ping/ping6.c (tclass) [IPV6_TCLASS]: New variable.
	(flowinfo) [IPV6_FLOWINFO]: New variable.
	(argp_options): Make `--ttl' a synonym for `--hoplimit'.
	[IPV6_FLOWINFO]: New option `-F/--flowinfo'.
	[IPV6_TCLASS]: New option `-T/--tos'.
	(parse_opt) [IPV6_FLOWINFO]: New case 'F'.
	[IPV6_TCLASS]: New case 'T'.
	(main) [IPV6_TCLASS]: Call setsockopt(IPV6_TCLASS).
	[IPV6_FLOWINFO]: Call setsockopt(IPV6_FLOWINFO).
	* ping/ping_common.h (OPT_FLOWINFO, OPT_TCLASS): New macros.

2013-01-17  Mats Erik Andersson  <gnu@gisladisker.se>

	CVE-2010-2529: Infinite loop.

	* ping/ping_echo.c (print_ip_opt) <IPOPT_RR>: Break loop
	if option is truncated or exhausted.
	<IPOPT_TS>: Break loop if option is truncated.

2013-01-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping6.c: Include <arpa/inet.h>.
	(print_ip_data): New function.
	(print_icmp_error): In verbose mode, let print_ip_data()
	display information on returned packet.

	* ping/ping_echo.c (print_icmp): Use bitwise-and in test.

2013-01-16  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping_echo.c (print_ip_header): Empirically test
	`ip->ip_len' to decide whether ntohs() is needed.
	(print_icmp): Call print_ip_data() only in verbose mode.

2013-01-16  Guillem Jover  <guillem@hadrons.org>

	* ping/libping.c (ping_xmit): Do not call perror().
	Instead return a negative status.
	* ping/ping.c (send_echo): New variable RC.
	Abort with a message on any error condition.
	* ping/ping6.c (ping_xmit): Likewise.
	(send_echo): Likewise.

2013-01-07  Mats Erik Andersson  <gnu@gisladisker.se>

	tftpd: Error handling.
	Send NAK on error conditions in chrooted mode,
	preventing the client from hanging indefinitely.

	* src/tftpd.c (main): Send NAK with ENOUSER as
	response, should chrooted mode specify non-existent
	user or group.  Likewise when setgid() or setuid()
	fails.  Send NAK with EACCESS, should chroot() fail.
	(usage_str, usage): Remove unused constructs.

2013-01-05  Mats Erik Andersson  <gnu@gisladisker.se>

	tftpd: Group setting.
	A group named `nogroup' is not portable enough,
	so tidy the chrooting code for robustness.

	* src/tftpd.c (DEFAULT_GROUP): Remove macro.
	(main): Do not initialize `group'.  Delay code
	block for chroot set-up until after forking and
	socket binding.  Separate setgid() from setuid(),
	and inherit group membership from owner, should
	no group have been specified.

2013-01-02  Mats Erik Andersson  <gnu@gisladisker.se>

	tftpd: Chrooted mode.

	* src/tftpd.c: Include <grp.h>, <pwd.h>, <xalloc.h>.
	(chrootdir, group, user): New variables.
	(DEFAULT_GROUP, DEFAULT_USER): New macros.
	(options): New options `-g/--group', `-s/--secure-dir',
	and `-u/--user'.  Put new options in separate group.
	(parse_opt): Parameter `arg' is now in use.
	<`g', `s', `u'>: New cases.
	(main): Assign default values to `group', `user'.
	If chrooted mode was specified, execute chroot(),
	setgid(), and setuid().
	* tests/tftp.sh (do_secure_setting): New variable.
	Set to true only for the super-user, then activating
	two further read tests.
	(REDIRECT): Set also for empty VERBOSE.

	* doc/inetutils.texi <tftpd invocation>: Fill with
	sensible content for old and new capabilities.

2012-12-27  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Conform to standard application set-up.

	* src/traceroute.c (opt_type): Default to TRACE_UDP.
	(opt_port): Set to TRACE_UDP_PORT.
	(opt_ttl, opt_wait): New variables.
	(argp_options): New options `-f/--first-hop', `-I/--icmp',
	and `-w/--wait'.
	(parse_opt) <`p', `t'> : Use strtol() for better sanitation.
	<`f', `I', `w'>: New cases.
	(main): Free RHOST after use.
	[HAVE_IDN]: Free `hostname'.
	(do_try): Set timer from `opt_wait'.
	(trace_init): Set `t->ttl' from `opt_ttl'.

	* doc/inetutils.texi <traceroute invocation>: Update
	with new options.  Add a section on diagnostics.

2012-12-19  Mats Erik Andersson  <gnu@gisladisker.se>

	Detect a writable directory for better coverage.
	Add a test for mapping of file names.

	* tests/ftp-localhost.sh (DLDIR): New variable.
	Put files in $DLDIR of the chrooted user.
	(GETME, PUTME): Use mktemp() to generate names.
	[do_transfer]: New test of two nmap modes.

2012-12-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftp/cmds.c (cp_subst): Change SRC_LEN to size_t.
	New variable OFFSET.  Update `*to_p' after realloc(),
	making the cursor a valid pointer.
	(domap): Calculate BUF_LEN from `mapout', not `name'.
	<LOOP, subcase `no token'>: Move character copying
	to outer if-block, thus breaking an infinite loop.

2012-12-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftp/cmds.c (put, mput, getit, mget): Check if
	domap() has allocated new memory, and only then
	update string pointer and free old memory.
	(domap) <'[', LOOP>: If cp_subst() substituted
	something, set MATCH to 1.

2012-12-07  Mats Erik Andersson  <gnu@gisladisker.se>

	Activate servers in FreeBSD 9 and 10.  They work
	sufficiently well with the previous adaptions.

	* configure.ac <*-freebsd9* || *-freebsd10*>:
	Delete inhibition of ftpd, rlogind, telnetd, and uucpd.

	Mixed compilation warnings.

	* ftp/cmdtab.c (help): Cast strlen() as int.
	* libls/ls.c (display): MAXBLOCK is portably `long'.
	* src/rlogind.c (protocol): Make NFD an unsigned int.
	* telnet/sys_bsd.c (ayt) [SIGINFO]: Mark `sig' as unused.
	* telnet/telnet.c (init_term): Declare static.  Delete
	unused parameter `fd'.  Rewrite numerical end of TERMBUF.
	(gettermname): Update call to init_term().
	(lm_will, lm_do, lm_mode, slc_import): Cast sizeof()
	as int when comparing to NETROOM.
	(telnet) [!AUTHENTICATION && !ENCRYPTION]: Trivially
	use parameter `user'.

2012-12-07  Mats Erik Andersson  <gnu@gisladisker.se>

	Keep track of allocations.  Was an unlimited use of malloc()!

	* src/rcp.c (sink): Change CURSIZE to size_t.  Initialize
	NAMEBUF and CURSIZE.  Free buffer at each allocation, and
	set CURSIZE.  Capture error condition after failed malloc(),
	resetting CURSIZE and continuing with next loop iteration.

	Signedness warnings in src/.

	* src/hostname.c (parse_file): Use ssize_t for NREAD.
	* src/logger.c (IU_MAX_FAC): New macro.
	(decode): Remove C.  Use `n >= IU_MAX_FAC' to detect
	input error.  Return N for successful values.
	(send_to_syslog): Cast LEN as ssize_t in comparison.
	* src/rcp.c (allocbuf): Cast `bp->cnt' as size_t in comparison.
	* src/rexecd.c (die): Cast `sizeof buf' as int in comparison.
	(getstr): Cast `buf_len >> 3' as ssize_t in comparison.
	* src/rshd.c (getstr): Likewise.

2012-12-06  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Allow `--up', `--down' to be used before
	interface selection.  Applies to all flags.

	* ifconfig/options.c (pending_setflags, pending_clrflags):
	New variables.
	(parse_opt_set_flag): Use parameters to manipulate only
	pending_setflags and pending_clrflags, not `ifp->*flags',
	since the latter need not be allocated.
	(parse_opt_finalize): Assign values to `ifp->setflags'
	and `ifp->clrflags' using `pending_*flags'.
	* ifconfig/options.h (pending_setflags, pending_clrflags):
	New external declarations.

	Detect member `struct ifreq.ifr_mtu'.

	* configure.ac (HAVE_STRUCT_IFREQ_IFR_MTU): Check for
	member ifr_mtu in `struct ifreq'.
	* ifconfig/system/solaris.h (ifr_mtu)
	[!HAVE_STRUCT_IFREQ_IFR_MTU]: Protect macro definition.

	ifconfig: Attend to many compiler warnings.

	* ifconfig/flags.c (if_flags): Set member `rev' to 0,
	whenever it was missing.  Remove duplicate elements
	"OACTIVE" and "D2".  End array with full element.
	(flag_char_tab): End array with full stop element.
	* ifconfig/options.c: Include <unused-parameter.h>.
	(ifconfig_initializer): Initialize all members.
	(formats): End array with full stop element.
	(argp_options): New local macro GRP.  Add GRP to every
	element.  Add description to `peer' and `brdaddr'.
	End array with full stop element.
	(parse_opt_set_flag): Mark ifp as unused.
	(default_help_filter): Mark input as unused.
	(argp): Add NULL as missing, last element.
	* ifconfig/printif.c: Include <unused-parameter.h>.
	(put_char, put_int, put_ulong): Mark form as unused.
	(put_flags_short): Mark argc and argv as unused.
	(fh_nothing): Mark all parameters as unused.
	(fh_newline, fh_tabulator, fh_progname, fh_name)
	(fh_index): Mark argc and argv as unused.
	(fh_exit): Mark form as unused.

	* ifconfig/system/bsd.c: Include <unused-parameter.h>.
	(system_parse_opt, system_configure): Mark all parameters
	as unused.
	(system_fh_hwaddr, system_fh_hwtype): Mark argc and argv
	as unused.

	* ifconfig/system/linux.c: Include <unused-parameter.h>.
	(print_hwaddr_ether, print_hwaddr_arcnet, print_hwaddr_dlci)
	(print_hwaddr_irda, print_hwaddr_rose): Mark form as unused.
	Set had_output.
	(print_hwaddr_ax25): Set had_output.
	(system_fh_hwaddr, system_hw_type): Mark argc and argv as unused.
	(linux_argp_options): Add group member to element "txqlen".
	End array with full stop element.
	(linux_argp): Fill missing members with NULL.

	* ifconfig/system/solaris.c: Include <unused-parameter.h>.
	(system_parse_opt): Mark all parameters as unused.
	(system_configure) [!IF_VALID_TXQLEN]: Trivially use
	paramaters sfd, ifr, and ifs.

2012-12-04  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/system/bsd.c (system_help): Update.
	(system_parse_opt_rest): Populate function with
	parser and actions for command line arguments.

	* ifconfig/system/solaris.c (system_help): Update.
	(system_parse_opt_rest): Implement actions for the
	arguments "up" and "down" of an interface.

2012-12-03  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Audit displaying of metrics.
	The portable display is to supress metric naught.

	* ifconfig/printif.c (fh_metric_query) [SIOCGIFMETRIC]:
	Add the further condition `form->ifr->ifr_metric > 0'
	(fh_metric) [SIOCGIFMETRIC]: Do not report value 0 of
	`form->ifr->ifr_metric' as 1.
	* ifconfig/system/bsd.c (system_fh_metric): Remove.
	* ifconfig/system/bsd.h (SYSTEM_FORMAT_HANDLER):
	Delete key "metric".
	(system_fh_metric): Remove prototype.

	Implement exceptional handler for GNU/Linux.

	* ifconfig/system/linux.c (system_fh_metric_query)
	(system_fh_metric): New functions.
	* ifconfig/system/linux.h (SYSTEM_FORMAT_HANDLER):
	Add new keys "metric?" and "metric".
	(system_fh_metric_query, system_fh_metric):
	New prototypes.

2012-12-03  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig.sh: Avoid substring matches.

	* tests/ifconfig.sh (LO): Assign inside a loop,
	after matching by `expr' against interface name.

	Format string errors and warnings.

	* ifconfig/options.c (parse_opt_flag_list):
	Cast LEN as int for use as width in `%*.*s'.
	* src/rcp.c (source): Use "%zd" instead of "%lld".
	* src/rexecd.c (doit): Format "%d" for `pwd->pw_gid'.
	* telnet/commands.c (ayt_status) [SIGINFO]:
	Return status 1.
	(help): Cast HELPIDENT as int for use as format width.

2012-11-28  Mats Erik Andersson  <gnu@gisladisker.se>

	libinetutils.a: Build if_nametoindex(), if_nameindex(),
	and if_freenameindex() into library, if they are missing
	in the system library.

	* libinetutils/Makefile.am (libinetutils_a_SOURCES):
	Add if_index.c.
	* libinetutils/if_index.c: Moved from old location at
	`ifconfig/if_index.c'.  Do not include <ifconfig.h>.
	* libinetutils/libinetutils.h (if_nameindex)
	[!HAVE_STRUCT_IF_NAMEINDEX): New structure declaration.
	(if_nametoindex, if_nameindex, if_freenameindex)
	[!HAVE_STRUCT_IF_NAMEINDEX): New function declarations.

	* ifconfig/Makefile.am (ifconfig_SOURCES): Remove if_index.c.
	(noinst_HEADERS): Remove if_index.h.
	* ifconfig/if_index.c, ifconfig/if_index.h: Deleted files.
	* ifconfig/ifconfig.h: Do not include "if_index.h".
	* ifconfig/system.h: Do not include <if_index.h>.

	Test script for ifconfig utility.

	* tests/ifconfig.sh: New file.
	* tests/Makefile.am (dist_check_SCRIPTS) [ENABLE_ifconfig]:
	Add ifconfig.sh.

2012-11-23  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Reusable IP sockets.
	Automated test systems seemingly fail here.

	* src/syslogd.c (create_inet_socket): Set socket
	option SO_REUSEADDR on IP sockets.

2012-11-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Output formatting.

	* ifconfig/options.c (formats) <gnu format>:
	Test with `ifdisplay?' to suppress empty lines
	for dormant interfaces.
	<net-tools format>: Remove a newline for txqlen.
	<netstat format>: Use `exists?' on `ifstat?',
	leaving statistics empty if `ifstat?' fails.

2012-11-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Initial hwaddr support for BSD.

	* ifconfig/options.c (formats) <unix format>:
	Place hwtype/hwaddr stanza before addr stanza,
	and emit text only if hwtype evaluates to true.
	(argp_options): Mention `--format=help' in usage.
	* ifconfig/system/bsd.c: Multiple inclusions.
	(ifp): New variable.
	(ESTABLISH_IFADDRS): New macro.
	(system_fh_hwaddr_query, system_fh_hwaddr)
	(system_fh_hwtype_query, system_fh_hwtype):
	New functions.
	* ifconfig/system/bsd.h (IU_BSD_TYPE, ETHERNAME):
	New macros.
	(SYSTEM_FORMAT_HANDLER): Replace keys "dragonflybsd",
	"freebsd", "netbsd", and "openbsd" by the single
	IU_BSD_TYPE, encoding the only relevant system type.
	Add keys "hwaddr?", "hwaddr", "hwtype?", and "hwtype".
	(system_fh_hwaddr_query, system_fh_hwaddr)
	(system_fh_hwtype_query, system_fh_hwtype):
	New prototypes.

2012-11-21  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Make address changes possible on BSD.

	* ifconfig/changeif.c (SET_SIN_LEN): New macro.
	(SIOCSIF): Add SET_SIN_LEN, which is needed by
	every BSD system.

	* ifconfig/options.c (formats) <unix format>:
	Add `dstaddr?' stanza for tunnel interfaces.

2012-11-18  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/ifconfig.c (main): New independent code
	to be executed when `list_mode' is true.
	* ifconfig/options.c (list_mode): New variable.
	(argp_options): New option `-l/--list'.
	(parse_opt) <'l'>: New case.
	* ifconfig/options.h (list_mode): New variable.

2012-11-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/system/Makefile.am (noinst_HEADERS):
	Add `solaris.h' which was accidentally removed.

2012-11-17  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/system/Makefile.am (noinst_HEADERS):
	Add `bsd.h' and `bsd.c' for distribution.

2012-11-17  Mats Erik Andersson  <gnu@gisladisker.se>

	ifconfig: Implement stub for BSD systems.

	* ifconfig/options.c (formats) <unix format>:
	Add metric to printout.
	* ifconfig/system.c [__DragonFly__ || __FreeBSD__ ||
	__NetBSD__ || __OpenBSD__]: Include "system/bsd.c".
	* ifconfig/system.h [__DragonFly__ || __FreeBSD__ ||
	__NetBSD__ || __OpenBSD__]: Include "system/bsd.h".
	* ifconfig/system/bsd.c, ifconfig/system/bsd.h:
	New source files.

2012-11-16  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Adapt to legacy utmp.

	* configure.ac: Check for getutxent.
	* srs/syslogd.c (wallmsg)
	[UTMP_NAME_FUNCTION || !HAVE_GETUTXENT]: Refine
	preprocessor conditional to let read_utmp() handle
	systems with legacy implementation of utmp.  Adding
	a test of !HAVE_GETUTXENT achieves this.

2012-11-16  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd, talkd: Alternative utmp access.

	* configure.ac: Check for getutxuser.
	* src/syslogd.c (wallmsg) [!UTMP_NAME_FUNCTION]:
	Remove UTMPBUF and COUNT.  Call setutxent(),
	getutxent(), and endutxent().
	* talkd/process.c (find_user) [HAVE_GETUTXUSER]:
	Remove UTMPBUF and UTMP_COUNT.  Call setutxent(),
	getutxuser(), and endutxent().
	* tests/readutmp.c (main) [HAVE_GETUTXUSER]: Remove
	UTMPP, UPTR, and COUNT.  Call setutxent(), getutxuser(),
	and endutxent().
	[!HAVE_GETUTXUSER]: Free UTMPP.

2012-11-15  Mats Erik Andersson  <gnu@gisladisker.se>

	Disable targets robustly.

	* am/enable.m4 (IU_DISABLE_TARGET): New macro.
	* configure.ac <ftpd, rlogind, rshd, talk, talkd, telnetd>
	<uucpd>: Use IU_DISABLE_TARGET to disable unbuildable targets,
	avoiding the incomplete manipulations used so far.

2012-11-14  Mats Erik Andersson  <gnu@gisladisker.se>

	* libinetutils/daemon.c (waitdaemon) [_SC_OPEN_MAX]:
	Remove HAVE_SYSCONF from preprocessor conditional.

	* src/syslogd.c (main): Install `die' for SIGINT, SIGQUIT,
	and SIGUSR1 based on NoDetach.  Initially set `dpg_output = 1'
	only in debug mode.  Print a notice also in non-detached mode.
	(cfline): Move assignment to `f->f_file' outside of
	if-statement.
	(dbg_printf): Test `!(NoDetach && dbg_output)' for output.

	* tests/waitdaemon.c: New source file.
	* tests/Makefile.am (check_PROGRAMS): Add waitdaemon.
	(TESTS): Likewise.
	* tests/.gitignore: Likewise.

	* tests/syslogd.sh: Add a sleep period after `kill -HUP'.
	(OBSCURE): New environment variable.  Conduct configuration
	test for non-existent log host only if OBSCURE is set.

	* tests/utmp.sh: Use who(1), if possible, to improve
	reliability of test, checking known users only.
	* configure.ac <*-freebsd9* || *-freebsd10*>:
	Do not disable syslogd and talkd, as the updated test script
	`utmp.sh' will catch the failure as long as it remains.

	* src/Makefile.am (AM_CPPFLAGS): Add $(PATHDEF_TTY_PFX).
	* talkd/Makefile.am (AM_CPPFLAGS): Likewise.
	* telnetd/Makefile.am (AM_CPPFLAGS): Likewise.

	* whois/Makefile.am: Set `LANG=C' when invoking perl.

2012-11-10  Mats Erik Andersson  <gnu@gisladisker.se>

	Consistent use of device prefix.

	* srs/rlogind.c (setup_utmp, cleanup): Use PATH_TTY_PFX,
	not PATH_DEV.
	* talkd/announce.c (announce): Likewise.
	* talkd/process.c (find_user): Likewise.
	* telnetd/pty.c (setup_utmp, cleanup): Likewise.

	* src/rexecd.c (doit) [DEBUG]: Use PATH_TTY, not _PATH_TTY.

	* doc/inetutils.texi: Refer to `.k5login', not `.klogin'.

2012-11-09  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Support encrypted libshishi sessions.

	* src/rcp.c (toremote) <remote-to-remote>: In format strings,
	put options to PATH_RSH before the host argument.
	[(KERBEROS || SHISHI) && ENCRYPTION] <doencrypt>:
	Add option `-x' in format strings.
	[SHISHI && ENCRYPTION]: Close encryption handle and data.
	(tolocal): In format string, portability needs `-R' as
	option to PATH_CP, not `-r'.
	[SHISHI && ENCRYPTION]: Close encryption handle and data.
	(kerberos) [SHISHI && ENCRYPTION]: New variables I and XBP.
	Call krcmd_mutual() and initialize encryption data.

	* src/rshd.c (doit) <denied non-encryption>: Include host name
	in syslog message.

2012-11-06  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Allow enforced encryption with libshishi,
	rejecting other Kerberized sessions.

	* src/rshd.c (uses_encryption) [SHISHI]: New variable.
	(options) [(KERBEROS || SHISHI) && ENCRYPTION]:
	Expose option `-x/--encrypt'.
	(doit) [SHISHI] <client encrypts>: Set `uses_encryption'
	instead of `doencrypt'.  Fail connection request if
	`doencrypt && !uses_encryption', otherwise proceed.
	[SHISHI] <logging>: Refine message to indicate whether
	encryption is in use.

	* src/rlogind.c (do_krb_login) [SHISHI]: Initialize RC
	as SHISHI_VERIFY_FAILED.
	[KERBEROS]: Initialize RC as 1.

	* src/rlogind.c (setup_utmp): Calculate offset
	from PATH_DEV.
	* telnetd/pty.c (setup_utmp): Likewise.

2012-11-05  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Buffer overflow, causing stalled and
	incomplete login for encrypted connections.

	* libinetutils/shishi_def.h (SHISHI_ENCRYPT_BUFLEN):
	Rename from previous BUFLEN.
	* libinetutils/shishi.c (readenc): Likewise, used
	in calling memset() on `buf'.
	* src/rlogind.c (do_shishi_login): Replace 100 by
	sizeof(cksumdata) when calling snprintf().  Insert
	`encrypted' in syslog message for encrypted exchange.
	(BUFLEN): Define as SHISHI_ENCRYPT_BUFLEN, if possible,
	otherwise fall back to existing value, or to 1024.
	(protocol): Declare FIBUF of length BUFLEN, and DBUF
	of length BUFLEN+1.

2012-11-02  Mats Erik Andersson  <gnu@gisladisker.se>

	* telnet/commands.c: Include <limits.h>.  Needed
	by Solaris to have LLONG_MAX.

2012-11-02  Mats Erik Andersson  <gnu@gisladisker.se>

	* telnet/commands.c (tn): New block with sanity check of
	numerical port, being out of range, or mixed with letters.

2012-11-01  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Build without readline support.

	* configure.ac <enable_ftp>: Remove test for disabling
	FTP client based on `$gl_cv_lib_readline = no'.
	* am/readline.m4 (gl_FUNC_READLINE): Create option
	`--disable-readline' using AC_ARG_ENABLE([readline]).
	(HAVE_READLINE): Demand also `$enable_readline = yes`.
	* ftp/cmds.c [HAVE_READLINE_READLINE_H]: Inclusion guard
	for <readline/readline.h>.
	[HAVE_READLINE_HISTORY_H]: Guard <readline/history.h>.
	(another) [HAVE_READLINE]: Conditional use of readline()
	and of add_history().
	* ftp/main.c [HAVE_READLINE_READLINE_H]: Inclusion guard
	for <readline/readline.h>.
	[HAVE_READLINE_HISTORY_H]: Guard <readline/history.h>.
	(argp_options) [!HAVE_READLINE]: Alternate description
	for `-e/--no-edit'.
	(cmdscanner) [HAVE_READLINE]: Conditional use of readline()
	and of add_history().

2012-10-30  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/readutmp.c: New file.
	* tests/utmp.sh: New file.
	* tests/Makefile.am (check_PROGRAMS): Add readutmp.
	(dist_check_SCRIPTS): Add utmp.sh.
	* tests/.gitignore: Add readutmp to list.

2012-10-29  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Increase universality by recognizing the alias
	name `pftp' and the option `-e'.

	* ftp/cmds.c (another): New variable SIZE.  Use LEN
	typed as size_t.  Condition readline() on `usereadline'
	not `fromatty', otherwise read input based on getline().
	Likewise, condition add_history() on `usereadline'.
	(dotrans): Use type size_t for I, OSTOP, FOUND.
	* ftp/ftp_var.h (usereadline): New variable.
	* ftp/main.c (argp_options): New option `-e/--no-edit'.
	(parse_opt) <'e'>: New case.
	(main): Check if invoked as `pftp', setting passive mode.
	Clear `usereadline' without a TTY.
	(cmdscanner): Change L to ssize_t.  New variable LEN.
	Condition readline() and add_history() on `usereadline',
	else use a getline() block for input.

2012-10-28  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftpd/popen.c (ftpd_popen): Prevent null deference
	and allocation overflow in access to glob patterns.

2012-10-23  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: PAM robustness.  Fine tune message passing,
	since the finite state automata of FTP can choke
	on some multiline messages.

	* ftpd/extern.h (lreply_multiline): New prototype.
	* ftpd/ftpd.c (user): Transmit a reply containing
	only a single line, cutting at the last newline.
	(pass): If the credential of an authenticated user
	contains a message, reply using lreply_multiline().
	(lreply_multiline): New function.
	* ftpd/pam.c (PAM_conv): Insert a newline character
	between concatenated message strings.  Remove only
	trailing whitespace, leaving any colon untouched.
	(pam_doit): Compare message string to `password:',
	including a colon.

2012-10-19  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd: Portability of utmp.  Disclosed by Solaris 11.

	* src/syslogd.c (wallmsg): Call read_utmp() with the
	file argument UTMP_FILE, not PATH_UTMP.
	* talkd/process.c (find_user): Likewise.

	* tests/syslogd.sh (USER): New variable.
	<verbose mode>: Add a stanza to the configuration file
	for passing all messages also to user $USER.

2012-10-18  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Properly close a user session.

	* ftpd/ftpd.c (dologout): Call end_login().
	* ftpd/pam.c (pam_doit): Call finishing pam_end()
	only if ERROR is not PAM_SUCCESS.

2012-10-18  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Security audit.

	* ftpd/auth.c (auth_user): Declare ERR at top.
	Replace most `return` inside switch block by `break`.
	Put call checkuser(PATH_FTPCHROOT) at function end
	whenever authentication succeeded, thus making it
	reachable for all authentication modes.

	* ftpd/ftpd.c: Include <xgetcwd.h>.
	(curdir, makedir, removedir): Remove prototype xgetcwd().
	(main): Call localhost() before sending welcome msg.
	(complete_login): New variable CWD.  Set EUID before
	calling chdir() for real users.  Call xgetcwd() and
	set HOME in environment for all kinds of user.
	(end_login): Reset `pcred->logged_in`.
	(getdatasock, passive): Call _exit() at failure of
	seteuid(cred.uid).

	ftp: Self documentating code.

	* ftp/ftp.c (getreply): Make ARPA's reply codes
	explicit.  Let N carry these codes, not an ASCII
	character value.

2012-10-11  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Server and realm detection.

	* libinetutils/shishi.c (get_auth): Parse server
	name input using shishi_parse_name(), but only if
	`srvname' has some content.  Retrieve default
	realm by calling shishi_realm_default(), and
	pass it to shishi_hostkeys_for_serverrealm().

	rlogin: Handle urgent data for non-encrypted Kerberos.
	This enables window sizing and buffer flushing.

	* src/rlogin.c (main): Set sigaction flag SA_RESTART
	when installing SIGURG and SIGUSR1; a portability fix.
	(oob) [SHISHI]: Assign urgent data `rcvbuf[4]' to MARK
	whenever `use_kerberos' is true.  This is then compared
	to different TIOCPKT_*.

	* src/rlogind.c (fatal): Replace an empty format
	input by the string "unspecified error", in order
	to protect against segfaults in vsnprintf().

2012-10-11  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin: Read urgent data also when Kerberos has
	been disabled.  Needed for window sizing.

	* src/rlogin.c (sigwinch): Call get_window_size()
	with STDIN_FILENO as file descriptor.
	(oob) [SHISHI]: Receive MSG_OOB data whenever
	`!use_kerberos' is true.

2012-10-11  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rlogind.c (rlogin_daemon)
	[(KERBEROS || SHISHI) && ENCRYPTION]: Protect
	encrypted port pre-selection.
	[(KERBEROS || SHISHI) && !ENCRYPTION]: Protect
	standard Kerberos port pre-selection.

2012-10-11  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Set local name correctly for libshishi.
	Improve selectivity of intended server host key.

	* libtelnet/shishi.h (krb5shishi_is_auth): Replace call
	to shishi_hostkeys_for_server(), with a variant where
	default realm is made explicit with shishi_realm_default().

	* telnetd/telnetd.c (telnetd_setup)
	[AUTHENTICATION || ENCRYPTION]: Exchange places of
	`local_hostname' and `remote_hostname' in call to
	auth_encrypt_init().

	rlogind: Enable Kerberised daemon mode listener.

	* src/rlogind.c (DEFPORT_KLOGIN, DEFPORT_EKLOGIN): New macros.
	(rlogin_daemon): New variable SERVICE.  Use service port
	`login', `klogin', or `eklogin' according to set options.

	* src/rlogin.c (main) <rcmd failure>: Print a NL, finishing
	an unfinished error massage emitted by Glibc.

2012-10-08  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Support libwrap in daemon mode.

	* configure.ac <rlogind summary>: Print $LIBWRAP.
	* src/Makefile.am (rlogind_LDADD): Add $(LIBWRAP).
	* src/rlogind.c [HAVE_TCPD_H]: Include <tcpd.h>.
	[WITH_WRAP && !HAVE_DECL_HOSTS_CTL]: New prototype
	for missing hosts_ctl() declaration.
	(allow_severity, deny_severity) [WITH_WRAP]:
	New variables.
	(check_host) [WITH_WRAP]: New function.
	(rlogin_daemon) [WITH_WRAP]: Call check_host().
	(protocol) [!SHISHI]: Trivial use of AP.

	* ftpd/server_mode.c (check_host): Use severity
	`deny_severity' to syslog() at rejects.

2012-10-05  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet: Reliability fix caused by OpenSolaris,
	where SIGWINCH regularly got lost.

	* telnet/sys_bsd.c (sys_telnet_init): New variable SA.
	[SIGWINCH]: Install handler with sigaction().
	[SIGTSTP]: Likewise.
	[SIGINFO]: Likewise.

2012-10-04  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/libping.c (ping_set_dest) [HAVE_DECL_GETADDRINFO]:
	Alternative and preferred resolver using getaddrinfo().
	* ping/ping6.c (print_echo) [NI_IDN]: Add flag NI_IDN
	to getnameinfo() if option OPT_NUMERIC is not set.
	(ping_set_dest) [AI_IDN]: Add flag AI_IDN to HINTS.
	* ping/ping_common.c (ipaddr2str) [NI_IDN]: Add flag
	NI_IDN to getnameinfo().
	* src/traceroute.c (main) [AI_IDN]: Add flag AI_IDN to HINTS.
	[AI_IDN && AI_CANONIDN]: Add flag AI_CANONIDN to HINTS.

2012-10-02  Mats Erik Andersson  <gnu@gisladisker.se>

	* libinetutils/logwtmp.c [HAVE_STRUCT_UTMPX_UT_SYSLEN]:
	Take care of overlong host name when storing length
	in `ut.ut_syslen'.
	* libinetutils/logwtmpko.c, libinetutils/utmp_init.c:
	Likewise.

	* ftpd/popen.c, libinetutils/daemon.c,
	libinetutils/ttymsg.c, src/inetd.c, src/rshd.c,
	src/syslogd.c, telnet/commands.c: Call _exit()
	with EXIT_SUCCESS or EXIT_FAILURE, not 0 or 1.

2012-10-02  Mats Erik Andersson  <gnu@gisladisker.se>

	uucpd: Upgrade, including IPv6.

	* src/uucpd.c: Include <unused-parameter.h>.
	(hisctladdr, hisaddrlen): Remove variables.
	(uucico_location, Logname): New variables.
	(nenv): Add `Logname'.
	(argp_options): New variable.
	(parse_opt): New function.
	(argp): Add `argp_options' and `parse_opt'.
	(main): New variables HISCTLADDR, HISADDRLEN.
	(readline): Read from STDIN_FILENO.
	(doit): New signature `(struct sockaddr *, socklen_t)'.
	Remove truncation of USER.  Ask password for non-existent
	user, then fail.  Check user shell after password check,
	and compare to `uucico_location'.  Set LOGNAME in `nenv'
	for portability.  Call execl() with `uucico_location'.
	[HAVE_INITGROUPS]: Guard call to initgroups().
	(dologin): New signature
	`(struct passwd *, struct sockaddr *, socklen_t)'
	[HAVE_DECL_GETNAMEINFO]: Use getnameinfo() as resolver.
	[!HAVE_DECL_GETNAMEINFO]: Extend code with gethostbyaddr()
	to accept IPv6.  Replace inet_ntoa() by inet_ntop().
	(dologin) [HAVE_STRUCT_UTMPX_UT_SYSLEN]: Correctly set
	the used length of `ut.ut_host'.

2012-10-01  Mats Erik Andersson  <gnu@gisladisker.se>

	uucpd: Restore inetd code.

	Code necessary for inetd mode was accidentally
	removed on 2009-10-26.  Replace daemon mode code.
	* src/uucpd.c: Include <grp.h>.
	(hisaddrlen): Type is socklen_t.
	(myctladdr): Removed.
	(main): Remove variables S and SP.  Remove broken,
	partial code for daemon mode operation.  New calls
	to dup2(), getpeername(), doit(), and dologout().
	(doit): New calls to initgroups() and execl().

2012-09-28  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Daemon mode update.

	Reinstalling an identical signal action was needed
	on legacy systems.  Made obsolete by setsig().

	* src/rlogind.c (rlogind_sigchld): Remove call to
	setsig() for reactivation.  Use _GL_UNUSED_PARAMETER.

	Make daemon mode able to do IPv4 and IPv6, but only
	if getaddrinfo() is available.  Use two sockets for
	better portability.

	* src/rlogind.c (use_af): New variable.
	(options): New switches `-4/--ipv4' and `-6/--ipv6'.
	Expose optional argument for `-d/--daemon'.
	(parse_opt) <'4', '6'>: New cases.
	(find_listenfd): New function, generating sockets
	for rlogin_daemon().
	(rlogin_daemon): Use select() on at most two
	listening sockets.  Let `use_af' determine IPv4
	and/or IPv6.  New variables LISTENFD[2], NUMFD,
	MAXFD, LFDSET.

2012-09-27  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin, rlogind: Signal dispositions.
	Use a more portable signal API.

	* libinetutils/libinetutils.h: Include <signal.h>.
	(setsig): New prototype, exposing old function.

	rlogin: Old signal API is inconsistent, even between
	libc6 versions.

	* src/rlogin.c (setsig): Remove external prototype.
	(main): New variable SA.  Use STDIN_FILENO, not 0.
	Call sigaction() with SIGURG, SIGUSR1, not setsig().
	Pass `&osmask' to doit(), needed for window sizing.
	(doit): Rename parameter as `osmask' for clarity.
	New variable SA.  Call sigaction for SIGINT, SIGCHLD.
	(setsignal): Fully reworked implementation.
	(writeroob): New variable SA.  Use sigaction().
	(oob): Use STDOUT_FILENO, not 1.  Offer ioctl TCIOFLUSH
	for systems lacking TIOCFLUSH.
	(reader): Rename parameter as `osmask'.  New variable SA.
	Assume that contemporary getpid() returns positive values.
	Call fcntl(F_SETOWN) as early as possible, and set owner
	using PID, not PPID.  Use sigaction() for SIGTTOU, SIGURG.
	(lostpeer): Use input parameter in setsig().
	(copytochild): Likewise for kill().

	* src/rlogind.c (rlogind_sigchld): Rename parameter.
	Replace signal() by setsig().
	(main, rlogin_daemon, rlogind_mainloop, protocol):
	Replace signal().

2012-09-25  Mats Erik Andersson  <gnu@gisladisker.se>

	Disable incompatible utmpx implementation.

	* configure.ac <*-freebsd9* || *-freebsd10*>:
	Disable building of ftpd, rlogind, syslogd,
	talkd, telnetd, and uucpd.

2012-09-19  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac <libwrap check>: Call AC_CHECK_DECLS
	with hosts_ctl.
	* ftpd/server_mode.c (hosts_ctl)
	[WITH_WRAP && !HAVE_DECL_HOSTS_CTL]: Add external
	prototype whenever undeclared.

	* ftpd/ftpd.c (complete_login): Cast pid_t as int
	in formatted print.
	* src/inetd.c (run_service, readchild, print_service)
	(main): Likewise.
	* src/syslogd.c (main): Likewise.
	* src/uucpd.c (dologout, dologin): Likewise.
	(dologout) [PATH_LASTLOG && HAVE_STRUCT_LASTLOG]:
	Declare F conditionally.

	* ifconfig/changeif.c: Access `HAVE_DECL_*' using `#if',
	not using `#ifdef' constructs.
	* libinetutils/kcmd.c, libinetutils/localhost.c: Likewise.
	* src/rlogind.c, src/rshd.c: Likewise.

2012-09-17  Mats Erik Andersson  <gnu@gisladisker.se>

	talk: Delay start of curses interface until
	the other party has established a connection.

	* talk/init_disp.c (init_display): Remove assignment
	of `current_state'.
	* talk/io.h (p_error): Execute curses function calls
	only if `curses_initialized' is true.  Otherwise call
	perror().
	(message): Likewise, placing a call to printf() for
	non-empty message strings only.
	* talk/talk.c (main): Delay call to init_display() until
	after end_msgs().  New messages set in `current_state'.

	talkd: Enforce access rights on `~/.talkrc'.

	* talkd/acl.c (read_acl): Site-wide file uses `system > 0'.
	New code block for the parameter case `system < 0', pushing
	a single, deny-all rule.
	(open_users_acl): New variables LEVEL, RC and ST.  Check
	properties of ACL file using stat().  Enforce a deny rule
	if they are too permissive.
	* doc/inetutils.texi <talkd invocation>: Updated.

2012-09-15  Mats Erik Andersson  <gnu@gisladisker.se>

	Mark unused parameters as such.

	* ftp/cmds.c (setbinary, setascii, settenex, setftmode)
	(setform, setstruct, status, setbell, settrace, sethash)
	(setverbose, setipany, setipv4, setipv6, setepsv4, setport)
	(setprompt, setglob, shell, pwd, quit, disconnect, proxabort)
	(setcase, setcr, setpassive, setsunique, setrunique, cdup)
	(syst): Add _GL_UNUSED_PARAMETER.
	* ftp/ftp.c (abortsend, abortrecv, psabort, abortpt, reset):
	Likewise.
	* ftp/main.c (parse_opt): Likewise.

	Header file and parse_opt() are common treatments.

	* src/logger.c: Include <unused-parameter.h>.
	(parse_opt): Add _GL_UNUSED_PARAMETER.
	* src/rcp.c: Likewise.
	(lostconn): Likewise
	* src/rexecd.c: Likewise.
	* src/rlogind.c (parse_opt): Likewise
	(do_shishi_login): Remove variable IV.
	* src/rshd.c: Likewise.

	* telnet/commands.c: Include <unused-parameter.h>.
	(shell): Add _GL_UNUSED_PARAMETER.
	* telnet/main.c: Likewise.
	(parse_opt): Likewise.
	* telnet/sys_bsd.c: Likewise.
	(deadpeer, intr, intr2, susp, sendwin): Likewise.

	* tests/localhost.c: Likewise.
	(main): Likewise.

	* whois/whois.c: Likewise.
	(ripe_argp_parser, gwhois_argp_parser): Likewise.

2012-09-15  Mats Erik Andersson  <gnu@gisladisker.se>

	Add missing values in option lists, and in similar
	lists.  All were detected as compiler warnings.

	* ftp/cmds.c (types): Add missing values.
	* ftp/cmdtab.c (cmdtab): Likewise.
	* ftp/main.c (argp, argp_options): Likewise.

	* src/dnsdomainname.c (argp): Likewise.
	* src/hostname.c (argp, argp_options): Likewise.
	* src/logger.c (arpg): Likewise
	(argp_options): Likewise.  New macro GRP.

	Collect Kerberos options into a group where relevant.

	* src/rcp.c (options): Add missing values.
	* src/rexec.c (argp): Likewise
	(options): Likewise.  New macro GRP.
	* src/rexecd.c (options): Likewise
	* src/rlogin.c (argp, argp_options): Likewise.
	* src/rlogind.c (argp): Likewise.
	(options): Likewise.  New macro GRP.
	* src/rsh.c (argp, options): Likewise
	* src/rshd.c (argp, options): Likewise

	* telnet/commands.c (Togglelist, Setlist, ModeList)
	(SlcList, EnvList, AuthList, EncryptList, cmdtab)
	(cmdtab2): Add missing values.
	* telnet/main.c (argp, argp_options): Likewise.
	* telnet/network.c (timeout): Likewise.
	* telnet/sys_bsd.c (TimeValue): Likewise.

	* whois/whois.c (gwhois_argp, gwhois_argp_children)
	(ripe_argp): Add missing values.
	(gwhois_arpg_options, ripe_argp_options): Likewise.
	New macro GRP.

2012-09-14  Mats Erik Andersson  <gnu@gisladisker.se>

	libinetutils: Compiler warnings.

	* libinetutils/argcv.c (argcv_get): Cast element as int.
	* libinetutils/cleansess.c [HAVE_UTMP_H && HAVE_LIBUTIL_H]:
	Include <libutil.h>.
	* libinetutils/daemon.c: Include <unused-parameter.h>.
	(waitdaemon_timeout): Add _GL_UNUSED_PARAMETER.
	* libinetutils/kcmd.c (kcmd): Cast strlen() as ssize_t.
	Add parantheses in logical expression.
	[SHISHI]: Declare SIN_LEN as socklen_t.  Trivial use of
	parameter service.
	* libinetutils/logwtmp.c (OUR_WTMP): New macro.
	(_logwtmp): Call open() with OUR_WTMP.
	* libinetutils/shishi.c (shishi_auth): Cast sizeof() as
	ssize_t.  Cast sname as `char *' in assignment of P.
	(senderror): Remove function, keeping as comment.
	(gat_auth): Remove variables I and AUTH_CORRECT.  Cast
	size expression as int.
	* libinetutils/utmp_init.c [HAVE_UTMP_H && HAVE_LIBUTIL_H]:
	Include <libutil.h>.
	(utmp_init) [!HAVE_UTMPX_H && !HAVE_PUTUTLINE && HAVE_LOGIN]:
	Trivially use parameter id.
	* libinetutils/utmp_logout.c [HAVE_UTMP_H && HAVE_LIBUTIL_H]:
	Include <libutil.h>.
	(utmp_logout) [!HAVE_UTMPX_H && HAVE_PUTUTLINE]: Protect
	declaration of UT.

2012-09-14  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: More compiler warnings.

	* am/libcurses.m4 (IU_LIB_TERMCAP): Use AC_LINK_IFELSE
	instead of AC_CHECK_DECLS to find declaration of tgetent.
	* telnetd/term.c (copy_termbuf) [TIOCPKT_IOCTL]: Declare
	LEN as size_t.  Increment LEN in loop.
	* telnetd/utility.c (printdata): Cast *PTR as int.

2012-09-14  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Compiler warnings.

	* telnetd/pty.c (startslave) [!AUTHENTICATION]:
	Trivially use autoname.
	(start_login): Trivially use host, autologin, name.
	* telnetd/telnetd.c: Include <unused-parameter.h>
	(argp_options): Add missing fields.  Collect options
	for authentication into a separate group.  New macro GRID.
	(parse_opt): Add _GL_UNUSED_PARAMETER.
	(argp): Add missing fields.
	* telnetd/term.c (tty_setlinemode) [!TIOCEXT && !EXTPROC]:
	Trivially use `on'.
	* telnetd/utility.c (pty_output_datalen): Cast integer
	difference as size_t.
	(pty_get_char): Likewise.
	(stilloob): Add missing field in TIMEOUT.
	(getterminaltype) [!AUTHENTICATION]: Trivially use user_name.
	(printsub) [AUTHENTICATION && ENCRYPTION]: Declare BUF as
	array of unsigned char.
	<case TELQUAL_NAME>: Cast array reference as `char *'
	inside call to debug_output_datalen.
	(_var_long_name): Trivially use start and length.

2012-09-13  Mats Erik Andersson  <gnu@gisladisker.se>

	Use libdl only when needed, i.e., with libpam.

	* configure.ac (LIBDL): New variable.  Publish it
	using AC_SUBST.  When calling AC_CHECK_LIB for
	dlopen in libdl, add the action `LIBDL=-ldl' which
	avoids a global change of LIBS.
	* ftpd/Makefile.am (LDADD): Add $(LIBDL).
	* src/Makefile.am (rexecd_LDADD, rshd_LDADD): Likewise.

	Link libnsl, libresolv or libsocket only if needed.

	* configure.ac: Use AC_SEARCH_LIBS instead of AC_CHECK_LIB
	when sensing for libnsl, libresolv, and libsocket.

	Refine libidn detection and specification.

	* configure.ac <--with-libidn-prefix>: New option.
	<libidn detection>: Call AC_MSG_CHECKING after other
	checks, and call AC_MSG_RESULT with correct variable.
	Preload INCIDN and LIBIDN from $with_libidn_prefix.
	In call to AC_CHECKLIB(idn, ...), use preset LIBIDN.
	In summary message, print `-lidn' instead of LIBIDN.

2012-09-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* ifconfig/changeif.c (herror prototype)
	[!HAVE_DECL_GETADDRINFO]: Conditional use of prototype.
	(set_address) [HAVE_DECL_GETADDRINFO]: New variables RC,
	ADDR, HINTS, AI, and RES.  New, alternate code for address
	resolution using getaddrinfo() and getnameinfo().

	* libinetutils/localhost.c (localhost) [HAVE_DECL_GETADDRINFO]:
	New variables RC, HINTS, RES, and FQDN.  New, alternate code
	for address resolution.

	* tests/Makefile.am (TESTS): Add `localhost' as test case.

2012-09-11  Mats Erik Andersson  <gnu@gisladisker.se>

	* ftpd/ftpcmd.y (cmd): Add parantheses to separate
	subordinate && from ||.
	* ftpd/ftpd.c (off_to_str): Cast OFF as long.
	(options): Fill in missing fields.
	(main) [!HAVE_INITSETPROCTITLE]: Trivially use envp.
	* ftpd/pam.c: Include <unused-parameter.h>.
	(pam_pass): Cast passwd as `char *'.
	(pam_end_login): Add _GL_UNUSED_PARAMETER.
	* ftpd/popen.c (ls_main prototype) [WITH_LIBLS]:
	Enclose within conditional WITH_LIBLS.
	* ftpd/server_mode.c (server_mode) [HAVE_FORK]:
	Trivially use argv.
	* libls/fts.c: Include <unused-parameter.h>.
	(fts_set): Add _GL_UNUSED_PARAMETER.
	* libls/ls.c (display): Cast MAXSIZE as off_t.

2012-09-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping.c (ping_finish): Replace format string "%ld"
	by "%zu" for counter status.
	* ping/ping6.c (ping_finish): Likewise.
	* ping/ping_common.h (struct ping_data): Set type size_t
	on fields ping_num_xmit, ping_num_recv and ping_num_rept.
	* ping/ping_router.c: Include <unused-parameter.h>.
	(ping_router): Add _GL_UNUSED_PARAMETER.

2012-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	talk, talkd: Portability issue.

	* talk/look_up.c (check_local): New variable ADDR.
	Call connect() with ADDR, built from `rp->addr'.

	* talkd/talkd.c (talkd_run): New variable CTL_ADDR.
	Call sendto() with CTL_ADDR, built from `msg.ctl_addr'.

2012-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Support IDN named hosts.

	* configure.ac: Check traceroute_BUILD and LIBIDN in
	summary message.
	* src/Makefile.am (traceroute_LDADD): Add $(LIBIDN).
	(INCLUDES): Add $(INCIDN).

	* src/traceroute.c: Include <unused_parameter.h>
	[HAVE_LOCALE_H]: Include <locale.h>.
	[HAVE_IDNA_H]: Include <idna.h>.
	(argp_options, argp): Add missing fields.
	(main): New variables RC and RHOST.  Let getaddrinfo()
	resolve RHOST.
	[HAVE_SETLOCALE]: Call setlocale().
	[HAVE_IDN]: Call idna_to_ascii_lz().
	(do_try): Add _GL_UNUSED_PARAMETER.

	ping, ping6: Use setlocale() independently of IDN.
	Attend to some compiler warnings.

	* ping/libping.c: Remove inclusion of <locale.h>.
	(ping_set_dest): Remove call to setlocale().
	* ping/ping.c: Include <unused-parameter.h>.
	[HAVE_LOCALE_H]: Include <locale.h>.
	(argp_options, argp): Add missing fields.
	(main) [HAVE_SETLOCALE]: Call setlocale().
	(sig_int): Add _GL_UNUSED_PARAMETER.
	(ping_run): Declare NRESP and I as size_t.
	(send_echo): Declare OFF as size_t.
	* ping/ping6.c: Include <unused-parameter.h>.
	(argp_options, argp): Add missing fields.
	(main) [HAVE_SETLOCALE]: Call setlocale().
	(sig_int, print_echo, ping_init): Add _GL_UNUSED_PARAMETER.
	(ping_run): Declare NRESP size_t and I as `unsigned long'.
	(send_echo): Declare OFF as size_t.
	(ping_echo): Replace format string "%d" by "%zd".
	(ping_set_dest): Remove call setlocale().
	* ping/ping_address.c: Include <unused-address.h>.
	(print_address): Add _GL_UNUSED_PARAMETER.
	* ping/ping_common.c: Include <unused-address.h>.
	(init_data_buffer): Use `size_t len' as second parameter.
	Declare I as size_t.
	(decode_pattern): Add _GL_UNUSED_PARAMETER.
	* ping/ping_common.h (init_data_buffer): Update prototype.
	* ping/ping_echo.c: Include <unused-parameter.h>.
	(ping_echo): Replace format string "%d" by "%zd".
	(print_echo, print_ip_data): Add _GL_UNUSED_PARAMETER.
	(print_icmp_code): Declare HLEN as size_t.
	(print_ip_header): Declare J as size_t.
	(icmp_diag): Add missing fields.
	* ping/ping_timestamp.c: Include <unused-parameter.h>.
	(print_timestamp): Add _GL_UNUSED_PARAMETER.

	inetd: Attend to compiler warnings.

	* src/inetd.c (toomany): Declare as unsigned.
	(argp_options, argp): Add missing fields.
	(struct servtab): Declare se_count as unsigned.
	(enter): Declare I as size_t.
	(parse_opt, echo_dg, discard_dg, chargen_dg)
	(machtime_stream, machtime_dg, daytime_stream)
	(daytime_dg): Add _GL_UNUSED_PARAMETER.

2012-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	talk, talkd: Compiler warnings.

	* talk/ctl.c (daemon_addr, ctl_addr, my_addr): Remove
	initial values, since they are incomplete.
	(open_sockt): Set `my_addr.sin_family' and `my_addr.sin_len'.
	(open_ctl): Likewise with `ctl_addr'.
	* talk/ctl_transact.c (ctl_transact): Likewise with
	`daemon_addr'.  Call htons() with `daemon_port'.
	* talk/get_addrs.c (daemon_port): Use in host byte order,
	calling ntohs() on `sp->s_port'.
	* talk/invite.c: Include <unused-parameter.h>.
	(re_invite): Add _GL_UNUSED_PARAMETER. Initialise `daemon_addr'.
	* talk/msgs.c: Include <unused-parameter.h>.
	(disp_msg): Add _GL_UNUSED_PARAMETER.
	* talk/talk.c (argp): Fill in missing fields.
	* talkd/talkd.c (argp_options, argp): Likewise.
	(parse_opt): Add _GL_UNUSED_PARAMETER.

2012-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	syslogd, tftp, tftpd, uucpd: Compiler warnings.

	* src/syslogd.c (argp_options, parse_opt): Fill in
	non-initialised fields.
	* src/tftp.c: Include <unused-parameter.h>.
	(cmdtab, argp_options, parse_opt): Fill in missing fields.
	(setbinary, setascii, status, intr, quit, settrace)
	(setverbose, timer): Add _GL_UNUSED_PARAMETER.
	* src/tftpd.c: Include <unused-parameter.h>.
	(options, argp, formats): Fill in missing fields.
	(parse_opt, timeout, justquit): Add _GL_UNUSED_PARAMETER.
	* src/uucpd.c (arpg): Fill in missing fields.

	Upgrade TFTP test.

	* tests/tftp.sh: Make mode `binary' explicit.  Add a case
	with `ascii' transmission.
	(ASCIIFILE, type): New variables.

2012-09-07  Mats Erik Andersson  <gnu@gisladisker.se>

	talkd: Full ACL capability.

	* talkd/acl.c (struct acl): New member `system'.
	(read_acl): Rename parameter `silent' as `system',
	used to distinguish site-wide and user setting.
	If `system' is true and file is set, but non-readable,
	then write a syslog message and abort execution.
	(open_user_acl): Call read_acl() with `system = 0'.
	(acl_match): New variables SYSTEM_ACTION, USER_ACTION,
	and FOUND_USER_ACL.  Check site-wide ACL against
	`msg->r_name' and user ACL against `msg->l_name'.
	Travers the full list of rules for applicable actions.
	Implement overriding mechanism depending on policy
	for the returned value.
	* talkd/intalkd.h (strict_policy): New variable.
	* talkd/talkd.c (strict_policy): Likewise.
	(arpg_options): New option `-S/--strict-policy'.
	(parse_opt) <'S'>: New case.
	(main): Call read_acl() with `system = 1'.
	* doc/inetutils.texi <talkd invocation>: Updated.

2012-09-06  Mats Erik Andersson  <gnu@gisladisker.se>

	talkd: Partial activation of ACL features.
	Upstream Gnulib has repaired read_utmp() call.

	* talkd/acl.c (ACT_ALLOW, ACT_DENY): Removed macros.
	(read_acl): Add parameter `int silent'.  Report missing
	file only if `!silent'.  Partially decrease syslog severity.
	New return values ACL_ALLOW and ACL_DENY.
	(open_users_acl): Call read_acl() with silent flag, a file
	is not mandatory for users.
	(acl_match): Return ACL_ALLOW as default result.
	* talkd/announce.c (print_msg, announce): Lower severity
	LOG_CRIT to LOG_ERR.
	* talkd/intalkd.h (ACL_ALLOW, ACL_DENY): New macros.
	(logging): New variable.
	(read_acl): Update prototype.
	* talkd/process.c (process_request): Delay ACL matching
	until protocol and address have been checked.  Send answer
	FAILED in reply whenever acl_match() returns ACL_DENY.
	Give syslog messages lower severity and condition on
	`logging || debug'.
	* talkd/table.c (insert_table): Change LOG_CRIT to LOG_ERR.
	* talkd/talkd.c (logging): New variable.
	(doc): Mention service `ntalk'.
	(argp_options): New option `-l/--logging'.
	(parse_opt) <'l'>: New case.
	(main): Call read_acl() with non-silent flag.  Explicitly
	use STDIN_FILENO as descriptor for talkd_run().
	(alarm_handler): New variable OERRNO. Protect and recover
	errno across handler actions.
	(talkd_run): Commit syslog messages for `logging || debug'.
	Lower severity to LOG_NOTICE.

	* doc/inetutils.texi <talkd invokation>: Expose the
	distinguishing features of the present implementation.

	* talk/init_disp.c (init_display): Catch SIGQUIT.

	* configure.ac: Include <sys/socket.h> when checking
	for `sockaddr_in6.sin6_len' and `sockaddr_storage.ss_len'.
	Check talk_BUILD and LIBCURSES in summary message.

2012-08-31  Mats Erik Andersson  <gnu@gisladisker.se>

	ping, ping6: Support IDN named hosts.

	* configure.ac: New checks for `locale.h' and setlocale().
	(--with-idn): New setting.
	(INCIDN, LIBIDN): New variables.
	* ping/Makefile.am (ping_LDADD): Add $(LIBIDN).
	(ping6_LDADD): Likewise.
	(INCLUDES): Add $(INCIDN).
	* ping/libping.c [HAVE_LOCALE_H]: Include <locale.h>.
	[HAVE_IDNA_H]: Include <idna.h>.
	(ping_set_dest) [HAVE_IDN]: New variables P and RC.
	Resolve HOST by a call to idna_to_ascii_lz().
	[HAVE_IDN && HAVE_SETLOCALE]: Call setlocale().
	* ping/ping6.c [HAVE_LOCALE_H]: Include <locale.h>.
	[HAVE_IDNA_H]: Include <idna.h>.
	(ping_set_dest): New variable RHOST used in getaddrinfo().
	[!HAVE_IDN]: Make RHOST a reference to HOST.
	[HAVE_IDN]: Resolve HOST by a call to idna_to_ascii_lz().
	[HAVE_IDN && HAVE_SETLOCALE]: Call setlocale().

2012-08-30  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac: Add a final AC_MSG_NOTICE, containing a summary
	of established compilation tasks.
	(KERBEROS_VERSION): Assign values `krb4' and `krb5'.  Change test
	values in case patterns.
	(enable_authentication, enable_encryption) [-n KERBEROS_VERSION]:
	Assign `yes' as default value in two separate tests.
	<KERBEROS_VERSION == Shishi>: Have `--without-shishi' bypass
	the feature checks for libshishi.  Set KERBEROS_VERSION empty
	when AC_CHECK_LIB fails.  Empty INCAUTH, LIBAUTH, and also
	KERBEROS_VERSION when AC_CHECK_HEADER fails.

	* tests/Makefile.am (bin_PROGRAMS): Remove variable.
	(check_PROGRAMS): New variable replaces bin_PROGRAMS, not added
	to variable TESTS.

	* tests/syslogd.sh (silence): New variable, decreases verbosity.

2012-08-24  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/tftp.sh (silence, bucket): New variables.
	Make the script silent in standard case.

2012-08-24  Petr MalÃ¡t  <oss@malat.biz>  (tiny change)

	* telnetd/utility.c (terminaltypeok): Use 2kb buffer, as suggested
	by GNU termcap manual.

2012-08-24  Petr MalÃ¡t  <oss@malat.biz>  (tiny change)

	* telnetd/utility.c (io_drain): New variable rfds.
	(io_drain): Use select to wait for data to be available.

2012-08-22  Petr MalÃ¡t  <oss@malat.biz>  (tiny change)

	* telnet/telnet.c (options, do_dont_resp, will_wont_resp):
	Initialize variables.
	(init_telnet): Remove partial initialization from here.

2012-08-22  Simon Josefsson  <simon@josefsson.org>

	* bootstrap: Updated from gnulib.

2012-08-20  Mats Erik Andersson  <gnu@gisladisker.se>

	Server realm pairing: Let server name determine
	realm to be contacted, as per library configuration.

	* libinetutils/shishi.c (shishi_auth): Whenever realm
	is not explicit, call shishi_realm_for_server() to get
	a usable realm; pass on to shishi_realm_default_set().
	* libtelnet/shishi.c (krb5shishi_send): Likewise.

2012-08-17  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet: Selectable principal name.

	* libtelnet/shishi.c (krb5shishi_send): Add a prefix
	`host/' to RemoteHostName only if a prefix is missing.
	* telnet/commands.c (tn) [AUTHENTICATION || ENCRYPTION]:
	Strip off any prefix from HOSTP before resolving address.
	[IPV6]: Improve error message at failed resolution.

2012-08-16  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Configurable principal name.

	* libtelnet/misc.c (ServerPrincipal): New variable.
	(auth_encrypt_init): Add `char *principal' to signature.
	Assign value to ServerPrincipal.
	* libtelnet/misc.h (ServerPrincipal): New external variable.
	* libtelnet/misc-proto.h (auth_encrypt_init): Updated.
	* libtelnet/shishi.c: Prune newlines in error messages.
	(krb5shishi_is_auth): New variable REALM.  Delay shishi_ap()
	and shishi_ap_req_der_set() until after complete setup.
	Extract server name and realm from ServerPrincipal and
	override defaults accordingly.  Use variant calls to access
	realm also, shishi_hostkeys_for_serverrealm() and
	shishi_hostkeys_for_localservicerealm().

	* telnet/telnet.c (telnet): Call auth_encrypt_init()
	with `principal = NULL'.
	* telnetd/telnetd.c (principal) [AUTHENTICATION || ENCRYPTION]:
	New variable.
	(argp_options) [AUTHENTICATION || ENCRYPTION]: New option
	`-S/--server-principal'.
	(parse_opt) [AUTHENTICATION || ENCRYPTION] <'S'>: New case.
	(telnetd_setup) [AUTHENTICATION || ENCRYPTION]: Pass
	`principal' in call to auth_encrypt_init().

2012-08-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rcp.c (main) [KERBEROS || SHISHI]: Add `!use_kerberos'
	when checking for effective root UID.
	* src/rlogin.c (main): Likewise.
	* src/rsh.c (main): Likewise.

2012-08-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp, rlogin, rsh: Host names with instances.

	* libinetutils/kcmd.c (kcmd) [SHISHI]: New variable HOST.
	Whenever `*ahost' contains a slash, separate the true host
	name into HOST.  Use HOST in resolver, and reconstruct
	Kerberos principal as `*ahost' afterwards.
	* libinetutils/shishi.c (shishi_auth): New variable P.
	Check `sname' for a slash in principal name, and construct
	TMPSERVER with prefix "host/" if needed.
	* src/rcp.c (kerberos) <no Kerberos service>: New variable P.
	Strip prefix like `host/' from HOST.
	* src/rlogin.c (main): Likewise.
	* src/rsh.c (main): Likewise.

	rlogind, rshd: Qualified Kerberos server names.

	* libinetutils/shishi.c (get_auth): New variables SERVER
	and REALM.  Decompose `srvname' using shishi_parse_name().
	Construct SERVERNAME with prefix "host/" if needed.  Use
	shishi_realm_default_set() to set realm if present.
	* src/rlogind.c (options) [KERBEROS || SHISHI]: Rename
	long option name `--servername' as `--server-principal'.
	* src/rshd.c (options) [KERBEROS || SHISHI]: Likewise.

	* src/rlogin.c (main) <try_connect> [KERBEROS]: Declare HP
	and use gethostbyname() only for KERBEROS.
	* src/rsh.c (main) [KERBEROS]: Likewise.

	rcp, rlogin, rsh: Aborting Kerberized services.

	* src/rcp.c (kerberos) [KERBEROS || SHISHI]: Fail with error
	if Kerberos authentication fails.  Degrade to plain service
	only on ECONNREFUSED.  Resolve service `shell/tcp' only in
	this latter case.
	* src/rlogin.c (main) [KERBEROS || SHISHI]: Likewise.
	* src/rsh.c (main) [KERBEROS || SHISHI]: Likewise.

	Error message handling.

	* libinetutils/krcmd.c (krcmd_mutual) [SHISHI]: Report
	errors using shishi_strerror().
	* libinetutils/shishi.c (shishi_auth) <failed verification>:
	Write a null character at the end of the received error
	message, not at buffer end.
	* src/rshd.c (doit) [SHISHI] <authentication failure>:
	Check `err_msg && *err_msg' before use in rshd_error().

	Conditionals for extra features.

	* src/rcp.c (family) [WITH_ORCMD_AF || WITH_RCMD_AF || SHISHI]:
	Add SHISHI to conditional.
	(options, parse_opt) [WITH_ORCMD_AF || WITH_RCMD_AF || SHISHI]:
	Add SHISHI as provider of `--ipv4' and `--ipv6'.
	* src/rlogin.c: Likewise.
	* src/rsh.c: Likewise.
	(options) [(KERBEROS || SHISHI) && ENCRYPTION]: Condition
	`-x/--encrypt' on ENCRYPTION.

2012-08-09  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/tftp.sh: Use evaluation `${VERBOSE:+-v}'
	to handle empty string uniformly.

2012-08-09  Mats Erik Andersson  <gnu@gisladisker.se>

	Make building successful on FreeBSD 9.0.

	* paths (PATH_UTMP): Add `/var/run/utx.active'.
	(PATH_WTMP): Add `/var/log/utx.log'.
	* src/Makefile.am (AM_CPPFLAGS): Add $(PATHDEF_UTMPX).
	* talkd/Makefile.am (AM_CPPFLAGS): Add $(PATHDEF_UTMP)
	and $(PATHDEF_UTMPX).

2012-08-08  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet: Support k5login authorization.

	* libtelnet/misc.c (UserNameRequested): Assign
	NULL, not naught.
	* libtelnet/auth.c (authenticated): Likewise.
	(authenticators) [SHISHI]: Remove two references
	to krb5shishi_cleanup.
	* libtelnet/shishi.c (krb5shishi_send): Check for
	non-empty UserNameRequested as the very first action.
	Add UserNameRequested to `HINT.client'.
	(krb5shishi_reply): Call shishi_done(), and assign NULL
	to `shishi_handle'.
	(krb5shishi_status): Remove variables CNAME, CNAMELEN.
	Replace call to shishi_encticketpart_client() with a call
	to shishi_authorized_p().
	(krb5shishi_is_auth): Check version of libshishi and call
	shishi_cfg_authorizationtype_set() "k5login basic".
	Replace a call to shishi_encticketpart_crealm() with a
	call to shishi_encticketpart_clientrealm().
	(krb5shishi_is): Remove debug print using puts().
	(krb5shishi_printsub): Likewise.

	rlogind, rshd: Support k5login authorization.

	* libinetutils/shishi.c (get_auth): Check version
	of libshishi and call shishi_cfg_authorizationtype_set()
	with "k5login basic".

2012-08-03  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind, rshd: Protocol exchange adherence.
	The implementations in both, with and without
	Kerberization, did not follow identical protocols.

	* libinetutils/kcmd.c (kcmd) [SHISHI]: Write remote user name
	first, then the local user name, falling back to remote name.
	* src/rlogind.c (do_shishi_login) [SHISHI]: Read local user
	name first, then remote name.
	* src/rshd.c (doit): Read `locuser' immediately before `command'.
	[!KERBEROS && !SHISHI]: Read `remuser' first.
	[KERBEROS || SHISHI]: Read `remuser' last.
	[SHISHI]: Insert `Kerberized' into syslog message only for active
	Kerberized connection.

	* src/rsh.c (options) [WITH_ORCMD_AF || WITH_RCMD_AF || SHISHI]:
	Add SHISHI as provider of `--ipv4' and `--ipv6'.

	* doc/inetutils.text: Updated.

2012-08-03  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac: Check whether `struct sockaddr_in6'
	contains sin6_len.  Correctly check for ut_addr_v6
	inside `struct utmpx'.
	* libinetutils/kcmd.c (kcmd) [SHISHI]: Condition on
	HAVE_STRUCT_SOCKADDR_STORAGE_SS_LEN for access to ss_len.
	(getport): Likewise.
	* ping/libping.c (ping_set_dest): Access sin_len
	conditioned on HAVE_STRUCT_SOCKADDR_IN_SIN_LEN.
	* src/rexec.c (do_rexec): Build INET6 structure
	guided by HAVE_STRUCT_SOCKADDR_IN6_SIN6_LEN.
	* src/tftp.c (resolve_name): Access ss_len based on
	HAVE_STRUCT_SOCKADDR_STORAGE_SS_LEN.
	* src/tftpd.c (main): Likewise.

2012-08-01  Mats Erik Andersson  <gnu@gisladisker.se>

	Better adaptions to different UTMP implementations.
	FreeBSD 9.0 has left most traditions behind.

	* configure.ac: Check for login, loginx, logoutx, logwtmp,
	and logwtmpx conditioned on libutil.  Ensure `LIBUTIL=-lutil'
	in cases where `$ac_cv_func_login_tty = yes' or
	`$ac_cv_have_decl_openpty = yes'.  Check for more fields in
	`struct utmp': ut_line, ut_session, ut_time, ut_addr_v6,
	and ut_name.  Check for `struct lastlogx' and field ll_ss.
	Add checks of `struct utmpx' for fields ut_user, ut_name,
	ut_id, ut_line, ut_pid, ut_type, ut_exit, ut_tv, ut_session,
	ut_syslen, ut_host, ut_ss, ut_addr_v6.  Check for pututline
	and pututxline.
	(UTMPX): Removed macro.

	* libinetutils/libinetutils.h (utmp_init): Update.
	* libinetutils/cleansess.c [HAVE_LOGOUT && HAVE_LOGWTMP]:
	Make the source build conditionally.
	* libinetutils/logwtmp.c: Prefer utmpx code if available.
	Conditionally use fields in `struct utmpx' or `struct utmp'.
	* libinetutils/logwtmpko.c (logwtmp)
	[HAVE_UPDWTMPX && !HAVE_LOGWTMP]: New condition on build,
	and migration to `struct utmpx'.
	* libinetutils/utmp_init.c: Add parameter `char *host'.
	Guard structure fields with conditionals.  Distinguish
	access methods on HAVE_PUTUTXLINE, HAVE_LOGINX, and
	HAVE_UPDWTMPX, HAVE_LOGWTMPX.  Similarly, test
	HAVE_PUTUTLINE, HAVE_LOGIN, HAVE_UPDWTMP, and HAVE_LOGWTMP.
	New calls to setutxent() or setutent().
	* libinetutils/utmp_logout.c: Essentially likewise.  Erase the
	fields ut_exit, ut_user, ut_name, and ut_host.
	[HAVE_LOGOUTX]: Protect call to logoutx()/logwtmpx().
	[HAVE_LOGOUT]: Likewise for logout()/logwtmp().

	* libls/print.c: Do not include <utmp.h>.

	* src/rlogind.c: Remove conditional on UTMPX and local
	prototypes for utmp_ptsid() and utmp_init().  Always use
	setup_utmp()
	(setup_utmp): New argument `host'.
	[!HAVE_LOGOUT && !HAVE_LOGWTMP]: Call utmp_logout().

	* src/uucpd.c [HAVE_UTMPX_H]: Include <utmpx.h>.
	(dologout) [HAVE_LOGWTMPX]: Call logwtmpx().
	[HAVE_LOGWTMP && !HAVE_LOGWTMP]: Call logwtmp().
	[HAVE_PUTUTXLINE && !HAVE_LOGWTMPX && !HAVE_LOGWTMP]:
	Manual setup for recent FreeBSD.
	(dologin): Likewise.

	* telnetd/pty.c: Always use setup_utmp().
	(setup_utmp): New argument `host'.

	FreeBSD 9.0 uses new paths.

	* paths (PATH_UTMPX): Add `/var/run/utx.active'.
	(PATH_WTMPX): Add `/var/run/utx.log'.
	(PATH_LASTLOG): Add `/var/run/utx.lastlogin'.

2012-07-29  Mats Erik Andersson  <gnu@gisladisker.se>

	Out-of-tree build with libshishi.

	* telnet/Makefile.am (INCLUDES): Add `-I$(top_srcdir)'.

	Obsolete source file.

	* libtelnet/Makefile.am (libtelnet_a_SOURCES): Remove
	reference to `getent.c'.

2012-07-27  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin, rshd: Protocol coherence.

	* configure.ac: Check for `getpwuid_r'.
	* libinetutils/kcmd.c (kcmd) [SHISHI]: Transmit `locuser' if
	defined at all.  Set `errno' to ENOENT at protocol failure.
	* libinetutils/krcmd.c [SHISHI && HAVE_GETPWUID_R]: Include
	<stdlib.h>, <unistd.h>, and <pwd.h>.  New static variables
	`pwbuflen', `pwbuf', `pwstor', and `pwd'.
	(krcmd) [SHISHI && HAVE_GETPWUID_R]: Determine local user
	using getpwuid_r() and pass this on to kcmd().
	(krcmd_mutual) [SHISHI && HAVE_GETPWUID_R]: Likewise.

	* src/rlogin.c (main) <label try_connect>: New variable
	KRB_ERRNO, used to track error causes reliably.
	* src/rlogind.c: Include <stdarg.h>.
	(rlogind_error): New function, reusing code from fatal().
	(fatal): Altered as trivial wrapper around rlogind_error().
	(do_krb_login): Check `*err_msg' in detecting messages.
	(do_shishi_login): Read `ad->rusername' and `ad->lusername'
	in the order mandated by exchange protocol, observing their
	meaning from server's view.  Check `error' in verifying
	successful exchange.  Provide error messages in case of
	failure.  Delay syslog message for success until applicable,
	and provide more detail in both syslog messages.
	* src/rshd.c (doit) [SHISHI]: Read `remuser' and `locuser'
	in the order relevant from server side perspective.  Check
	`error' in verifying successful exchange.  Pass error
	messages and better syslog messages in response to exchange
	and authentication.

2012-07-24  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp: Non-encrypting libshishi support.

	* src/rcp.c [SHISHI]: Include <shishi.h>, `shishi_def.h'.
	[ENCRYPTION]: Replace obsolete conditionals on CRYPT.
	(dest_realm, use_kerberos, doencrypt) [KERBEROS || SHISHI]:
	Always declare variables.
	(h, enckey, iv1, iv2, iv3, iv4, ivtab, keytype, keylen)
	(rc, wlen) [SHISHI]: New variables.
	(options, parse_opt) [KERBEROS || SHISHI]: Make `-K', '-k'
	and `-x' available with libshishi.
	(main) [KERBEROS || SHISHI]: If `doencrypt && !use_kerberos'
	then exit with failure.
	(toremot): Invalidate descriptor `rem'.
	[SHISHI]: Call shishi_done() at completion.
	(tolocal) [SHISHI]: Likewise.
	(kerberos) [KERBEROS || SHISHI]: New variable KRB_ERRNO,
	used to capture error conditions better.  New code for
	libshishi support.
	(oldw) [KERBEROS || SHISHI]: Extend to libshishi.

	* libinetutils/shishi.c (shishi_auth) <missing ticket>:
	Add realm to error message, call shishi_realm_default().

	* src/rsh.c (talk) [KERBEROS && ENCRYPTION]: Replace
	obsolete macro CRYPT.  Replace non-existent variable
	`doenencryption' by `doencrypt'.

2012-07-23  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp, rlogin, rlogind: IP_TOS mending.

	* src/rcp.c (toremote, tolocal)
	[IP_TOS && IPPROTO_IP && IPTOS_THROUGHPUT]: New variables
	SS and SSLEN.  Call getpeername() to determine domain and
	call setsockopt(IP_TOS) only for family AF_INET.
	* src/rlogin.c (main): Likewise.
	* src/rlogind.c (rlogind_mainloop)
	[IP_TOS && IPPROTO_IP && IPTOS_THROUGHPUT]: Set socket
	option IP_TOS only for family AF_INET.

2012-07-22  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin, rsh: Find official host name.

	* libinetutils/kcmd.c (kcmd) [HAVE_DECL_GETADDRINFO]:
	New variable FQDN.  Establish official host name by
	calling getnameinfo() on requested host.

2012-07-22  Mats Erik Andersson  <gnu@gisladisker.se>

	rsh, rlogin: Working IPv6 with libshishi.

	* libinetutils/kcmd.c (kcmd) [SHISHI]: Add a
	parameter `int af' to signature.  Apply as
	`hints.ai_family = af'.
	* libinetutils/krcmd.c (kcmd) [SHISHI]: Update.
	(krcmd) [SHISHI]: Add parameter `int af'.  Pass
	this to kcmd().
	(krcmd_mutual) [SHISHI]: Likewise.
	* libinetutils/shishi_def.h (krcmd, krcmd_mutual):
	Update signatures.
	* src/rlogin.c (main) [SHISHI] <try_connect>:
	Add parameter `family' to krcmd() and krcmd_mutual().
	* src/rsh.c (main) [SHISHI] <try_connect>: Likewise.

2012-07-21  Mats Erik Andersson  <gnu@gisladisker.se>

	r-commands: Partial IPv6 support.
	Adapt host resolution to cope with IPv6,
	in particular for libshishi related code.

	* libinetutils/kcmd.c (getport): New signature
	`(int *, int)', adding address family parameter.
	Update code to use `struct sockaddr_storage'.
	New variable LEN.
	(kcmd): New alternate code using getaddrinfo(),
	instead of gethostbyname().
	[HAVE_DECL_GETADDRINFO]: New variables HINTS, AI, RES.

	* libinetutils/shishi_def.h <struct auth_data>: Changed
	type of FROM to `struct sockaddr_storage'.
	* src/rlogind.c <struct auth_data> [!SHISHI]: Likewise.
	(rlogind_auth): New variables ADDRP, PORT.  Adapt to new
	type of `auth_data.from'.
	[!KERBEROS]: Accept families AF_INET and AF_INET6.
	(rlogind_mainloop): Adapt to new `auth_data.from'.
	(do_rlogin): Likewise.
	[WITH_IRUSEROK_AF || WITH_IRUSEROK]: New variable ADDRP.
	(do_shishi_login): New type `struct sockaddr_storage'
	for SOCK.

2012-07-18  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin: Close libshishi handle.
	The normal logout action should lead to an
	orderly close down of the active libshishi
	handle, otherwise the tickets get lost.

	* src/rlogin.c (doit) <reader returning> [SHISHI]:
	Call shishi_done() in authenticating mode, possibly
	also shishi_key_done() and shishi_crypto_close().

2012-07-18  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogin: Non-authenticating with libshishi.
	Verified functionality with `-K' switch.

	* src/rlogin.c (OPTIONS): Remove unused macro.
	(main): Call doit() with reference to SMASK,
	not OSMASK.
	(reader) [SHISHI]: Check OOB data only in
	Kerberos mode, i.e., for set `use_kerberos'.

	rlogind: Authenticating mode with libshishi.
	Avoid segmentation faults.

	* src/rlogind.c (so_krb_login): Properly set
	an empty error message by `*err_msg = NULL'.
	(do_shishi_login): Do not free CKSUM before use,
	but do so afterwards.

2012-07-14  Mats Erik Andersson  <gnu@gisladisker.se>

	telnetd: Activate authentication modes.
	Send TELOPT_AUTHENTICATION based on the
	authentication level chosen for the server.

	* telnetd/utility.c (getterminaltype)
	[AUTHENTICATION]: Choose between send_wont(),
	send_do() and send_will() with TELOPT_AUTHENTICATION
	depending on `auth_level'.

2012-07-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* telnetd/telnetd.c (auth_level) [AUTHENTICATION]:
	Use only in kerberized server builds.
	(arpg_options, parse_opt) [AUTHENTICATION]
	<-a/--authmode>: Likewise.
	(parse_mode) [AUTHENTICATION]: Likewise.

	* telnetd/utility.c (io_drain) <EAGAIN in read()>:
	Silence useless logging message `ttloop: retrying'.

2012-07-13  Mats Erik Andersson  <gnu@gisladisker.se>

	telnet, telnetd: Set service name for libshishi
	in server and allow client to specify realm.

	* libtelnet/shishi.c (dest_realm): New variable.
	(krb5shishi_send): Call shishi_realm_default_set()
	whenever `dest_realm' is set.
	(krb5shishi_is_auth): New variable SERVER.  Construct
	a service name from `LocalHostName' and use it in a
	call to shishi_hostkeys_for_server().
	* telnet/main.c (dest_realm) [KRB4 || SHISHI]:
	New external variable.
	(argp_options) [AUTHENTICATION && (KRB4 || SHISHI)]:
	Activate the option `-k/--realm' also whith SHISHI.
	(parse_opt) [AUTHENTICATION && (KRB4 || SHISHI)]:
	Likewise.

2012-07-11  Mats Erik Andersson  <gnu@gisladisker.se>

	Allow builds on OpenSolaris with libshishi.

	* telnet/main.c: Include <arpa/telnet.h>.

2012-07-10  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Resolve conflicts `int' versus `size_t'.
	Inappropriate use of `int' leads to failure
	of authentication on 64-bit architectures.

	* libinetutils/shishi.c (shishi_auth): Let OUTLEN
	be `size_t'. Read and write lengths using MSGLEN.
	(get_auth): New argument type `size_t *cksumlen'.
	Let OUTLEN be `size_t'.  New variable LEN.
	(readenc, writeenc): New type `size_t outlen'.
	* libinetutils/shishi_def.h (shishi_auth):
	Modified signature.
	* src/rlogind.c (do_shishi_login): Use `size_t'
	for CKSUMLEN and `socklen_t' for SOCKLEN.
	* src/rshd.c (doit) [SHISHI]: Likewise.

2012-07-07  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rshd.c (doit) <PAM_NEW_AUTHTOK_REQD>:
	When either pam_authenticate() or pam_acct_mgmt()
	require token renewal, then call pam_chauthtok()
	and repeat the previous call.
	(rsh_conv) <PAM_PROMPT_ECHO_OFF>: Build a full
	pam_response structure using an emtpy password,
	instead of returning an empty pointer.  Make a
	syslog notice showing the passed message string.

2012-07-05  Mats Erik Andersson  <gnu@gisladisker.se>

	rsh, rshd: Functional Shishi code.  Tested on
	32-bit system, with and without encryption,
	but without PAM.

	* src/rlogind.c (servername): New variable.
	(options): New option `-S/--servername'.
	(parse_opt) <'S'>: Implement `-S'.
	(do_shishi_login): Add `servername' as additional
	argument to get_auth().
	* src/rsh.c (servername): New variable.
	(options): New option `-S/--servername'.  Rephrase
	explanation for `-v/--vacuous'.
	(parse_opt) <'S'>: Implement `-S'.
	(doit): Add `servername' as additional argument to
	get_auth().  Apply ntohs() to PORT in calculating
	CKSUMDATA.  Do not free CKSUM before use!
	(doit) [WITH_IRUSEROK_AF && !WITH_PAM]: Calculate
	FROMADDRP separately, not within nested conditionals.

	* libinetutils/kcmd.c (kcmd) [SHISHI]: Let arguments
	`laddr' and `faddr' be `struct sockaddr_storage *'.
	New variables LEN and PORT, use `struct sockaddr_storage'
	for SIN and FROM.  Modify resolver code to handle AF_INET
	and AF_INET6.
	* libinetutils/krcmd.c (krcmd) [SHISHI]: Produce error
	message using shishi_strerror() at failures.
	(krcmd_mutual) [SHISHI]: Use `struct sockaddr_storage'
	for LADDR and FADDR.
	* libinetutils/shishi.c (shishi_auth, get_auth): Return
	meaningful error status, not `1' every time.
	(shishi_auth) <ticket fetch failure>: Report Kerberos
	principal name, not only host name of server.
	(shishi_auth) <authentication response reading>: Store
	int32 sized answer in an integer, not in a char!  Report
	a failure in case authentication actually failed.
	(get_auth): Add a further parameter `char *srvname'.
	Call shishi_server_for_local_service() only if `srvname'
	was NULL.  Otherwise, manually assemble the host's
	principal name.
	(get_auth) <authentication type failure>: Follow protocol
	and send a response 0x01.
	(get_auth) <protocol version failure>: Follow protocol
	and send a response 0x02.
	* libinetutils/shishi_def.h (get_auth): Update signature.

2012-07-03  Mats Erik Andersson  <gnu@gisladisker.se>

	* libinetutils/kcmd.c (kcmd, getport)
	[HAVE_STRUCT_SOCKADDR_IN_SIN_LEN]: Initiate `sin.sin_len'.
	(kcmd): Calculate address strings using inet_ntop().
	Use correct address location in message `Trying ...'.
	* src/rsh.c (main) [KERBEROS || SHISHI]: New variable
	KRB_ERRNO used for proper error diagnostics.  Assign a
	value after each authentication call.
	(warning): Remove erroneous call to va_arg().

2012-07-02  Mats Erik Andersson  <gnu@gisladisker.se>

	* libinetutils/shishi_def.c (shishi_auth): New type
	`unsigned short port' of seventh parameter.
	* libinetutils/shishi.c (shishi_auth): Likewise.
	Call shishi_init() before shishi_realm_default_set().
	* src/rlogin.c (parse_opt) <'k'>: Copy value from `arg'.
	* src/rsh.c (options): The option `-k/--realm' takes
	a value REALM, which was missing.

2012-07-01  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Fix non-kerberized Shishi code.

	* src/rshd.c (options) [KERBEROS || SHISHI]: Add missing
	SHISHI to conditional activation of `-k/--kerberos' and
	`-v/--vacuous'.
	(doit) [KERBEROS] <check address family>: Remove SHISHI
	in conditional, thus preventing libshishi based server
	from issuing failure for non AF_INET connections.
	(doit) [SHISHI && use_kerberos] <authentication>:
	Insert missing `if (use_kerberos)' before code block
	for conducting Shishi authentication; adjust indentation
	of this complete block!
	(doit) [SHISHI] <checksum test>: Conditionally activate
	getsockname() for reporting receiving port.

2012-06-25  Mats Erik Andersson  <gnu@gisladisker.se>

	rlogind: Prepare for address independence.
	Update some coding techniques to simplify later
	IPv6 migration.

	* libinetutils/shishi_def.h (struct auth_data):
	New members `socklen_t fromlen', `char *hostaddr'.
	* src/rlogind.c (struct auth_data): Likewise.
	(rlogin_daemon) [HAVE_STRUCT_SOCKADDR_IN_SIN_LEN]:
	Assign missing value for `saddr.sin_len'.
	(rlogind_auth): Use `ap->hostaddr' as address string.
	[HAVE_DECL_GETNAMEINFO || HAVE_DECL_GETADDRINFO]:
	New variables RC and HOSTSTR; delete HP in this case.
	[HAVE_DECL_GETNAMEINFO]: Alternate code for finding
	host name.
	[HAVE_DECL_GETADDRINFO && HAVE_DECL_GETNAMEINFO]:
	Alternate code for host name validation.
	(rlogind_mainloop): Deleted variable SIZE.  New
	variables ADDRSTR and REPLY.  Put socket address
	size in `auth_data.fromlen'.  Determine host address
	`auth_data.hostaddr' by calling inet_ntop() once.
	[WITH_IRUSEROK_SA || WITH_IRUSEROK_AF || WITH_IRUSEROK]:
	Choose the best available iruserok variant.
	[WITH_RUSEROK_AF || WITH_RUSEROK]: Choose best variant.
	(do_shishi_login): Compute SOCKLEN as `sizeof (sock)'.

2012-06-25  Mats Erik Andersson  <gnu@gisladisker.se>

	rcp, rlogin, rsh, rshd: IPv6 ability.

	* src/rcp.c (family) [WITH_ORCMD_AF || WITH_RCMD_AF]:
	New variable.
	(options) [WITH_ORCMD_AF || WITH_RCMD_AF]: New options
	`4/ipv4' and `6/ipv6'.
	(parse_opt) [WITH_ORCMD_AF || WITH_RCMD_AF] <4, 6>:
	Assign value AF_INET or AF_INET6 to `family'.
	(toremote, kerberos) [WITH_ORCMD_AF || WITH_RCMD_AF]:
	Replace AF_INET by `family' in orcmf_af() and rcmd_af().
	(tolocal) [WITH_ORCMD_AF || WITH_RCMD_AF]: Likewise.
	[!KERBEROS && WITH_ORCMD_AF]: Correction to conditional.
	Call one of the rcmd() variants only if the macro KERBEROS
	is not defined.

	* src/rlogin.c (family) [WITH_ORCMD_AF || WITH_RCMD_AF]:
	New variable.
	(argp_options) [WITH_ORCMD_AF || WITH_RCMD_AF]: New
	options `4/ipv4' and `6/ipv6'.
	(parse_opt) [WITH_ORCMD_AF || WITH_RCMD_AF] <4, 6>:
	Assign value AF_INET or AF_INET6 to `family'.
	(main) [WITH_ORCMD_AF]: Call orcmd_af().
	[WITH_RCMD_AF && !WITH_ORCMD_AF]: Call rcmd_af().
	[WITH_ORCMD && !WITH_ORCMD_AF && !WITH_RCMD_AF]:
	Call orcmd().

	* src/rsh.c (family) [WITH_ORCMD_AF || WITH_RCMD_AF]:
	New variable.
	(options) [WITH_ORCMD_AF || WITH_RCMD_AF]: New options
	`4/ipv4' and `6/ipv6'.
	(parse_opt) [WITH_ORCMD_AF || WITH_RCMD_AF] <4, 6>:
	Assign value AF_INET or AF_INET6 to `family'.
	(main) [WITH_ORCMD_AF]: Use `family' in last argument
	to orcmd_af().
	[WITH_RCMD_AF]: Likewise for rcmd_af().

	* src/rshd.c (main): New type `struct sockaddr_storage from'.
	Cast &FROM as `struct sockaddr *' when calling doit().
	(doit): New signature `(int, struct sockaddr *, socklen_t)'.
	Adapt code to new parameter type `struct sockaddr * fromp',
	using casts whenever needed.  Check `fromp->sa_family'.
	[WITH_IRUSEROK_AF && !WITH_PAM]: New variable FROMADDRP.
	[KERBEROS || SHISHI]: Check for IPv4 only in this case.
	<hostname validation> [HAVE_DECL_GETNAMEINFO]: Use the
	flag NI_NAMEREQD.

2012-06-19  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: PAM session handling.

	* src/rshd.c: Include <sys/wait.h>.
	(doit) <port != 0 && parent> [WITH_PAM]: Call
	pam_close_session(), pam_setcred(), and pam_end().
	(doit) <without port> [WITH_PAM]: Call fork().  Parent
	waits for child and properly closes PAM session.
	(doit) <child> [WITH_PAM]: Call pam_open_session().

2012-06-18  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (WITH_ORCMD_AF, WITH_ORCMD, WITH_RCMD_AF)
	(WITH_RRESVPORT_AF, WITH_IRUSEROK_AF, WITH_IRUSEROK_SA)
	(WITH_RUSEROK_AF): New macros.
	* src/rcp.c (toremote, tolocal, kerberos)
	[WITH_ORCMD_AF || WITH_RCMD_AF || WITH_ORCMD]:
	Replace rcmd() by orcmd_af(), rcmd_af(), or orcmd().
	* src/rsh.c (main)
	[WITH_ORCMD_AF || WITH_RCMD_AF || WITH_ORCMD]: Likewise.
	* src/rshd.c (doit) [WITH_RRESVPORT_AF]: Use rresvport_af()
	instead of rresvport().
	[WITH_IRUSEROK_SA || WITH_IRUSEROK_AF]: Replace iruserok()
	with iruserok_sa() or iruserok_af().
	[WITH_RUSEROK_AF]: Use ruserok_af(), not ruserok().

2012-06-18  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rshd.c (doit): New signature
	`(int, struct sockaddr_in *, socklen_t)'.
	(main): Pass FROMLEN to doit().
	(doit): New variables INPORT, RC, PORTSTR, ADDRSTR.
	(doit) [HAVE_DECL_GETNAMEINFO]: New variable ADDRNAME.
	(doit): Put numeric info in ADDRSTR, INPORT, PORTSTR
	early on, later replacing multiple inet_ntoa().  Do not
	overwrite `fromp->sin_port', but use INPORT, PORTSTR.
	Prefer using getnameinfo().
	(doit) <address verification> [HAVE_DECL_GETNAMEINFO]:
	New alternate code.

2012-06-15  Mats Erik Andersson  <gnu@gisladisker.se>

	rshd: Duplicate static memory results.  Consistently
	needed on systems running DragonFlyBSD.

	* src/rshd.c (doit): When assigning HOSTNAME, apply
	strdup() to results of inet_ntoa() and `hp->h_name'
	in order to avoid loss of its contents later on.

	rshd: Implement PAM support.

	* src/Makefile.am (rshd_LDADD): Add also $(LIBPAM).
	* src/rshd.c [HAVE_SECURITY_PAM_APPL_H]: Include
	<security/pam_appl.h>.
	(pam_rc, pam_handle, pam_conv) [WITH_PAM]: New variables.
	(rsh_conv) [WITH_PAM]: New function.
	(iruserok) [!WITH_PAM && __GLIBC__ && WITH_IRUSEROK]:
	Set prototype only in absence of WITH_PAM.
	(doc) [WITH_PAM]: Expand string content.
	(username, logname, homedir, shell, path): Increase lengths,
	including a preamble like `SHELL='.
	(rhost): New variable used for environment variable RHOST.
	(envinit) [!WITH_PAM]: Use only in absence of PAM support.
	(doit) [WITH_PAM]: New code.
	[!WITH_PAM && WITH_IRUSEROK]: Call iruserok() only in
	absence of PAM.
	[!WITH_PAM && !WITH_IRUSEROK && WITH_RUSEROK]: Likewise
	for ruserok().
	(doit) <fail label> [WITH_PAM]: Report errors via syslog.
	(doit): Replace numerical offset by key string size when
	setting `homedir', `path', `shell', and `username'.
	Really assign a value to `logname', for portability.
	(doit) <failed execl>: Report to syslog.

2012-06-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rshd.c (doit) [HAVE_GETPWNAM_R]: New variables
	PWBUF, PWBUFLEN, PWSTOR, and RET.  Call getpwnam_r(),
	checking both `ret' and `pwd == NULL' for failure.

2012-06-15  Simon Josefsson  <simon@josefsson.org>

	* bootstrap: Updated from gnulib.

2012-06-11  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd, rlogind: Distinguish logging facility.
	Use LOG_AUTH only for authentication messages.

	* src/rexecd.c (doit): Add LOG_AUTH to syslog() in user
	contexts.  Otherwise use default LOG_DAEMON in openlog().
	* src/rlogind.c (main, do_rlogin, do_krb4_login)
	(do_krb5_login, do_shishi_login): Likewise.

2012-06-09  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Long address transfer request.

	* ftpd/ftpcmd.y (LPRT): New token.
	(long_host_port): New value returning type.
	* doc/inetutils.texi (ftpd invocation): Updated.

2012-06-07  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd: Audit of PAM code.

	* src/rexecd.c (doc) [WITH_PAM]: Expand string.
	(doit): Remove variable TOKEN.  Add flag PAM_SILENT
	in call to pam_setcred().  Really update USER when
	calling pam_get_item(PAM_USER).  When execl() fails,
	close properly by calling pam_end().

2012-06-07  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Audit of existing PAM code.

	* ftpd/extern.h (pam_end_login) [WITH_LINUX_PAM]:
	New prototype.
	* ftpd/ftpd.c (end_login) [WITH_LINUX_PAM]: Call
	pam_end_login() to tear down current client.
	* ftpd/pam.c: Include <syslog.h>.
	(pam_doit): Add missing call to pam_open_session().
	(pam_end_login): New function.

2012-06-06  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Restrict to Linux-PAM, which is only valid code.

	* configure.ac (WITH_PAM): Add check for PAM_CONV_AGAIN.
	(WITH_LINUX_PAM, FTPD_LIBPAM): New variables.
	* ftpd/Makefile.am (LDADD): Replace LIBPAM by FTPD_LIBPAM.
	* ftpd/auth.c (auth_user, auth_pass) [WITH_LINUX_PAM]:
	Replace old WITH_PAM by correct WITH_LINUX_PAM.
	* ftpd/extern.h [WITH_LINUX_PAM]: Likewise.
	* ftpd/ftpd.c [WITH_LINUX_PAM]: Likewise.
	* ftpd/pam.c [WITH_LINUX_PAM]: Likewise.
	(PAM_CONV_AGAIN, PAM_INCOMPLETE): Removed macro definitions.
	(PAM_conversation): Initialise second element to NULL.
	(GET_MEM): Return PAM_BUF_ERR.
	(PAM_conv) [!PAM_CONV_AGAIN]: Set RETVAL to PAM_CONV_ERR.
	(pam_doit) [PAM_CONV_AGAIN]: Test `error == PAM_CONV_AGAIN'.
	[PAM_INCOMPLETE]: Test `error == PAM_INCOMPLETE'.
	(pam_doit): Return PAM_SUCCESS, not 0.
	(pam_user): Initialise `PAM_conversation.appdata_ptr'.

2012-06-02  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Long passive transfer request.

	* ftpd/extern.h (PASSIVE_PASV, PASSIVE_EPSV, PASSIVE_LPSV):
	New macros.
	* ftpd/ftpcmd.y (LPSV): New token.
	(cmd) <PASV>: Call passive() with PASSIVE_PASV.
	<EPSV>: Call passive() with PASSIVE_EPSV; both variants.
	<LPSV>: New subcommand.
	(cmdtab): New entry `LPSV'.
	* ftpd/ftpd.c (passive): Use macros PASSIVE_* to distinguish
	subcases.  Add two subcases for `LPSV', with pointer math
	shared with `PASV'.
	* doc/inetutils.texi: Updated.

2012-05-31  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Adaptive block size in image mode.

	* ftp/ftp.c (sendrequest): New variables BLKSIZE, BUFSIZE.
	Change type of BUF to `static char *' for allocation.
	Set BLKSIZE to `st_blksize' for input file.  Allocate and
	increase size of buffer as needed.
	<TYPE_I>: Use BUFSIZE for buffer length when calling read().
	(recvrequest): Call fstat() on successful stream `fout'
	and set BLKSIZE to `st_blksize'.
	(abort_remote): Replace macro BUFSIZ by `sizeof(buf)'.

2012-05-31  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Use adaptive block sizes in image mode.

	* ftpd/ftpd.c (receive_data): Update signature to
	`(FILE *, FILE *, off_t)'.  Make BUF a pointer to
	allocated memory.
	<TYPE_I> : Allocate BUF of size `blksize'.  Change
	buffer size to this value inside loop calling read().
	(retrieve): Remove `const' from BUFFER_SIZE again.
	If `cmd == 0', use `st_blksize' for setting BUFFER_SIZE.
	(store): Call fstat() on successful stream `fout'.

2012-05-30  Mats Erik Andersson  <gnu@gisladisker.se>

	Incomplete coding of variadic printing.  Each such command
	consumes the pointer, leaving it in an undefined state.
	Some 64-bit systems are sensitive to these mistakes.

	* ftpd/ftpd.c (reply, lreply): Missing va_end(). Give each
	vprintf() and vsyslog() a separate pair va_start()/va_end().
	* src/rcp.c (run_err): Likewise for vfprintf().
	* src/rshd.c (rshd_error): Missing va_end().

2012-05-30  Mats Erik Andersson  <gnu@gisladisker.se>

	ftpd: Allow 64-bit offsets and file sizes.  Restrict
	file size for use of mmap() and only null offset, since
	Solaris and Linux demand page size alignment.  Assign
	a positive malloc size for use in data transmission.

	* ftpd/ftpcmd.y: Include <inttypes.h> or <stdint.h>.
	(token union): Use `intmax_t i' instead of `int i' in order
	to handle 64-bit offsets and sizes.
	(cmd, rcmd, host_port, sizecmd): Use format strings `%jd'
	and `%ju'.  Append `LL' to numerical constants.
	(yylex) <ARGS>: Convert numeric strings using strtoimax().
	* ftpd/ftpd.c (retrieve): Initialise BUFFER_SIZE to `BUFSIZ'
	in all cases.  Essential correction, since malloc() would
	otherwise allocate 0 bytes in binary mode.
	(IU_MMAP_SIZE): New macro.
	(send_data): Initialise BUF to `MAP_FAILED'.  Change LEN
	and FILESIZE to be `off_t'.  Add debug logging about offsets
	and transmission modes `ascii/image/mmap'.
	[HAVE_MMAP]: Attempt mapping only if file size is less than
	IU_MMAP_SIZE and only when `restart_point == 0'.

2012-05-26  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/ftp-localhost.sh (do_transfer, GETME, PUTME):
	New variables.  Environmental TRANSFERTEST sets do_transfer.
	(posttesting): Remove file `$FTPHOME/$PUTME' if $do_transfer
	is true and file exists.
	(test_report): Lessen verbosity by printing exchange data
	only if $VERBOSE is non-empty.
	[do_transfer]: Execute transmission tests.  These execute
	an additional `put' for selected addressing and modes.

2012-05-26  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Reporting and accounting of large files.

	* ftp/extern.h (ptransfer): New signature
	`(char *, long long, struct timeval *, struct timeval *)'.
	* ftp/ftp.c (sendrequest, recvrequest): New type `long long'
	for BYTES and LOCAL_HASHBYTES.
	(ptransfer): New type `long long' for BS.  New format string
	`%lld' for byte counter and byte rate.

2012-05-24  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability to FreeBSD.

	* ftp/cmds.c: Include <stdint.h> for `intmax_t'.
	* ftp/ftp.c: Likewise.

2012-05-24  Mats Erik Andersson  <gnu@gisladisker.se>

	ftp: Large file support.  The implementation
	has been truncating offset values.

	* ftp/cmds.c (restart): Convert `restart_point' using atoll().
	Use a format string `%jd' and cast as `intmax_t'.
	* ftp/ftp.c (sendrequest): Remove cast of `restart_point'
	as `long'. Use format string `%jd' and cast as `intmax_t'.
	(recvrequest): Likewise.  Variables I and N must be `off_t'
	for computations with `restart_point'.

2012-05-21  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd: Adapt to PAM authentication.

	* src/Makefile.am (rexecd_LDADD): Use $(LIBPAM).
	* src/rexecd.c [HAVE_SECURITY_PAM_APPL_H]: Include
	<security/pam_appl.h>.
	(pam_rc, password_pam, pam_flags, pam_handle, pam_conv)
	[WITH_PAM]: New variables.
	(rexec_conv) [WITH_PAM]: New function.
	(remotehost): New variable, used in environment.
	(envinit) [!WITH_PAM]: Add `remotehost' to list.
	(doit) [WITH_PAM]: New variable TOKEN.  Add alternate
	authentication checks.  Set `pam_rc = PAM_ABORT' where
	errors are caught.
	<parent fork>: Set `pam_handle' to NULL, since the child
	process closes all authentication.
	(die) [WITH_PAM]: Call pam_end() if PAM is still active.
	* doc/inetutils.texi (rexecd invocation): Update.

2012-05-20  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd: Use getpwnam_r() if available, thus
	preparing migration to PAM.

	* src/rexecd.c [HAVE_GETPWNAM_R]: Include <xalloc.h>.
	(doit) [HAVE_GETPWNAM_R]: New variables PWBUF, PWBUFLEN,
	and PWSTOR.  Dynamically allocate PWBUF.  Call getpwnam_r()
	with composite check on result.

2012-05-16  Mats Erik Andersson  <gnu@gisladisker.se>

	ping, traceroute: Type-of-Service.

	* doc/inetutils <ping, traceroute invocation>: Update.
	* ping/ping.c (tos): New variable.
	(argp_options): New option `-T/--tos'.
	(parse_opt): New case `T'.
	(main): Set socket option IP_TOS.
	* src/traceroute.c (opt_tos): New variable.
	(argp_options): New option `-t/--tos'.
	(parse_opt): New case `t'.
	(trace_init): New variable FD.  Set socket option IP_TOS.

2012-05-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Build test binaries early.

	* tests/Makefile.am (check_PROGRAMS): Removed variable.
	(bin_PROGRAMS): New variable.
	(TESTS): Use `bin_PROGRAMS' instead of `check_PROGRAMS'.

2012-05-14  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Stop at unreachable destinations.

	* src/traceroute.c (unreach_sign): New variable.
	(do_try): New local variables RC, TYPE, and CODE.  Let negative
	return status from trace_read() be abnormal.  Print additional
	packet failure information for ICMP_DEST_UNREACH.
	(CAPTURE_LEN): New macro.
	(trace_read): Set new signature to `(trace_t *, int *, int *)'.
	Change size of DATA to CAPTURE_LEN.  New variable RC.  Capture
	type and code of incoming ICMP message.
	<TRACE_UDP>: Inspect all ICMP_DEST_UNREACH packets.  Calculate
	port number using length offset in IP header.  Set `stop' for
	all kinds of ICMP_DEST_UNREACH, and set positive return code,
	except for ICMP_PORT_UNREACH.
	<TRACE_ICMP>: Inspect also ICMP_DEST_UNREACH packets.  Check
	their identity only, not seqno.  Set `stop' also for these,
	and have them return positive status.  Calculate OLD_ICMP
	using length offset in IP header.

	* ping/ping_echo.c (ping_echo): Size of RSPACE is MAX_IPOPTLEN.

2012-05-12  Mats Erik Andersson  <gnu@gisladisker.se>

	ping: Support IP option Timestamp.

	* doc/inetutils.texi (ping invocation): Update.
	* ping/ping.c (suboptions): New variable.
	(decode_ip_timestamp): New function.
	(ARG_IPTIMESTAMP): New enumeration value.
	(argp_options): Add long option `ip-timestamp'.
	(parse_opt) <ARG_IPTIMESTAMP>: New case.
	* ping/ping_common.h (OPT_IPTIMESTAMP, SOPT_TSONLY)
	(SOPT_TSADDR, SOPT_TSPRESPEC): New macros.
	* ping/ping_echo.c (ping_echo) [options & OPT_IPTIMESTAMP]:
	New setup case.
	(print_ip_opt): New variable K.
	<IPOPT_TS>: New printout case.
	* ping/ping_impl.h (suboptions) [!USE_IPV6]: New external.

2012-05-11  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Dynamic identity and sequence numbers.

	* src/traceroute.c (seqno): New variable.
	(main): Assign getpid() to `pid'.  Initialise `seqno'.
	(trace_read) <TRACE_UDP>: Replace numerical offset `11'.
	(trace_read) <TRACE_ICMP && ICMP_ECHOREPLY>: Apply ntohs()
	to `ic->icmp_seq' and to `ic->icmp_id'.
	<TRACE_ICMP && ICMP_TIME_EXCEEDED>: Complete code rewrite.
	(trace_write): Activate dynamic `pid' and `seqno' in call to
	icmp_echo_encode().

2012-05-10  Mats Erik Andersson  <gnu@gisladisker.se>

	Refactor address-to-string conversion as common code.

	* ping/ping6.c (options): Remove qualifier `static'.
	(ipaddr2str): Removed function.
	(print_icmp_error): Call ipaddr2str() with new signature.
	* ping/ping_common.c: Include <errno.h>, <netinet/in.h>,
	<arpa/inet.h>, and <netdb.h>.
	(options): New external variable.
	(ipaddr2str, sinaddr2str): New functions.
	* ping/ping_common.h (ipaddr2str, sinaddr2str): New prototypes.
	* ping/ping_echo.c (ipaddr2str): Removed function.
	(print_icmp_header): Call ipaddr2str() with new signature.
	(print_ip_opt): Replace ipaddr2str() with sinaddr2str().

2012-05-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping6.c (argp_options): New option `verbose'.
	(parse_opt) <v>: New case.
	(ping_echo): Print identity in verbose mode.
	* ping/ping_echo.c (ping_echo): Likewise.
	(print_ip_header): Print IP header dump in verbose mode.

2012-05-09  Mats Erik Andersson  <gnu@gisladisker.se>

	ping: Options `--mask' and `--ttl'.

	* ping/ping.c (ttl): New variable.
	(ARG_TTL): New enumeration value.
	(argp_options): Add long option `mask' as synomym to `address'.
	New long option `ttl'.
	(parse_opt) <ARG_TTL>: New case.
	(main): If `ttl > 0', set value for sockopt IP_TTL.
	(*decode_typ): Add check for `mask'.

	ping6: Option `--hoplimit'.

	* ping/ping6.c (hoplimit): New variable.
	(ARG_HOPLIMIT): New enumeration value.
	(argp_options): New long option `hoplimit'.
	(parse_opt) <ARG_HOPLIMIT>: New case.
	(main): If `hoplimit > 0', set value for sockopt IPV6_UNICAST_HOPS.

	* doc/inetutils.texi (ping invocation): Updates, corrections.

2012-05-09  Mats Erik Andersson  <gnu@gisladisker.se>

	Discriminate UTC from non-UTC time stamps.

	* ping/ping_common.c (is_normed_time, ping_cvt_time): New fcns.
	* ping/ping_common.h (is_normed_time, ping_cvt_time): New prototypes.
	* ping/ping_timestamp.c (print_timestamp): New variable TIMESTR.
	Call ping_cvt_time() to generate strings for three time values.
	[options & OPT_VERBOSE]: Print time difference if both of
	`icmp->icmp_otime' and `icmp->icmp_ttime' are UTC-based.

	* ping/ping_common.h (_PING_BUFLEN):  Really replace the
	parameter name `USE_IPV6' by the neutral name `u'.

2012-05-08  Mats Erik Andersson  <gnu@gisladisker.se>

	Critical package errors in size and allocation.

	* ping/ping.c (send_echo): Replace macro PING_HEADER_LEN by
	calculated value OFF, i.e., the number of consumed bytes.
	* ping/ping6.c (send_echo): Likewise.
	(ping_init): Initialise `p->ping_datalen' as the size of
	`struct timeval', a possible payload.
	* ping/ping_common.h (PING_HEADER_LEN): Use correct size as
	`sizeof(struct icmp6_hdr)' and ICMP_MINLEN, respectively.
	(PING_TIMING): Compare with `sizeof(struct timeval)'.
	(_PING_BUFLEN) <IPv4 case>: Add contribution MAXIPLEN, and
	increase ICMP contribution to ICMP_TSLEN, the maximal length.
	* ping/ping_echo.c (ping_echo) [options & OPT_RROUTE && IP_OPTIONS]:
	Remove call (a recent regression) to ping_set_packetsize().

2012-05-08  Mats Erik Andersson  <gnu@gisladisker.se>

	Incomplete endianness conversions.

	* libicmp/icmp_echo.c (icmp_generic_encode): Apply htons() to
	SEQNO and IDENT.
	* ping/libping.c (my_echo_reply, ping_recv): Apply ntohs() to
	`orig_icmp->icmp_id' and `orig->icmp_seq'.
	* ping/ping6.c (print_echo): Likwise for `icmp6->icmp6_seq'.
	* ping/ping_address.c (print_address): Apply ntohs() to
	`icmp->icmp_seq'.
	* ping/ping_echo.c (print_echo): Likewise.
	(print_ip_header): Apply ntohs() to `ip->ip_len', `ip->ip_id',
	`ip->ip_off', and to `ip->ip_sum'.
	* ping/ping_timestamp.c (print_timestamp): Apply ntohs() to
	`icmp->icmp_seq'.

2012-05-08  Mats Erik Andersson  <gnu@gisladisker.se>

	Use symbolic size names in all harmless cases.

	* libicmp/icmp.h (ICMP_TSLEN): Use size of `n_time'.
	* libicmp/icmp_address.c (icmp_address_encode): Use ICMP_MASKLEN.
	* libicmp/icmp_echo.c (icmp_generic_encode): Use ICMP_MINLEN.
	* libicmp/icmp_timestamp.c (icmp_timestamp_encode): Use ICMP_TSLEN.
	* ping/libping.c (_ping_packetsize): Use ICMP_TSLEN.  Add cases
	for ICMP_ADDRESS and ICMP_ADDRESSREPLY.  Use PING_HEADER_LEN in
	default case.
	(ping_set_dest) [HAVE_STRUCT_SOCKADDR_SA_LEN]: Set `s_in->sin_len'.
	* ping/ping_address.c (ping_address): Use ICMP_MASKLEN.
	* ping/ping_common.h (_ping_setbuf, ping_set_data): Use `use_ipv6'
	as parameter, not the macro name USE_IPV6.
	* ping/ping_echo.c (print_echo): Use PING_HEADER_LEN.
	(print_ip_header): Use `sizeof(*ip)' for IP header size.
	Use tabs at end of printed header.
	(print_ip_data): Use IPPROTO_TCP and IPPROTO_UDP.  Add case
	for IPPROTO_ICMP.
	* ping/ping_timestamp.c (ping_timestamp): Use ICMP_TSLEN.

	Determine correct and relevant diagnostic messages.

	* ping/ping_echo.c (struct icmp_code_descr): Add field `int type'.
	(icmp_code_descr): Prepend every member with a type value for
	correct discrimination.
	(print_icmp_code): New signature `(int, int, char *)'.  Test `type'
	as well as `code' when matching.
	(print_icmp): Update call to print_icmp_code().
	(icmp_diag): New members ICMP_ROUTERADV and ICMP_ROUTERDISCOVERY.
	New members ICMP_INFO_REPLY and ICMP_ADDRESS.  Replace incorrect
	ICMP_MASKREPLY with ICMP_ADDRESSREPLY.
	(print_ip_opt) <IPOPT_SSRR>: New case.  Code shared with IPOPT_LSRR.
	<IPOPT_LSRR, IPOPT_RR>: Replace call to ntohl() by correct htonl().

2012-05-07  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability issue for setting timeval manually.

	* ping/ping.c (ping_run): Erase RESP_TIME, INTVL, and NOW
	before first use.
	* ping/ping6.c (ping_run): Likewise.  Do not erase RESP_TIME
	inside loop.

	Regression in calculating response timing.

	* src/traceroute.c (do_try): Use format string ` %2d ' with HOP.
	New variable SAVE_ERRNO.  Call select() before gettimeofday(),
	but save `errno' in SAVE_ERRNO.  Take care of microsecond
	underflow when calculating time difference.
	(trace_read): Replace numerical size by `sizeof (data)'.

2012-04-27  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping_address.c (print_address): Remove duplicate
	prototype.  Print additional newline to conform with output
	formatting for other types of reporting.
	* ping/ping_echo.c (ping_echo)
	[(options & OPT_ROUTE) & IP_OPTIONS]: Increase data length
	to accomodate the amount used for record routes in IP header.

2012-04-24  Mats Erik Andersson  <gnu@gisladisker.se>

	rexec: Read password from stdin.

	* src/rexec.c (main): New variables PASSWORD and N.
	If `arguments.password' is a single dash, read a line
	from standard in and assign it to `arguments.password'.
	* doc/inetutils.texi (rexec invocation):  Mention new
	treatment of `-p/--password'.

2012-04-22  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd: Implement syslog support.

	* src/rexecd.c: Include <syslog.h>.
	(logging, options): New variables.
	(parse_opt): New function.
	(argp): Insert `options' and `parse_opt'.
	(main): Call openlog().  Do not exit at surplus arguments,
	but make a note in syslog.  Log failed getpeername().
	(doit): New variables RHOST and RET.  In addition to error()
	and die(), make many entries in the syslog of varying severity.

	* src/rexec.c (do_rexec): Add a five second alarm around
	accept() for stderr channel, in case the server side is
	not responding.

	* doc/inetutils.texi (rexec, rexecd): Document recent
	additions.  Make option encoding for `rexec' complete.

2012-04-21  Mats Erik Andersson  <gnu@gisladisker.se>

	rexecd: Privilege audit and protocol conformity.

	* src/rexecd.c (doit): Execute changes of group as
	soon as password has been verified.  Remove useless
	call to setegid().  Protect setpgid() by the macro
	HAVE_SETPGID.  Delay sending the single NUL character
	until the time immediately before execution is handed
	over to a shell interpreter.

2012-04-20  Mats Erik Andersson  <gnu@gisladisker.se>

	Portability issue found on 64-bit OpenBSD.

	* ping/ping.c (ping_run): Break infinite loop by calling error()
	after failure in select().
	* ping/ping6.c (ping_run): Likewise.  Clear RESP_TIME.
	* src/traceroute.c (do_try): New variable FD.  Clear TIME and
	calculate NOW before calling select().  Set `fd + 1' to be the
	maximal file descriptor when calling select().  On failure in
	select(), return `errno' for proper detection, not EPERM.

2012-04-20  Mats Erik Andersson  <gnu@gisladisker.se>

	rexec, rexecd: Implement support for IPv6.

	* src/rexec.c (options): New `-4/ipv4', `-6/ipv6', and `-a/ipany'.
	(struct arguments): New member `int af'.
	(parse_opt): Detect `4', `6', and `a'.
	(do_rexec): New variables `ret', `addrlen', `hints', `ai', `res'.
	New type `struct sockaddr_storage` for ADDR.  Removed `host'.
	Replace gethostbyname() by getaddrinfo() in resolving host name.
	(do_rexec) <use error stream>: Use `struct sockaddr_storage` for
	SERV_ADDR and prepare bind() based on properties of ADDR.
	* src/rexecd.c (main): Use `struct sockaddr_storage' for FROM.
	(a_sin): Removed variable.
	(doit): New signature `doit(int, struct sockaddr *, socklen_t)`
	Change PORT to be `in_port_t'.  Remove call to bind().  Rewrite
	preparations for connect() to detect address family.

2012-04-19  Mats Erik Andersson  <gnu@gisladisker.se>

	Let `rexec' return a relevant return status.

	* src/rexec.c (remote_err): New variable.
	(main): Return `remote_err' as status.
	(do_rexec): New variable ON.  Set SO_REUSEADDR on SERV_SOCK.
	(do_rexec) <while loop>: New variables CONSUMED and OFFSET.
	Filter off initial bytes `\000' and `\001' appearing on either
	of the sockets SOCK and ERR_SOCK, since these represent return
	statuses and are now recorded in `remote_err'.

	String storage sanitation and intelligible return codes.

	* src/rexecd.c (username, logname, homedir, shell): Increase length.
	(envinit): Use NULL as last member, not naught.
	(doit): Set SO_REUSEADDR on socket S.  Use sizeof() to calculate
	explicit offset in strncat() with environment variables.  Let
	LOGNAME inherit the value from USER.
	(doit, getstr) <die calls>: Use EXIT_FAILURE as first argument.

2012-04-18  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/rexec.c (do_exec): Set missing values for `sin_family' and
	`sin_len' in SERV_ADDR.
	* src/rexecd.c (die): Use vsnprintf() for variadic lists!  Send
	also final newline character.  Call exit() at the end!

2012-04-13  Mats Erik Andersson  <gnu@gisladisker.se>

	Improve checking of FTP access verification.

	* ftpd/ftpd.c (complete_login): Abort login attempt when
	setegid() fails.
	(pass): Clear LOGIN_ATTEMPTS only if login was really granted.

2012-04-11  Mats Erik Andersson  <gnu@gisladisker.se>

	Support for DragonFly BSD.

	* configure.ac: Define UTMPX for `*dragonfly*'.
	* ftpd/extern.h: Include <sys/socket.h>.
	* src/rexec.c (do_rexec): Explicit casts as `struct sockaddr'.
	* src/tftpd.c (validate_access): Declare TIMEOUTBUF correctly
	to be of type `sigjmp_buf'.
	* telnet/externs.h: Include <errno.h> unconditionally.  Remove
	conditionals for `errno' depending on macro CRAY.

2012-03-31  Alfred M. Szmidt  <ams@gnu.org>

	configure.ac: Minor cleanup.

	* configure.ac: Don't check for mkstemp, don't try to replace
	strdup.
	(long long, long double): Remove checks.
	(AM_C_PROTOTYPES): Likewise.
	(AC_FUNC_ALLOCA, AC_FUNC_MALLOC, AC_FUNC_REALLOC): Likewise.

2012-03-31  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (DISTCLEANFILES): Added $(PACKAGE)-$(VERSION).tar.xz
	to list.

2012-03-29  Alfred M. Szmidt  <ams@gnu.org>

	* tests/.gitignore: Added tools.sh to list.

2012-03-29  Alfred M. Szmidt  <ams@gnu.org>

	Create xz compressed tarballs as part of `make dist'.

	* README-alpha: Updated.
	* configure.ac: Added dist-xz.
	* .gitignore: Added inetutils-*.tar.xz to list.

2012-03-27  Alfred M. Szmidt  <ams@gnu.org>

	Check return code of malloc, or use xmalloc.

	* whois/whois.c: Include "xalloc.h".
	(gwhois_argp_parser, queryformat): Use xmalloc over malloc.
	* telnet/commands.c: Include "xalloc.h".
	(env_init, env_define): Use xmalloc over malloc.
	* src/syslogd.c: Include "xalloc.h".
	(crunch_list): Use xmalloc over malloc.
	* src/rshd.c: Include "xalloc.h".
	(doit): Use xmalloc over malloc.
	* src/rsh.c: Include "xalloc.h".
	(main): Use xmalloc over malloc.
	* src/rlogind.c: Include "xalloc.h".
	(do_shishi_login): Use xmalloc over malloc.
	* src/rlogin.c: Include "xalloc.h".
	(main): Use xmalloc over malloc.
	* libtelnet/shishi.c (krb5shishi_send): Check return code of
	malloc.
	* libtelnet/kerberos5.c (kerberos5_send): Don't use assert to
	check the return code for malloc
	* libinetutils/kcmd.c (kcmd): Check return code of malloc.
	* ifconfig/printif.c: Include "xalloc.h".
	(print_interfaceX): Use xmalloc over malloc.
	* ftp/cmds.c: Include "xalloc.h".
	(dotrans, domap): Use xmalloc over malloc.

2012-03-21  Mats Erik Andersson  <gnu@gisladisker.se>

	* configure.ac (DD, MKTEMP, NETSTAT): New variables.  Use
	AC_PATH_PROG on `dd', `mktemp', and `netstat'.  Declare as
	precious with AC_ARG_VAR.
	(SED): New variable.  Set using AC_PROG_SED, protect by
	AC_ARG_VAR.
	(GREP): Protect using AC_ARG_VAR.
	* tests/Makefile.am (BUILT_SOURCES, EXTRA_DIST, CLEANFILES)
	(tools_subst): New variables.
	(tools.sh): New target.
	* tests/ftp-localhost.sh: Source `tools.sh'.  Use $GREP, $MKTEMP,
	$NETSTAT, and $SED instead of utility names.  Change tests for
	`grep', and `netstat'; check $need_mktemp.
	(FTPHOME): Check also fifth field of passwd, should GECOS be
	missing.
	(USER): Calculate using `func_id_user'.
	* tests/hostname.sh: Source `tools.sh'.  `func_id_uid` replaces
	`id -u'.
	* tests/ping-localhost.sh: Likewise.
	* tests/traceroute-localhost.sh: Likewise.
	* tests/syslogd.sh: Check directory early, then source `tools.sh'.
	Check $need_mktemp and $need_netstat.  Use $SED, $MKTEMP,
	$NETSTAT, and $GREP.  Replace `id -u' by `func_id_uid'.
	* tests/telnet-localhost.sh: Source `tools.sh'.  Check
	$need_mktemp.  Use $SED, $MKTEMP, and $GREP.
	(USER): Compute using `func_id_user'.
	* tests/tftp.sh: Source `tools.sh'.  Check $need_dd, $need_mktemp,
	and $need_netstat.  Remove checks for `netstat' and `grep'.  Use
	$SED, $MKTEMP, $NETSTAT, $GREP, and $DD.
	(USER): Compute using `func_id_user'.
	* tests/tools.sh.in: New file.

2012-03-20  Mats Erik Andersson  <gnu@gisladisker.se>

	* am/libcurses.m4 (IU_LIB_TERMCAP) <termlib detection>: Add a
	missing use of `test'.
	(HAVE_TERMLIB_TGETENT): New macro, replaces HAVE_TERMINFO_TGETENT.

2012-03-15  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (dnsdomainname invocation): Doc fix.
	* man/dnsdomainname.h2m: Likewise.
	* src/dnsdomainname.c (doc): Likewise.

	* src/dnsdomainname.c (dnsdomainname): Don't error when canonical
	name does not have domain name component (compatibility with
	Debian dnsdomainname).  Suggested by Mats Erik Andersson
	<gnu@gisladisker.se>.

	* tests/dnsdomainname.sh: Reject non-0 and non-1 exit codes (i.e.,
	crashes).

2012-03-15  Mats Erik Andersson  <gnu@gisladisker.se>

	* tests/dnsdomainname.sh: Replace `! test -x' by `test ! -x' for
	shell portability.

2012-03-14  Simon Josefsson  <simon@josefsson.org>

	* tests/dnsdomainname.sh: Don't fail on configuration errors.
	Suggested by Mats Erik Andersson <mats.andersson@gisladisker.se>.

2012-03-14  Mats Erik Andersson  <gnu@gisladisker.se>

	Make explicit dependency on header files for libwrap and termcap.

	* am/libcurses.m4 (IU_LIB_TERMCAP): Check whether tgetent() is
	really declared in <termcap.h>, not only checking presence of
	<termcap.h>.  That failing, check declaration of tgetent() using
	the pair <curses.h>, and <term.h>.  In case of no successful
	detection at all, set LIBTERMCAP to empty.
	* configure.ac (LIBWRAP): Define only if hosts_ctl() is present in
	libwrap and also the header <tcpd.h> exists.

2012-03-13  Mats Erik Andersson  <gnu@gisladisker.se>

	* src/traceroute.c (do_try): When displaying traces, print host
	name only if in resolving mode; otherwise only numerical address.
	Insert one additional blank before time printout.
	(get_hostname): Remove conditional clause on
	OPT_RESOLVE_HOSTNAMES.

2012-03-12  Simon Josefsson  <simon@josefsson.org>

	* NEWS: Mention new dnsdomainname tool.
	* configure.ac: Add tool dnsdomainname.
	* doc/inetutils.texi: Document dnsdomainname.
	* man/Makefile.am: Build dnsdomainname.1.
	* man/dnsdomainname.h2m: New file.
	* src/.gitignore: Ignore dnsdomainname.
	* src/Makefile.am (bin_PROGRAMS): Add $(dnsdomainname_BUILD).
	(dnsdomainname_SOURCES): New variable.
	(EXTRA_PROGRAMS): Add dnsdomainname.
	* src/dnsdomainname.c: New file.
	* tests/dnsdomainname.sh: New file.

2012-03-10  Mats Erik Andersson  <gnu@gisladisker.se>

	* whois/tld_serv_list (.cz, .fo, .gl, .gs, .hk, .ie, .il, .in)
	(.is, .jp, .kr, .kz, .lt, .lu, .lv, .ms, .mx, .ng, .nz, .pe, .pl)
	(.ro, .ru, .se, .sg, .si, .sk, .sm, .su, .tf, .th, .tr, .tw, .us):
	Updated entry.
	(.dz, .ec, .es, .eu, .fi, .gd, .gg, .gi, .gy, .hn, .hr, .ht, .im)
	(.io, .ir, .je, .ke, .la, .ly, .ma, .md, .me, .mg, .mn, .mp, .mu)
	(.my, .na, .nc, .nf, .pm, .pr, .pt, .qa, .re, .rs, .sa, .sb, .sc)
	(.so, .sx, .tk, .tl, .tv, .tz, .ua, .uy, .uz, .vc, .ve, .wf, .yt):
	New or upgraded from web entry.
	(.hm, .ki, .mf, .pk, .pw, .sl, .sn, .tj, .ug, .um, .vn, .yu, .za):
	Broken address or other comment.

2012-03-06  Mats Erik Andersson  <gnu@gisladisker.se>

	* ping/ping6.c (print_echo): Use flag NI_NUMERICHOST in call to
	getnameinfo() whenever the option OPT_NUMERIC is active.
	* ping/ping_echo.c (ipaddr2str): Isolate case OPT_NUMERIC to call
	xstrdup().  Then call xstrdup() if gethostbyaddr() fails.  In main
	body, replace every `hp->h_name' for `ipstr', and conversely,
	since only `hp->h_name' can fail do be defined.
	* tests/ping-localhost.sh: Insert option `-n' to ping and ping6.

2012-03-03  Mats Erik Andersson <gnu@gisladisker.se>

	Display command prompt only in interactive mode.

	* src/tftp.c (fromatty): New variable; true in interactive mode.
	(main): Assign value to FROMATTY.
	(command): Display prompt only if FROMATTY is true.

2012-03-02  Mats Erik Andersson <gnu@gisladisker.se>

	Make service lookup optional in FTP client.

	* ftp/cmds.h (DEFPORT) [!DEFPORT]: New macro.  Define as
	IPPORT_FTP if available, otherwise as 21.
	(another): Condition call to add_history() on FROMATTY.
	(setpeer): Call getservbyname() for `ftp/tcp'.  Set port if
	successful; use DEFPORT otherwise.
	* ftp/ftp_var.h (sp): Remove external variable.
	* ftp/main.c (main): Remove call to getservbyname() and the use of
	SP.
	(cmdscanner): Condition call to add_history() on FROMATTY.

2012-03-01  Mats Erik Andersson <gnu@gisladisker.se>

	Subtests for SIGHUP reaction of `inetd' and `syslogd'.

	* tests/syslogd.sh: Write a second configuration file after first
	run, send SIGHUP to server, and evaluate message response.
	(SUCCESSES): Update arithmetic expression used in evaluation.
	(OUT_USER, OUT_DEBUG, TAG2, COUNT2, COUNT2_debug, COUNT3)
	(COUNT3_info): New variables.  <verbose report>: Print messages of
	files $OUT_USER and $OUT_DEBUG.

	* tests/tftp.sh: Calculate new port after first test run, send
	SIGHUP to server, and transmit a small file at each adress in old
	list.
	(do_conf_reload): New variable.

2012-03-01  Mats Erik Andersson <gnu@gisladisker.se>

	Reduce external prerequisites in test scripts.

	* tests/ftp-localhost.sh: Replace `head -1' by `sed 1q'.
	* tests/telnet-localhost.sh, tests/tftp.sh: Likewise.  Replace `ps
	pid' by `kill -0 pid'.
	* tests/syslogd.sh: Likewise.  Replace `wc -l' by `grep -c'.

	* tests/tftp.sh: Do not issue `set -m', since no job control in
	use.

2012-02-25  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Sort lexically.

2012-02-25  Alfred M. Szmidt  <ams@gnu.org>

	Silence sc_makefile_at_at_check.

	* whois/Makefile.am (bin_PROGRAMS): Use $(...) type of variable
	reference instead of @...@.
	* telnetd/Makefile.am: Likewise.
	* telnet/Makefile.am (bin_PROGRAMS): Likewise.
	* talkd/Makefile.am (inetdaemon_PROGRAMS): Likewise.
	* talk/Makefile.am (bin_PROGRAMS): Likewise.
	* src/Makefile.am (bin_PROGRAMS, inetdaemon_PROGRAMS)
	(install-exec-hook): Likewise.
	* ping/Makefile.am (bin_PROGRAMS, install-exec-hook): Likewise.
	* libls/Makefile.am (noinst_LIBRARIES): Likewise.
	* ifconfig/Makefile.am (bin_PROGRAMS): Likewise.
	* ftpd/Makefile.am (inetdaemon_PROGRAMS): Likewise.
	* ftp/Makefile.am (bin_PROGRAMS): Likewise.

2012-02-25  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Added sc_assignment_in_if to
	list.
	(sc_assignment_in_if): New target.

	* bootstrap: Updated from gnulib.

	* src/inetd.c (main, tcpmux, chargen_dg, chargen_stream)
	(nextconfig, newstr, run_service): Fix indentation.

2012-02-22  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ping-localhost.sh, tests/traceroute-localhost.sh: Mend
	string quotation for expected variable expansion.
	* tests/syslogd.sh (SYSLOGD, LOGGER): Allow value overriding.
	* tests/telnet-localhost.sh (INETD, TELNET, ADDRPEEK): Likewise.
	(TARGET): New variable, replacing previous TARGET4.

2012-02-22  Mats Erik Andersson <gnu@gisladisker.se>

	Implement group assignment for services.

	* src/inetd.c (struct servtab): New component `char *se_group'.
	(run_service): New variable GRP.  Check existence of
	`sep->se_group'.  If valid, then apply setgid() to `grp->gr_gid'
	instead of `pwd->pw_gid'.  <initgroups> [HAVE_INITGROUPS]: Use
	`grp->gr_id' if an explicit group was stated, otherwise use
	`pwd->pw_gid'.
	(print_service): Display also group membership.
	(enter, freeconfig): Add string handling for groups.
	(getconfigent): Parse user string for an optional group component.
	(nextconfig): Assure that an assigned group really exists.
	(fix_tcpmux): Add empty group string.
	* doc/inetutils.texi (inetd configuration file): Add setting of
	group.

2012-02-21  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/telnet-localhost.sh: Skip test in absence of assigned TTY.
	Rewrite case evaluation without nested pipelines and OR
	connectives.

2012-02-21  Mats Erik Andersson <gnu@gisladisker.se>

	Basic test case for `telnet'.

	* tests/Makefile.am (dist_check_SCRIPTS) [ENABLE_inetd &&
	ENABLE_telnet]: Added telnet-localhost.sh.
	* tests/telnet-localhost.sh: New file.

	* tests/ftp-localhost.sh (posttesting): Use SIGTERM first, then
	SIGKILL.
	(locate_port): Adapt regex alternate pattern for legacy `grep'.
	* tests/syslogd.sh (clean_testdir, locate_port): Likewise.
	* tests/tftp.sh (posttesting, locate_port): Likewise.

2012-02-20  Mats Erik Andersson <gnu@gisladisker.se>

	Improve behaviour of single stacked clients.

	* ftp/ftp.c (hookup): Do not add AI_ADDRCONFIG to HINTS.ai_flags.
	* src/logger.c (open_socket): Likewise.
	* telnet/commands.c (tn): Likewise.

	* telnet/Makefile.am, telnetd/Makefile.am (LDADD): Remove the
	addition of `$(LIBREADLINE)': not needed.

2012-02-19  Mats Erik Andersson <gnu@gisladisker.se>

	* bootstrap.conf (gnulib_modules): Add sethostname to list.

	* tests/syslogd.sh: Sleep slightly before evaluating outcome.

2012-02-18  Mats Erik Andersson <gnu@gisladisker.se>

	* README (Notes): Explicitly name extent of Shishi support.

	Portability issue caused by FreeBSD.
	* ftpd/ftpcmd.y (cmd) <EPRT>: Remove precompiler conditionals
	using AI_V4MAPPED, keeping code, but do not set AI_V4MAPPED in
	`hints.ai_flags'.

2012-02-13  Simon Josefsson  <simon@josefsson.org>

	* README (Notes): Doc fix.

2012-02-09  Mats Erik Andersson <gnu@gisladisker.se>

	* am/krb5.m4: When examining `libkrb5', replace AC_CHECK_LIB by
	AC_TRY_LINK in order to avoid cached results, since identical
	library and function names are tested for.  <OpenBSD Heimdal>: New
	test case.

2012-02-08  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh: Reimplement a subtest using standard INET
	port.  A second SYSLOG daemon is started, which only uses INET
	sockets.
	(do_standard_port): New variable, initially `true', changed to
	`false' for non-root user and when 514/udp is in use.

2012-02-08  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c: Implement presetable inet port, defaulting to the
	standard port `syslog/udp'.  Fall back to `514' if `syslog' fails.
	(find_inet_port): New function.
	(BindPort): New variable.
	(portstr) [IPPORT_SYSLOG]: New variable.
	(LogPortText): Initialize to NULL.
	(LogForwardPort): New variable.
	(argp_options, parse_opt): New option `-B/--bind-port'.
	(main): New call to `find_inet_port'.
	(create_inet_socket): Check that LOGPORTTEXT is non-null,
	otherwise inet sockets are left disabled.
	(fprintflog, cfline) [AI_ADDRCONFIG]: Only AF_UNSPEC invokes
	AI_ADDRCONFIG.  Replace LOGPORTTEXT by LOGFORWARDPORT in calls to
	getaddrinfo.

	* tests/syslogd.sh: Adapt to `syslogd' allowing non-standard
	ports.
	(PORT): Make presetable from command line.
	(locate_port): New function.  <non-root && privileged port>: Use a
	pseudo-random port.  <port in use>: Take a pseudo-random step to
	an even higher port, only to disable inet sockets if even that
	action fails.
	[do_inet_socket]: Add `-B$PORT' to IU_OPTIONS and append `:$PORT'
	to option `-h' in calls to logger.

	* tests/ftp-localhost.sh, tests/tftp.sh (NSSWITCH): Override with
	value `/etc/services' when running OpenBSD.

2012-02-06  Mats Erik Andersson <gnu@gisladisker.se>

	* doc/inetutils.texi (logger invocation): Describe option
	`-u/--unix'.
	(ftpd invocation): Describe options `-4/ipv4' and `-6/--ipv6'.
	* tests/ftp-localhost.sh (NSSWITCH, PASSWD, PROTOCOLS): New
	variables naming standard files.  Check their presence and skip
	test otherwise.
	* tests/tftp.sh (NSSWITCH, PASSWD, PROTOCOLS): Likewise.

2012-02-05  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/tftp.sh: Need job control, issue `set -m'.
	(spawned_pid): New variable.  <inetd restart failure>: For better
	robustness, kill process immediately using SPAWNED_PID.

2012-02-04  Mats Erik Andersson <gnu@gisladisker.se>

	* src/logger.c (unixsock): New variable.
	(open_socket): Allow HOST and UNIXSOCK to determine UNIX socket
	name.  Add test that HOST be non-NULL.
	(argp_options): New option `-u/--unix'.
	(parse_opt) <h>: Erase UNIXSOCK, i.e., clear `-u'.  <u>: New
	option.  Set UNIXSOCK, erase HOST.

2012-02-04  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/Makefile.am (INCLUDES): Add $(INCAUTH) to list.
	* src/Makefile.am (INCLUDES): Likewise.

2012-02-03  Mats Erik Andersson <gnu@gisladisker.se>

	Do not use which(1) in test scripts.

	* tests/ftp-localhost.sh: Use a trivial match to detect grep(1)
	and a trivial invokation of netstat(1).  Use `sysctl -a', while
	discarding STDOUT and STDERR, to sense for sysctl(8).
	* tests/tftp.sh: Likewise with grep(1).

2012-02-03  Mats Erik Andersson <gnu@gisladisker.se>

	Attempt full detection of any intermediary step failing.

	* tests/ftp-localhost.sh: Test presence of grep(1), netstat(1).
	Capture failing mktemp(1).
	(posttesting): Verify non-empty TMPDIR and it being a directory.
	<inetd.conf, .netrc>: Test successful write to these files.
	<starting INETD>: Test successful start as well as presence of
	`$TMPDIR/inetd.pid' afterwards.
	* tests/tftp.sh: Test presence of grep(1) and netstat(1).  Capture
	failing mktemp(1).
	(posttesting): Verify non-empty TMPDIR and it being a directory.
	<write_conf>: Test successful execution.
	(REDIRECT): New variable.  <INETD invokation>: Always use
	debug-mode `-d', but suppress STDERR in non-verbose execution
	mode.  An eval call implements this during the first attempt.
	Test the validity of `inetd_pid' afterwards.  <restart of INETD>:
	Use `kill -9' and delete the file INETD_PID.  <creation of test
	files>: Check validity of TMPDIR and test for failure when
	creating the directory `$TMPDIR/tftp-test'.

2012-02-02  Mats Erik Andersson <gnu@gisladisker.se>

	Full set of prototypes for Shishi enabled builds.

	* libinetutils/shishi_def.h (krcmd, krcmd_mutual) [SHISHI]: New
	prototypes.
	* libtelnet/auth-proto.h (auth_name) [AUTHENTICATION]: Likewise.
	* libtelnet/auth.c (auth_onoff) [AUTHENTICATION]: Likewise.
	* libtelnet/enc-proto.h (EncryptStart, EncryptStartInput)
	[ENCRYPTION]
	(EncryptStartOutput, EncryptStatus, EncryptStop, EncryptStopInput)
	(EncryptStopOutput, EncryptType, encrypt_start, encrypt_end)
	(encrypt_request_start, encrypt_request_end, encrypt_support)
	(encrypt_dec_keyid, encrypt_enc_keyid): Likewise.
	* libtelnet/genget.h (Ambiguous): Likewise.
	* libtelnet/misc-proto.h (auth_encrypt_user): Likewise.
	* src/rlogind.c (do_shishi_login) [SHISHI]: New prototype.
	* telnet/commands.c [ENCRYPTION]: Include <libtelnet/encrypt.h>.
	[AUTHENTICATION || ENCRYPTION]: Include <libtelnet/misc.h>.
	* telnet/main.c [AUTHENTICATION]: Include <libtelnet/auth.h>.
	[ENCRYPTION]: Include <libtelnet/encrypt.h>.
	* telnet/telnet.c [AUTHENTICATION]: Include <libtelnet/auth.h>.
	[ENCRYPTION]: Include <libtelnet/encrypt.h>.
	[AUTHENTICATION || ENCRYPTION]: Include <libtelnet/misc.h>.
	* telnet/terminal.c [ENCRYPTION]: Include <libtelnet/encrypt.h>.
	* telnetd/telnetd.c [AUTHENTICATION || ENCRYPTION]: Include
	<libtelnet/misc.h>.

2012-02-01  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh (do_inet_socket): New variable.  <port is
	busy>: Continue, but disable INET test.  Issue a notice.
	* tests/tftp.sh (write_conf): New function.  <failed inetd
	launch>: Make a second start attempt, with new port.

2012-02-01  Guillem Jover  <guillem@hadrons.org>

	* src/Makefile.am (LDADD): Set to minimal, common value.
	(rcp_LDADD, rexecd_LDADD, rlogin_LDADD, rlogind_LDADD, rsh_LDADD)
	(rshd_LDADD, traceroute_LDADD, uucpd_LDADD): New variables.

2012-02-01  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Check for typedefs `Schedule' and `Session_Key' in
	<arpa/telnet.h>.
	* libinetutils/des_rw.c (MIN) [ENCRYPTION && KERBEROS && !MIN]:
	Define missing macro.
	(roundup) [ENCRYPTION && KERBEROS && !roundup]: Likewise.
	* libinetutils/kcmd.c (kcmd) [HAVE_SIGACTION]: Use modern signal
	handling.  New variables SIGS and OSIGS.
	* libtelnet/auth.c (AUTHTYPE_NAMES) [AUTHENTICATION]: New macro,
	needed by OpenSolaris to fill in `authtype_names' by
	<arpa/telnet.h>.
	* libtelnet/encrypt.h [ENCRYPTION &&
	!HAVE_ARPA_TELNET_H_SCHEDULE]: Typedef for `Schedule' is
	conditional.
	[ENCRYPTION && !HAVE_ARPA_TELNET_H_SESSION_KEY]: Typedef for
	`Session_Key' is conditional.
	* libtelnet/misc.c: Include <arpa/telnet.h>.
	* src/rlogind.c (ENC_WRITE) [KERBEROS && ENCRYPTION]: Define macro
	using correct name.
	* src/rshd.c (MAX) [!MAX]: Define missing macro.

2012-02-01  Mats Erik Andersson <gnu@gisladisker.se>

	Detect and protect header files for Kerberos support.

	* configure.ac: Check for <com_err.h>, <kerberosIV/des.h>,
	<kerberosIV/krb.h>, <kerberosV/krb5.h>, <krb5.h>, <krb5/asn1.h>,
	<krb5/crc-32.h>, <krb5/ext-proto.h>, <krb5/krb5.h>,
	<krb5/los-proto.h>.

	* libinetutils/des_rw.c
	[ENCRYPTION && KERBEROS && HAVE_KERBEROSIV_DES_H]: Include
	<kerberosIV/des.h>.
	[ENCRYPTION && KERBEROS && HAVE_KERBEROSIV_KRB_H]: Include
	<kerberosIV/krb.h>.
	* libinetutils/kcmd.c, libinetutils/krcmd.c
	[KERBEROS && HAVE_KERBEROSIV_DES_H]: Include <kerberosIV/des.h>.
	[KERBEROS && HAVE_KERBEROSIV_KRB_H]: Include <kerberosIV/krb.h>.
	* libtelnet/forward.c [KRB5 && FORWARD && HAVE_KRB5_KRB5_H]:
	Include <krb5/krb5.h>.
	[KRB5 && FORWARD && HAVE_KRB5_ASN1_H]: Include <krb5/asn1.h>.
	[KRB5 && FORWARD && HAVE_KRB5_CRC_32_H]: Include <krb5/crc-32.h>.
	[KRB5 && FORWARD && HAVE_KRB5_LOS_PROTO_H]: Include
	<krb5/los-proto.h>.
	[KRB5 && FORWARD && HAVE_KRB5_EXT_PROTO_H]: Include
	<krb5/ext-proto.h>.
	* libtelnet/kerberos.c [KRB4 && HAVE_DES_H]: Include <des.h>.
	[KRB4 && HAVE_KRB_H]: Include <krb.h>.
	* libtelnet/kerberos5.c [KRB5 && HAVE_KRB5_H]: Include <krb5.h>.
	[KRB5 && HAVE_COM_ERR_H]: Include <com_err.h>.
	* src/rcp.c
	[KERBEROS && HAVE_KERBEROSIV_DES_H]: Include <kerberosIV/des.h>.
	[KERBEROS && HAVE_KERBEROSIV_KRB_H]: Include <kerberosIV/krb.h>.
	* src/rlogin.c: Likewise.
	[SHISHI]: Do inclusions independently of conditional code.
	* src/rlogind.c [KERBEROS && KRB4 && HAVE_KERBEROSIV_DES_H]:
	Include <kerberosIV/des.h>.
	[KERBEROS && KRB4 && HAVE_KERBEROSIV_KRB_H]: Include
	<kerberosIV/krb.h>.
	[KERBEROS && KRB5 && HAVE_KRB5_H]: Include <krb5.h>.
	[KERBEROS && KRB5 && HAVE_KERBEROSIV_KRB_H]: Include
	<kerberosIV/krb.h>.
	* src/rsh.c, src/rshd.c [KERBEROS && HAVE_KERBEROSIV_DES_H]:
	Include <kerberosIV/des.h>.
	[KERBEROS && HAVE_KERBEROSIV_KRB_H]: Include <kerberosIV/krb.h>.
	[SHISHI]: Do inclusions independently of conditional code.

2012-01-31  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/kcmd.c: Include <fcntl.h>.
	* libtelnet/auth.h (AUTH_REJECT) [!AUTH_REJECT]: Protect
	`#define'.
	(AUTH_UNKNOWN) [!AUTH_UNKNOWN]: Likewise.
	(AUTH_OTHER) [!AUTH_OTHER]: Likewise.
	(AUTH_USER) [!AUTH_USER]: Likewise.
	(AUTH_VALID) [!AUTH_VALID]: Likewise.
	* libtelnet/enc_des.c (ofb64_init, ofb64_start)
	[ENCTYPE_DES_OFB64]
	(ofb64_is, ofb64_reply, ofb64_session, ofb64_keyid)
	(ofb64_printsub)
	(ofb64_encrypt, ofb64_decrypt): Protect definitions.
	* libtelnet/encrypt.c (i_support_encrypt) [ENCTYPE_DES_OFB64]
	(i_support_decrypt): Add ENCTYPE_DES_OFB64 only if existing,
	otherwise only ENCTYPE_DES_CFB64.
	(encryptions) [ENCTYPE_DES_OFB64]: Conditional use of OFB64 calls.
	* libtelnet/encrypt.h [!ENCTYPE_ANY && TELOPT_ENCTYPE_NULL]
	(ENCTYPE_ANY): Use alternate macro.
	[!ENCTYPE_DES_CFB64 && TELOPT_ENCTYPE_DES_CFB64]
	(ENCTYPE_DES_CFB64): Likewise
	[!ENCTYPE_DES_OFB64 && TELOPT_ENCTYPE_DES_OFB64]
	(ENCTYPE_DES_OFB64): Likewise.
	(ENCTYPE_CNT) [!ENCTYPE_CNT && TELOPT_ENCTYPE_CNT]: Likewise.
	(VALIDKEY) [!VALIDKEY]: Protect `#define'.

2012-01-31  Mats Erik Andersson <gnu@gisladisker.se>

	* src/tftp.c (resolve_name): Do not use AI_ADDRCONFIG at all.
	Assign HOSTNAME with `ai->ai_canonname' only if it has contents,
	otherwise assign `<dummy>', which is very unlikely.
	* tests/ftp-localhost.sh: Make SVR4-compliant.  Refactor code.
	Error messages go to STDERR.  Use HERE-docs for configuration.
	(PWD): If not exported, assign with command substitution `pwd`.
	(USER, FTPUSER, save_IFS): New variables.
	(FTPHOME): New variable, for portably calculating home of FTPUSER.
	Make certain of existence and readability of this directory.
	(test_report): New function for common evaluation tasks.
	* tests/syslogd.sh (PWD): If not exported, assign with command
	substitution `pwd`.
	* tests/tftp.sh: Expand to cover IPv6.  Error messages to STDERR.
	Make `inetd' and `tftp' verbose only with VERBOSE set.
	(PWD): If not exported, assign with command substitution `pwd`.
	(locate_port): New prototype, dropping address family argument,
	always detecting IPv4 and IPv6.

2012-01-27  Mats Erik Andersson <gnu@gisladisker.se>

	* libtelnet/auth.c, libtelnet/enc_des.c, libtelnet/encrypt.c,
	libtelnet/kerberos.c, libtelnet/kerberos5.c, libtelnet/shishi.c:
	Add external prototype `void printsub (char, unsigned char *,
	int)', appearing as callback.
	* libtelnet/auth-proto.h (auth_gen_printsub): Remove prototype.
	(auth_printsub): Missing prototype.
	* libtelnet/auth.c (auth_gen_printsub): Declare as static, and
	position before code for `auth_printsub'.
	* libtelnet/enc-proto.h (encrypt_printsub): Missing prototype.
	[ENCRYPTION && TELNETD]: Rename macro TELENTD as TELNETD, both are
	otherwise not in use.
	* libtelnet/encrypt.c (encrypt_gen_printsub): Reorder parameters
	in declaration to read `(unsigned char *, int, unsigned char *,
	int)'.
	(encrypt_printsub): Likewise.
	* telnet/utilities.c [AUTHENTICATION]: Include <libtelnet/auth.h>.
	[ENCRYPTION]: Include <libtelnet/encrypt.h>.
	* telnetd/telnetd.h: Include <libtelnet/encrypt.h>.

2012-01-27  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh, tests/tftp.sh (PORT): Detect if it is
	preset, or detect an unused value from a short list.
	* tests/ftp-localhost.sh (locate_port): New function.

2012-01-26  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh (SOCKET): Disable the use of this UNIX socket
	name if its length would be excessive.

2012-01-26  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh, tests/ping-localhost.sh,
	tests/syslogd.sh, tests/tftp.sh, tests/traceroute-localhost.sh:
	Test the availability of compiled resources.
	* tests/syslogd.sh (LOGGER): Rename from IU_LOGGER.
	(SYSLOGD): Rename from IU_SYSLOGD.
	* tests/tftp.sh (IFCONFIG_SIMPLE): New helper variable.

2012-01-25  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh: Substantial rewrite.  Early verbosity.
	Consistent quoting for white space in IU_TESTDIR.  Robustness with
	error checking.  Execution inside `tests/'.
	(TARGET, TARGET6): New variables.
	(TMPDIR): Overrides `/tmp/' as temporary directory.

2012-01-23  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: New preamble to fail with SVR4 shell.
	Backtics in command substitution.
	* tests/tftp.sh: Rewrite for SVR4 portability.  Backtics in
	command substitution.  expr(1) for arithmetic.  Only basic regex
	with grep(1), no `-q'.  Remove character classes.  Quotation issue
	for tr(1).  Use `test -r /dev/urandom' to circumvent soft link.

2012-01-22  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/tftp.sh (USER): Calculate as `id -u -n'.

2012-01-22  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: sysctl(1) uses `=' or `:' as delimeter.
	Detect both.

2012-01-22  Mats Erik Andersson <gnu@gisladisker.se>

	* ftpd/extern.h (usefamily): New declaration.
	* ftpd/ftpd.c (options): New options `-4/ipv4' and `-6/ipv6`.
	(parse_opt): Detect `4' and `6'.
	* ftpd/server_mode.c (usefamily): New variable.
	(DEFPORT) [!DEFPORT]: Use IPPORT_FTP if available.
	(server_mode): Remove use of AI_ADDRCONFIG.  When seeing
	AF_UNSPEC, build AF_INET6 socket and reset socket option
	IPV6_V6ONLY.

2012-01-22  Mats Erik Andersson <gnu@gisladisker.se>

	* ftpd/extern.h (passive): New prototype.
	* ftpd/ftpcmd.y (EPRT, EPSV, CHAR): New tokens.
	(net_proto, tcp_port, net_addr): New value returning types.
	(cmd) <PORT>: Use value returned from `host_port'.  Erase PDATA
	and USEDEFAULT only if successful.
	(cmd) <PASV>: Changed call to passive().
	(cmd) <EPRT, EPSV>: New code for token parsers.
	(host_port): Declare as `%type <i>', returning an integer.  Handle
	mapped IPv4 addresses.  Erase DATA_DEST after an address resolving
	failure.
	(DLIST): New macro used as state in finite state automata.
	(cmdtab): New entries EPRT and EPSV.
	(yylex) <DLIST>: Implement new state.
	* ftpd/ftpd.c (passive): New prototype `passive(int, int)'.  New
	variable TRY_AF.  Select address family based on parameters and
	CTRL_ADDR.
	(passive) <EPSV>: Handle AF_INET and AF_INET6.
	(passive) <PASV>: Process also mapped IPv4 address.
	* tests/ftp-localhost.sh: More tests in inetd mode: EPSV and EPRT
	for IPv4 and IPv6.  Suppress FTP dialog unless verbose.

2012-01-18  Simon Josefsson  <simon@josefsson.org>

	* ftpd/ftpd.c (options): Don't use OPTION_ARG_OPTIONAL for -a.
	Resolves crash reported by Michal Mazurek <akfaew@jasminek.net>.

2012-01-07  Guillem Jover  <guillem@hadrons.org>

	* ifconfig/flags.c (flag_char_tab): Protect for full portability
	every macro invokation IFF_* by a precompiler conditional.

2012-01-07  Mats Erik Andersson <gnu@gisladisker.se>

	* telnet/utilities.c (SetNetTrace): Filename buffer overrun:
	replace strcpy() by strncpy().
	(printoption, printsub): Code formatting of ternary operator.

2012-01-07  Guillem Jover  <guillem@hadrons.org>

	* telnet/utilities.c (printsub) <env_common>: Use constant format
	strings instead of offsets into fixed string.  Remove NOQUOTE, add
	QUOTE.

2012-01-06  Simon Josefsson  <simon@josefsson.org>

	inetutils 1.9.1

	* configure.ac: Replace all '_' into '.'.

	* NEWS: Updated.

	* bootstrap: Updated from gnulib.

2012-01-04  Mats Erik Andersson <gnu@gisladisker.se>

	Regression: Erase port for active data transmission.

	* ftpd/ftpcmd.y (host_port): Use AI_NUMERICHOST and AI_NUMERICSERV
	in `HINTS.ai_flags'.  Do not use AI_ADDRCONFIG.
	* ftpd/ftpd.c (getdatasock): Erase port number stored in
	DATA_SOURCE.
	* tests/ftp-localhost.sh: Detect transfered data and duplicate
	tests also for an active connection, not only a passive attempt.

2012-01-03  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Removed git-merge-changelog.

2012-01-03  Mats Erik Andersson <gnu@gisladisker.se>

	Internal address structure rewrite for `ftpd'.

	* ftpd/extern.h (data_dest, his_addr): Change to `struct
	sockaddr_storage'.
	(server_mode): New prototype: second argument `struct sockaddr *'.
	* ftpd/ftpcmd.y (cmd): Use casts to `struct sockaddr_in' to
	evaluate sub case `host_port'.
	(yylex) [HAVE_SETPROCTITLE]: Compare to numeric naught, not NULL.
	* ftpd/ftpd.c (data_dest, his_addr, ctrl_addr, data_source)
	(pasv_addr): Change to `struct sockaddr_storage'.
	(main): Apply updated server_mode().
	(main, getdatasock, dataconn): Set IP_TOS only for AF_INET.
	(dataconn, passive): Copy addresses using memcpy().
	(statfilecmd): Change SIN to `struct sockaddr_storage'.
	(statcmd): Casts as `struct sockaddr_in' needed for A and P.
	(passive): Clear port number depending on address family.  Reply
	with 229 for EPSV/IPv6 and 227 for PASV.
	* ftpd/server_mode.c (check_host): Activate AF_INET6 case.
	(server_mode): Second argument is 'struct sockaddr *', must be
	initiated before call, and returns actual address length.  New
	variable SAVED_ADDRLEN.  Changed call due to these two.

2012-01-02  Mats Erik Andersson <gnu@gisladisker.se>

	Initial address family abstraction for `ftpd'.

	* ftpd/extern.h: Include <netinet/in.h>.
	(data_dest_len, his_addr_len): New socklen_t variables.
	(server_mode): Use a socklen_t argument.
	* ftpd/ftpcmd.y: Include <netdb.h>.
	(cmd) [unix || __unix__]: SYS_TYPE must recognize __unix__.
	(host_port): Use getaddrinfo to initiate DATA_DEST.
	* ftpd/ftpd.c (data_set_len, his_addrlen, addrstr, portstr)
	(ctrl_addrlen, data_source_len, pasv_addrlen): New variables.
	(check_host) [HAVE_LIBWRAP]: Prototype extended with socklen_t.
	(dolog): Likewise.
	(main): Use HIS_ADDRLEN, CTRL_ADDRLEN instead of local ADDRLEN.
	Changed calls to server_mode and dolog due to new prototypes.
	(getdatasock): Address family determined by CTRL_ADDR.  Inherit
	fields in DATA_SOURCE from CTRL_ADDR, and DATA_SOURCE_LEN from
	CTRL_ADDRLEN.  Dynamic address length to bind().
	(dataconn): Use FROM as `struct sockaddr_storage.  Change socket
	descriptor S to be `int'.  Assign DATA_DEST and DATA_DEST_LEN in a
	block.  Use getnameinfo for error message.  Dynamic socket length
	in connect().
	(statcmd): Lookup using getnameinfo().
	(dolog): New prototype, extended by `socklen_t'.  Likewise.
	(passive): Removed variable LEN, now using length and family
	stored in address variables, which are global.
	* ftpd/server_mode.c (check_host): New prototype: adding
	`socklen_t'.  Removed SIN, HP.  New variables ERR, NAME.  Lookup
	uses getnameinfo().
	(server_mode): New prototype: adding `socklen_t'.  Delete
	SERVER_ADDR.  New varables ERR, PORTSTR, HINTS, RES, AI.  Lookup
	uses getaddrinfo and a loop to get listener.  Server loop removes
	ADDRLEN, now setting address length by use of PHIS_ADDRLEN.

2011-12-31  Alfred M. Szmidt  <ams@gnu.org>

	inetutils 1.9

	* Makefile.am (EXTRA_DIST): Removed README-alpha from list.

	* NEWS: Updated.

2011-12-31  Alfred M. Szmidt  <ams@gnu.org>

	Fix prohibit_always_true_header_tests syntax-checks.

	* ifconfig/printif.c: Don't protect inclusion of <alloca.h> with
	HAVE_ALLOCA_H.

	* configure.ac: Don't protect inclusion of <sys/types.h> with
	HAVE_SYS_TYPES_H.
	* libinetutils/daemon.c: Likewise.
	* telnet/commands.c: Likewise.
	* src/syslogd.c: Likewise.

2011-12-30  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Check for ruserok.  If iruserok exists, then
	define WITH_IRUSEROK, else if ruserok exists, then define
	WITH_RUSEROK.  Disable rlogind and rshd otherwise.  Check for
	__check_rhosts_file.
	* src/rlogind.c (__check_rhosts_file) [HAVE___CHECK_RHOSTS_FILE]:
	Protect declaration as extern variable.
	(iruserok) [__GLIBC__ && WITH_IRUSEROK]: Protect declaration as
	extern.
	(options) [HAVE___CHECK_RHOSTS_FILE]: Conditionally include the
	option `-l/--no-rhosts'.
	(parse_opt) [HAVE___CHECK_RHOSTS_FILE]: Likewise.
	(exec_login) [SOLARIS]: Contemporary arguments for execle.
	(do_rlogin) [WITH_IRUSEROK]: Protect usage of iruserok.
	[!WITH_IRUSEROK && WITH_RUSEROK]: Do authorization with ruserok
	composed with inet_ntoa.
	* src/rshd.c (options) [HAVE___CHECK_RHOSTS_FILE]: Conditionally
	include the option `-l/--no-rhosts'.
	(__check_rhosts_file) [HAVE___CHECK_RHOSTS_FILE]: Protect
	declaration as extern variable.
	(iruserok) [__GLIBC__ && WITH_IRUSEROK]: Protect declaration as
	extern.
	(parse_opt) [HAVE___CHECK_RHOSTS_FILE]: Conditional detection of
	`-l/--no-rhosts'.
	(doit) [WITH_IRUSEROK]: Protect call to iruserok.
	[!WITH_IRUSEROK && WITH_RUSEROK]: Do authorization with ruserok
	composed with inet_ntoa.

2011-12-30  Alfred M. Szmidt  <ams@gnu.org>

	Fix prohibit_dirent_without_use, sc_unsigned_short,
	sc_unsigned_long sc_unsigned_char checks.

	* ftpd/ftpd.c, libicmp/icmp.h, libicmp/icmp_address.c,
	libicmp/icmp_cksum.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c, libinetutils/des_rw.c,
	libinetutils/kcmd.c, libinetutils/krcmd.c, libinetutils/ttymsg.c,
	libls/fts.c, libls/fts.h, libls/ls.c, libls/ls.h, libls/print.c,
	libtelnet/kerberos.c, ping/libping.c, ping/ping.c, ping/ping.h,
	ping/ping6.c, ping/ping_common.c, ping/ping_common.h,
	ping/ping_echo.c, ping/ping_impl.h, src/inetd.c, src/rcp.c,
	src/rexecd.c, src/rlogin.c, src/rlogind.c, src/rshd.c,
	src/syslogd.c, src/tftp.c, src/tftpd.c, src/traceroute.c,
	talk/ctl.c, talk/talk_ctl.h, telnet/krb4-proto.h, telnet/ring.c,
	telnet/ring.h: Silence Fix prohibit_dirent_without_use,
	sc_unsigned_short, sc_unsigned_long sc_unsigned_char checks.

2011-12-30  Alfred M. Szmidt  <ams@gnu.org>

	Fix sc_prohibit_test_minus_ao check.

	* tests/tftp.sh: Fix sc_prohibit_test_minus_ao check.
	* tests/syslogd.sh: Likewise.
	* tests/ftp-localhost.sh: Likewise.

2011-12-30  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (sc_unsigned_short): New target.

2011-12-30  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap: Updated from gnulib.
	* lib/Makefile.am: File removed.

2011-12-30  Mats Erik Andersson <gnu@gisladisker.se>

	* ftp/cmds.c (restart): Use `%lld' as format for long long int.
	* ftpd/ftpcmd.y (rcmd, sizecmd): Likewise; also `%llu'.
	* ftpd/ftpd.c (off_to_str): Likewise.
	* src/rcp.c (source): Likewise.

2011-12-25  Alfred M. Szmidt  <ams@gnu.org>

	* libtelnet/encrypt.c: Fix indentation, and Use ANSI style
	declarations for prototypes.
	(EncryptDisable, EncryptType, EncryptStart, encrypt_support)
	(encrypt_is, encrypt_reply, encrypt_keyid, encrypt_start_output)
	(encrypt_send_request_start, encrypt_wait, encrypt_printsub):
	Don't declare any variables as `register'.

2011-12-25  Alfred M. Szmidt  <ams@gnu.org>

	* libtelnet/encrypt.c (encrypt_keyid): Make sure that LEN never is
	greater than MAXKEYLEN.

2011-12-22  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/setsig.c (setsig) [HAVE_SIGACTION]: Initialize
	`osa.sa_mask' just to be sure.
	[HAVE_SIGVEC]: Likewise with `osv.sv_mask'.
	* src/rlogin.c: Many rewritten comments.
	(main): New variable OSMASK, used for old, saved signal mask.
	(setsignal): New variable OSIGS, likewise.
	(done): Use waitpid() instead of wait().
	(catch_child): Detect errno equal to EINTR.
	(doit, lostpeer): Let exit messages explain better.  Add host name
	to them, and append CR for correct printout.

2011-12-22  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/setsig.c (setsig) [HAVE_SIGACTION]: New variable
	OSA.  Superpose SA_RESTART on SA_FLAGS, no replacement!  Use OSA
	for old signal mask in calling sigaction.  Return SIG_ERR on
	error, or fetch old signal handler from OSA upon success.
	[HAVE_SIGVEC]: Likewise: New variable OSV.  Use OSV in call to
	sigvec.  Return SIG_ERR on error, or old handler brought in from
	OSV.

2011-12-20  Mats Erik Andersson <gnu@gisladisker.se>

	* src/rlogind.c (rlogind_auth) [IP_OPTIONS]: Abort connection as
	soon either of IPOPT_SSRR or IPOPT_LSRR is found.  Other options
	are recorded, and reported, but immediately erased.
	* src/rshd.c (doit) [IP_OPTIONS]: Likewise.
	[HAVE_NETINET_IN_SYSTM_H]: Include <netinet/in_systm.h>.
	[HAVE_NETINET_IP_H]: Include <netinet/ip.h>.
	* NEWS: Mention security issue inherent in source routing.
	* AUTHORS: Mention myself as contributing author.

2011-12-19  Mats Erik Andersson <gnu@gisladisker.se>

	* src/rcp.c (main) [!KERBEROS]: Exit at non-zero geteuid().
	(toremote): After setting IPTOS_THROUGHPUT, print warning only for
	ERRNO not equal to ENOPROTOOPT.
	(tolocal): Likewise.
	* src/rshd.c (doit): Remove misplaced syslog message.  Improve
	comments on port usage.

2011-12-13  Alfred M. Szmidt  <ams@gnu.org>

	Require automake 1.11.1.

	* bootstrap: Updated from gnulib.

	* bootstrap.conf (buildreq): Require automake 1.11.1.
	* configure.ac: Likewise.

2011-12-13  Mats Erik Andersson <gnu@gisladisker.se>

	* am/libcurses.m4 (IU_LIB_TERMCAP): Check libtermcap before
	libcurses.  New macros HAVE_TGETENT, HAVE_TERMCAP_TGETENT,
	HAVE_CURSES_TGETENT, and HAVE_TERMINFO_TGETENT.
	* am/readline.m4 (gl_FUNC_READLINE): In case libreadline is
	absent, check whether libedit is present and suffices.
	* telnet/telnet.c [HAVE_TERMCAP_TGETENT]: Include <termcap.h>.
	[HAVE_CURSES_TGETENT]: Include <curses.h> and <term.h>.
	(init_term) [HAVE_TGETENT]: Replace HAVE_READLINE by HAVE_TGETENT.
	* telnetd/utility.c [HAVE_TERMCAP_TGETENT]: Likewise.
	[HAVE_CURSES_TGETENT]: Likewise.
	(terminaltypeok) [HAVE_TGETENT]: Likewise.

2011-12-13  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: Check presence of directory `~ftp'.

2011-12-13  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/tftp.sh: Subtests for differing data transfer size.
	Portability fix for Solaris.

2011-12-11  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: Use strict IPv4 options for portability.
	* configure.ac: Check for iruserok.  Disable building of rshd and
	rlogind if it is missing.
	* NEWS, TODO: Updated.

2011-12-11  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: Replace `echo' with portable construct.

2011-12-10  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: Expand trapping to kill inetd process.
	* tests/syslogd.sh: Likewise.
	* tests/tftp.sh: Use a random testing directory and implement
	cleanup in a trapping function.

2011-12-09  Mats Erik Andersson <gnu@gisladisker.se>

	* telnet/Makefile.am (INCLUDES): Add $(NCURSES_INCLUDE) to list.
	* telnetd/Makefile.am: Likewise.
	* telnetd/utility.c (readstream) [HAVE_STREAMSPTY &&
	HAVE_TERMIO_H]: Make use of `struct termio' conditioned on
	HAVE_TERMIO_H.

2011-12-03  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh: Random test directory.  Identity from id(1).
	Trap exit conditions for clean up.

2011-12-02  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh: Match exact port number in regex pattern.
	* tests/tftp.sh: Likewise.

2011-12-02  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/ftp-localhost.sh: Portable invokation of mktemp(1).

2011-12-02  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Check for external declarations of `telcmds' and
	`telopts'.  Define UTMPX for NetBSD.
	* telnet/commands.c (send_tncmd) [!HAVE_DECL_TELOPTS]: Make the
	external declaration conditional.
	[HAVE_DECL_TELOPTS]: Enforce a cast `char **' on system's TELOPTS.

2011-12-01  Mats Erik Andersson <gnu@gisladisker.se>

	* ifconfig/ifconfig.c: Include <netinet/in.h>.
	* ifconfig/printif.h: Likewise.
	* ping/libping.c: Likewise.
	* src/hostname.c: Include <arpa/inet.h> after <netinet/in.h>.
	* tests/syslogd.sh: Extra long socket name only for known cases.
	Delay verbose version printing.  Clean up when port was busy.

2011-11-30  Mats Erik Andersson <gnu@gisladisker.se>

	OpenBSD 4.9 has changed <syslog.h>.  Relax configuration.

	* configure.ac (syslog internal macros): Remove check of
	LOG_MAKEPRI.
	* src/syslogd.c (LOG_MAKEPRI) [!LOG_MAKEPRI]: New macro.

2011-11-29  Alfred M. Szmidt  <ams@gnu.org>

	Basic test case for `hostname'.

	* tests/Makefile.am (dist_check_SCRIPTS) [ENABLE_hostname]: Added
	hostname.sh.
	* tests/hostname.sh: New file.

2011-11-29  Alfred M. Szmidt  <ams@gnu.org>

	* tests/syslogd.sh: Output verbose output if VERBOSE is true.

2011-11-29  Alfred M. Szmidt  <ams@gnu.org>

	Be more robust in checking for IPV6_HOPLIMIT, and
	IPV6_RECVHOPLIMIT.

	* configure.ac: Rewrite check for IPV6_HOPLIMIT,
	IPV6_RECVHOPLIMIT, and IPV6_2292HOPLIMIT.  Don't add X prefix to
	checks related to working_icmp6, have_beyondscope and ipv6.

2011-11-29  Giuseppe Scrivano  <gscrivano@gnu.org>

	* tests/syslogd.sh: Use 127.0.0.1 and [::1] instead of localhost
	as arguments to logger.

2011-11-29  Mats Erik Andersson <gnu@gisladisker.se>

	* whois/make_ip_del.pl: Compute netmasks correctly also with
	64-bit arithmetic.

2011-11-26  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/tftp.sh: Return skip code if INET port is already in use.
	* tests/syslogd.sh: Likewise.  Implement the corresponding test.
	(PORT, PROTO): New variables.

2011-11-26  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/tftp.sh (INETD_PID): New variable; allows better
	robustness.  Improve patterns to fit also BSD.

2011-11-26  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Check presence of <protocols/talkd.h>.  Disable
	building of `talk' and `talkd' if it is missing.
	* ftpd/Makefile.am (ftpd_SOURCES): Exclude unused `logwtmp.c'.
	* libinetutils/logwtmpko.c [HAVE_UTMPX_H && SOLARIS]: Include
	<utmpx.h>.
	[HAVE_UPDWTMP && SOLARIS]: Implement missing `logwtmp()'.

2011-11-21  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Do not check for <malloc.h>.
	* libinetutils/localhost.c [HAVE_MALLOC_H]: Do not include
	<malloc.h> and delete the conditional.
	* telnet/commands.c [HAVE_MALLOC_H]: Likewise.

2011-11-21  Mats Erik Andersson <gnu@gisladisker.se>

	* telnetd/telnetd.c (login_invocation) [SOLARIS]: Changes for
	terminal and user name.
	* TODO: Updated.

2011-11-21  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/syslogd.sh: Implement post-run cleanup.

2011-11-21  Mats Erik Andersson <gnu@gisladisker.se>

	* libtelnet/getent.c [HAVE_CGETENT]: Include <stdlib.h>.
	* telnet/sys_bsd.c (sendayt) [SIGINFO]: Missing declaration.
	* doc/inetutils.texi (telnet invocation): Minor fixes.
	* TODO: Updated.

2011-11-19  Mats Erik Andersson <gnu@gisladisker.se>

	* TODO: Updated.

2011-11-19  Simon Josefsson  <simon@josefsson.org>

	* TODO: Updated.

2011-11-19  Simon Josefsson  <simon@josefsson.org>

	* README (Notes): Doc fix.

2011-11-19  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (gnulib_modules): Remove readline.
	* configure.ac: Search for readline.
	* ftp/cmds.c: Unconditionally include readline headers.
	* ftp/main.c: Likewise.
	* am/readline.m4: New file.

2011-11-19  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (/m4): Added to list.
	* bootstrap.conf (gnulib_modules): Don't try to create m4/ for
	./bootstrap.

	* configure.ac: Add check for IPV6_2292HOPLIMIT.

2011-11-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (sc_unsigned_char, sc_unsigned_long): New targets.

2011-11-19  Mats Erik Andersson <gnu@gisladisker.se>

	* telnet/telnet.c [HAVE_READLINE]: Replace previous use of
	HAVE_LIBREADLINE for header inclusion and code protection.
	* telnetd/utility.c [HAVE_READLINE]: Likewise.

2011-11-19  Simon Josefsson  <simon@josefsson.org>

	* tests/Makefile.am (dist_check_SCRIPTS): Add ftp-localhost.sh.
	* tests/ftp-localhost.sh: New file.

2011-11-19  Simon Josefsson  <simon@josefsson.org>

	* ftp/cmds.c [HAVE_READLINE_HISTORY_H]: Include
	<readline/history.h>.
	* ftp/main.c: Likewise.

2011-11-18  Simon Josefsson  <simon@josefsson.org>

	* ftp/cmds.c: Replace complex readline #includes with simple
	include of gnulib's readline.h.
	(another): Assume libreadline has add_history.
	* ftp/main.c: Likewise.
	* configure.ac: Remove obsolete readline checks (we now use
	gnulib's readline module).

2011-11-17  Mats Erik Andersson <gnu@gisladisker.se>

	* telnet/telnet.c [HAVE_LIBREADLINE]: Include <curses.h>.
	* telnetd/utility.c [HAVE_LIBREADLINE]: Likewise.
	[HAVE_STREAMSPTY && HAVE_GETMSG && HAVE_STROPTS_H]: Include
	<stropts.h>.
	* telnetd/state.c [HAVE_STREAMSPTY && TIOCSIGNAL &&
	HAVE_STROPTS_H]: Likewise.
	(NTELOPTS) [!NTELOPTS]: New macro.

2011-11-14  Simon Josefsson  <simon@josefsson.org>

	* README (Notes): Doc fix.

2011-11-14  Bruno Haible <bruno@clisp.org>  (tiny change)

	* telnet/Makefile.am (LDADD): Add LIBREADLINE, for tgetent on
	Solaris.
	* telnetd/Makefile.am (LDADD): Likewise.

2011-11-14  Simon Josefsson  <simon@josefsson.org>

	* src/Makefile.am (logger_SOURCES): Add logprio.h.

2011-11-14  Simon Josefsson  <simon@josefsson.org>

	* ping/ping.c: New variable.
	(argp_options): Add parameter -W aka --linger.
	(parse_opt): Parse -W parameter.
	(ping_run): Use linger parameter.
	* doc/inetutils.texi (ping invocation): Doc fix.
	* NEWS: Likewise.

2011-11-12  Simon Josefsson  <simon@josefsson.org>

	* .gitignore, doc/.gitignore: Update from gnulib-tool.
	* NEWS: Add.

2011-11-11  Mats Erik Andersson <gnu@gisladisker.se>

	* doc/inetutils.texi (Introduction): White space.
	(Common options): Mention `--usage'.  Replace brackets.
	(Exit status): Spacing around `---'.
	(telnetd invocation): Several corrections.
	* telnetd/telnetd.c (argp_options): Remove duplicate space.

2011-11-09  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (create_unix_socket): Avoid buffer overrun for
	very long UNIX socket names.  Return proper error codes also when
	bind() or chmod() fail.
	* tests/syslogd.sh: Implement tests for the boundary cases of very
	long UNIX socket names.

2011-10-31  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (Top): Remove 'Concept Index'.  Doc fix.
	(Introduction): Doc fix.
	(Concept Index): Removed chapter, not used properly.
	(Index): Remove incorrect description text.

2011-10-31  Simon Josefsson  <simon@josefsson.org>

	* tests/.gitignore: Add addrpeek.

2011-10-31  Simon Josefsson  <simon@josefsson.org>

	* cfg.mk (local-checks-to-skip): Add sc_bindtextdomain.
	(exclude_file_name_regexp--sc_prohibit_have_config_h): New
	variable, to silence syntax-check warning.

2011-10-29  Mats Erik Andersson <gnu@gisladisker.se>

	* src/tftp.c (peeraddr): Change to `struct sockaddr_storage'.
	(peerlen): New variable.
	(port): Changed to use host byte order.
	(get_port, set_port): New functions.
	(main): Remove SIN.  Do not initiate F as a socket.
	(resolve_name): New signature `int r_n (char *)'.  Remove unused
	return state RESOLVE_NOT_RESOLVED.  Replace use of gethostbyname()
	by code based on getaddrinfo().
	(setpeer): Simplifications brought in by resolve_name() and PORT.
	(put): Handle square bracket escaping of host address.  Use new
	function set_port().
	(get): Likewise.
	(send_file): Change FROM to be `struct sockaddr_storage'.  Use
	PEERLEN in sendto().  Use set_port() and get_port().
	(recvfile): Likewise.
	(nak): Use PEERLEN in sendto().
	* doc/inetutils.texi (tftp): Mention escaping of IPv6 addresses.

2011-10-29  Mats Erik Andersson <gnu@gisladisker.se>

	* src/tftp.c (main): New variable SP.  Set default value for PORT.

2011-10-28  Simon Josefsson  <simon@josefsson.org>

	* cfg.mk (_build-aux): Add variable, gnulib now needs this for
	syntax-check.

2011-10-27  Mats Erik Andersson <gnu@gisladisker.se>

	* src/tftpd.c (main) [HAVE_STRUCT_SOCKADDR_SA_LEN]: Assign value
	to `sin.ss_len'.
	(main): Do not use connect() on the socket.
	(send_file, recvfile, nak): Replace send() by sendto().

2011-10-27  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac (HAVE_STRUCT_TFTPHDR_TH_U): Detect whether `struct
	tftphdr' contains a member `th_u'.
	* src/tftp.c (makerequest, tpacket) [HAVE_STRUCT_TFTPHDR_TH_U]:
	Use pointer variable `tp->th_stuff', or generate a correct
	pointer.
	* src/tftpd.c (tftp) [HAVE_STRUCT_TFTPHDR_TH_U]: Likewise.

2011-10-27  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/Makefile.am (INCLUDES): Add -I$(top_srcdir) to list.

2011-10-26  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap.conf (gnulib_modules): Add ioctl to list.

	* ftpd/Makefile.am (LDADD): Put iu_LIBRARIES as last element of
	LDADD.

	* libicmp/icmp_timestamp.c: Include <stddef.h>; reverts parts of
	2011-10-15.
	* libicmp/icmp_address.c: Do not include <stddef.h>.  Revert
	change of 2011-10-25.

2011-10-25  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Pass regexp to git-version-gen to get version tag.
	Use AC_CONFIG_HEADER instead of AM_CONFIG_HEADER.

2011-10-25  Alfred M. Szmidt  <ams@gnu.org>

	New variables (iu_LIBRARIES and iu_INCLUDES ) for specifying core
	inetutils libraries and header files in Makefile.am.

	* configure.ac (iu_INCLUDES, iu_LIBRARIES): New variables.

	* whois/Makefile.am (INCLUDES, LDADD): Use $(iu_INCLUDES) and
	$(iu_LIBRARIES), respectivley.
	* tests/Makefile.am (AM_CPPFLAGS, LDADD): Likewise.
	* ifconfig/Makefile.am (INCLUDES, LDADD): Likewise.
	* ftp/Makefile.am (INCLUDES, LDADD): Likewise.
	* ftpd/Makefile.am (INCLUDES, LDADD): Likewise.
	* talkd/Makefile.am (INCLUDES, LDADD): Likewise.
	* talk/Makefile.am (INCLUDES, LDADD): Likewise.

	* telnetd/Makefile.am (INCLUDES): Use $(iu_INCLUDES).
	(LDADD): Use $(iu_LIBRARIES) and explicitly use static version of
	libtelnet.
	* telnet/Makefile.am (INCLUDES, LDADD): Likewise.
	* src/Makefile.am (INCLUDES): Use $(iu_INCLUDES).
	(LDADD): Use $(iu_LIBRARIES) and explicitly use static version of
	libicmp.
	* ping/Makefile.am (ping_LDADD): Use $(iu_LIBRARIES) and
	explicitly use static version of libicmp.
	(INCLUDES, ping6_LDADD): Use $(iu_INCLUDES) and $(iu_LIBRARIES),
	respectivley.

	* libtelnet/Makefile.am (INCLUDES): Use $(iu_INCLUDES).
	* libls/Makefile.am (INCLUDES): Likewise.
	* libinetutils/Makefile.am (libinetutils_a_LIBADD): Variable
	removed.
	(INCLUDES): Use $(iu_INCLUDES).

2011-10-25  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Don't try to define ARG_UNUSED macro.

2011-10-25  Alfred M. Szmidt  <ams@gnu.org>

	* libicmp/icmp_address.c: Include <stddef.h>; reverts parts of
	2011-10-15.

2011-10-24  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (buildreq): Lowered build requirement of autoconf
	to 2.59.

2011-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* README-alpha: Don't mention gettext and libtool as build
	requirements.

2011-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (buildreq): New variable.
	(bootstrap_sync): Likewise.

2011-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* README-prereq: New file.
	* README-alpha: Mention that help2man is required for building.

2011-10-23  Alfred M. Szmidt  <ams@gnu.org>

	Updated ./bootstrap.

	* bootstrap: Updated from gnulib (2011-10-23).
	* bootstrap.conf (ACLOCAL_FLAGS): New variable.
	* Makefile.am (AUTOMAKE_OPTIONS): Removed variable.
	(ACLOCAL_AMFLAGS): Removed variable.

2011-10-21  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/tftpsubs.c (PKTSIZE) [PKTSIZE]: Only define PKTSIZE
	if needed.
	* src/tftp.c, src/tftpd.c: Likewise.

2011-10-19  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/telnetd.h [HAVE_STROPTS_H && !HAVE_IOCTL]: Only include
	<stropts.h> if HAVE_IOCTL wasn't defined.

2011-10-15  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (gnulib, gnulib/, .sc-start-sc_bindtextdomain)
	(.sc-start-sc_prohibit_have_config_h, lib/, !lib/Makefile.am):
	Added to list.

2011-10-15  Alfred M. Szmidt  <ams@gnu.org>

	Clean up (some) `make syntax-check' errors.

	* src/syslogd.c (init): Removed redundant if statment before free
	call (was reintroduced 2011-06-20).
	* libicmp/icmp_timestamp.c: Don't include <stddef.h>.
	* src/syslogd.c (cfline): Removed redundant parentehsis around
	macros.

2011-10-15  Alfred M. Szmidt  <ams@gnu.org>

	* src/inetd.c (argp_options) <pidfile>: Updated doc. string.

2011-10-11  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ping/ping.c (parse_opt): Make `pattern' static.
	* ping/ping6.c (parse_opt): Likewise.

2011-09-01  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (BindAddress): New variable.
	(finet): Replace by two-element vector of same name.
	(argp_options): New options: "ipv4", "ipv6", "ipany", "bind".
	(parse_opt): Likewise.
	(main): Adaptions to the vector `finet[2]'.
	(create_inet_socket): New prototype `void c_i_s (int, int [2])'.
	Separate address families.  Use BINDADDRESS at resolve time.
	(fprintlog): Temporary socket by family; use descriptor pointer.
	(die): Close both internet sockets.
	* doc/inetutils.texi (syslogd): Update capabilities and options
	for the server `syslogd'.
	* tests/syslogd.sh: Adapt server options for IPv6.

2011-08-20  Mats Erik Andersson <gnu@gisladisker.se>

	* src/logger.c (send_to_syslog, parse_opt) [LOG_PERROR]: Enclose
	every reference to LOG_PERROR in a compiler conditional.
	* src/logprio.h: New file.
	* src/logger.c [!HAVE_SYSLOG_INTERNAL]: Include "logprio.h"
	instead of the irregularly present <syslog-int.h>.
	* src/syslogd.c: Likewise.

2011-08-20  Mats Erik Andersson <gnu@gisladisker.se>

	* ftp/ftp.c (hookup): Remove length in format string.
	* ifconfig/printif.c [HAVE_ALLOCA_H]: Include <alloca.h>.
	* src/rexec.c: Include "minmax.h".
	* libls/fts.c (fts_load): Replace `rindex' with `strrchr'.
	* ping/ping_echo.c (ping_echo): Write non-empty error text.
	* ping/ping6.c (parse_opt, ping_init): Likewise.
	* ping/ping6.c [__sun__]: Define _XPG4_2 for access to
	`msg_control'.

2011-08-18  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/utmp_logout.c (utmp_logout) [UTMPX]: Insert missing
	variable TV in right-hand side.

2011-08-17  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap.conf (gnulib_modules): Use snippet/unused-parameter
	instead of unused-parameter.  It tracks a gnulib change.

2011-07-28  Mats Erik Andersson <gnu@gisladisker.se>

	* ftpd/ftpd.c (getdatasock): Misnamed variable DATA_SOURCE.

2011-07-25  Mats Erik Andersson <gnu@gisladisker.se>

	* ftpd/ftpd.c (getdatasock) [HAVE_STRUCT_SOCKADDR_IN_SIN_LEN]:
	Assign value to structure member `sin_len'.
	* ftpd/server_mode.c (server_mode) [HAVE...SIN_LEN]: Likewise.
	* ftpd/ftpcmd.y (host_port) [HAVE...SIN_LEN]: Likewise.

2011-07-17  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (LogPort): Remove variable.
	(main): Initialize INET socket based only on ACCEPTREMOTE.
	(fprintlog): Implement forwarding independently of any INET
	listener.  A socket using TEMP_FINET is initialized as needed.
	(init): Remove call to `getservbyname()' and variable SP.  They
	are no longer needed and accidential config loss is now avoided.

2011-07-13  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (cfline): Prevent incrementing beyond string end.
	Discard config line with empty action.
	* tests/syslogd.sh: Three new degenerate config lines.

2011-06-20  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c: Replace all `struct sockaddr_in' with `struct
	sockaddr_storage'; provide `socklen_t' where needed.  Replace
	`gethostbyname', `struct hostent' with `getaddrinfo' and `struct
	addrinfo'.
	(struct filed): In `struct f_forw', use `struct sockaddr_storage'
	and `socklen_t'.
	(addrstr, addrname, usefamily, LogPortText): New variables.
	(main): Call `create_inet_socket' with parameter USEFAMILY.
	(create_inet_socket): New parameter list `int' with address
	family.  Enforce `IPV6_ONLY' for family `AF_INET6'.
	(cvthname): New parameter list `struct sockaddr *, socklen_t'.
	Replace `inet_ntoa' and `gethostbyaddr' by two applications of
	`getnameinfo'.
	(init): Use LOGPORTTEXT to determine listening port.  Sanity check
	on `f->f_prevhost' before freeing memory.
	* tests/syslogd.sh [REMOTE_LOGHOST]: Include a loghost setting.

2011-06-18  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added mkstemp to list.

2011-06-18  Alfred M. Szmidt  <ams@gnu.org>

	* tests/syslogd.sh: Changed permission on file to be executable.

2011-06-18  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added unused-parameter to list.

	* libtelnet/Makefile.am (INCLUDES): Added "-I$(top_srcdir)/lib
	-I../lib" to list.
	* src/Makefile.am (INCLUDES): Added -I$(top_builddir)/lib to list.

	* talkd/talkd.c: Include "unused-parameter.h".  Replaced all usage
	of ARG_UNUSED with _GL_UNUSED_PARAMETER.
	* talkd/table.c: Likewise.
	* talk/init_disp.c: Likewise.
	* src/syslogd.c: Likewise.
	* src/rlogind.c: Likewise.
	* src/rlogin.c: Likewise.
	* src/inetd.c: Likewise.
	* libtelnet/auth.c: Likewise.
	* ftpd/server_mode.c: Likewise.
	* ftpd/ftpd.c: Likewise.
	* ftp/main.c: Likewise.
	* ftp/ftp.c: Likewise.
	* ftp/cmds.c: Likewise.

2011-06-18  Alfred M. Szmidt  <ams@gnu.org>

	* whois/whois.h: Replace RETSIGTYPE with void; this is old K&Rism.
	* whois/whois.c: Likewise.
	* telnet/sys_bsd.c: Likewise.
	* talk/invite.c: Likewise.
	* talk/init_disp.c: Likewise.
	* src/syslogd.c: Likewise.
	* src/rsh.c: Likewise.
	* src/rlogind.c: Likewise.
	* src/rlogin.c: Likewise.
	* src/rcp.c: Likewise.
	* src/inetd.c: Likewise.
	* ping/ping6.c: Likewise.
	* ping/ping.c: Likewise.
	* libtelnet/auth.c: Likewise.
	* libinetutils/daemon.c: Likewise.

2011-06-18  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Use malloc-gnu and realloc-gnu
	instead of the old malloc and realloc modules.

2011-06-17  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/libinetutils.h: Don't include <config.h>; instead
	produce an error if we haven't included it.

2011-06-17  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added signal to list.

2011-06-16  Simon Josefsson  <simon@josefsson.org>

	* configure.ac: Don't check for sig_t.
	* libinetutils/setsig.c (setsig): Use sighandler_t instead of
	sig_t.  Reported by Mats Erik Andersson <gnu@gisladisker.se>.
	* ftp/cmds.c (mput, mget, mdelete, mls, shell, doproxy): Likewise.
	* ftp/ftp.c (command, getreply, sendrequest, recvrequest)
	(pswitch, proxtrans): Likewise.
	* src/rlogin.c (setsignal): Likewise.
	* src/rcp.c (susystem): Likewise.

2011-06-15  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (fprintlog): Sanity check on `f->f_prevhost' to
	avoid deferencing NULL.
	(cfline): A permanently failed DNS lookup must produce F_UNUSED.
	* tests/syslogd.sh: New file.
	* tests/Makefile.am (dist_check_SCRIPTS) [ENABLE_logger &&
	ENABLE_syslogd]: Add `syslogd.sh'.

2011-06-08  Alfred M. Szmidt  <ams@gnu.org>

	* tests/tftp.sh: Skip test if we cannot execute netstat.  Enable
	verbose execution of test as early as possible.

2011-06-05  Alfred M. Szmidt  <ams@gnu.org>

	Clean up `make syntax-check' errors.

	* tests/addrpeek.c: Include <config.h> instead of "config.h".
	(main): Call set_program_name.

	* src/syslogd.c (init): Removed redundant if statment before free
	call.

	* libls/stat_flags.c: Don't include <stddef.h>.

	* ifconfig/changeif.c (set_address): Fix typo.
	* src/logger.c (parse_opt): Likewise.
	* src/rlogin.c: Likewise.
	* talk/invite.c (answers): Likewise.

	* ftp/ftp.c: Removed redundant parentehsis in #if guard.

2011-06-05  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Don't check for <osockaddr.h>.
	* talkd/intalkd.h [HAVE_OSOCKADDR_H]: Don't include <osockaddr.h>.
	* talk/look_up.c: Likewise.
	* talk/invite.c: Likewise.
	* talk/get_names.c: Likewise.
	* talk/get_addrs.c: Likewise.
	* talk/ctl_transact.c: Likewise.
	* talk/ctl.c: Likewise.

2011-05-09  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (gnulib_modules): Removed 'exit' from list.
	(gnulib_modules): Remove 'strcase' from list (not needed anymore,
	according to gnulib documentation).

2011-05-06  Mats Erik Andersson <gnu@gisladisker.se>

	* doc/inetutils.texi (ftp invocation): Document new capabilities
	related to the recent IPv6 code.  A single old misprint.

2011-05-06  Mats Erik Andersson <gnu@gisladisker.se>

	* ftp/extern.h (setipany, setipv4, setipv6): New prototypes.
	* ftp/cmdtab.c (ipanyhelp, ipv4help, ipv6help): New help texts.
	(cmdtab): Register commands `ipany', `ipv4', and `ipv6'.
	* ftp/cmds.c (status): Report address family.
	(setipany, setipv4, setipv6): New functions.

2011-05-06  Mats Erik Andersson <gnu@gisladisker.se>

	* src/syslogd.c (fprintlog): Deallocate pointers F_HNAME or
	F_FNAME when F_TYPE is invalidated as F_UNUSED.
	(cfline): Likewise.
	(init): Deallocate F_FNAME, F_HNAME, F_UNAMES, and F_PREVHOST
	before reclaiming the pointer F.

2011-04-17  Mats Erik Andersson <gnu@gisladisker.se>

	* ftp/ftp_var.h (usefamily): New variable.
	* ftp/main.c (argp_options): New options `ipv4` and `ipv6`.
	(parse_opt): Parse cases '4' and '6', set USEFAMILY accordingly.
	(main): Initialize USEFAMILY to `AF_UNSPEC`.
	* ftp/ftp.c (hookup): Resolve addresses according to USEFAMILY.
	Use macro AI_ADDRCONFIG only with family `AF_UNSPEC`.
	(initconn): New IPv6 protocol methods `EPSV` and `LPSV`.  New
	variable DATA_ADDR_SA6.
	(initconn) [noport]: New IPv6 methods `EPRT` and `LPRT`.

2011-04-08  Mats Erik Andersson <gnu@gisladisker.se>

	* ftp/cmds.c (setepsv4): New function.
	(setpeer): Use the variable PORT in host byte order.
	(status): New status message, based on DOEPSV4.
	* ftp/cmdtab.c (epsv4help): New string variable.
	(cmdtab): New command `epsv4` inserted.
	* ftp/extern.h (setepsv4): New declaration.
	* ftp/ftp_var.h (doepsv4): New variable.
	* ftp/main.c (main): Initiate DOEPSV4 to `off`.
	* ftp/ftp.c: Explicitly condition IP_TOS on address family
	AF_INET.  Replace `struct sockaddr_in` by `struct
	sockaddr_storage`.  Always use CTLADDRLEN when referencing address
	lengths.
	(ctladdrlen, ia, portstr): New variables.
	(FTP_CONNECT_TIMEOUT): New macro.
	(hookup): Replace resolver `gethostbyname` by `getaddrinfo`.  A
	timed alarm interrupts any slow connection attempt.
	(getreply): New server return codes for `LPSV` and `EPSV`.
	(initconn): New protocol methods `EPSV` and `LPSV`.
	(initconn) [noport]: Trivial switch statement on `AF_INET`.  New
	protocol methods `EPRT` and `LPRT`.

2011-03-27  Mike Frysinger  <vapier@gentoo.org>

	* configure.ac: Use AC_CANONICAL_HOST instead of
	AC_CANONICAL_SYSTEM.

2011-03-27  Mike Frysinger  <vapier@gentoo.org>

	* ftpd/server_mode.c: Include <libinetutils.h>.
	(server_mode): Changed prototype to ` int server_mode (const char
	*pidfile, struct sockaddr_in *phis_addr, char *argv[])'.  Handle
	systems that do not have fork().
	* ftpd/extern.h (server_mode): Updated prototype.
	* ftpd/ftpd.c (main): Handle systems that do not have fork().

2011-03-27  Mike Frysinger  <vapier@gentoo.org>

	* libinetutils/libinetutils.h: Include <config.h>.
	(fork_exit, fork): New macros.
	* configure.ac: Check for presence of fork().

2011-01-26  Mats Erik Andersson <gnu@gisladisker.se>

	* src/traceroute.c (main): Remove test on geteuid().

2011-01-25  Mats Erik Andersson <gnu@gisladisker.se>

	* src/logger.c (host_family) [HAVE_DECL_GETADDRINFO]: New
	variable.
	(struct logger_sockaddr) [HAVE_IPV6]: New component SINET6.
	(open_socket) [HAVE_DECL_GETADDRINFO]: Implement new code based on
	getaddrinfo.  Reorganize old handler of port specification.
	(argp_options): New options `--ipv4' and `--ipv6`.
	(parse_opt): Implement parsing of new options.
	* doc/inetutils.texi (logger): Describe implications of
	IPv6-support and fallback.  Small corrections to example usage.

2010-12-21  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (pidfile_option): New variable.
	(pid_file): New variable.
	(argp_options): Add an option for replacing file name of PID file.
	(parse_opt): Handle option `p'.
	(main): Condition PID file use on PIDFILE_OPTION.  Replace the
	macro PATH_INETDPID by variable PID_FILE.

2010-12-21  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (inetd_getaddrinfo): If IPV6, then add a flag
	AI_NUMERICHOST if the node is a numeric address string.  New
	variable NUMERIC_ADDRESS.  Debug symbolic addresses.
	(getconfigent): Replace `strchr' with `strrchr'.

2010-12-21  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (print_service): If `ISMUX(SEP)' then present the
	node name as `tcpmux' or as `tcpmuxplus'.  Make 'builtin=' show
	actual service name, or `no' for non-builtins.
	(fix_tcpmux): Let SERV.se_file report `fix_tcpmux' as origin.
	Correct some spelling mistakes in error message.

2010-12-21  Mats Erik Andersson <gnu@gisladisker.se>

	* tests/addrpeek.c: New file.
	* tests/Makefile.am: Register `addrpeek' using `check_PROGRAMS',
	but conditioned on `ENABLE_inetd'.

2010-12-21  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (prepenv): New prototype: `prepenv(int, struct
	sockaddr *, socklen_t)'.
	(prepenv): Change type of IP to `char []' of fixed length.  Delete
	HOST.  New integer variable RET.  Make type of SA_SERVER depend on
	macro IPV6, either `struct sockaddr_storage' or `struct
	sockaddr_in'.
	(prepenv): Eliminate use of `inet_ntoa' and `gethostbyaddr' by new
	calls to `getnameinfo', with and without restiction to numeric
	results.  Debugging output for three select environment variables.
	(main): Make type of SA_CLIENT depend on macro IPV6, either
	`struct sockaddr_storage' or `struct sockaddr_in'.  Adaptions to
	the new prototype for `prepenv'.

2010-12-04  Mike Frysinger <vapier@gentoo.org>  (tiny change)

	* man/Makefile.am (dist_man1_MANS): Renamed to dist_man_MANS.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	* src/traceroute.c: Include "xalloc.h".
	* src/traceroute.c (host): Deleted variable.
	(hostname, addrstr): New variables;
	(parse_opt) [ARGP_KEY_ARG]: Abolish gethostbyname.  Only use
	xstrdup to copy argument.
	(main): Use getaddrinfo and getnameinfo for name resolving.  New
	variables HINTS and *RES of type `struct addrinfo'.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	Resolve a double free issue.  Leads to segmentation faults.

	* src/inetd.c (nextconfig): Do not use `freeconfig'
	unconditionally.  Condition on SERV_NODE, which needs partial
	memory deallocation.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	Partially revert changes introduced in fd64a202.

	* src/inetd.c (nextconfig): Call `enter' for TCPMUX services, but
	`expand_enter' for every other service.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (inetd_getaddrinfo): Do not use AI_V4MAPPED with
	address family AF_INET.  FreeBSD fails otherwise.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	* ifconfig/flags.c (flag_char_tab): Protect the uses of
	IFF_NOTRAILERS by `#ifdef'.

2010-11-22  Mats Erik Andersson <gnu@gisladisker.se>

	Regression caused by fe539ae9...797d881c

	* src/traceroute.c: Revert change from 2010-10-31.  Change element
	`ttl' in `struct trace' to be plain `int'.
	(trace_init): Change type of TTLP to be `const int *'.  Use
	`sizeof (*ttlp)' in both calls to setsockopt.
	(trace_inc_ttl): Likewise.

2010-11-21  Mike Frysinger <vapier@gentoo.org>

	* configure.ac: Check for __rcmd_errstr.
	* src/rshd.c (doit): Protect declaration and use of __rcmd_errstr
	variable with HAVE___RCMD_ERRSTR check.

2010-11-19  Mike Frysinger <vapier@gentoo.org>

	* ftp/extern.h: Rename function ruserpass to remote_userpass.
	* ftp/ftp.c (login): Call remote_userpass instead of ruserpass.
	* ftp/ruserpass.c (remote_userpass): Renamed from ruserpass.

2010-10-31  Mats Erik Andersson <gnu@gisladisker.se>

	* ifconfig/if_index.c (if_nametoindex, if_freenameindex)
	(if_nameindex): Provide functions only if HAVE_STRUCT_IF_NAMEINDEX
	isn't defined.

2010-10-31  Mats Erik Andersson  <gnu@gisladisker.se>

	libinetutils: UTMP fixes for OpenBSD.

	* libinetutils/utmp_init.c [HAVE_UTIL_H]: Include <util.h>.
	(utmp_init): Only use UTX.ut_host if HAVE_STRUCT_UTMP_UT_NAME ||
	HAVE_STRUCT_UTMPX_UT_NAME are defined.
	[HAVE_STRUCT_UTMP_UT_HOST]: Initialise USER using UTX.ut_host.
	Call pututline()/endutent() only if HAVE_DECL_GETUTENT is defined,
	otherwise use login().
	* libinetutils/cleansess.c [HAVE_UTIL_H]: Include <util.h>.
	* libinetutils/utmp_logout.c [HAVE_UTIL_H]: Include <util.h>.
	Call getutline() only if HAVE_DECL_GETUTENT is defined, otherwise
	use logout().

2010-10-31  Alfred M. Szmidt  <ams@gnu.org>

	Use git-version-gen to extract version number.

	* .gitignore (.tarball-version, .version): Added to list.
	* configure.ac: Use git-version-gen to extract version number.
	* bootstrap.conf (gnulib_modules): Added git-version-gen to list.

	* Makefile.am (BUILT_SOURCES): New variable.
	($(top_srcdir)/.version, dist-hook): New targets.

	* bootstrap.conf (gnulib_modules): Removed unlocked-io from list.

2010-10-31  Mats Erik Andersson  <gnu@gisladisker.se>

	traceroute: Pass integer values to IP_TTL option.

	* src/traceroute.c (trace_init): Renamed TTLP to TTL, and changed
	type to `int'.
	(trace_inc_ttl): Likewise.

2010-10-31  Mats Erik Andersson  <gnu@gisladisker.se>

	Calculate socket length using sockaddr.

	* src/inetd.c: New element `se_addrlen' in `struct servtab'.
	(expand_enter): Record in SE_ADDRLEN the actual length of each
	established control address.
	(setup): Use the exact address length in call to bind(3).

2010-10-31  Mats Erik Andersson  <gnu@gisladisker.se>

	Improve the test suite.

	* tests/tftp.sh: Make it robust and portable to GNU/Linux and BSD.
	* tests/ping-localhost.sh: Test `ping' and `ping6'.
	* tests/traceroute-localhost.sh: Test UDP and ICMP.

2010-10-31  Ludovic CourtÃ¨s  <ludo@gnu.org>

	tftp: Resolve the "tftp" service only when no port is specified.

	* src/tftp.c: Include <error.h>.
	(port): Change from `short' to `int'.
	(sp): Remove variable.
	(main): Don't call `getservbyname'.
	(setpeer): Call `getservbyname' when ARGC != 3.
	(put, get): Refer to PORT instead of SP->s_port.

2010-10-27  Mats Erik Andersson <gnu@gisladisker.se>
	    Simon Josefsson  <simon@josefsson.org>

	* telnetd/telnetd.c (telnetd_setup): Pass correct length of saddr
	to getnameinfo calls.

2010-10-26  Mats Erik Andersson <gnu@gisladisker.se>

	* telnetd/telnetd.c (telnetd_setup): Really use LEN as size of
	address.

2010-10-19  Alfred M. Szmidt  <ams@gnu.org>

	Added gendocs module for generation of web manual.

	* doc/.gitignore: Ignore gendocs_template.
	* cfg.mk (manual_title): New variable.
	* bootstrap.conf (gnulib_modules): Added gendocs to list.

2010-10-19  Ludovic CourtÃ¨s  <ludo@gnu.org>

	Add `tftpd' and `tftp' test.

	* tests/Makefile.am (dist_check_SCRIPTS) [ENABLE_inetd &&
	ENABLE_tftpd && ENABLE_tftp]: Add `tftp.sh'.
	* tests/tftp.sh: New file.

2010-10-19  Alfred M. Szmidt  <ams@gnu.org>

	Silence sc_program_name errors.

	* cfg.mk (local-checks-to-skip): Removed sc_program_name from
	list.
	* tests/localhost.c: Include <progname.h>.
	(main): Set type to `int main (int argc, char **argv)'.  Call
	set_program_name.
	* talkd/talkd.c: Include <progname.h>.
	(main): Call set_program_name.
	* libinetutils/argcv.c: Include <progname.h>.
	(main): Set type to `int main (int argc, char **argv)'.  Call
	set_program_name.
	* ifconfig/options.c (parse_cmdline): Removed call to
	set_program_name.
	* ifconfig/ifconfig.c: Include <progname.h>
	(main): Call set_program_name.

	* bootstrap.conf (gnulib_modules): Added git-merge-changelog to
	list.

2010-10-18  Alfred M. Szmidt  <ams@gnu.org>

	Always use <termios.h> interface.

	* telnetd/term.c: Always use <termios.h> interface.
	* telnetd/telnetd.h [!HAVE_TERMIO_H]: Don't include <termio.h>
	[!HAVE_TERMIO_H && !HAVE_TERMIO_H]: Don't include <sgtty.h>.
	* telnet/externs.h (USE_TERMIO): Uncondtionally define macro.
	(SYSV_TERMIO) [!HAVE_TERMIOS_H && HAVE_TERMIO_H]: Undefine macro.

	* talk/init_disp.c [!HAVE_TERMIOS_H]: Don't include <sys/ioctl.h>.
	[!HAVE_TERMIOS_H && HAVE_SYS_IOCTL_COMPAT_H]: Don't include
	<sys/ioctl_compat.h>.

	* libls/ls.c: Unconditionally include <termios.h>

	* src/uucpd.c: Likewise.

	* configure.ac: Removed checks for termios.h and termio.h specifc
	functions, variables and headers.

	* bootstrap.conf (gnulib_modules): Added termios module.

2010-10-18  Mats Erik Andersson <gnu@gisladisker.se>

	* libinetutils/tftpsubs.c (synchnet): Changed type of FROM to be
	"struct sockaddr_storage".

	* src/tftpd.c: Changed all uses of "struct sockaddr_in" to be
	"struct sockaddr_storage".
	(fromlen): Meticulously tracks length of address structure FROM in
	every function.
	(verifyhost): Expanded declaration signature to be "(struct
	sockaddr_storage *, socklen_t)".  Use getnameinfo(3) as resolver.
	(tftp) <logging>: Now displays address family "IPv4", "IPv6", or
	"?".

2010-10-18  Mats Erik Andersson <gnu@gisladisker.se>

	* ifconfig/printif.c (put_flags): Declare F as `unsigned short
	int'.
	(put_int): Parse H, h, and # modifiers.
	* ifconfig/options.c (formats) <unix>: Fix formating.
	* ifconfig/flags.c (flag_char_tab) [IFF_SIMPLEX]: New member
	IFF_SIMPLEX

2010-10-18  Guillem Jover  <guillem@hadrons.org>

	* configure.ac: Remove opie AC_CHECK_LIB check.

2010-10-18  Guillem Jover  <guillem@hadrons.org>

	* src/inetd.c (nextconfig): Call expand_enter instead of enter for
	tcpmux services.
	(fix_tcpmux): Likewise.

2010-10-18  Guillem Jover  <guillem@hadrons.org>

	* src/inetd.c (getconfigent): If se_argc == 1 inject the
	normalized se_server name into se_argv[0].

2010-10-18  Guillem Jover  <guillem@hadrons.org>

	* src/inetd.c (getconfigent) [IPV6]: Change default family to IPv4
	for "tcp" and "udp".  Change "tcp6" and "udp6" to support IPv4
	mapped addresses.  Add "tcp6only" and "udp6only" protocols for
	IPv6 only addresses.
	(fix_tcpmux) [IPV6]: Set se_proto to "tcp6".
	[!IPV6]: Set se_proto to "tcp".

2010-10-01  Mats Erik Andersson <gnu@gisladisker.se>

	* src/inetd.c (setup, expand_enter, getconfigent, prepenv): Fix
	comments.

2010-09-18  Mats Erik Andersson <gnu@gisladisker.se>

	* ping/ping6.c: Include <sys/uio.h> for knowing "struct iov" in
	BSD.
	* ping/ping6.c (ping_init): Check for EACCES failure from
	socket(2).
	* ping/libping.c (ping_init): Likewise.

2010-09-23  Mats Erik Andersson <gnu@gisladisker.se>

	* ifconfig/system/linux.c (linux_if_nameindex): Express the exact
	amount remaining of the string when locating next token.

2010-09-28  Mats Erik Andersson <gnu@gisladisker.se>

	* configure.ac: Unconditionally include <sys/types.h> when
	checking for `struct sockaddr_in6'.  Needed for OpenBSD.

2010-09-15  Mats Erik Andersson <gnu@gisladisker.se>

	* telnetd/telnetd.c (login_invocation, argp_options): Access
	login(1) by detected PATH_LOGIN.

2010-09-15  Mats Erik Andersson <gnu@gisladisker.se>

	* man/Makefile.am: Use expansion "$(MAKE)".

2010-09-21  Simon Josefsson  <simon@josefsson.org>

	* ifconfig/system/qnx.h: Rename pre-processor symbol
	IFCONFIG_SYSTEM_SOLARIS_H to IFCONFIG_SYSTEM_QNX_H.  Reported by
	Mats Erik Andersson <gnu@gisladisker.se>.

2010-09-09  Mats Erik Andersson <gnu@gisladisker.se>

	* src/tftp.c (peeraddr, f, trace, verbose, rexmtval)
	(maxtimeout): Remove external scope.
	(peeraddr, f, port, trace, verbose, connected): Upgrade to static
	scope in file.
	(rexmtval, maxtimeout): Static scope and new positioning.

2010-09-03  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (telnetd invocation): Use two spaces after
	end-of-sentence period.  Reported by "Alfred M. Szmidt"
	<ams@gnu.org>.

2010-08-20  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (telnetd invocation): Document --authmode and
	--debug values.  Tiny patch from Mats Erik Andersson
	<mats.andersson@gisladisker.se>.

2010-08-20  Simon Josefsson  <simon@josefsson.org>

	* src/logger.c: Include sys/uio.h for writev.  Suggested by Mats
	Erik Andersson <mats.andersson@gisladisker.se>.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* ifconfig/system.h [__hpux__]: Don't include "system/hpux.c".

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	ifconfig: Random fixes for the `generic' operating system.

	* ifconfig/system/generic.c (system_if_nameindex): New variable.
	* ifconfig/flags.h: Include <sys/types.h>.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* src/tftp.c (intr): Changed type to `void intr (int signo)'.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	ifconfig: Removed support for HPUX and OSF.

	* ifconfig/system/hpux.c, ifconfig/system/hpux.h,
	ifconfig/system/osf.c, ifconfig/system/osf.h: Files removed.
	* ifconfig/system/Makefile.am (noinst_HEADERS): Don't include
	hpux.h, hpux.c, osf.c, osf.h.
	* ifconfig/system.c [__hpux__]: Don't include "system/hpux.c".

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Converted K&R style declarations to ISO C89.

	* ftp/cmds.c (account, all_lower, all_upper, another, cd, cdup)
	(changetype, confirm, cp_subst, delete, disconnect, do_chmod)
	(do_umask, domap, doproxy, dotrans, fatal, get, getit, globulize)
	(lcd, ls, macdef, makedir, mdelete, mget, mls, modtime, mput)
	(newer, onoff, proxabort, put, pwd, quit, quote, quote1, reget)
	(remglob, removedir, renamefile, restart, rmthelp, rmtstatus)
	(setascii, setbell, setbinary, setcase, setcr, setdebug, setform)
	(setftmode, setglob, sethash, setnmap, setntrans, setpassive)
	(setpeer, setport, setprompt, setrunique, setstruct, setsunique)
	(settenex, settrace, settype, setverbose, shell, site, site_idle)
	(sizecmd, status, strdown, syst, user): Use ANSI style
	declarations for prototypes.
	* ftp/extern.h (abortpt, abortrecv, abortsend, cmdabort, intr)
	(lostpeer, proxabort, psabort): Likewise.
	* ftp/ftp.c (abort_remote, abortpt, abortrecv, abortsend)
	(dataconn, empty, getreply, gunique, hookup, initconn, login)
	(proxtrans, psabort, pswitch, ptransfer, recvrequest, reset)
	(sendrequest, tvsub): Likewise.
	* ftp/main.c (makeargv, slurpstring): Likewise.
	* ftpd/ftpcmd.y (lookupyyle): Likewise.
	* libinetutils/tftpsubs.c (r_init, w_init): Likewise.
	* libls/cmp.c (acccmp, modcmp, namecmp, revacccmp, revmodcmp)
	(revnamecmp, revsizecmp, revstatcmp, sizecmp, statcmp): Likewise.
	* libls/fts.c (fts_alloc, fts_build, fts_children, fts_close)
	(fts_lfree, fts_load, fts_maxarglen, fts_open, fts_padjust)
	(fts_palloc, fts_read, fts_set, fts_sort, fts_stat): Likewise.
	* libls/ls.c (display, ls_main, mastercmp, traverse): Likewise.
	* libls/print.c (compute_columns, printacol, printaname, printcol)
	(printlink, printlong, printscol, printstream, printtime)
	(printtype): Likewise.
	* libls/stat_flags.c (flags_to_string, string_to_flags): Likewise.
	* libls/util.c (putname, usage): Likewise.
	* ping/ping.c (ping_finish): Likewise.
	* ping/ping6.c (echo_finish, ping_finish): Likewise.
	* ping/ping_address.c (address_finish): Likewise.
	* ping/ping_echo.c (echo_finish): Likewise.
	* ping/ping_timestamp.c (timestamp_finish): Likewise.
	* src/inetd.c (fix_tcpmux): Likewise.
	* src/logger.c (open_socket): Likewise.
	* src/rcp.c (response): Likewise.
	* src/rlogin.c (sendwindow, writer): Likewise.
	* src/syslogd.c (create_inet_socket): Likewise.
	* src/tftp.c (w_init, , r_init, , tail, , command, intr, makeargv)
	(startclock, stopclock, getcmd, intr): Likewise.
	* src/tftpd.c (r_init, w_init): Likewise.
	* src/uucpd.c (getpwnam, , dologout, dologout, dologin): Likewise.
	* talk/ctl.c (open_ctl, open_sockt): Likewise.
	* talk/get_names.c (getlogin, , ttyname): Likewise.
	* talk/init_disp.c (init_display, quit, set_edit_chars): Likewise.
	* talk/invite.c (announce_invite, invite_remote, send_delete):
	Likewise.
	* talk/io.c (talk): Likewise.
	* talk/look_up.c (check_local): Likewise.
	* talk/msgs.c (end_msgs, start_msgs): Likewise.
	* talkd/table.c (new_id): Likewise.
	* talkd/talkd.c (talkd_init): Likewise.
	* telnet/commands.c (docharmode, dokludgemode, dolinemode)
	(dolmmode, env_help, env_init, env_list, modehelp, getslc)
	(lclchars, logout, modehelp, quit, send_esc, send_help, slc_help)
	(slccmd, help, slc_help, suspend, togcrlf, togcrmod, togdebug)
	(togglehelp): Likewise.
	* telnet/main.c (tninit): Likewise.
	* telnet/network.c (init_network, netflush, setneturg, stilloob):
	Likewise.
	* telnet/sys_bsd.c (susp, TerminalAutoFlush, TerminalDefaultChars)
	(TerminalFlushOutput, TerminalSaveState, xmitAO, init_sys)
	(sys_telnet_init): Likewise.
	* telnet/telnet.c (doflush, dosynch, env_opt_start)
	(env_opt_start_info, get_status, gettermname, init_telnet, intp)
	(netclear, rlogin_susp, sendabort, sendayt, sendbrk, sendeof)
	(sendnaws, sendsusp, slc_check, slc_end_reply, slc_export)
	(slc_init, slc_mode_export, slc_start_reply, slc_update, slcstate)
	(suboption, telrcv, telsnd, xmitAO, xmitEC, xmitEL): Likewise.
	* telnet/terminal.c (getconnmode, init_terminal, setcommandmode):
	Likewise.
	* telnet/tn3270.c (init_3270): Likewise.
	* telnet/utilities.c (EmptyTerminal, SetForExit, optionstatus):
	Likewise.
	* telnetd/pty.c (scrub_env): Likewise.
	* telnetd/slc.c (netflush, check_slc, default_slc, deferslc)
	(get_slc_defaults, send_slc): Likewise.
	* telnetd/state.c (doclientstat, doclientstat, recv_ayt, send_brk)
	(send_eof, send_intr, send_status, send_susp, suboption, telrcv):
	Likewise.
	* telnetd/telnetd.c (print_hostinfo, telnetd_run): Likewise.
	* telnetd/telnetd.h (netclear, netflush): Likewise.
	* telnetd/term.c (init_termbuf, set_termbuf, term_change_eof)
	(term_send_eof, tty_flowmode, tty_isbinaryin, tty_isbinaryout)
	(tty_iscrnl, tty_isecho, tty_isediting, tty_islitecho, tty_israw)
	(tty_issofttab, tty_istrapsig, tty_linemode, tty_restartany):
	Likewise.
	* telnetd/termstat.c (netflush, defer_terminit, flowstat)
	(localstat, terminit): Likewise.
	* telnetd/utility.c (_gettermname, debug_close, debug_open)
	(io_drain, io_setup, net_buffer_is_full, net_input_level)
	(net_output_level, net_read, netclear, netflush)
	(pty_buffer_is_full, pty_input_level, pty_output_level, pty_read)
	(ptyflush, set_neturg): Likewise.

	* ftp/ftp.c (getreply): Pass bogus value to lostpeer.
	(proxtrans): Likewise.
	(reset): Likewise.
	(abort_remote): Likewise.
	* ftp/cmds.c (another): Likewise.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Use fseeko instead of fseek.

	* libinetutils/tftpsubs.c (write_behind): Use fseeko instead of
	fseek.
	* libinetutils/tftpsubs.c (write_behind): Likewise.
	* ftpd/ftpd.c (store): Likewise.
	* ftp/ftp.c (recvrequest): Likewise.
	(sendrequest): Likewise.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Removed sc_makefile_check from
	list.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Removed useless C preprocessor parentehsis.

	* cfg.mk (local-checks-to-skip): Removed sc_useless_cpp_parens
	from list.

	* ftp/cmds.c: Removed useless C preprocessor parentehsis.
	* ftp/ftp.c: Likewise.
	* ftpd/auth.c: Likewise.
	* ftpd/ftpcmd.y: Likewise.
	* ftpd/ftpd.c: Likewise.
	* ftpd/logwtmp.c: Likewise.
	* ifconfig/changeif.c: Likewise.
	* ifconfig/flags.c: Likewise.
	* ifconfig/if_index.c: Likewise.
	* ifconfig/system.c: Likewise.
	* ifconfig/system.h: Likewise.
	* ifconfig/system/linux.c: Likewise.
	* libinetutils/daemon.c: Likewise.
	* libinetutils/kcmd.c: Likewise.
	* libinetutils/krcmd.c: Likewise.
	* libinetutils/utmp_init.c: Likewise.
	* libinetutils/utmp_logout.c: Likewise.
	* libls/fts.c: Likewise.
	* libtelnet/auth-proto.h: Likewise.
	* libtelnet/auth.c: Likewise.
	* libtelnet/enc_des.c: Likewise.
	* libtelnet/encrypt.c: Likewise.
	* libtelnet/forward.c: Likewise.
	* libtelnet/misc.c: Likewise.
	* libtelnet/read_passwd.c: Likewise.
	* src/inetd.c: Likewise.
	* src/rcp.c: Likewise.
	* src/rlogin.c: Likewise.
	* src/rlogind.c: Likewise.
	* src/rsh.c: Likewise.
	* src/rshd.c: Likewise.
	* src/uucpd.c: Likewise.
	* talk/init_disp.c: Likewise.
	* telnet/authenc.c: Likewise.
	* telnet/commands.c: Likewise.
	* telnet/defines.h: Likewise.
	* telnet/externs.h: Likewise.
	* telnet/main.c: Likewise.
	* telnet/ring.c: Likewise.
	* telnet/sys_bsd.c: Likewise.
	* telnet/telnet.c: Likewise.
	* telnet/tn3270.c: Likewise.
	* telnet/utilities.c: Likewise.
	* telnetd/state.c: Likewise.
	* telnetd/telnetd.c: Likewise.
	* telnetd/telnetd.h: Likewise.
	* telnetd/term.c: Likewise.
	* telnetd/termstat.c: Likewise.
	* telnetd/utility.c: Likewise.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Use EXIT_SUCCESS and EXIT_FAILURE macros through out.

	* cfg.mk (local-checks-to-skip): Removed
	sc_prohibit_magic_number_exit from list.

	* whois/whois.c (main, err_sys, err_quit): Don't use magical exit
	numbers.
	* telnetd/utility.c (io_drain, fatal): Likewise.
	* telnetd/telnetd.c (main, telnetd_setup): Likewise.
	* telnetd/state.c (telrcv): Likewise.
	* telnetd/pty.c (startslave, cleanup): Likewise.
	* telnet/terminal.c (init_terminal): Likewise.
	* telnet/network.c (init_network): Likewise.
	* telnet/main.c (main): Likewise.
	* talkd/talkd.c (talkd_init, alarm_handler): Likewise.
	* talkd/table.c (insert_table): Likewise.
	* talkd/announce.c (announce): Likewise.
	* talkd/acl.c (netdef_parse, read_acl): Likewise.
	* talk/init_disp.c (init_display, quit): Likewise.
	* src/uucpd.c (main): Likewise.
	* src/traceroute.c (main): Likewise.
	* src/tftpd.c (main, tftp, timer, justquit): Likewise.
	* src/tftp.c (main, command, quit): Likewise.
	* src/syslogd.c (main, add_funix, crunch_list, die): Likewise.
	* src/rshd.c (main, doit, getstr): Likewise.
	* src/rsh.c (main, else, sigmask, talk, copyargs): Likewise.
	* src/rlogind.c (main, rlogin_daemon, rlogind_auth)
	(rlogind_mainloop, getstr, cleanup, fatal): Likewise.
	* src/rlogin.c (main): Likewise.
	* src/rexecd.c (main, doit): Likewise.
	* src/rexec.c (main): Likewise.
	* src/rcp.c (main, toremote, sink): Likewise.
	* src/logger.c (main): Likewise.
	* src/inetd.c (echo_stream, discard_stream, chargen_stream)
	(tcpmux, main): Likewise.
	* ping/ping.c (main): Likewise.
	* libtelnet/auth.c (auth_send): Likewise.
	* libls/util.c (usage): Likewise.
	* libls/ls.c (traverse, display): Likewise.
	* ifconfig/ifconfig.c (main): Likewise.
	* ftpd/ftpd.c (main, pass): Likewise.
	* ftp/cmds.c (fatal): Likewise.
	* libinetutils/daemon.c: Include <stdlib.h>.
	(waitdaemon_timeout): Don't use magical exit numbers.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Only include <signal.h> if it is used.

	* cfg.mk (local-checks-to-skip): Removed
	sc_prohibit_signal_without_use from list.

	* ftp/domacro.c: Don't include <signal.h>.
	* libicmp/icmp_address.c: Likewise.
	* libicmp/icmp_echo.c: Likewise.
	* libicmp/icmp_timestamp.c: Likewise.
	* libtelnet/read_passwd.c: Likewise.
	* ping/libping.c: Likewise.
	* ping/ping_address.c: Likewise.
	* ping/ping_echo.c: Likewise.
	* ping/ping_router.c: Likewise.
	* ping/ping_timestamp.c: Likewise.
	* src/traceroute.c: Likewise.
	* src/uucpd.c: Likewise.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Removed sc_trailing_blank from
	list.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Removed sc_space_tab from list.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	Don't protect <config.h> with HAVE_CONFIG_H.

	* cfg.mk (local-checks-to-skip): Removed sc_prohibit_have_config_h
	from list.

	* ftp/cmdtab.c: Include <config.h> uncondtionally.
	* ftp/domacro.c: Likewise.
	* ftp/ftp.c: Likewise.
	* ftp/main.c: Likewise.
	* ftp/ruserpass.c: Likewise.
	* ftpd/auth.c: Likewise.
	* ftpd/conf.c: Likewise.
	* ftpd/ftpcmd.y: Likewise.
	* ftpd/ftpd.c: Likewise.
	* ftpd/logwtmp.c: Likewise.
	* ftpd/pam.c: Likewise.
	* ftpd/popen.c: Likewise.
	* ftpd/server_mode.c: Likewise.
	* ifconfig/changeif.c: Likewise.
	* ifconfig/flags.c: Likewise.
	* ifconfig/if_index.c: Likewise.
	* ifconfig/ifconfig.c: Likewise.
	* ifconfig/options.c: Likewise.
	* ifconfig/printif.c: Likewise.
	* ifconfig/system/generic.c: Likewise.
	* ifconfig/system/hpux.c: Likewise.
	* ifconfig/system/linux.c: Likewise.
	* ifconfig/system/osf.c: Likewise.
	* ifconfig/system/qnx.c: Likewise.
	* ifconfig/system/solaris.c: Likewise.
	* libicmp/icmp_address.c: Likewise.
	* libicmp/icmp_cksum.c: Likewise.
	* libicmp/icmp_echo.c: Likewise.
	* libicmp/icmp_timestamp.c: Likewise.
	* libinetutils/cleansess.c: Likewise.
	* libinetutils/des_rw.c: Likewise.
	* libinetutils/kcmd.c: Likewise.
	* libinetutils/krcmd.c: Likewise.
	* libinetutils/localhost.c: Likewise.
	* libinetutils/logwtmp.c: Likewise.
	* libinetutils/setsig.c: Likewise.
	* libinetutils/shishi.c: Likewise.
	* libinetutils/tftpsubs.c: Likewise.
	* libinetutils/ttymsg.c: Likewise.
	* libinetutils/utmp_init.c: Likewise.
	* libinetutils/utmp_logout.c: Likewise.
	* libls/cmp.c: Likewise.
	* libls/fts.c: Likewise.
	* libls/ls.c: Likewise.
	* libls/print.c: Likewise.
	* libls/stat_flags.c: Likewise.
	* libls/util.c: Likewise.
	* libtelnet/auth.c: Likewise.
	* libtelnet/enc_des.c: Likewise.
	* libtelnet/encrypt.c: Likewise.
	* libtelnet/genget.c: Likewise.
	* libtelnet/getent.c: Likewise.
	* libtelnet/kerberos.c: Likewise.
	* libtelnet/kerberos5.c: Likewise.
	* libtelnet/misc.c: Likewise.
	* libtelnet/read_passwd.c: Likewise.
	* libtelnet/shishi.c: Likewise.
	* ping/libping.c: Likewise.
	* ping/ping.c: Likewise.
	* ping/ping6.c: Likewise.
	* ping/ping_address.c: Likewise.
	* ping/ping_common.c: Likewise.
	* ping/ping_echo.c: Likewise.
	* ping/ping_router.c: Likewise.
	* ping/ping_timestamp.c: Likewise.
	* src/inetd.c: Likewise.
	* src/logger.c: Likewise.
	* src/rcp.c: Likewise.
	* src/rexec.c: Likewise.
	* src/rexecd.c: Likewise.
	* src/rlogin.c: Likewise.
	* src/rlogind.c: Likewise.
	* src/rsh.c: Likewise.
	* src/rshd.c: Likewise.
	* src/syslogd.c: Likewise.
	* src/tftp.c: Likewise.
	* src/tftpd.c: Likewise.
	* src/traceroute.c: Likewise.
	* src/uucpd.c: Likewise.
	* talk/ctl.c: Likewise.
	* talk/ctl_transact.c: Likewise.
	* talk/display.c: Likewise.
	* talk/get_addrs.c: Likewise.
	* talk/get_names.c: Likewise.
	* talk/invite.c: Likewise.
	* talk/io.c: Likewise.
	* talk/look_up.c: Likewise.
	* talk/msgs.c: Likewise.
	* talk/talk.c: Likewise.
	* talkd/talkd.c: Likewise.
	* telnet/authenc.c: Likewise.
	* telnet/commands.c: Likewise.
	* telnet/main.c: Likewise.
	* telnet/network.c: Likewise.
	* telnet/sys_bsd.c: Likewise.
	* telnet/telnet.c: Likewise.
	* telnet/terminal.c: Likewise.
	* telnet/tn3270.c: Likewise.
	* telnet/utilities.c: Likewise.
	* telnetd/telnetd.h: Likewise.
	* whois/whois.c: Likewise.
	* ftp/cmds.c: Likewise.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Removed
	sc_prohibit_assert_without_use from list.

2010-08-19  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (local-checks-to-skip): Removed sc_obsolete_symbols from
	list.

2010-08-18  Giuseppe Scrivano  <gscrivano@gnu.org>

	Under GNU/Linux print interfaces without an address with ifconfig
	-a.

	* bootstrap.conf (gnulib_modules): Add module `read-file'.

	* NEWS: Update.

	* ifconfig/options.c (parse_cmdline): Use system_if_nameindex, not
	if_nameindex.

	* ifconfig/system.h: Include <if_index.h>.

	* ifconfig/system/hpux.c (system_if_nameindex): New variable.
	* ifconfig/system/osf.c (system_if_nameindex): Likewise.
	* ifconfig/system/qnc.c (system_if_nameindex): Likewise.
	* ifconfig/system/solaris.c (system_if_nameindex): Likewise.

	* ifconfig/system/linux.c (linux_if_nameindex): New function.
	(system_if_nameindex): New variable.

2010-08-16  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ifconfig/flags.c (flag_char_tab): Protect the uses of IFF_SLAVE
	and IFF_MASTER by #ifdefs.

2010-08-16  Alfred M. Szmidt  <ams@gnu.org>

	* ifconfig/options.c (parse_cmdline): Error out if IFNX is NULL.

2010-07-30  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ifconfig/if_index.c (if_nameindex): Remove local variable `len'.
	Remove code that compute the sizeof of the struct `ifreq'.

2010-07-10  Alfred M. Szmidt  <ams@gnu.org>

	* ifconfig/options.c (parse_opt_set_default_format): Abort if no
	output format could be found.

2010-07-10  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ifconfig/if_index.h (if_indextoname): Remove function
	declaration.

	* ifconfig/if_index.c (if_indextoname): Remove unused function.

2010-07-03  Giuseppe Scrivano  <gscrivano@gnu.org>

	* configure.ac: Do not check if `bcmp', `bcopy' and `bzero' exist.

	* libinetutils/des_rw.c (des_read): Use `memcpy' instead of
	`bcopy'.
	(des_write): Likewise.
	(des_clear_key): Use `memset' instead of `bzero'.

	* libtelnet/encrypt.h (SAMEKEY): Use `memcmp' instead of `bcmp'.

	* libinetutils/kcmd.c (kcmd): Use `memcpy' instead of `bcopy'.

	* libinetutils/logwtmp.c (logwtmp_keep_open): Use `memset' instead
	of `bzero'.
	* ftp/ftp.c (initconn): Likewise.
	* src/uucpd.c (main): Likewise.

	* talk/get_addrs.c (get_addrs): Use `memmove' instead of `bcopy'.

2010-06-21  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ifconfig/if_index.c (if_indextoname): Return NULL on errors.

2010-05-19  Kaio Rafael <kaiorafael@gmail.com>  (tiny change)

	* whois/as_del_list, whois/make_as_del.pl: Added copyright notice.
	* whois/ip_del_list, whois/make_ip_del.pl: Likewise.
	* whois/make_tld_serv.pl, whois/tld_serv_list: Likewise.

2010-05-18  Simon Josefsson  <simon@josefsson.org>

	* tests/Makefile.am (dist_check_SCRIPTS): Make testing ping and
	traceroute conditioned on ENABLE_ping and ENABLE_traceroute.
	Reported by Adam Sampson <ats@offog.org>.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version number to 1.8.
	* NEWS: Update.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* src/uucpd.c: Include <sys/wait.h>, <sys/time.h>, <time.h>
	unconditionally.
	* src/tftp.c: Include <sys/time.h>, <time.h> unconditionally.
	* src/syslogd.c: Include <sys/time.h>, <time.h>, <stdarg.h>
	unconditionally.
	(dbg_printf): Remove redundant va_start call, don't use K&R style
	variable arguments.
	* src/rshd.c Include <alloca.h>, <sys/time.h>, <time.h>,
	<sys/select.h> unconditionally.
	[!alloca]: Removed macro.
	* src/rsh.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.
	* src/rlogind.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.
	* src/rlogin.c: Include <sys/time.h>, <time.h>, <sys/wait.h>,
	<stdarg.h> unconditionally.
	(warning): Don't use K&R variable arguments.
	* src/rexecd.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.
	* src/rexec.c: Include <sys/select.h> unconditionally.
	* src/rcp.c: Include <sys/time.h>, <time.h> unconditionally.
	* src/inetd.c: Include <sys/wait.h>, <sys/time.h>, <time.h>,
	<sys/select.h> unconditionally.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* ifconfig/system/solaris.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/system/qnx.c: Include <unistd.h> unconditionally.
	* ifconfig/system/osf.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/system/linux.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/system/hpux.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/printif.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/options.c: Include <string.h> unconditionally.
	* ifconfig/ifconfig.c: Include <unistd.h>, <string.h>
	unconditionally.
	* ifconfig/flags.c: Include <string.h> unconditionally.
	* ifconfig/changeif.c: Include <string.h> unconditionally.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/utmp_logout.c: Include <sys/time.h>, <time.h>,
	<string.h> unconditionally.
	* libinetutils/utmp_init.c: Include <sys/time.h>, <time.h>,
	<string.h> unconditionally.
	* libinetutils/ttymsg.c (O_NONBLOCK): Removed macro.
	* libinetutils/setsig.c: Include <stdlib.h> unconditionally.
	* libinetutils/logwtmp.c: Include <sys/time.h>, <time.h>,
	<errno.h>, <string.h> unconditionally.
	* libinetutils/localhost.c: Include <stdlib.h> unconditionally.
	* libinetutils/cleansess.c: Include <sys/time.h>, <time.h>,
	<string.h> unconditionally.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* libtelnet/shishi.c: Include <string.h> unconditionally.
	* libtelnet/read_passwd.c: Don't include <strings.h>.
	* libtelnet/kerberos5.c: Include <string.h> unconditionally.
	* libtelnet/kerberos.c: Include <stdlib.h>, <string.h>
	unconditionally.
	* libtelnet/encrypt.c: Include <stdlib.h>, <string.h>, "genget.h"
	unconditionally.
	* libtelnet/enc_des.c: Include <stdlib.h> unconditionally.
	* libtelnet/auth.c: Include <stdlib.h> unconditionally.

2010-05-15  Alfred M. Szmidt  <ams@gnu.org>

	* libls/fts.c: Include <string.h> unconditionally.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/popen.c: Include <sys/wait.h> unconditionally.
	* ftpd/ftpd.c: Include <sys/time.h>, <time.h>, <sys/wait.h>
	unconditionally.
	(reply): Don't use K&R variable arguments.
	(lreply): Don't use K&R variable arguments.
	* ftpd/ftpcmd.y: Include <sys/time.h>, <time.h>, <sys/utsname.h>
	unconditionally.
	* ftpd/auth.c: Include <sys/time.h>, <time.h> unconditionally.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* talk/msgs.c: Include <sys/time.h>, <time.h> unconditionally.
	* talk/io.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.
	* talk/invite.c: Include <sys/time.h>, <time.h> unconditionally.
	* talk/ctl_transact.c: Include <sys/time.h>, <time.h>,
	<sys/select.h> unconditionally.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (DISTCLEANFILES): Added
	`$(PACKAGE)-$(VERSION).tar.gz' to list.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	Use || and && instead of -o and -a in calls to test.

	* configure.ac: Use || and && type of test instead of -o and -a
	for calls to `test'.  Don't check for poll() Include <errno.h>
	unconditionally in check for `sys_errlist'.  Include <unistd.h>
	and <stdlib.h> in check for `environ'.
	* am/config_paths.m4: Use || and && type of test instead of -o and
	-a for calls to `test'.
	* am/libcurses.m4: Likewise.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/ruserpass.c: Include <stdarg.h> unconditionally.
	* ftp/ftp.c: Include <sys/time.h>, <time.h>, <stdarg.h>,
	<sys/select.h> unconditionally.
	(command): Don't use K&R variable arguments.
	* ftp/cmds.c: <sys/wait.h>, <sys/time.h>, <time.h>

	* telnetd/telnetd.c: Include <sys/utsname.h>, <strings.h>
	unconditionally.

	* telnet/utilities.c: Include <sys/time.h>, <time.h>
	unconditionally.  Don't include "fdset.h".
	* telnet/tn3270.c: Don't include "fdset.h".
	* telnet/telnet.c: Include <stdlib.h> unconditionally.
	* telnet/sys_bsd.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.  Don't include "fdset.h".
	* telnet/network.c: Include <sys/time.h>, <time.h>, <sys/select.h>
	unconditionally.
	* telnet/commands.c: Include <fcntl.h>, <stdarg.h>, <stdlib.h>
	unconditionally.
	(call): Don't use K&R variable arguments.
	* telnet/fdset.h: File removed.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	Silence makefile_at_at_check_exceptions from `make syntax-check'.

	* telnetd/Makefile.am (INCLUDES, LDADD): Use $() variables,
	instead of @@.
	(LIBTERMCAP, LIBCRYPT, LIBUTIL): Removed variables.
	* telnet/Makefile.am (noinst_HEADERS): Removed fdset.h from list.
	(LIBTERMCAP, LIBCRYPT): Removed variables.
	* src/Makefile.am (LDADD): Use $() variables, instead of @@.
	* libtelnet/Makefile.am (INCLUDES): Use $() variables, instead of
	@@.
	* ftpd/Makefile.am (LIBCRYPT, LIBWRAP, LIBPAM, LIBLS): Variables
	removed.
	* ftp/Makefile.am (READLINE): Use $() variables, instead of @@.
	* cfg.mk (_makefile_at_at_check_exceptions): New variable.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* libicmp/.gitignore: Removed file.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Removed all occurances of @acronym.
	(ftp invocation): Document --passive and --active options.

	* doc/.gitignore (Makefile, Makefile.in): Removed rules.

2010-05-14  Alfred M. Szmidt  <ams@gnu.org>

	* AUTHORS: Updated.

2010-05-14  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap (gnulib_path): Default to "gnulib" if it doesn't have
	a value.  Redirect "git clone" stderr to stdout.

2010-05-12  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap: Remove test to skip autoheader.

2010-05-11  Giuseppe Scrivano  <gscrivano@gnu.org>

	* src/tftpd.c (timer): Use `siglongjmp' instead of `longjmp'.
	(send_file): Use `sigsetjmp' instead of `setjmp'.
	(recvfile): Likewise.

	Reported by Hugo Heutinck <hheutinck@mail.altenpts.nl>.

2010-05-11  Giuseppe Scrivano  <gscrivano@gnu.org>

	* src/rcp.c (main): Change the test to check if the call to
	`asprintf' failed.

2010-05-04  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap: Update to the last gnulib version.

2010-05-03  Simon Josefsson  <simon@josefsson.org>

	* lib/.gitignore: Remove file.

2010-05-03  Simon Josefsson  <simon@josefsson.org>

	* tests/traceroute-localhost.sh (TRACEROUTE): Update to reflect
	move of traceroute to src/.

2010-03-23  Simon Josefsson  <simon@josefsson.org>

	* src/rlogind.c: Don't protect #include <pty.h> in a HAVE_PTY_H
	check, with gnulib we always have pty.h.

	* bootstrap.conf (gnulib_modules): Add forkpty and remove pty.

2010-03-15  Giuseppe Scrivano  <gscrivano@gnu.org>

	* src/rshd.c (iruserok): Declare extern only under glibc.

	* src/rlogind.c: Include pty.h only if HAVE_PTY_H is defined.
	(iruserok): Declare extern only under glibc.

2010-03-10  Ludovic CourtÃ¨s  <ludo@gnu.org> (tiny change)

	* ftp/main.c (main): Call getservbyname(3) after arguments have
	been parsed.

2010-03-10  Ludovic CourtÃ¨s  <ludo@gnu.org> (tiny change)

	* ifconfig/flags.c (if_flags): Add trailing entry with NULL
	`name'.

2010-02-13  Giuseppe Scrivano  <gscrivano@gnu.org>

	* configure.ac: Don't check for the `sa_family_t' type.  It is
	already done by gnulib.

2010-02-08  Sergey Poznyakoff  <gray@gnu.org.ua>

	Ifconfig: add more format functions; implement --format=help.

	* ifconfig/if_index.c (if_nametoindex): Fix return value.
	* ifconfig/ifconfig.c (main): Rewrite loop.
	* ifconfig/options.c (formats): Add docstrings.  Add "help"
	format.
	(format_find): New function.
	* ifconfig/options.h (format)<docstr>: New member.
	(format_find): New prototype.
	* ifconfig/printif.c (format_handles): New functions: format?,
	docstr?, defn, foreachformat, verbose?, rep.
	(put_flags): Minor change.
	(format_handler, fh_exists_query, fh_error): Rewrite the loop.
	(fh_format_query, fh_docstr)
	(fh_defn, fh_foreachformat)
	(fh_rep, fh_verbose_query): New functions.
	(fh_format): Rewrite using format_find.
	* ifconfig/printif.h (fh_format_query, fh_docstr)
	(fh_defn, fh_foreachformat)
	(fh_rep, fh_verbose_query): New prototypes.
	* NEWS: Update.

2010-02-08  Sergey Poznyakoff  <gray@gnu.org.ua>

	Ifconfig: read format from files and implement the -s option.

	* ifconfig/flags.c (if_format_flags): Rename to if_list_flags.
	(if_format_flags): New function.
	(print_if_flags): Fix spelling of the 3rd argument.
	* ifconfig/flags.h (IF_FORMAT_FLAGS_BUFSIZE): New define.
	(if_format_flags): Rename to if_list_flags.
	(if_format_flags): New prototype.
	* ifconfig/ifconfig.h: Include obstack.h
	* ifconfig/options.c (formats)<netstat>: New format.
	(argp_options): New option: --short (-s).
	(parse_opt_set_default_format): Optimize.
	(parse_opt_set_default_format_from_file): New function.
	(parse_opt): Handle -s option.  If argument to --format begins
	with a '@', it specifies a file to read format from.
	(parse_cmdline): Order interfaces alphabetically.
	* ifconfig/printif.c (put_flags_short): New function.
	(fh_flags): ${flags}{short} prints flags in short notation.

2010-02-04  Alfred M. Szmidt  <ams@gnu.org>

	New options --active and --passive.

	* ftp/main.c (OPT_PROMPT): New enum.
	(argp_options) <prompt>: Removed short option (-p).  <active>: New
	option; uses -A as short option.  <passive>: New option; uses -p
	as short option.
	(parse_opt): Handle --active and --passive, updated --prompt
	accordingly.
	(main) <passivemode>: Set initial value before argument parsing.

2010-01-29  Alfred M. Szmidt  <ams@gnu.org>

	* ping/Makefile.am (install-ping-hook): Clarify warning message
	when installing a SUID root program.
	* src/Makefile.am (install-traceroute-hook, install-rsh-hook)
	(install-rlogin-hook, install-rcp-hook): Likewise.

2010-01-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	Implement -a option; correctly print interface metric.

	* ifconfig/options.c (formats) <gnu-one-entry> <net-tools, unix,
	osf>: Use ${ifdisplay?} to select interfaces to be displayed.
	(ifs_cmdline): New global.
	(parse_opt_new_ifs): Set ifs_cmdline.
	* ifconfig/options.h (all_option, ifs_cmdline): New externs.
	* ifconfig/printif.c (format_handles) <ifdisplay?>: New handler.
	(fh_ifdisplay_query): New function.
	(fh_metric_query): Metric of 0 is OK.
	(fh_metric): Display 1 for zero metric, as other ifconfigs do.
	* ifconfig/printif.h (fh_ifdisplay_query): New prototype.

2010-01-27  Sergey Poznyakoff  <gray@gnu.org.ua>

	Implement setting interface options: up, down, multicast,
	allmulti.

	* ifconfig/flags.c: Include <stdlib.h> and "xalloc.h".
	(if_flag) <rev>: New member.
	(IFF_NOARGP) [IFF_NOARP]: New flag for "ARP".
	(IFF_NOTRAILERS) [IFF_NOTRAILERS]: New flag for "TRAILERS".
	(IFF_NOACC) [IFF_NOACC]: New flag for"ACC".
	(IFF_NOSR8025) [IFF_NOSR8025]: New flag for "SR8025"
	(IFF_NOCHECKSUM) [IFF_NOCHECKSUM]: New flag for "CHECKSUM".
	(cmpname, if_nameztoflag, if_format_flags): New function.
	(if_flagtoname) Avoid extra comparison.
	(if_nametoflag): Rewrite.
	* ifconfig/flags.h (if_nametoflag): Updated prototype.
	(if_nameztoflag, if_format_flags): New prototypes.
	* ifconfig/options.c (all_option): New global variable.
	(UP_OPTION, DOWN_OPTION): New enumerators.
	(argp_options) <address>: Use -A as short option.  <up, down,
	flags>: New options.  <all>: New option, with -a as short option.
	<peer>: Handle an extra argument.  <mtu>: Fix typo.
	(parse_opt_set_flag, parse_opt_flag_list)
	(parse_opt_set_point_to_point): New functions.
	(parse_opt) <UP_OPTION, DOWN_OPTION, F, a>: Handle new options.
	<p, d>: Call parse_opt_set_point_to_point instead.  <v>: Handle
	--verbose flag.
	(default_help_filter): New function
	(argp): Use default_help_filter as help filter.
	* ifconfig/options.h (ifconfig) <setflags, clrflags>: New members.
	(parse_opt_set_flag, parse_opt_flag_list)
	(parse_opt_set_point_to_point): New prototypes.
	* ifconfig/printif.c (fh_brdaddr_query, fh_dstaddr_query): Update
	calls to if_nametoflag.
	* ifconfig/system/linux.c (system_help): Update docstring.
	(system_parse_opt_rest) <EXPECT_DSTADDR>: Call
	parse_opt_set_point_to_point instead.  <up, down, flags>: Handle
	new options.

2010-01-12  Simon Josefsson  <simon@josefsson.org>

	* whois/whois.c (openconn) [!HAVE_GETADDRINFO]: Remove variables
	hostinfo, servinfo, and saddr and supporting code.
	* src/inetd.c (servtab): Remove !HAVE_GETADDRINFO support.
	(setup) [!HAVE_GETADDRINFO]: Remove function.
	(expand_enter) [!HAVE_GETADDRINFO]: Remove function.
	* configure.ac: Remove HAVE_GETADDRINFO variable.  Don't check for
	getaddrinfo.
	* bootstrap.conf (gnulib_modules): Add getaddrinfo.

2010-01-13  Simon Josefsson  <simon@josefsson.org>

	* TODO: Update.
	* THANKS: Update.
	* README: Update.

2010-01-12  Alfred M. Szmidt  <ams@gnu.org>

	Moved single file programs to src/.

	* libinetutils/Makefile.am (noinst_HEADERS): Added tftpsubs.h
	shishi_def.h to list.
	* libinetutils/Makefile.am (INCLUDES): Removed
	-I$(top_srcdir)/headers from list.  Added
	-I$(top_srcdir)/libinetutils to list.
	* Makefile.am: File removed.
	* headers/shishi_def.h: File renamed to ..
	* libinetutils/shishi_def.h: ... this.
	* headers/tftpsubs.h: File renamed to ...
	* libinetutils/tftpsubs.h: ... this.

	* src/.gitignore: New file.
	* src/Makefile.am: New file.

	* man/Makefile.am (hostname.1, inetd.8, logger.1, rcp.1, rexec.1)
	(rexecd.8, rlogin.1, rlogind.8, rsh.1, rshd.8, syslogd.8, tftp.1)
	(tftpd.8, traceroute.1, uucpd.8): Look for main program file in
	src/.
	(mapped_name): Added rewrite rules for hostname, inetd, logger,
	rcp, rexec, rexecd, rlogin, rlogind, rsh, rshd, syslogd, tftp,
	tftpd, traceroute, and uucpd.
	* configure.ac (AC_CONFIG_SRCDIR): Look for src/inetd.c.
	(AC_CONFIG_FILES): Removed hostname/Makefile, inetd/Makefile,
	logger/Makefile, rcp/Makefile, rexec/Makefile, rexecd/Makefile,
	rlogin/Makefile, rlogind/Makefile, rsh/Makefile, rshd/Makefile,
	syslogd/Makefile, tftp/Makefile, tftpd/Makefile,
	traceroute/Makefile, and uucpd/Makefile from list.  Added
	src/Makefile to list.  Sorted list (in the order: libraries,
	programs, documentation, tests, misc.).
	* Makefile.am (SUBDIRS): Removed hostname, inetd, logger, rcp,
	rexec, rexecd, rlogin, rlogind, rsh, rshd, syslogd, tftp, tftpd,
	traceroute, and uucpd from list.  Added src to list.  Sorted list
	(in the order: libraries, programs, documentation, tests).

	* hostname/.gitignore, hostname/Makefile.am: Files removed.
	* hostname/hostname.c: File renamed to ...
	* src/hostname.c: ... this.

	* inetd/.gitignore, inetd/Makefile.am: Files removed.
	* inetd/inetd.c: File renamed to ...
	* src/inetd.c: ... this.

	* logger/.gitignore, logger/Makefile.am: Files removed.
	* logger/logger.c: File renamed to ...
	* src/logger.c: ... this.

	* rcp/.gitignore, rcp/Makefile.am: Files removed.
	* rcp/rcp.c: File renamed to ...
	* src/rcp.c: ... this.

	* rexec/.gitignore, rexec/Makefile.am: Files removed.
	* rexec/rexec.c: File renamed to ...
	* src/rexec.c: ... this.

	* rexecd/.gitignore, rexecd/Makefile.am: Files removed.
	* rexecd/rexecd.c: File renamed to ...
	* src/rexecd.c: ... this.

	* rlogin/.gitignore, rlogin/Makefile.am: Files removed.
	* rlogin/rlogin.c: File renamed to ...
	* src/rlogin.c: ... this.

	* rlogind/.gitignore, rlogind/Makefile.am: Files removed.
	* rlogind/rlogind.c: File renamed to ...
	* src/rlogind.c: ... this.

	* rsh/.gitignore, rsh/Makefile.am: Files removed.
	* rsh/rsh.c: File renamed to ...
	* src/rsh.c: ... this.

	* rshd/.gitignore, rshd/Makefile.am: Files removed.
	* rshd/rshd.c: File renamed to ...
	* src/rshd.c: ... this.

	* syslogd/.gitignore, syslogd/Makefile.am: Files removed.
	* syslogd/syslogd.c: File renamed to ...
	* src/syslogd.c: ... this.

	* tftp/.gitignore, tftp/Makefile.am: Files removed.
	* tftp/tftp.c: File renamed to ...
	* src/tftp.c: ... this.

	* tftpd/.gitignore, tftpd/Makefile.am: Files removed.
	* tftpd/tftpd.c: File renamed to ...
	* src/tftpd.c: ... this.

	* traceroute/.gitignore, traceroute/Makefile.am: Files removed.
	* traceroute/traceroute.c: File renamed to ...
	* src/traceroute.c: ... this.

	* uucpd/.gitignore, uucpd/Makefile.am: Files removed.
	* uucpd/uucpd.c: File renamed to ...
	* src/uucpd.c: ... this.

2010-01-12  Alfred M. Szmidt  <ams@gnu.org>

	Merged tftp/extern.h and tftp/main.c into tftp/tftp.c.

	* tftp/Makefile.am (tftp_SOURCES): Removed main.c from list.
	(noinst_HEADERS): Variable removed.
	* tftp/extern.h, tftp/main.c: Files removed.
	* tftp/tftp.c: Include <sys/file.h>, <arpa/inet.h>, <fcntl.h>,
	<netdb.h>, <stdlib.h>, <argp.h>, <libinetutils.h>, "xalloc.h", and
	"progname.h".  Don't include "extern.h".
	(TIMEOUT, HELPINDENT, RESOLVE_OK, RESOLVE_FAIL)
	(RESOLVE_NOT_RESOLVED): New macros.
	(cmd): New structure.
	(intr, get, help, modecmd, put, quit, setascii, setbinary)
	(setpeer, setrexmt, settimeout, settrace, setverbose, status)
	(command, getusage, makeargv, putusage, settftpmode, getcmd, tail)
	(recvfile, send_file): New forward declarations.
	(peeraddr, f, port, trace, verbose, connected, mode, line, margc)
	(margv, prompt, toplevel, sp, vhelp, thelp, chelp, qhelp, hhelp)
	(shelp, rhelp, mhelp, sthelp, xhelp, ihelp, ashelp, bnhelp)
	(cmdtab, args_doc, doc, argp_options, host_port_argv)
	(hostport_argc, toplevel, argp, hostname, modes, rexmtval)
	(maxtimeout): New variables.
	(parse_opt, main, resolve_name, get_args, setpeer, modecmd)
	(setbinary, setascii, setftpmode, put, putusage, get, getusage)
	(setrexmt, settimeout, status, intr, tail, command, getcmd)
	(makeargv, quit, help, settrace, setverbose): New functions.

2010-01-08  Simon Josefsson  <simon@josefsson.org>

	* README-alpha: Explain more.

2009-12-28  Alfred M. Szmidt  <ams@gnu.org>

	* man/.gitignore: Added `*.8' to list.

2009-12-28  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added `update-copyright' to
	list.

2009-12-28  Giuseppe Scrivano  <gscrivano@gnu.org>

	* man/ping6.h2m: New file.

2009-12-28  Giuseppe Scrivano  <gscrivano@gnu.org>

	* bootstrap.conf (gnulib_modules): Add `xvasprintf' to list.
	* telnet/commands.c: Include "xalloc.h" and "xvasprintf.h".
	(cmdrc): Use xvasprintf/xstrdup to allocate RCNAME.  Removed
	variable M1SAVE.
	(rcbuf): Variable removed.

	* .gitignore: Added asprintf.c, vasprintf.c, xasprintf.c,
	xvasprintf.c, xvasprintf.h to list.

	Reported by Zhitong Wangzt <zhitong.wangzt@alibaba-inc.com>.

2009-12-19  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version number to 1.7.90.

2009-12-19  Winston Edmond  <wbe@psr.com>

	* inetd/inetd.c (main): Close CTRL before exiting main loop.

2009-12-17  Simon Josefsson  <simon@josefsson.org>

	* man/Makefile.am (all): Add ping6.1.
	(dist_man1_MANS) [ENABLE_ping6]: Add ping6.1.
	(ping6.1): Add rule.
	(mapped_name): New variable, for mapping non-standard tool paths.
	(man): Use $(mapped_name).
	* NEWS: Updated.

2009-12-17  Simon Josefsson  <simon@josefsson.org>

	* man/Makefile.am (all): Change daemon man section from 1 to 8.
	(.h2m.8): Add rule for daemons.
	(.h2m.1): Invoke new meta-rule 'man'.
	(man): New meta-rule to invoke help2man, simplified from before.
	(EXTRA_DIST): Add $(all:.8=.h2m).
	* NEWS: Updated.  Reported by Juergen Daubert
	<juergen.daubert@gmx.net>.

2009-12-17  Simon Josefsson  <simon@josefsson.org>

	* tests/Makefile.am (TESTS): Change $(check_SCRIPTS) to
	$(dist_check_SCRIPTS).

2009-12-13  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version number to 1.7.

2009-12-13  Alfred M. Szmidt  <ams@gnu.org>

	* man/.gitignore: New file.

2009-12-13  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version number to 1.6.92.

2009-12-13  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (release-prep-hook): New variable.

2009-12-11  Simon Josefsson  <simon@josefsson.org>

	* tests/Makefile.am (EXTRA_DIST): Remove variable.
	(check_SCRIPTS): Renamed to dist_check_SCRIPTS.  Reported by
	ludo@gnu.org (Ludovic CourtÃ¨s).

2009-12-10  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (gnulib_modules): Add pty.

2009-12-10  Simon Josefsson  <simon@josefsson.org>

	* README-alpha: Change daily snapshot URL.

2009-12-09  Simon Josefsson  <simon@josefsson.org>

	* Makefile.am (AUTOMAKE_OPTIONS): Increase required automake
	version to 1.11 (because of AM_SILENT_RULES).

2009-12-08  Simon Josefsson  <simon@josefsson.org>

	* tftp/main.c: Include <argp.h>, <libinetutils.h>, "progname.h".
	(program_name): Removed variable.
	(argp, args_doc, doc, argp_options, hostport_argv, hostport_argc):
	New variable.
	(parse_opt): New function.
	(main): Use progname and argp.
	* man/Makefile.am (all): Add tftp.1 and tftpd.1.
	(dist_man1_MANS) [ENABLE_tftp]: Add tftp.1.
	(dist_man1_MANS) [ENABLE_tftpd]: Add tftpd.1.
	* NEWS: Updated.

2009-12-08  Simon Josefsson  <simon@josefsson.org>

	* man/Makefile.am (all): New variable.
	(EXTRA_DIST): Use $(all).
	(MAINTAINERCLEANFILES): Likewise.  Suggested by Alfred M. Szmidt
	<ams@gnu.org>.

2009-12-08  Simon Josefsson  <simon@josefsson.org>

	* man/Makefile.am (dist_man1_MANS): Variable cleared.
	(dist_man1_MANS) [ENABLE_hostname]: Add `hostname.1'.
	(dist_man1_MANS) [ENABLE_ifconfig]: Add `ifconfig.1'.
	(dist_man1_MANS) [ENABLE_inetd]: Add `inetd.1'.
	(dist_man1_MANS) [ENABLE_ftp]: Add `ftp.1'.
	(dist_man1_MANS) [ENABLE_ftpd]: Add `ftpd.1'.
	(dist_man1_MANS) [ENABLE_logger]: Add `logger.1'.
	(dist_man1_MANS) [ENABLE_ping]: Add `ping.1'.
	(dist_man1_MANS) [ENABLE_rcp]: Add `rcp.1'.
	(dist_man1_MANS) [ENABLE_rexec]: Add `rexec.1'.
	(dist_man1_MANS) [ENABLE_rexecd]: Add `rexecd.1'.
	(dist_man1_MANS) [ENABLE_rlogin]: Add `rlogin.1'.
	(dist_man1_MANS) [ENABLE_rlogind]: Add `rlogind.1'.
	(dist_man1_MANS) [ENABLE_rsh]: Add `rsh.1'.
	(dist_man1_MANS) [ENABLE_rshd]: Add `rshd.1'.
	(dist_man1_MANS) [ENABLE_syslogd]: Add `syslogd.1'.
	(dist_man1_MANS) [ENABLE_talk]: Add `talk.1'.
	(dist_man1_MANS) [ENABLE_talkd]: Add `talkd.1'.
	(dist_man1_MANS) [ENABLE_telnet]: Add `telnet.1'.
	(dist_man1_MANS) [ENABLE_telnetd]: Add `telnetd.1'.
	(dist_man1_MANS) [ENABLE_traceroute]: Add `traceroute.1'.
	(dist_man1_MANS) [ENABLE_uucpd]: Add `uucpd.1'.
	(dist_man1_MANS) [ENABLE_whois]: Add `whois.1'.
	(man_aux): Variable removed.
	(EXTRA_DIST): Set it directly instead of via man_aux.
	* am/enable.m4 (IU_ENABLE_FOO): Export ENABLE_foo.

	Reported by Ludovic CourtÃ¨s <ludo@gnu.org>.

2009-12-08  Simon Josefsson  <simon@josefsson.org>

	* man/Makefile.am: Use .h2m as extension for help2man includes.
	* man/ftp.x: Renamed to ftp.h2m.
	* man/ftpd.x: Renamed to ftpd.h2m.
	* man/hostname.x: Renamed to hostname.h2m.
	* man/ifconfig.x: Renamed to ifconfig.h2m.
	* man/inetd.x: Renamed to inetd.h2m.
	* man/logger.x: Renamed to logger.h2m.
	* man/ping.x: Renamed to ping.h2m.
	* man/rcp.x: Renamed to rcp.h2m.
	* man/rexec.x: Renamed to rexec.h2m.
	* man/rexecd.x: Renamed to rexecd.h2m.
	* man/rlogin.x: Renamed to rlogin.h2m.
	* man/rlogind.x: Renamed to rlogind.h2m.
	* man/rsh.x: Renamed to rsh.h2m.
	* man/rshd.x: Renamed to rshd.h2m.
	* man/syslogd.x: Renamed to syslogd.h2m.
	* man/talk.x: Renamed to talk.h2m.
	* man/talkd.x: Renamed to talkd.h2m.
	* man/telnet.x: Renamed to telnet.h2m.
	* man/telnetd.x: Renamed to telnetd.h2m.
	* man/tftp.x: Renamed to tftp.h2m.
	* man/tftpd.x: Renamed to tftpd.h2m.
	* man/traceroute.x: Renamed to traceroute.h2m.
	* man/uucpd.x: Renamed to uucpd.h2m.
	* man/whois.x: Renamed to whois.h2m.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (hostname invocation): Fix typo.  Reported by
	Alfred M. Szmidt <ams@gnu.org>.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* libinetutils/libinetutils.h: Don't include config.h, leads to
	double inclusion of config.h.
	* talkd/intalkd.h: Likewise.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* rexec/rexec.c (do_rexec): Don't use reserved variable 'stdin'.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* NEWS: Mention that man pages are generated using help2man.
	* configure.ac: Check for LN_S.
	* man/Makefile.am: Rewrite using skeleton rules.  Add man pages
	for many tools.
	* man/ftpd.x: New file.
	* man/ftp.x: Likewise.
	* man/hostname.x: Likewise.
	* man/ifconfig.x: Likewise.
	* man/inetd.x: Likewise.
	* man/logger.x: Likewise.
	* man/ping.x: Likewise.
	* man/rcp.x: Likewise.
	* man/rexecd.x: Likewise.
	* man/rexec.x: Likewise.
	* man/rlogind.x: Likewise.
	* man/rlogin.x: Likewise.
	* man/rsh.x: Likewise.
	* man/syslogd.x: Likewise.
	* man/talkd.x: Likewise.
	* man/talk.x: Likewise.
	* man/tftpd.x: Likewise.
	* man/tftp.x: Likewise.
	* man/traceroute.x: Likewise.
	* man/uucpd.x: Likewise.
	* man/whois.x: Likewise.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi (hostname invocation): Add section.

2009-12-07  Simon Josefsson  <simon@josefsson.org>

	* configure.ac: Check for help2man.
	* configure.ac (AC_CONFIG_FILES): Add man/Makefile.
	* Makefile.am (SUBDIRS): Add man directory.
	* man/Makefile.am: Add file.
	* man/telnet.x, man/telnetd.x, man/rshd.x: New files.

2009-12-06  Giuseppe Scrivano  <gscrivano@gnu.org>

	* NEWS: Mention the new program rexec.

2009-12-06  Guillem Jover  <guillem@hadrons.org>

	* hostname/hostname.c (parse_file): Use a do ... while loop
	instead of a while loop.

2009-12-05  Guillem Jover  <guillem@hadrons.org>

	* configure.ac: Remove libbsd check.

2009-12-05  Guillem Jover  <guillem@hadrons.org>

	* syslogd/syslogd.c (doexit): New function declaration.
	(main): Install doexit as SIGTERM handler.  Send SIGTERM instead
	of SIGALRM to the parent process.
	(doexit): New function.

2009-12-06  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac (AM_INIT_AUTOMAKE): Depend on automake 1.11.

2009-12-05  Guillem Jover  <guillem@hadrons.org>

	* ftpd/logwtmp.c (logwtmp) [_HAVE_UT_TV]: Use a `struct timeval'
	variable to get the result from gettimeofday.
	* libinetutils/logwtmp.c (logwtmp) [HAVE_STRUCT_UTMP_UT_TV]:
	Likewise.
	* libinetutils/utmp_init.c (utmp_init) [HAVE_STRUCT_UTMPX_UT_TV]:
	Likewise.
	* libinetutils/utmp_logout.c (utmp_logout): Likewise.

2009-12-05  Guillem Jover  <guillem@hadrons.org>

	* uucpd/uucpd.c (dologin): New `time_t' variable to use with
	time(), copy its contents to `ll.ll_time' afterwards.

2009-12-05  Guillem Jover  <guillem@hadrons.org>

	* configure.ac (AM_SILENT_RULES): Call macro.

2009-12-05  Samuel Thibault  <samuel.thibault@ens-lyon.org> (tiny change)

	* am/config_paths.m4 (IU_CONFIG_PATHS): Set iu_test_type to `e'.

2009-12-05  Ludovic CourtÃ¨s  <ludo@gnu.org> (tiny change)

	* tests/Makefile.am (check_SCRIPTS): New variable.
	(TESTS): Added $(check_SCRIPTS), removed `ping-localhost.sh' and
	`traceroute-localhost.sh' from list.
	(EXTRA_DIST): New variable.

2009-12-05  Alfred M. Szmidt  <ams@gnu.org>

	* cfg.mk (news-check-regexp): New variable.

2009-12-04  Guillem Jover  <guillem@hadrons.org>

	* ftp/ftp.c (hookup, initconn): Change `len' type from size_t to
	socklen_t.
	(dataconn): Change `fromlen' type from size_t to socklen_t.
	* ftpd/server_mode.c (server_mode): Change `addrlen' type from
	size_t to socklen_t.
	* ping/libping.c (ping_recv): Change `fromlen' type from size_t to
	socklen_t.
	* rexecd/rexecd.c (main): Likewise.
	* rlogind/rlogind.c (rlogin_daemon, rlogind_mainloop): Change
	`size' type from size_t to socklen_t.
	(rlogind_auth): Change `optsize' type from size_t to socklen_t.
	* rshd/rshd.c (main): Change `fromlen' type from size_t to
	socklen_t.
	(doit): Change `optsize' type from size_t to socklen_t.
	* syslogd/syslogd.c (main): Change `len' type from size_t to
	socklen_t.
	* talk/ctl.c (open_sockt, open_ctl): Change `length' type from
	size_t to socklen_t.
	* talkd/talkd.c (talkd_run): Change `len' type from size_t to
	socklen_t.
	* tftp/tftp.c (send_file, recvfile): Change `fromlen' type from
	size_t to socklen_t.
	* tftpd/tftpd.c (fromlen): Likewise.
	(main): Change `j' type from size_t to socklen_t.

2009-12-04  Simon Josefsson  <simon@josefsson.org>

	* doc/inetutils.texi: Improve chapter titles.

2009-12-03  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ftp/Makefile.am (LDADD): Replace "-L../lib -lgnu" with
	"../lib/libgnu.a".
	* ftpd/Makefile.am (LDADD): Likewise.
	* gwhois/Makefile.in (LDADD): Likewise.
	* inetd/Makefile.am (LDADD): Likewise.
	* ping/Makefile.am (ping_LDADD, ping6_LDADD): Likewise.
	* rcp/Makefile.am (LDADD): Likewise.
	* rexec/Makefile.am (LDADD): Likewise.
	* rexecd/Makefile.am (LDADD): Likewise.
	* rlogin/Makefile.am (LDADD): Likewise.
	* rlogind/Makefile.am (LDADD): Likewise.
	* rsh/Makefile.am (LDADD): Likewise.
	* rshd/Makefile.am (LDADD): Likewise.
	* syslogd/Makefile.am (LDADD): Likewise.
	* talk/Makefile.am (LDADD): Likewise.
	* talkd/Makefile.am (LDADD): Likewise.
	* telnet/Makefile.am (LDADD): Likewise.
	* telnetd/Makefile.am (LDADD): Likewise.
	* tests/Makefile.am (LDADD): Likewise.
	* tftp/Makefile.am (LDADD): Likewise.
	* tftpd/Makefile.am (LDADD): Likewise.
	* traceroute/Makefile.am (LDADD): Likewise.
	* uucpd/Makefile.am (LDADD): Likewise.
	* whois/Makefile.am (LDADD): Likewise.
	* hostname/Makefile.am (LDADD): Replace "-lgnu" with
	"../lib/libgnu.a".

2009-12-03  Giuseppe Scrivano  <gscrivano@gnu.org>

	* tests/Makefile.am (LDADD): Add missing dependency to gnulib.

2009-12-03  Giuseppe Scrivano  <gscrivano@gnu.org>

	* ftp/cmds.c (domap): Add braces around the else branch.
	(strup): Remove function.
	* ftp/ftp.c (hookup): Change `len' type to size_t.
	(getreply): Add parentheses around logic operators.
	(initconn): Change `len' type to size_t.
	(dataconn): Change `fromlen' type to size_t.
	(gunique): Add braces around the else branch.
	* ftp/main.c [HAVE_LIBREADLINE]: Include <readline/history.h>.
	* ftp/ruserpass.c (ruserpass): Add braces around the if branch.
	Add parentheses around logic operators.
	* ftpd/popen.c (ls_main): Add prototype.
	(ftpd_popen): Add parentheses.
	* ftpd/ftpd.c (off_to_str): Add casts to satisfy what the format
	string expects.
	(yyparse) Add prototype.
	(authentication_setup) Remove prototype.
	* ftpd/ftpcmd.y (yylex): Cast p->name to (char *) when its value
	is assigned to yylval.s.  Convert a ternary operator to an
	explicit if/else.
	* ftpd/server_mode.c (server_mode): Change type of `addrlen' to
	size_t.
	* hostname/hostname.c (struct hostname_arguments): Change type of
	`hostname_new' to (char *).
	(set_name): Likewise.
	(get_name): Remove unused variable.
	* ifconfig/system/linux.c (system_fh_hwaddr): Add cast.
	* inetd/inetd.c (expand_enter): Remove unused variables.
	(getconfigent): Change type of `argc' to int.
	* libinetutils/tftpsubs.c (synchnet): Change the `fromlen' type to
	socklen_t.
	* libinetutils/ttymsg.c (normalize_path): Use parentheses around
	assignment used as truth value.
	* libinetutils/utmp_logout.c (utmp_logout): Move assignment out
	from the if condition.
	* libls/ls.c (mastercmp): Add explicit braces.
	* ping/libping.c (ping_recv): Change `fromlen' type to size_t.
	* ping/ping6.c (parse_opt): Remove unused variable.
	* rcp/rcp.c (toremote): Remove unused variable.
	(rsource): Use parentheses around assignment used as truth value.
	* rexecd/rexecd.c (main): Change type of `fromlen' to size_t.  Use
	NULL as sentinel value to execl.  Add return statement.
	* rlogind/rlogind.c (iruserok): Add prototype.
	(rlogind_auth): Change type of `optisize' to size_t.
	* rsh/rsh.c (main): Remove unused variable.
	* rshd/rshd.c (iruserok): Add prototype.
	(main): Change type of `addrlen' to size_t.  Remove unused
	variable.
	(doit): Change type of `optsize' to size_t.  Add parentheses.  Use
	NULL as sentinel to execl instead of 0.
	* talk/ctl.c (open_sockt): Change `length' type to size_t.  Add
	return statement.
	(open_ctl): Likewise.
	* talk/ctl_transact.c (ctl_transact): Add return statement.
	* talk/display.c (display): Add return statement.
	* talk/get_addrs.c (get_addrs): Likewise.
	* talk/get_names.c (get_names): Likewise.
	* talk/init_disp.c (init_display): Likewise.
	(set_edit_chars): Likewise.
	* talk/invite.c (announce_invite): Likewise.
	(invite_remote): Likewise.
	(send_delete): Likewise.
	* talk/io.c (p_error): Add return statement.
	(message): Add return statement.
	* talk/look_up.c (check_local): add return statement.
	* talk/msgs.c (start_msgs): Add return statement.
	(end_msgs): Add return statement.
	* talk/talk.h (display): Change the type of 'text' to (char *).
	* talk/talk.c (display): Likewise.  Insert <unistd.h>.
	* talkd/talkd.c (talkd_run): Change type of len to size_t.
	* telnetd/slc.c (change_slc): Introduce a new variable `func' of
	type int.  Rename the previous `func' to `func_c' and assign its
	value to `func'.
	* telnetd/state.c (telrcv): Add parentheses around comparison.
	* telnetd/telnetd.c (struct debug_mode): Add missing braces around
	initializer.
	(telnetd_run): Add missing return statement.
	* telnetd/term.c (term_change_eof): Likewise.
	(oldeofc): Define it only if VEOF == VMIN.
	* telnetd/termstat.c (clientstat): Add parentheses around
	assignment.
	(getconfigent): Change `argc' and `i' type to int.
	* telnetd/utility.c [HAVE_READLINE_READLINE_H]: Include <term.h>.
	(net_get_char): Add default return statement.
	(pty_get_char): Likewise.
	(pty_input_putback): Likewise.
	(debug_close): Likewise.
	(printsub): Cast &pointer[i] to (char *) when used as argument to
	debug_output_datalen.
	* tftpd/tftpd.c (fromlen): Change type to size_t.  Make it static.
	(peer, rexmtval, maxtimeout, buf, ackbuf, from): Make static.
	(main): Change type of `j' to size_t.
	* telnet/externs.h (env_getvalue): Change argument type to const
	char *.
	* telnet/commands.c (makeargv): Add parentheses around assignment
	used as boolean value.
	(dokludgemode): Add return statement.
	(shell): Use NULL as sentinel to execl.
	(quit): Add return statement.
	(env_default, env_undefine, getcmd, tn): Add parentheses around
	assignment used as boolean value.
	(env_define, env_export, env_getvalue, env_init, env_undefine)
	(env_unexport): Move assignment out from the if condition.
	(env_export, env_find, env_define, env_send, env_unexport)
	(env_varval): Change type of `var' to (const char *).
	(tn): Add parentheses around logic operators.
	(cmdtab, cmdtab2): Add missing braces around initializer.
	* telnet/main.c (main): Add parentheses around assignment used as
	boolean value.
	* telnet/sys_bsd.c (process_rings): Cast ttyiring.supply to char *
	when used as argument to TerminalRead.
	* telnet/telnet.c [HAVE_READLINE_READLINE_H]: Include <term.h>.
	(initfunc, env_opt_add): Add parentheses around assignment used as
	boolean value.
	(dooption, gettermname, suboption, telnet): Remove cast.
	(suboption): Add casts to int.
	* telnet/terminal.c (ttyflush): When used as argument, cast
	ttyiring.{bottom, consume} (char *) to TerminalRead.
	* tftp/tftp.c (send_file): Change `fromlen' type to size_t.
	(recvfile): Likewise.
	(printstats): Add cast.
	* whois/whois.c (queryformat): Remove unused variable.

2009-12-03  Alfred M. Szmidt  <ams@gnu.org>

	* inetd/inetd.c (setup) [IPV6]: Reverse the value of
	SEP->se_v4mapped before setting socket options.  Reported by Ross
	Alexander <Ross.Alexander@eu.nec.com>.

2009-11-23  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping6.c (argp_options) <numeric>: Fix typo.

2009-11-16  Simon Josefsson  <simon@josefsson.org>

	* tests/ping-localhost.sh: Call the right executable.  Support
	EXEEXT.  Fix license header.
	* tests/traceroute-localhost.sh: Likewise.
	* tests/Makefile.am: Set EXEEXT, for Windows builds.

2009-11-16  Simon Josefsson  <simon@josefsson.org>

	* configure.ac: Don't call AB_INIT here too, it is already invoked
	via gnulib.  Reported by Alfred M. Szmidt <ams@gnu.org>.

2009-11-15  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Quote first argument in AC_DEFINE macro calls.
	(fixes sc_m4_quote_check)
	* am/config_paths.m4: Likewise.
	* am/check_weak_refs.m4: Likewise.

2009-11-15  Alfred M. Szmidt  <ams@gnu.org>

	* libtelnet/shishi.c: Don't include <assert.h> (fixes
	prohibit_assert_without_use).

2009-11-15  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (*.sig): Added new ignore rule.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* cfg.mk: Ignore failing tests, please revisit later.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* rcp/rcp.c (RCP_MODEMASK): Use S_ISVTX instead of S_ISTXT.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* ifconfig/system.c: Include config.h properly.
	* libinetutils/argcv.c: Likewise.
	* libinetutils/defauthors.c: Likewise.
	* libinetutils/logwtmpko.c: Likewise.
	* libtelnet/forward.c: Likewise.
	* talk/init_disp.c: Likewise.
	* talkd/acl.c: Likewise.
	* talkd/announce.c: Likewise.
	* talkd/print.c: Likewise.
	* talkd/process.c: Likewise.
	* talkd/table.c: Likewise.
	* telnet/ring.c: Likewise.
	* telnetd/pty.c: Likewise.
	* telnetd/slc.c: Likewise.
	* telnetd/state.c: Likewise.
	* telnetd/telnetd.c: Likewise.
	* telnetd/term.c: Likewise.
	* telnetd/termstat.c: Likewise.
	* telnetd/utility.c: Likewise.
	* tests/localhost.c: Likewise.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* rcp/rcp.c: Drop replacement of S_ISTXT, we use gnulib.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* libinetutils/daemon.c: Doc fix.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version number to 1.6.91.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/cmds.c (ls, setnmap): Fix syntax-check
	sc_avoid_if_before_free.

	* ftp/ftp.c (login, recvrequest, pswitch, gunique): Likewise.
	* ftp/ruserpass.c (ruserpass): Likewise.
	* ftpd/auth.c (auth_user, sgetcred): Likewise.
	* ftpd/ftpcmd.y (cmd_list, cmd, rcmd): Likewise.
	* ftpd/ftpd.c (curdir, end_login, dolog, send_file_list):
	Likewise.
	* ftpd/pam.c (pam_user): Likewise.
	* ifconfig/if_index.c (if_freenameindex): Likewise.
	* inetd/inetd.c (freeconfig, getconfigent): Likewise.
	* libinetutils/argcv.c (int argcv_free): Likewise.
	* libls/fts.c (fts_close, fts_build): Likewise.
	* libtelnet/kerberos5.c (kerberos5_is_auth): Likewise.
	* libtelnet/misc.c (auth_encrypt_init, auth_encrypt_user):
	Likewise.
	* syslogd/syslogd.c (main, logmsg): Likewise.
	* telnet/commands.c (env_define, env_undefine, tn): Likewise.
	* telnetd/state.c (suboption): Likewise.
	* telnetd/utility.c (getterminaltype): Likewise.
	* tftpd/tftpd.c (validate_access): Likewise.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Don't split copyright year list.

2009-11-14  Simon Josefsson  <simon@josefsson.org>

	* ftpd/ftpd.c: Don't include getopt.h without using it.
	* whois/whois.c: Likewise.
	* uucpd/uucpd.c: Likewise.
	* tftpd/tftpd.c: Likewise.
	* telnetd/telnetd.c: Likewise.
	* telnet/main.c: Likewise.
	* talk/talk.c: Likewise.
	* rshd/rshd.c: Likewise.
	* rlogind/rlogind.c: Likewise.
	* rexecd/rexecd.c: Likewise.
	* rcp/rcp.c: Likewise.
	* ifconfig/options.c: Likewise.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added gnupload.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (GNUmakefile, bootstrap.conf): Added new ignore
	rules.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Added dirname-lgpl.
	(lib/.gitignore): Updated by ./bootstrap.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* tests/Makefile.am (TESTS): Added ping-localhost.sh and
	traceroute-localhost.sh.  Use $(check_PROGRAMS) instead of
	specifying all C test cases manually.

	* tests/traceroute-localhost.sh, tests/ping-localhost.sh: New
	file.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (*.gcno, *.gcda, *.gcov, inetutils-*/)
	(inetutils-*.tar.gz): Added new ignore rules.

2009-11-14  Alfred M. Szmidt  <ams@gnu.org>

	* whois/whois.h, rsh/rsh.c (usage): Removed prototype.

2009-11-13  Simon Josefsson  <simon@josefsson.org>

	* hostname/hostname.c (get_aliases, get_ip_addresses): Fix
	syntax-check sc_cast_of_x_alloc_return_value.
	* ping/ping_common.c (init_data_buffer): Likewise.
	* rsh/rsh.c (main): Likewise.

2009-11-13  Simon Josefsson  <simon@josefsson.org>

	* rshd/rshd.c (doit): Fix syntax-check
	sc_cast_of_alloca_return_value.
	* ftpd/ftpd.c (send_file_list): Likewise.

2009-11-13  Simon Josefsson  <simon@josefsson.org>

	* inetd/inetd.c (nextconfig): Fix syntax-check
	sc_cast_of_argument_to_free.
	* hostname/hostname.c (set_name): Likewise.

2009-11-12  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (gnulib_modules): Add maintainer-makefile, to get
	coverage generating rules.
	* cfg.mk: New file, with coverage uploading rules.

2009-11-08  Alfred M. Szmidt  <ams@gnu.org>

	* hostname/hostname.c (_hostname_options): Struct renamed to ..
	(hostname_arguments): ... this.  Updated all references.
	(parse_opt, main, get_name, set_name): Renamed ARGUMENTS to ARGS.
	Updated all references.

2009-10-29  Alfred M. Szmidt  <ams@gnu.org>

	* hostname/hostname.c (argp_options): Fixed typo.

2009-10-29  Alfred M. Szmidt  <ams@gnu.org>

	* rlogind/rlogind.c, telnetd/pty.c: Include <pty.h>.

2009-10-29  Alfred M. Szmidt  <ams@gnu.org>

	* rexecd/rexecd.c (doit): Added forward declaration.

2009-10-29  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (TAGS): Added to list.

2009-10-29  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Use `getopt-gnu' instead of
	`getopt'.

2009-10-26  Alfred M. Szmidt  <ams@gnu.org>

	* uucpd/uucpd.c [BSD4_2]: Removed obsolete code.
	(main) [BSDINETD]: Likewise.
	(doit) [BSD4_2]: Likewise.
	(usage_str): Variable removed.
	(usage): Function removed.

2009-10-26  Alfred M. Szmidt  <ams@gnu.org>

	* traceroute/traceroute.c: Don't include "traceroute.h".
	(TRACE_UDP_PORT, TRACE_TTL): New macros.
	(TRACE_UDP, TRACE_ICMP, TRACE_1393): New enums.
	(trace): New struct.
	(trace_init, trace_inc_ttl, trace_inc_port, trace_port)
	(trace_read, trace_write, trace_udp_sock, trace_icmp_sock): Added
	forward declarations.
	* traceroute/traceroute.h: File removed.
	* traceroute/Makefile.am (noinst_HEADERS): Variable removed.

2009-10-26  Alfred M. Szmidt  <ams@gnu.org>

	* rcp/rcp.c: Include <sys/wait.h>.  Removed include for
	"extern.h".
	(BUF): New structure (from rcp/util.c).
	(allocbuf, colon, lostconn, nospace, okname, run_err, susystem)
	(verifydir): New functions (from rcp/util.c).
	* rcp/extern.h, rcp/util.c: Files removed.
	* rcp/Makefile.am (rcp_SOURCES): Removed `util.c'.
	(noinst_HEADERS): Variable removed.

2009-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/README.sec, ping/README.sec, syslogd/README.sec,
	talkd/README.sec, telnet/README.sec, telnetd/README.sec: Files
	removed.

	* whois/README: File removed.

2009-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* whois/TODO, ping/TODO, libicmp/TODO, ifconfig/TODO: Files
	removed (content merged into top-level TODO).
	* TODO: Updated.

2009-10-23  Alfred M. Szmidt  <ams@gnu.org>

	Renamed `gwhois' to `whois'.

	* Makefile.am (SUBDIRS): Renamed `gwhois' to `whois'
	* configure.ac: Likewise.

	* gwhois/.gitignore: Renamed file to ...
	* whois/.gitignore: ... this.

	* gwhois/Makefile.am: Renamed file to ...
	* whois/Makefile.am: ... this.

	* gwhois/README: Renamed file to ...
	* whois/README: ... this.

	* gwhois/TODO: Renamed file to ...
	* whois/TODO: ... this.

	* gwhois/as_del_list: Renamed file to ...
	* whois/as_del_list: ... this.

	* gwhois/data.h: Renamed file to ...
	* whois/data.h: ... this.

	* gwhois/ip_del_list: Renamed file to ...
	* whois/ip_del_list: ... this.

	* gwhois/make_as_del.pl: Renamed file to ...
	* whois/make_as_del.pl: ... this.

	* gwhois/make_ip_del.pl: Renamed file to ...
	* whois/make_ip_del.pl: ... this.

	* gwhois/make_tld_serv.pl: Renamed file to ...
	* whois/make_tld_serv.pl: ... this.

	* gwhois/tld_serv_list: Renamed file to ...
	* whois/tld_serv_list: ... this.

	* gwhois/whois.c: Renamed file to ...
	* whois/whois.c: ... this.

	* gwhois/whois.h: Renamed file to ...
	* whois/whois.h: ... this.

2009-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* .gitignore (ChangeLog): Removed from list.

2009-10-23  Alfred M. Szmidt  <ams@gnu.org>

	* rexec/.gitignore: New file.

2009-10-20  Rakesh Pandit  <rakesh@fedoraproject.org>

	* ping/ping.c (parse_opt): Handle `--debug' and `--ignore-routing'
	simultaneously.
	* ping/ping6.c (parse_opt): Likewise.  Set `socket_type' to
	SO_DONTROUTE.

2009-10-10  Giuseppe Scrivano <gscrivano@gnu.org>

	* TODO: Updated.

2009-10-06  Rakesh Pandit  <rakesh@fedoraproject.org>

	* ping/ping_common.h (ping_data): New member `ping_start_time'.
	(ping_timeout_p): New prototype.
	* ping/ping_common.c (ping_timeout_p): New function.

	* ping/ping6.c: Rename `timeout' to `resp_time', and use `timeout'
	for --timeout.
	(argp_options, parse_opt): New option --timeout.
	(ping_run): Check if we should abort due to timeout.
	(ping_init): Initialise P->ping_start_time.

	* ping/ping.c: Rename `timeout' to `resp_time', and use `timeout'
	for --timeout.
	(argp_options, parse_opt): New option --timeout.
	(ping_run): Check if we should abort due to timeout.
	* ping/libping.c (ping_init): Initialise P->ping_start_time.

	* doc/inetutils.texi (ping invocation): Updated.
	* NEWS: Updated.

2009-10-01  Rakesh Pandit <rakesh@fedoraproject.org>

	* talkd/talkd.c [HAVE_CONFIG_H]: Include config.h.

2009-08-21  Giuseppe Scrivano  <gscrivano@gnu.org>

	rexec: show all missing arguments before exit.

	* rexec/rexec.c (main): Show all missing arguments before exit
	from the process.

2009-08-20  Giuseppe Scrivano  <gscrivano@gnu.org>

	rexec: new program.

	* configure.ac: Add new client `rexec'.
	* Makefile.am (SUBDIRS): Add `rexec'.
	* doc/inetutils.texi: Document the new program.
	* rexec/Makefile.am: New file.
	* rexec/rexec.c: New file.

2009-08-18  Sergey Poznyakoff  <gray@gnu.org.ua>

	Fix possible array overflow in ping.

	* ping/ping.h (_C_BIT, _C_MASK)
	(_PING_SET, _PING_CLR, _PING_TST): Remove in favor of
	ping_common.h
	* ping/ping6.h: Likewise.
	* ping/ping_common.h (_C_BIT, _C_MASK): Moved from ping.h
	(_C_IND): New macro.
	(_PING_SET, _PING_CLR, _PING_TST): Modified versions of macros
	from ping.h.
	* ping/libping.c, ping/ping6.c: Update calls to _PING macros.

2009-07-19  Sergey Poznyakoff  <gray@gnu.org.ua>

	Fix net-tool output format in ifconfig.

	* configure.ac: Check for struct ifreq.ifr_map
	* paths: Add PATH_PROCNET_DEV
	* ifconfig/Makefile.am (AM_CPPFLAGS): Add $(PATHDEF_PROCNET_DEV)
	* ifconfig/if_index.c (if_nameindex): Fix typo.
	* ifconfig/options.c (net-tool format): Display interface
	statistics, if available.
	* ifconfig/printif.c: New macros: map?, irq?, irq, baseaddr?,
	baseaddr, memstart?, memstart, memend?, memend, dma?, dma.
	* ifconfig/printif.h (put_ulong): New prototype.
	(fh_map_query, fh_irq_query, fh_irq, fh_baseaddr_query)
	(fh_baseaddr, fh_memstart_query, fh_memstart, fh_memend_query)
	(fh_memend, fh_dma_query, fh_dma): New prototypes.
	* ifconfig/system/linux.c: Implement reading /proc/net/dev.
	* ifconfig/system/linux.h: Declare /proc/net/dev-related
	functions.

	* ping/ping_address.c: Rearrange includes to fix compilation on
	FreeBSD
	* ping/ping_echo.c: Likewise.
	* ping/ping_router.c: Likewise.
	* ping/ping_timestamp.c: Likewise.

2009-07-10  Giuseppe Scrivano <gscrivano@gnu.org>
	    Alfred M. Szmidt <ams@gnu.org>

	* rexecd/rexecd.c: Use EXIT_FAILURE consistently for calls to
	error.
	(doit): Add return value check after use
	setegid/setuid/setgid/initgroups and define its prototype.

2009-07-03  Sergey Poznyakoff  <gray@mirddin.farlep.net>

	Use separate sources for autoconf macros, as recommended by
	Autoconf.

	* acinclude.m4: Remove
	* am: New directory.
	* am/check_macro.m4: New file
	* am/check_member.m4: New file
	* am/check_weak_refs.m4: New file
	* am/config_paths.m4: New file
	* am/enable.m4: New file
	* am/flushleft.m4: New file
	* am/krb5.m4: New file
	* am/libcurses.m4: New file
	* am/result.m4: New file
	* bootstrap: Get aclocal flags from Makefile.am
	* Makefile.am (ACLOCAL_AMFLAGS): Add -I am.

2009-06-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* acinclude.m4 (IU_FLUSHLEFT): Fix the definition.
	* configure.ac: Use IU_FLUSHLEFT where needed.

2009-06-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* logger/logger.c: Rewritten from scratch, not using the libc
	syslog function.
	* doc/inetutils.texi: Update logger description.
	* NEWS: Update.

2009-06-26  Sergey Poznyakoff  <gray@gnu.org.ua>

	Finish argp-fying the utilities.

	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Order source
	names.
	* libinetutils/libinetutils.h (iu_argp_init): New macro.

	* ftp/main.c, ftpd/ftpd.c, hostname/hostname.c, inetd/inetd.c,
	logger/logger.c, ping/ping.c, ping/ping6.c, rcp/rcp.c,
	rexecd/rexecd.c, rlogin/rlogin.c, rlogind/rlogind.c, rsh/rsh.c,
	rshd/rshd.c, syslogd/syslogd.c, talk/talk.c, talkd/talkd.c,
	telnet/main.c, telnetd/telnetd.c, tftpd/tftpd.c,
	traceroute/traceroute.c, uucpd/uucpd.c: Use iu_argp_init.  Rewrite
	option descriptions to conform to standards.texi.

	* ifconfig/Makefile.am (INCLUDES): Add libinetutils
	* ifconfig/changeif.c: Use error() for diagnostics.
	* ifconfig/printif.c: Likewise.
	* ifconfig/ifconfig.c: Likewise.
	(main): Call parse_cmdline.
	* ifconfig/ifconfig.h: Include error.h, argp.h and libinetutils.h.
	* ifconfig/options.c: Use argp.  "check-existence": fix typo (was
	*check-existance).
	(usage): Remove.  Use error() for diagnostics.
	* ifconfig/options.h (parse_opt): Rename to parse_cmdline.
	* ifconfig/system.h (system_argp_child): New extern.
	(system_help_options, SYSTEM_SHORT_OPTIONS)
	(SYSTEM_LONG_OPTIONS): Remove.

	* ifconfig/system/generic.c: Use new command line parsing method.
	* ifconfig/system/hpux.c: Likewise.
	* ifconfig/system/linux.c: Likewise.
	* ifconfig/system/linux.h: Likewise.
	* ifconfig/system/osf.c: Likewise.
	* ifconfig/system/qnx.c: Likewise.
	* ifconfig/system/solaris.c: Likewise.

	* gwhois/Makefile.am (INCLUDES): Add libinetutils.
	* gwhois/whois.c: Use argp to parse the command line.
	(is_ripe_server): New function.
	(queryformat): Use is_ripe_server to determine if the server
	supports RIPE syntax.

2009-06-26  Sergey Poznyakoff  <gray@gnu.org.ua>

	Use argp in r* utils, telnet, talk and uucpd.

	* inetd/inetd.c: Remove unused forward decl.
	* rlogind/rlogind.c, rsh/rsh.c, rshd/rshd.c, telnet/main.c,
	telnetd/telnetd.c, tftpd/tftpd.c, uucpd/uucpd.c: Use argp to parse
	command line.

	* talk/talk.c: Use argp to parse command line.
	* talk/get_names.c (get_names): Argv no longer include program
	name.

	* rsh/Makefile.am (INCLUDES): Add libinetutils.
	* tftpd/Makefile.am: Likewise.
	* uucpd/Makefile.am: Likewise.

2009-06-25  Alfred M. Szmidt  <ams@gnu.org>

	* tests/Makefile.am (AM_CPPFLAGS): Added `-I$(top_srcdir)/lib' to
	list.

2009-06-25  Alfred M. Szmidt  <ams@gnu.org>

	* rexecd/Makefile.am (INCLUDES): Use
	`-I$(top_srcdir)/libinetutils' instead of `-I../libinetutils'

	* rexecd/rexecd.c: Include "libinetutils.h" instead of
	<libinetutils.h>.

2009-06-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	Use argp-version-etc module from gnulib

	* bootstrap.conf: Add argp-version-etc; Remove deprecated modules.
	* ftp/main.c, ftpd/ftpd.c, hostname/hostname.c, inetd/inetd.c,
	logger/logger.c, ping/ping.c, ping/ping6.c, rlogin/rlogin.c,
	syslogd/syslogd.c, talkd/talkd.c, traceroute/traceroute.c: Use
	argp-version-etc instead of ARGP_PROGRAM_DATA.

	* libinetutils/defauthors.c: New file.
	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Add
	defauthors.c.
	* libinetutils/libinetutils.h: Include argp-version-etc.h.
	(default_program_authors): New extern.
	(ARGP_PROGRAM_DATA_SIMPLE, ARGP_PROGRAM_DATA): Removed.

	* rcp/Makefile.am (INCLUDES): Add libinetutils.
	* rcp/rcp.c: Use argp and asprintf.  Remove obsolete varargs
	stuff.  Use error to display error messages on tty.

	* rexecd/Makefile.am (INCLUDES): Add libinetutils.
	* rexecd/rexecd.c: Use argp.  Remove obsolete varargs stuff.  Use
	error to display error messages on tty.

2009-06-15  Simon Josefsson  <simon@josefsson.org>

	* libtelnet/*: Change use of 'InetUtils' to 'Inetutils' as per
	mailing list discussions.

2009-06-10  Simon Josefsson  <simon@josefsson.org>

	* libinetutils/shishi.c: Add includes for strlen, memcpy, etc.
	* libtelnet/Makefile.am (noinst_HEADERS): Add genget.h.
	* libtelnet/auth-proto.h: Add prototype for auth_sendname, used by
	kerberos5.c and shishi.c.
	* libtelnet/auth.c: Add include for alarm.
	* libtelnet/enc_des.c: Add include for memcpy, etc.  Make type of
	encrypt_debug_mode explicit.
	* libtelnet/encrypt.c: Add includes for printf, isprefix, etc.
	(encrypt_send_keyid, encrypt_dec_keyid): Make return type
	explicit.
	(encrypt_keyid): Make return type explicit and mark as static.
	* libtelnet/misc.c: Add includes for auth_init and encrypt_init.

2009-06-02  Simon Josefsson  <simon@josefsson.org>

	* README-alpha: Mention statcvs URL.

2009-05-09  Alfred M. Szmidt  <ams@gnu.org>

	* ROADMAP: File removed, content to moved ...
	* TODO: ... here.

2009-05-07  Simon Josefsson  <simon@josefsson.org>

	* bootstrap.conf (gnulib_modules): Import fdl-1.3 instead of fdl,
	we want a version specific import.
	* doc/Makefile.am: Rename fdl.texi to fdl-1.3.texi.
	* doc/inetutils.texi: Use FDLv1.3+.  Reported by Karl Berry
	<karl@freefriends.org>.

2009-04-30  Simon Josefsson  <simon@josefsson.org>

	* acinclude.m4: Avoid comment to fix script.

2009-04-30  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* ftpd/Makefile.am (EXTRA_DIST): Removed man_MANS from list
	* ftpd/Makefile.am (man_MANS): Variable removed.
	* inetd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* libls/Makefile.am (EXTRA_DIST): Variable removed.
	* logger/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* ping/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* rcp/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* rexecd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* rlogin/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* rlogind/Makefile.am (EXTRA_DIST, man_MANS): Variable removed.
	* rsh/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* rshd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* syslogd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* talk/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* talkd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* telnet/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* telnetd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* tftp/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.
	* tftpd/Makefile.am (EXTRA_DIST, man_MANS): Variables removed.

	* ftp/ftp.1, ftpd/ftpd.8, gwhois/whois.1, inetd/inetd.8,
	libls/ls.1, logger/logger.1, ping/ping.8, rcp/rcp.1,
	rexecd/rexecd.8, rlogin/rlogin.1, rlogind/rlogind.8, rsh/rsh.1,
	rshd/rshd.8, syslogd/syslog.conf.5, syslogd/syslogd.8,
	talk/talk.1, talkd/talkd.8, telnet/telnet.1, telnetd/telnetd.8,
	tftp/tftp.1, tftpd/tftpd.8: Files removed.

2009-04-29  Simon Josefsson  <simon@josefsson.org>

	* NEWS: Mention that manual is now GFDLv1.3+.
	* bootstrap.conf: Import fdl-1.3 module.
	* doc/fdl.texi: Remove.

2009-04-29  Alfred M. Szmidt  <ams@gnu.org>

	* doc/Makefile.am (inetutils_TEXINFOS): Removed ftp.texi,
	ftpd.texi, inetd.texi, logger.texi ping.texi, rcp.texi
	rexecd.texi, rlogin.texi, rlogind.texi, rsh.texi rshd.texi,
	syslogd.texi, talk.texi, talkd.texi tftp.texi and traceroute.texi
	from list.
	* ftp.texi, ftpd.texi, inetd.texi, logger.texi, ping.texi,
	rcp.texi, rexecd.texi, rlogin.texi, rlogind.texi, rsh.texi,
	rshd.texi, syslogd.texi talk.texi, talkd.texi tftp.texi,
	traceroute.texi: Files removed.
	* doc/inetutils.texi: Rewritten.

2009-04-11  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (checkout_only_file): Removed variable.
	* README-hacking: New file.

2009-04-11  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (checkout_only_file): New variable.
	* README-hacking: File removed.
	* README-alpha: Updated.

2009-02-06  Simon Josefsson <simon@josefsson.org>

	* configure.ac: Bump version number to 1.6.90.

2009-01-23  Rakesh Pandit <rakesh.pandit@gmail.com>

	* ftpd/ftpcmd.y: Fix typo.

2008-12-27  Sergey Poznyakoff  <gray@gnu.org.ua>

	* bootstrap.conf: Add xgethostname and xgetdomainname.
	* configure.ac: Check for opendir2

	* hostname/hostname.c: Use xgethostname and xgetdomainname.
	* libinetutils/libinetutils.h (ARGP_PROGRAM_DATA_SIMPLE): New
	macro.
	(ARGP_PROGRAM_DATA): Rewrite using ARGP_PROGRAM_DATA_SIMPLE.
	* ftp/main.c, logger/logger.c, rlogin/rlogin.c, syslogd/syslogd.c:
	Use ARGP_PROGRAM_DATA_SIMPLE.
	* libls/fts.c: Fix bsdisms.
	* ping/ping.c: Include netinet/in.h
	* ping/ping_common.c: Include sys/socket.h and string.h.

	* bootstrap.conf: Add dirfd, filemode, inttostr and progname.
	* configure.ac: Fix checks for IPv6 header files.
	* doc/Makefile.am (inetutils_TEXINFOS): Add traceroute.texi.
	* doc/ftp.texi: Fixes.
	* ftp/cmds.c: Add missing includes.
	* ftp/ftp.c: Remove extern program_name.
	* ftp/ftp_var.h: Include progname.h
	* ftp/main.c (main): Call set_program_name
	* ftp/ruserpass.c: Include error.h
	* ftpd/Makefile.am (LDADD): Link LIBLS before libgnu.
	* ftpd/extern.h: Include getopt.h
	* ftpd/ftpd.c, gwhois/whois.c, hostname/hostname.c,
	logger/logger.c, rcp/rcp.c, rexecd/rexecd.c, rlogin/rlogin.c,
	rsh/rsh.c, rshd/rshd.c, syslogd/syslogd.c, talk/talk.c,
	traceroute/traceroute.c: Include progname.h
	(main): Call set_program_name.

	* ftpd/popen.c: Remove useless extern.
	* ifconfig/ifconfig.h: Include progname.h.
	* ifconfig/options.c (parse_opt): Call set_program_name.
	* ifconfig/options.h (program_name): Remove extern.
	* inetd/inetd.c: Include progname.h
	(main): Call set_program_name.
	(EAI_ADDRFAMILY): Provide a fallback definition for FreeBSD.
	* libinetutils/argcv.c: Include ctype.h
	* libinetutils/libinetutils.h (utmp_logout, logwtmp_keep_open):
	New protos.
	* libls/bsdport.h: Remove
	* libls/bsdport.c: Remove
	* libls/Makefile.am (libls_a_SOURCES): Remove bsdport.c
	(noinst_HEADERS): Remove bsdport.h
	(INCLUDES): New var.
	* libls/fts.c: Remove bsdport.h
	* libls/ls.c: Remove bsdisms.
	* libls/print.c: Likewise.
	* libtelnet/auth.h (auth_debug_mode): Fix extern.
	* ping/libping.c (ping_recv): Fix call to ping_event.handler.
	* ping/ping.c, ping/ping6.c (main): Call set_program_name.
	* ping/ping_common.c (ping_set_data): Remove useless if.
	* ping/ping_common.h: Include error.h and progname.h
	* rcp/util.c: Include error.h
	* rlogind/rlogind.c: Include utmp.h

	* talk/ctl.c (print_addr): Remove unused function.
	* talk/ctl_transact.c: Include talk.h
	* talk/display.c: Fix order of function definitions.
	* talk/get_addrs.c: Include unistd.h
	* talk/get_names.c: Include unistd.h and netinet/in.h
	* talk/init_disp.c: Include unistd.h
	* talk/invite.c: Fix order of function definitions.
	* talk/io.c: Include unistd.h
	* talk/look_up.c: Include unistd.h.  Fix order of function
	definitions.
	* talk/talk.h: Include progname.h.  Add missing prototypes.
	* talk/talk_ctl.h (ctl_transact): New proto.
	* telnet/commands.c: Include sys/wait.h.  Reorder function
	definitions.
	* telnet/externs.h, telnet/ring.h: Add missing prototypes.
	* telnet/telnet.c: Reorder function definitions.
	* telnet/utilities.c: Include sys/socket.h
	* telnetd/telnetd.h: Include sys/stat.h and ctype.h.  Add missing
	prototypes.
	* traceroute/Makefile.am (INCLUDES): Add ../lib.
	(LDADD): Add ../libgnu.a
	* uucpd/uucpd.c: Reorder function definitions.

	* NEWS, configure.ac: Version 1.6

	* doc/ftp.texi: Use proper Texinfo markup
	* doc/ftpd.texi: Likewise.
	* doc/inetutils.texi: Likewise.
	* doc/logger.texi: Likewise.
	* doc/ping.texi: Likewise.
	* doc/rcp.texi: Likewise.
	* doc/rexecd.texi: Likewise.
	* doc/rlogin.texi: Likewise.
	* doc/rlogind.texi: Likewise.
	* doc/rsh.texi: Likewise.
	* doc/rshd.texi: Likewise.
	* doc/syslogd.texi: Likewise.
	* doc/talk.texi: Likewise.
	* doc/talkd.texi: Likewise.
	* doc/tftp.texi: Likewise.
	* doc/traceroute.texi: Likewise.

2008-12-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* bootstrap.conf: Add version-etc-fsf.
	* inetd/inetd.c: Restore (approximate) list of authors from the
	ChangeLog.  Fix memory allocation.  Use getline for reading config
	files.  Reorder stuff in a logical manner.

2008-12-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* README-alpha: Rewrite.  Add information on how to get sources
	from CVS and Git.
	* README-hacking: New file.
	* bootstrap.conf: Update copyright year.  Remove
	checkout_only_file override.

	* bootstrap: New file.
	* bootstrap.conf: Read in the options from .bootstrap, if it is
	present.
	* configure.ac: Always check for getaddrinfo.

	* inetd/inetd.c: Support optional address specifications.  Use
	getaddrinfo wherever it is available, otherwise fall back to
	gethostbyname/getservbyname approach.  Improve debugging
	diagnostics.

	* doc/inetd.texi: Rewrite in a manual fashion.  Document new
	features.
	* inetd/inetd.8: Provide a reference to texinfo docs.

2008-10-14  Rakesh Pandit  <rakesh.pandit@gmail.com>

	* ping/ping_impl.h, ping/ping.h, ping/ping_common.h, ping/ping6.h
	(ping_stat, PEV_RESPONSE, PEV_DUPLICATE, PEV_NOECHO)
	(PING_INTERVAL, PING_CKTABSIZE, MAXWAIT, OPT_FLOOD, OPT_INTERVAL)
	(OPT_NUMERIC, OPT_QUIET, OPT_RROUTE, OPT_VERBOSE, PING_TIMING)
	(PING_HEADER_LEN, PING_DATALEN): Moved all these common macros and
	structures from ping_impl.h , ping6.h and ping_ping.h to
	ping_common.h.  Removed PING_INTERVAL.
	* ping/ping6.c (ping_run): Used PING_SET_INTERVAL similar to
	libping.c and used PING_DEFAULT_INTERVAL in place of
	PING_INTERVAL.

	* ping/libping.c (ping_set_datalen): Removed.

	* ping/libping.c, ping/ping_common.c (_ping_freebuf,
	ping_unset_data): Moved _ping_freebuf, ping_unset_data from
	libping.c to ping_common.c.
	* ping/ping6.c (ping_run): Free memory with call to
	ping_unset_data.

2008-10-14  Rakesh Pandit  <rakesh.pandit@gmail.com>

	* ping/libping.c, ping/ping_common.c, ping/ping_common.h
	(ping_set_count, ping_set_sockopt, ping_set_interval): Moved
	functions from libping.c to ping_common.c and made corresponding
	entries in ping_common.h

	* ping/ping6.c (main): Used ping_set_interval, ping_set_sockopt,
	ping_set_count in place of directly modifying struct p.

2008-10-14  Rakesh Pandit  <rakesh.pandit@gmail.com>

	* ping/ping_common.h, ping/ping.c, ping/ping_address.c,
	ping/ping_echo.c, ping/ping_router.c, ping/ping_timestamp.c,
	ping/libping.c: Added common headers from ping related files
	(ping.c, ping_address.c, ping_echo.c, ping_router.c)
	(ping_timestamp.c, libping.c) and ping6.c to ping/ping_common.h.

	* ping/ping.h, ping/ping6.h, ping/ping_common.h (ping_data,
	ping_efp): Moved ping_data, ping_efp from ping.h & ping6.h to
	ping_common.h

	* ping/libping.c, ping/ping6.c, ping/ping_common.c (_ping_setbuf,
	ping_set_data): Moved _ping_setbuf and ping_set_data from
	libping.c & ping6.c to ping_common.c

	* ping/ping_common.h (ping_address, event, ping_data): Introduced
	new unions ping_address and event in ping_common.h.  Replaced ping
	efp handler(ping_efp/ping_efp6) with event union and socket
	address(sockaddr_in sockaddr_in6) with ping_address union.

	* ping/ping_common.h (_PING_BUFLEN, _ping_setbuf, ping_set_data):
	New argument use_ipv6 and all callers changed.

2008-10-14  Rakesh Pandit  <rakesh.pandit@gmail.com>

	* libicmp/Makefile.am (libicmp_a_SOURCES): Removed libping.c and
	ping.h

	* ping/Makefile.am (ping_SOURCES): Added libping.c and ping.h

2008-10-14  Rakesh Pandit  <rakesh.pandit@gmail.com>

	* ping/ping6.c (is_root, count, interval, socket_type): New global
	variables count, interval & socket_type, similar to ping.c
	Initialize to is_root and count to false and DEFAULT_PING_COUNT
	respectively.

	* ping/ping6.c (parse_opt): Replaced ping structure usage with
	global variables.

	* ping/ping6.c (main): Assigned parsed values to ping structure.

2008-09-27  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Renamed ftp and ftpd nodes to `FOO
	invocation'.  Formatting fixes.

2008-09-27  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (DISTCLEANFILES): Removed `include/*.h,
	`include/*/*.h', and `include/stamp-'h from list.

	* configure.ac (AC_CONFIG_FILES): Removed `doc/rfc/Makefile.am'
	from list

	* doc/Makefile.am (SUBDIRS): Remove variable.
	* doc/rfc/.cvsignore, doc/rfc/Makefile.am, doc/rfc/rfc1282.txt:
	Files removed.

2008-09-26  Arash Yadegarnia <arash@bluehome.net> (tiny change)

	* doc/ftpd.texi (ftpd): Updated documentation for `--auth'.

2008-09-26  Alfred M. Szmidt  <ams@gnu.org>

	* .cvsignore (config.h, confpaths.h, stamp-h1): Added files.

	* hostname/.cvsignore: New file.

2008-09-26  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Refer to `COMMAND invocation' nodes for
	logger, rcp, rexecd and syslogd.  Formating fixes.  Mention
	traceroute in the TOC.

	* doc/logger.texi, doc/rcp.texi, doc/rexecd.texi, doc/syslogd.texi
	doc/talk.texi, doc/talkd.texi, doc/tftp.texi: Fixed some
	formatting details.  Renamed all nodes to `COMMAND invocation'.

2008-09-26  Alfred M. Szmidt  <ams@gnu.org>

	* doc/traceroute.texi: New file.

2008-09-26  Alfred M. Szmidt  <ams@gnu.org>

	* README-alpha: Update details where to get gnulib.

2008-08-23  Debarshi Ray  <rishi@gnu.org>

	* hostname/hostname.c (main): Initialize OPTIONS to zero.

2008-08-23  Debarshi Ray  <rishi@gnu.org>

	* hostname/hostname.c (hostname_options): New structure to
	encapsulate command line options.
	(hostname_file, hostname_new, hostname_alias, hostname_fqdn)
	(hostname_ip_address, hostname_dns_domain, hostname_short):
	Variables removed.
	(get_name): Changed type to `void get_name (const hostname_options
	*const options)'.  All users changed accordingly.
	(set_name): Likewise.
	(main): Added new variable OPTIONS.

2008-08-13  Debarshi Ray  <rishi@gnu.org>

	* hostname/hostname.c: Options --alias and --ip-adress aliased to
	--aliases and --ip-addresses respectively.

2008-08-12  Debarshi Ray  <rishi@gnu.org>

	* hostname/hostname.c: Include arpa/inet.h and netinet/in.h.
	Added new switches --alias, --ip-address and removed OPTION_HIDDEN
	from --file.
	(hostname_alias, hostname_ip_address): New variables.
	(get_aliases, get_ip_addresses, parse_file): New functions.
	(main): Replace printf with puts.
	(get_short_hostname): Changes to follow GNU coding style.

2008-08-12  Debarshi Ray  <rishi@gnu.org>

	* hostname/hostname.c (parse_opt) <ARGP_KEY_NO_ARGS>: Removed.
	(main): Removed unused variable INDEX.  Specify default value of
	GET_NAME_ACTION.

2008-08-12  Debarshi Ray  <rishi@gnu.org>

	* NEWS: Mention the addition of `hostname'.
	* configure.ac: Add new client `hostname'.
	(AC_CONFIG_FILES): Add `hostname/Makefile'.
	* Makefile.am (SUBDIRS): Add `hostname' to list.
	* hostname/Makefile.am: New file.
	* hostname/hostname.c: Likewise.

2008-08-09  Debarshi Ray  <rishi@gnu.org>

	* libicmp/icmp_timestamp.c: Include <stddef.h>.

2008-07-19  Sergey Poznyakoff  <gray@gnu.org.ua>

	* inetd.c (TOOMANY): Raise to 1000, as specified in the docs.
	(struct servtab): New member se_max.
	(main): Take into account se_max settings.
	(getconfigent): Initialize se_max.
	* inetd/inetd.8: Document [.max] suffix.

2008-06-11  Debarshi Ray  <rishi@gnu.org>

	* rlogin/Makefile.am (INCLUDES): Added
	`-I$(top_srcdir)/libinetutils'.

	* rlogin/rlogin.c: Include <argp.h>.  Remove include for
	<getopt.h>.  Include "libinetutils.h".
	(dflag, host, user): New variables.
	(msg, usage): Functions removed.  Use argp_error or error in all
	callers accordingly.
	(short_options, long_options): Variables removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc, argp_options): New variables.
	(program_name): Variable removed.
	(parse_opt): New function.
	(argp): New variable.
	(main): Added new variable INDEX.  Removed variables CH, DFLAG,
	HOST and USER.  Use argp to parse program options.

2008-06-05  Debarshi Ray  <rishi@gnu.org>

	* libicmp/libping.c (ping_reset): New function.
	(_ping_freebuf): Free PING->ping_cktab.
	(ping_unset_data): New function.

	* libicmp/ping.h (ping_reset): New function.
	(ping_unset_data): New function.

	* ping/ping.c (ping_type): Changed type to `int (*ping_type) (char
	*hostname)'.  All users changed accordingly.
	(decode_type): Likewise.
	(main): Allow multiple hosts on the command line.
	(ping_run): Avoid decrementing PRELOAD.  Replaced free with
	ping_unset_data.

	* ping/ping6.c (main): Added new variable STATUS.  Multiple host
	support implemented.
	(ping_run): Avoid decrementing PRELOAD.
	(ping_echo): Changed type to `static int ping_echo (char
	*hostname)`.  All callers and declarations changed accordingly.
	Added new variable STATUS.  Free PING->ping_hostname.
	(ping_reset): New function.
	(echo_finish): Call return instead of exit.

	* ping/ping_address.c (ping_address): Changed type to `int
	ping_address (char *hostname)'.  All callers and extern
	declarations changed accordingly.

	* ping/ping_echo.c (ping_echo): Likewise.

	* ping/ping_router.c (ping_router): Likewise.

	* ping/ping_timestamp.c (ping_timestamp): Likewise.

2008-05-20  Debarshi Ray  <rishi@gnu.org>

	* ftp/cmds.c, ftp/ftp.c, ftp/main.c, ftpd/ftpd.c, ftpd/popen.c,
	inetd/inetd.c, libinetutils/argcv.c, libls/ls.c, ping/ping6.c,
	rcp/util.c, rexecd/rexecd.c, rlogind/rlogind.c, rsh/rsh.c,
	talk/get_names.c, talk/invite.c, talk/look_up.c, talkd/talkd.c,
	telnet/commands.c, telnet/utilities.c, telnetd/utility.c,
	uucpd/uucpd.c: Remove unused variables and add ARG_UNUSED
	attribute to unused function arguments.

2008-05-13  Debarshi Ray  <rishi@gnu.org>

	* libls/bsdport, libls/cmp.c, libls/ls.c, libls/print.c,
	libls/stat_flags.c [ORIGINAL_SOURCE]: Removed dead code.

2008-04-21  Guillem Jover <guillem@hadrons.org>

	* syslogd/syslogd.c (init): Add ARG_UNUSED attribute to SIGNO
	argument.
	(domark): Likewise.  Remove now unneeded no-op SIGNO statement.

2008-04-20  Michal Svoboda <pht@spatium.org> (tiny change)

	* ping/ping6.c (print_echo): Cast ICMP6+1 and not ICMP6 to `struct
	timeval *'.

2008-04-19  Debarshi Ray  <rishi@gnu.org>

	* traceroute/traceroute.c: Added new switch --type.
	(opt_type): New variable.
	(main): Replace getuid with geteuid.  Use OPT_TYPE instead of
	hard-coding TRACE_ICMP.

2008-04-18  Debarshi Ray  <rishi@gnu.org>

	* ChangeLog: Remove unnecessary "(tiny change)"s.

2008-04-17  Debarshi Ray  <rishi@gnu.org>

	* traceroute/traceroute.c: Include <error.h>.  Added new switch
	--tries.
	(opt_max_tries): Declared static.

2008-04-17  Alfred M. Szmidt  <ams@gnu.org>

	* traceroute/traceroute.c (do_try): Removed unused variable HOST.

2008-04-16  Debarshi Ray  <rishi@gnu.org>

	* syslogd/syslogd.c: Include <argp.h>, and <error.h>.  Remove
	include for <getopt.h>.
	(program_name): Variable removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc): New variables.
	(usage): Function removed.
	(OPT_NO_FORWARD, OPT_NO_KLOG, OPT_NO_UNIXAF, OPT_PIDFILE): New
	enums.
	(argp_options): New variable.
	(short_options, long_options): Variables removed.
	(parse_opt): New function.
	(argp): New variable.
	(main): Removed variable OPTION.  Use argp to parse program
	options.  Use error instead of "output message; exit;"
	concoction's.
	(add_funix): Use error instead of "output message; exit;"
	concoction's.
	(crunch_list): Use error instead of "output message; exit;"
	concoction's.
	(die): Use program_invocation_name instead of program_name.

2008-04-16  Debarshi Ray  <rishi@gnu.org>

	* logger/Makefile.am (INCLUDES): Added
	`-I$(top_srcdir)/libinetutils'.

	* logger/logger.c: Include <argp.h>, and <error.h>.  Remove
	include for <getopt.h>.  Include "libinetutils.h".
	(program_name, short_options, long_options): Variables removed.
	(tag, logflags, pri): New variables.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc, argp_options): New variables.
	(usage): Function removed.
	(parse_opt): New function.
	(argp): New variable.
	(main): Added new variable INDEX.  Removed variables OPTION,
	LOGFLAGS, PRI and TAG.  Use argp to parse program options.
	(pencode): Use error instead of "output message; exit;"
	concoction's.  Use EXIT_FAILURE.

2008-04-15  Ludovic CourtÃ¨s <ludo@gnu.org> (tiny change)

	* acinclude.m4 (IU_CONFIG_PATHS): Honor `$TMPDIR'.

2008-04-14  Edward Attfield <attfield@nortel.com> (tiny change)

	* telnet/sys_bsd.c (process_rings): New variable NFDS.  Detect the
	number of open file descriptors during FD_SET.

2008-02-06  Simon Josefsson  <simon@josefsson.org>

	* libtelnet/shishi.c: Delay initialization of Shishi until it is
	really needed.

2007-09-06  Debarshi Ray  <rishi@gnu.org>

	* ftp/cmds.c (setpeer): If HOSTNAME is set, try to reconnect to
	it.

2007-09-02  Debarshi Ray  <rishi@gnu.org>

	* bootstrap.conf (gnulib_modules): Added `readline'.

	* configure.ac: Check for add_history libhistory and libreadline.

	* ftp/Makefile.am (READLINE): Added `@LIBHISTORY@'.

	* ftp/extern.h (another): Changed type of PROMPT to `const char
	*'.

	* ftp/cmds.c (another): Added new variables BUFFER and ARG.  Use
	readline for input.  Use better error handling.
	(another) [HAVE_LIBHISTORY]: Use add_history.

	* ftp/ftp.c (login): Removed all references to HAVE_LIBREADLINE.
	* ftp/ftp_var.h: Likewise.

	* ftp/main.c [!HAVE_LIBREADLINE]: #include "readline.h".
	(cmdscanner): Use readline uniformly.  Use NULL instead of 0.
	(cmdscanner) [HAVE_LIBHISTORY]: Use add_history.

2007-09-02  Pedro Alves  <pedro_alves@portugalmail.pt>  (tiny change)

	* rcp/rcp.c (rsource): Free BUF after call to source().

2007-07-26  Debarshi Ray  <rishi@gnu.org>

	* ping/ping_echo.c (ping_echo): Free PING->ping_hostname.
	(echo_finish): Call return instead of exit.

	* ping/ping.c (main): Free PING and DATA_BUFFER.
	(ping_run): Free PING->ping_buffer and PING->ping_cktab.

2007-07-21  Debarshi Ray  <rishi@gnu.org>

	* ftp/main.c: Include <argp.h>, and <string.h>.  Remove include
	for <getopt.h>.  Include "libinetutils.h".
	(program_name): Variable removed.
	(usage): Function removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc, argp_options): New variables.
	(parse_opt): New function.
	(short_options, long_options): Variables removed.
	(argp): New variable.
	(main): Added new variable INDEX.  Use EXIT_FAILURE and
	EXIT_SUCCESS.  Use argp to parse program options.  Use
	program_invocation_name instead of program_name.

	* ftp/cmds.c (quit): Use EXIT_SUCCESS.
	(shell): Use EXIT_FAILURE.

2007-07-15  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/ftp.c (command): Ignore SIGPIPE when flushing COUT.

	* ftp/cmds.c (setpeer): Check that the connection is still open by
	sending a NOOP command to the server.

2007-07-15  Karl Berry <karl@freefriends.org> (tiny change)

	* doc/inetutils.texi: Fix typo.

2007-06-26  Alfred M. Szmidt  <ams@gnu.org>

	* COPYING: Updated to GPLv3.

	* Makefile.am, acinclude.m4, bootstrap.conf, configure.ac, paths,
	doc/Makefile.am, doc/rfc/Makefile.am, ftp/Makefile.am, ftp/cmds.c,
	ftpd/Makefile.am, ftpd/logwtmp.c, gwhois/Makefile.am,
	gwhois/whois.c, headers/Makefile.am, headers/shishi_def.h,
	ifconfig/Makefile.am, ifconfig/changeif.c, ifconfig/flags.c,
	ifconfig/flags.h, ifconfig/if_index.c, ifconfig/if_index.h,
	ifconfig/ifconfig.c, ifconfig/ifconfig.h, ifconfig/options.c,
	ifconfig/options.h, ifconfig/printif.c, ifconfig/printif.h,
	ifconfig/system.h, ifconfig/system/Makefile.am,
	ifconfig/system/generic.c, ifconfig/system/generic.h,
	ifconfig/system/hpux.c, ifconfig/system/hpux.h,
	ifconfig/system/linux.c, ifconfig/system/linux.h,
	ifconfig/system/osf.c, ifconfig/system/osf.h,
	ifconfig/system/qnx.c, ifconfig/system/qnx.h,
	ifconfig/system/solaris.c, ifconfig/system/solaris.h,
	inetd/Makefile.am, inetd/inetd.c, lib/Makefile.am,
	libicmp/Makefile.am, libicmp/icmp.h, libicmp/icmp_address.c,
	libicmp/icmp_cksum.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c, libicmp/libping.c, libicmp/ping.h,
	libinetutils/Makefile.am, libinetutils/argcv.c,
	libinetutils/argcv.h, libinetutils/cleansess.c,
	libinetutils/libinetutils.h, libinetutils/localhost.c,
	libinetutils/logwtmp.c, libinetutils/setsig.c,
	libinetutils/shishi.c, libls/Makefile.am, libtelnet/Makefile.am,
	libtelnet/kerberos5.c, libtelnet/shishi.c, logger/Makefile.am,
	ping/Makefile.am, ping/ping.c, ping/ping6.c, ping/ping6.h,
	ping/ping_address.c, ping/ping_common.c, ping/ping_common.h,
	ping/ping_echo.c, ping/ping_router.c, ping/ping_timestamp.c,
	rcp/Makefile.am, rexecd/Makefile.am, rlogin/Makefile.am,
	rlogind/Makefile.am, rlogind/rlogind.c, rsh/Makefile.am,
	rshd/Makefile.am, syslogd/Makefile.am, talk/Makefile.am,
	talkd/Makefile.am, talkd/acl.c, talkd/announce.c, talkd/intalkd.h,
	talkd/print.c, talkd/process.c, talkd/table.c, talkd/talkd.c,
	telnet/Makefile.am, telnetd/Makefile.am, telnetd/pty.c,
	telnetd/telnetd.c, telnetd/telnetd.h, telnetd/term.c,
	telnetd/utility.c, tests/Makefile.am, tests/localhost.c,
	tftp/Makefile.am, tftpd/Makefile.am, traceroute/Makefile.am,
	traceroute/traceroute.c, traceroute/traceroute.h,
	uucpd/Makefile.am: Updated license blurbs to the GNU General
	Public License version 3.

2007-06-26  Karl Berry  <karl@freefriends.org>  (tiny change)

	* doc/inetutils.texi: Updated Info directory entries.  Use
	@copying for permission notice.

2007-06-26  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Removed `allocsa'.

2007-06-11  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/ftpd.c (makedir): Pass NAME when calling reply().

2007-05-28  Debarshi Ray  <rishi@gnu.org>

	* inetd/inetd.8: Fix typo.

	* inetd/Makefile.am (INCLUDES): Added
	-I$(top_srcdir)/libinetutils.

	* inetd/inetd.c: Include <stdbool.h>, <argp.h> and
	"libinetutils.h".  Don't include <getopt.h>
	(program_name): Variable removed.
	(debug, env_option, resolve_option): Changed type to bool.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc): New variables.
	(OPT_ENVIRON, OPT_RESOLVE): New enums.
	(argp_options): New variable.
	(parse_opt): New function.
	(argp): New variable.
	(usage): Function removed.
	(short_options, long_options): Variables removed.
	(main): Use argp to parse program options.

2007-06-04  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping6.c (main): Move argument parsing before calling
	ping_init.

	* ping/ping.c (main): Reorder assignment of argc and argv to be
	right after calling argp_parse.

	* tftpd/tftpd.c (struct formats) [notdef]: Removed unused field
	"mail"..

	* telnet/telnet.c (modelist) [notdef]: Removed variable.
	(printring) [notdef]: Removed function.

	* telnet/sys_bsd.c (TerminalRestoreState) [notdef]: Remvoved
	function.
	(TerminalNewMode) [notdef]: Removed unused code.

	* telnet/ring.h (ring_consume_data) [notdef]: Removed extern
	declaration.

	* telnet/ring.c (ring_consume_data) [notdef]: Removed function.

	* telnet/commands.c (filestuff) [notdef]: Removed unused code.

	* rshd/rshd.c (doit) [notdef]: Removed unused code.

	* libtelnet/kerberos.c (prkey) [notdef]: Function removed.

	* libtelnet/encrypt.c (encrypt_init, encrypt_session_key)
	[notdef]: Removed unused code.

	* libls/fts.c (fts_build) [notdef]: Removed unused code.

	* libinetutils/des_rw.c (des_pcbc_encrypt) [notdef]: Removed
	forward declaration.

	* AUTHORS: Rewritten.

2007-05-31  Alfred M. Szmidt  <ams@gnu.org>

	* whois/.cvsignore: File removed.

	* ping/ping_router.c: Don't include "getopt.h".

2007-05-28  Debarshi Ray  <rishi@gnu.org>

	* ping/ping_timestamp.c: Don't include "getopt.h".  Include
	"ping_common.h".
	(ping_timestamp): Use error instead of "output message; exit;"
	concoction's.

	* ping/ping_impl.h (is_root, preload): Removed extern
	declarations.

	* ping/ping_echo.c (ping_echo): Use error instead of "output
	message; exit;" concoction's.

	* ping/ping_common.h (show_license): Removed declaration.

	* ping/ping_common.c: Include "ping_common.h".
	(ping_cvt_number, decode_pattern): Use error instead of "output
	message; exit;" concoction's.
	(show_license): Function removed.

	* ping/ping_address.c: Don't include "getopt.h".  Include
	"ping_common.h".
	(ping_address): Use error instead of "output message; exit;"
	concoction's.

	* ping/ping6.c: Include <stdbool.h>.  Don't include <getopt.h>.
	Include <argp.h> and "libinetutils.h".
	(short_options, long_options): Variables removed.
	(is_root, patptr, one, pattern_len): New variables.
	(show_usage): Function removed.
	(program_name): Variable removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc, argp_options): New variables.
	(parse_opt): New function.
	(argp): New variable.
	(main): Use argp to parse program options.
	(ping_echo, ping_init): Use error instead of "output message;
	exit;" concoction's.

	* ping/ping.c: Don't include <getopt.h>.  Include <argp.h> and
	"libinetutils.h".
	(short_options, long_options): Variables removed.
	(is_root, patptr, pattern_len, socket_type, count, interval): New
	variables.
	(show_usage): Function removed.
	(decode_type): Changed type to `int (*decode_type (const char
	*arg)) (int argc, char **argv)'.  All callers changed accordingly.
	(program_name): Variable removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc): New variables.
	(ARG_ECHO, ARG_ADDRESS, ARG_TIMESTAMP, ARG_ROUTERDISCOVERY): New
	enums.
	(argp_options): New variable.
	(parse_opt): New function.
	(main): Use argp to parse program options.

	* ping/Makefile.am (INCLUDES): Added
	`-I$(top_srcdir)/libinetutils'.

2007-05-28  Debarshi Ray  <rishi@gnu.org>

	* talkd/talkd.c (parse_opt): Renamed argument ST to STATE.

2007-05-24  Alfred M. Szmidt  <ams@gnu.org>

	* TODO: Updated.

2007-05-24  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/ftpd.c (main): Changed type of ADDRLEN to socklen_t.
	(dataconn): Changed type of S and FROMLEN to socklen_t.
	(passive): Changed type of LEN to socklen_t.

	* inetd/inetd.c (set_proc_title, echo_dg, chargen_dg, machtime_dg)
	(daytime_dg): Changed type of SIZE to socklen_t.

	* telnetd/state.c (doopt, dont, will, wont): Changed type to char
	[].

2007-05-24  Alfred M. Szmidt  <ams@gnu.org>

	* traceroute/traceroute.c (do_try): Removed variable PREV_TRACE.
	New variable PREV_ADDR.  Only print the IP/hostname if the
	previous IP was not the same.
	(trace_read): Changed type of DATA to u_char.
	(trace_read): Changed type of SIZ to socklen_t.
	(trace_write): Cast HDR to u_char *.

2007-05-23  Alfred M. Szmidt  <ams@localhost>

	* talkd/talkd.c (doc): Fix typo.

2007-05-23  Debarshi Ray  <rishi@gnu.org>

	* talkd/talkd.c: Include <argp.h>.  Don't include <getopt.h>.
	(show_usage, show_version, show_license): Functions removed.
	(short_options, long_options): Variables removed.
	(acl_file): New variable.
	(program_name): Variable removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc, argp_options): New variables.
	(parse_opt): New function.
	(argp): New variable.
	(main): Use argp to parse program options.

2007-05-23  Alfred M. Szmidt  <ams@localhost>

	* bootstrap.conf (gnulib_modules): Added "argp".

2007-05-23  Debarshi Ray  <rishi@gnu.org>

	* traceroute/Makefile.am (INCLUDES): Added
	`-I$(top_srcdir)/libinetutils'.

	* traceroute/traceroute.c: Don't include <getopt.h>.  Include
	<argp.h> and "libinetutils.h".  Use error() instead of "output
	message; exit;" concoction's.
	(show_usage): Function removed.
	(program_name): Variable removed.
	(host): New variable.
	(OPT_VERSION, OPT_HELP, OPT_RESOLVE_HOSTNAMES): Macros removed.
	(shor_options, option long_options): Variable removed.
	(ARGP_PROGRAM_DATA): Call macro.
	(args_doc, doc): New variables.
	(OPT_RESOLVE): New enum.
	(argp_options): New variable.
	(parse_opt): New function.
	(main) Use argp to parse program options.

2007-05-23  Debarshi Ray  <rishi@gnu.org>

	* libinetutils/libinetutils.h: Include "config.h".
	(ARGP_PROGRAM_DATA): New macro.

2007-04-19  Alfred M. Szmidt  <ams@gnu.org>

	* NEWS: Minor clean up.

2007-04-19  Alfred M. Szmidt  <ams@gnu.org>

	* whois/Makefile.am, whois/main.c, whois/net.c,
	whois/whois-servers: Files removed.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* tests/.cvsignore: New file.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* tests/localhost.c: Need to #include <stdio.h> for printf.

2007-04-12  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Removed
	`xalloc-die.c' from list.
	* libinetutils/xalloc-die.c: File removed.

2007-04-12  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/utmp_init.c (__USE_GNU): Define macro if and only
	if __USE_GNU was not defined.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* tests/Makefile.am: New file.

	* tests/localhost.c: New self test.

	* configure.ac: Build tests/Makefile.

	* Makefile.am (SUBDIRS): Add tests/.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* acinclude.m4: Remove AB_INIT.

	* bootstrap.conf (gnulib_modules): Add autobuild.

2007-04-12  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf (gnulib_modules): Removed `restrict' and
	`stdio-safer'.

2007-04-12  Alfred M. Szmidt  <ams@gnu.org>

	* acinclude.m4 (jm_INCLUDED_REGEX): Function removed.
	* configure.ac: Don't call `jm_INCLUDED_REGEX'.

	* bootstrap.conf (gnulib_modules): Add `regex' to list.

2007-04-12  Alfred M. Szmidt  <ams@gnu.org>

	* bootstrap.conf: Create m4/ if it does not exist.

	* README-alpha: Updated.

2007-04-12  Simon Josefsson  <simon@josefsson.org>

	* README-alpha: Mention new daily builds and autobuild logs.

	* acinclude.m4: Add contents of autobuild.m4.  Suggested by
	"Alfred M. Szmidt" <ams@gnu.org>.

	* configure.ac: Call AB_INIT.

2007-03-31  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (snapshot): Target renamed to `snapshot'.

2007-03-30  Alfred M. Szmidt  <ams@gnu.org>

	Revert change from 2007-03-29.

	* Makefile.am (MAINTAINERCLEANFILES): Removed variable.
	* ping/Makefile.am (MAINTAINERCLEANFILES): Likewise.

2007-03-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	* README-alpha: Fixed typo.

2007-03-29  Debarshi Ray  <rishi@gnu.org>  (tiny change)

	* Makefile.am (MAINTAINERCLEANFILES): New variable.

2007-03-29  Debarshi Ray  <rishi@gnu.org>  (tiny change)

	* ping/Makefile.am (MAINTAINERCLEANFILES): New variable.

2007-03-27  Debarshi Ray  <rishi@gnu.org>  (tiny change)

	* bootstrap.conf (checkout_only_file): New variable.
	* README-alpha: Updated.

2007-03-21  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/main.c (usage): Fix typo.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* README-alpha: Updated instructions for generating auto* and
	gnulib files.

	* autogen.sh: File removed.

	* bootstrap.conf, lib/Makefile.am: New files.

2007-03-16  Simon Josefsson  <simon@josefsson.org>

	* libtelnet/shishi.c (krb5shishi_send): Don't set a
	use-session-key ap-options, that is for user2user authentication
	which is not appropriate here.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* .cvsignore: Added `build-aux'.

	* ping/.cvsignore: Added `ping6'.

	* traceroute/.cvsignore: New file.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Removed libglob checks.
	(AC_CONFIG_FILES): Don't list glob/Makefile.

	* Makefile.am (SUBDIRS): Removed `glob'.

	* glob/.cvsignore, glob/COPYING.LIB, glob/Makefile.am,
	glob/SMakefile, glob/configure.bat, glob/configure.in,
	glob/fnmatch.c, glob/fnmatch.h, glob/glob.c, glob/glob.h: Files
	removed.

2007-03-16  Alfred M. Szmidt  <ams@gnu.org>

	* lib/.cvsignore, lib/Makefile.am, lib/alloca.c, lib/alloca_.h,
	lib/allocsa.c, lib/allocsa.h, lib/allocsa.valgrind,
	lib/asnprintf.c, lib/dup-safer.c, lib/error.c, lib/error.h,
	lib/exit.h, lib/exitfail.c, lib/exitfail.h, lib/fd-safer.c,
	lib/fopen-safer.c, lib/free.c, lib/getcwd.c, lib/getcwd.h,
	lib/getdelim.c, lib/getdelim.h, lib/getline.c, lib/getline.h,
	lib/getopt.c, lib/getopt1.c, lib/getopt_.h, lib/getopt_int.h,
	lib/getpass.c, lib/getpass.h, lib/gettext.h, lib/getusershell.c,
	lib/malloc.c, lib/mbchar.c, lib/mbchar.h, lib/mbuiter.h,
	lib/memchr.c, lib/memcmp.c, lib/memcpy.c, lib/memmove.c,
	lib/mempcpy.c, lib/mempcpy.h, lib/memset.c, lib/minmax.h,
	lib/obstack.c, lib/obstack.h, lib/pipe-safer.c, lib/poll.c,
	lib/poll_.h, lib/printf-args.c, lib/printf-args.h,
	lib/printf-parse.c, lib/printf-parse.h, lib/readutmp.c,
	lib/readutmp.h, lib/realloc.c, lib/regcomp.c, lib/regex.c,
	lib/regex.h, lib/regex_internal.c, lib/regex_internal.h,
	lib/regexec.c, lib/setenv.c, lib/setenv.h, lib/size_max.h,
	lib/snprintf.c, lib/snprintf.h, lib/stdbool_.h, lib/stdint_.h,
	lib/stdio--.h, lib/stdio-safer.h, lib/strcase.h, lib/strcasecmp.c,
	lib/strchrnul.c, lib/strchrnul.h, lib/strdup.c, lib/strdup.h,
	lib/strerror.c, lib/strncasecmp.c, lib/strndup.c, lib/strndup.h,
	lib/strnlen.c, lib/strnlen.h, lib/strnlen1.c, lib/strnlen1.h,
	lib/sysexit_.h, lib/unistd--.h, lib/unistd-safer.h,
	lib/unlocked-io.h, lib/unsetenv.c, lib/vasnprintf.c,
	lib/vasnprintf.h, lib/vsnprintf.c, lib/vsnprintf.h, lib/wcwidth.h,
	lib/xalloc-die.c, lib/xalloc.h, lib/xgetcwd.c, lib/xgetcwd.h,
	lib/xmalloc.c, lib/xsize.h, m4/absolute-header.m4, m4/alloca.m4,
	m4/allocsa.m4, m4/codeset.m4, m4/d-ino.m4, m4/eealloc.m4,
	m4/eoverflow.m4, m4/error.m4, m4/exitfail.m4, m4/extensions.m4,
	m4/free.m4, m4/getcwd-abort-bug.m4, m4/getcwd-path-max.m4,
	m4/getcwd.m4, m4/getdelim.m4, m4/getline.m4, m4/getndelim2.m4,
	m4/getopt.m4, m4/getpass.m4, m4/gettext.m4, m4/getusershell.m4,
	m4/glibc2.m4, m4/glibc21.m4, m4/gnulib-cache.m4,
	m4/gnulib-comp.m4, m4/gnulib-tool.m4, m4/iconv.m4, m4/intdiv0.m4,
	m4/intmax.m4, m4/intmax_t.m4, m4/inttypes-h.m4,
	m4/inttypes-pri.m4, m4/inttypes.m4, m4/inttypes_h.m4,
	m4/isc-posix.m4, m4/lcmessage.m4, m4/lib-ld.m4, m4/lib-link.m4,
	m4/lib-prefix.m4, m4/lock.m4, m4/longdouble.m4, m4/longlong.m4,
	m4/mbchar.m4, m4/mbiter.m4, m4/mbrtowc.m4, m4/memchr.m4,
	m4/memcmp.m4, m4/memcpy.m4, m4/memmove.m4, m4/mempcpy.m4,
	m4/memset.m4, m4/minmax.m4, m4/nls.m4, m4/obstack.m4,
	m4/onceonly_2_57.m4, m4/po.m4, m4/poll.m4, m4/printf-posix.m4,
	m4/progtest.m4, m4/readutmp.m4, m4/regex.m4, m4/restrict.m4,
	m4/setenv.m4, m4/signed.m4, m4/size_max.m4, m4/snprintf.m4,
	m4/ssize_t.m4, m4/stdbool.m4, m4/stdint.m4, m4/stdint_h.m4,
	m4/stdio-safer.m4, m4/strcase.m4, m4/strchrnul.m4, m4/strdup.m4,
	m4/strerror.m4, m4/strerror_r.m4, m4/strndup.m4, m4/strnlen.m4,
	m4/sysexits.m4, m4/uintmax_t.m4, m4/ulonglong.m4,
	m4/unistd-safer.m4, m4/unistd_h.m4, m4/unlocked-io.m4,
	m4/vasnprintf.m4, m4/visibility.m4, m4/vsnprintf.m4,
	m4/wchar_t.m4, m4/wcwidth.m4, m4/wint_t.m4, m4/xalloc.m4,
	m4/xgetcwd.m4, m4/xsize.m4: Files removed.

2007-03-10  Elian Gidoni  <arkaino@gmail.com>
	    Alfred M. Szmidt  <ams@gnu.org>

	* NEWS: Mention the addition of `traceroute'.
	* configure.ac: Add new client `traceroute'.
	(AC_CONFIG_FILES): Add `traceroute/Makefile'.
	* Makefile.am (SUBDIRS): Add `traceroute' to list.
	* traceroute/Makefile.am: New file.
	* traceroute/traceroute.h: Likewise.
	* traceroute/traceroute.c: Likewise.

2007-03-10  Alfred M. Szmidt  <ams@gnu.org>

	* README-alpha, ROADMAP, THANKS, TODO: Updated.

2007-03-08  Petr Salinger  <Petr.Salinger@seznam.cz>

	* configure.ac (IU_CHECK_MEMBERS): Fix typo 'stuct' -> 'struct'.

2007-03-08  Simon Josefsson  <jas@extundo.com>

	* telnet/ring.h (ring_encrypt): Fix typo in prototype.

2006-11-17  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ping/ping.c (main): Allow zero argument for -c

2006-11-11  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping_common.h (DEFAULT_PING_COUNT): New macro.
	* ping/ping6.c (ping_init): Set default ping count to
	DEFAULT_PING_COUNT.
	(show_usage): Mention the default.
	* ping/ping.c (main): Set default ping count to
	DEFAULT_PING_COUNT.
	(show_usage): Mention the default.
	* NEWS: Mention new behaviour.

2006-10-25  Alfred M. Szmidt  <ams@gnu.org>

	* rsh/rsh.c: Include "xalloc.h".

	* telnet/authenc.c [AUTHENTICATION || ENCRYPTION]: Include
	<unistd.h>.

	* libinetutils/utmp_init.c: Include <utmpx.h> if and only if
	HAVE_UTMPX_H is defined.
	(utmp_init): Changed all references of UTMPX to HAVE_UTMPX_H.

	* talk/io.c (errno, sys_nerr): Removed extern declarations.

2006-10-21  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/cmds.c, ftp/cmdtab.c, ftp/domacro.c, ftp/ftp.c, ftp/main.c,
	ftp/ruserpass.c, ftpd/ftpcmd.y, ftpd/ftpd.c, ftpd/logwtmp.c,
	ftpd/popen.c, inetd/inetd.c, lib/regex_internal.c,
	libinetutils/des_rw.c, libinetutils/kcmd.c, libinetutils/krcmd.c,
	libinetutils/tftpsubs.c, libinetutils/ttymsg.c, libls/cmp.c,
	libls/fts.c, libls/ls.c, libls/print.c, libls/stat_flags.c,
	libls/util.c, libtelnet/auth.c, libtelnet/enc_des.c,
	libtelnet/encrypt.c, libtelnet/forward.c, libtelnet/genget.c,
	libtelnet/getent.c, libtelnet/kerberos.c, libtelnet/misc.c,
	libtelnet/read_passwd.c, logger/logger.c, rcp/rcp.c, rcp/util.c,
	rexecd/rexecd.c, syslogd/syslogd.c, talk/ctl.c,
	talk/ctl_transact.c, talk/display.c, talk/get_addrs.c,
	talk/get_names.c, talk/init_disp.c, talk/invite.c, talk/io.c,
	talk/look_up.c, talk/msgs.c, talk/talk.c, telnet/authenc.c,
	telnet/commands.c, telnet/main.c, telnet/network.c, telnet/ring.c,
	telnet/sys_bsd.c, telnet/telnet.c, telnet/terminal.c,
	telnet/tn3270.c, telnet/utilities.c, telnetd/slc.c,
	telnetd/state.c, telnetd/termstat.c, tftp/main.c, tftp/tftp.c,
	tftpd/tftpd.c, uucpd/uucpd.c, whois/net.c: Removed lint cruft.

2006-10-21  Guillem Jover  <guillem@hadrons.org>

	* syslogd/syslogd.c (init): Close CF properly before returning.

2006-10-21  Guillem Jover  <guillem@hadrons.org>

	* ftpd/ftpd.c (store): Do not overwrite `name' with gunique's
	return value, to avoid passing NULL to LOGCMD.

2006-10-21  Guillem Jover  <guillem@hadrons.org>

	* libinetutils/localhost.c (localhost): Determine the FQDN only if
	gethostname did not fail.

2006-10-21  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/utility.c: Include <time.h>.
	(expand_line): Cast LINE to (char *).

	* ftpd/auth.c: Include <string.h>
	(auth_user) <default>: Cast LEN to (size_t).

	* ftp/cmdtab.c: Include <string.h>
	* libinetutils/xalloc_die.c: Include <stdlib.h>
	* talk/get_addrs.c: Include <stdlib.h>, and <string.h>.
	* talk/get_names.c: Include <stdlib.h>, and <string.h>.
	* talk/init_disp.c: Include <stdlib.h>.
	* talk/invite.c: Include <string.h>
	* talk/look_up.c: Include <string.h>
	* talk/talk.c: Include <stdlib.h>
	* telnet/network.c: Include <stdlib.h>
	* telnet/ring.c: Include <string.h>.
	* telnet/terminal.c: Include <stdlib.h>.
	* telnet/utilities.c: Include <stdlib.h>.

	* rexecd/rexecd.c: Renamed all occurences of ASIN to A_SIN.

	* libtelnet/encrypt.c, ftp/cmds.c, libls/util.c,
	libls/stat_flags.c, libls/print.c, libls/ls.c, libls/fts.c,
	libinetutils/tftpsubs.c, libinetutils/des_rw.c, ftpd/popen.c,
	ftpd/logwtmp.c, ftpd/ftpcmd.y, whois/net.c, telnetd/termstat.c,
	telnetd/state.c, telnetd/slc.c, telnet/utilities.c, telnet/main.c,
	libtelnet/misc-proto.h, libtelnet/key-proto.h,
	libtelnet/forward.c, rcp/util.c, talk/invite.c, telnet/externs.h:
	Remove useless casts to (void).

	* libtelnet/encrypt.c, libtelnet/enc_des.c, libtelnet/enc-proto.h,
	libtelnet/auth.h, telnetd/utility.c, telnetd/telnetd.h,
	telnetd/telnetd.c, telnet/ring.h, telnet/krb4-proto.h,
	telnet/commands.c, rlogind/rlogind.c, libtelnet/encrypt.h,
	libtelnet/kerberos.c, libtelnet/read_passwd.c: Remove all
	references to P().

2006-10-21  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Version 1.5
	* NEWS: Version 1.5
	* lib/readutmp.c, lib/readutmp.h: Update from gnulib
	* syslogd/syslogd.c (wallmsg): Use new read_utmp interface.
	* talkd/process.c (find_user): Use new read_utmp interface.

2006-10-21  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/auth.c (auth_user) <default>: Free PCRED->message before
	returning if sgetcred() returned non-zero.

	* inetd/inetd.8: Fix typos.  Based on patch from Stephen Liebbe
	<sliebbe@gmail.com>.

2006-10-21  Guillem Jover  <guillem@hadrons.org>

	* configure.ac (AC_CHECK_LIB): Remove check for unused libz.

2006-10-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* doc/ChangeLog, ftp/ChangeLog, ftpd/ChangeLog, glob/ChangeLog,
	gwhois/ChangeLog, headers/ChangeLog, ifconfig/ChangeLog,
	inetd/ChangeLog, libicmp/ChangeLog, libinetutils/ChangeLog,
	libls/ChangeLog, libtelnet/ChangeLog, logger/ChangeLog,
	ping/ChangeLog, rcp/ChangeLog, rexecd/ChangeLog, rlogin/ChangeLog,
	rlogind/ChangeLog, rsh/ChangeLog, rshd/ChangeLog,
	syslogd/ChangeLog, talk/ChangeLog, talkd/ChangeLog,
	telnet/ChangeLog, telnetd/ChangeLog, tftp/ChangeLog,
	tftpd/ChangeLog, uucpd/ChangeLog, whois/ChangeLog: Merge with this
	file and remove.

	* configure.ac (AC_CHECK_HEADERS): Add dependecy headers
	* doc/Makefile.am (inetutils_TEXINFOS): Add fdl.texi
	* ftp/Makefile.am, ftpd/Makefile.am, gwhois/Makefile.am,
	ifconfig/Makefile.am, inetd/Makefile.am, libinetutils/Makefile.am,
	logger/Makefile.am, ping/Makefile.am, rcp/Makefile.am,
	rexecd/Makefile.am, rlogin/Makefile.am, rlogind/Makefile.am,
	rsh/Makefile.am, rshd/Makefile.am, syslogd/Makefile.am,
	talk/Makefile.am, talkd/Makefile.am, telnet/Makefile.am,
	telnetd/Makefile.am, tftp/Makefile.am, tftpd/Makefile.am,
	uucpd/Makefile.am, whois/Makefile.am: Move pathdefs to
	AM_CPPFLAGS.  Load libgnu after libinetutils.

	* lib/Makefile.am: Fresh import from the CVS gnulib
	* lib/alloca.c, lib/alloca_.h, lib/allocsa.c, lib/allocsa.h,
	lib/asnprintf.c, lib/dup-safer.c, lib/error.c, lib/error.h,
	lib/exit.h, lib/exitfail.c, lib/fd-safer.c, lib/fopen-safer.c,
	lib/free.c, lib/getcwd.c, lib/getopt.c, lib/getopt1.c,
	lib/getpass.c, lib/gettext.h, lib/getusershell.c, lib/malloc.c,
	lib/mbchar.c, lib/mbchar.h, lib/memchr.c, lib/memcmp.c,
	lib/memcpy.c, lib/memmove.c, lib/obstack.c, lib/pipe-safer.c,
	lib/printf-args.c, lib/printf-parse.c, lib/readutmp.c,
	lib/readutmp.h, lib/realloc.c, lib/regcomp.c, lib/regex.c,
	lib/regex.h, lib/regex_internal.c, lib/regex_internal.h,
	lib/regexec.c, lib/setenv.c, lib/size_max.h, lib/snprintf.c,
	lib/stdbool_.h, lib/stdint_.h, lib/stdio--.h, lib/stdio-safer.h,
	lib/strcasecmp.c, lib/strdup.c, lib/strerror.c, lib/strncasecmp.c,
	lib/strndup.c, lib/strnlen.c, lib/strnlen1.c, lib/strnlen1.h,
	lib/sysexit_.h, lib/unsetenv.c, lib/vasnprintf.c, lib/vsnprintf.c,
	lib/xalloc-die.c, lib/xgetcwd.c, lib/xmalloc.c, m4/codeset.m4,
	m4/d-ino.m4, m4/exitfail.m4, m4/extensions.m4,
	m4/getcwd-path-max.m4, m4/getcwd.m4, m4/getdelim.m4,
	m4/getline.m4, m4/getopt.m4, m4/getpass.m4, m4/gettext.m4,
	m4/getusershell.m4, m4/gnulib-cache.m4, m4/gnulib-comp.m4,
	m4/intmax_t.m4, m4/inttypes-pri.m4, m4/inttypes_h.m4,
	m4/lib-link.m4, m4/longdouble.m4, m4/longlong.m4, m4/mbchar.m4,
	m4/mempcpy.m4, m4/nls.m4, m4/onceonly_2_57.m4, m4/po.m4,
	m4/poll.m4, m4/readutmp.m4, m4/regex.m4, m4/setenv.m4,
	m4/signed.m4, m4/size_max.m4, m4/stdbool.m4, m4/stdint.m4,
	m4/stdint_h.m4, m4/stdio-safer.m4, m4/strdup.m4, m4/strndup.m4,
	m4/strnlen.m4, m4/ulonglong.m4, m4/unistd-safer.m4,
	m4/unlocked-io.m4, m4/xalloc.m4, m4/xgetcwd.m4: Update from gnulib

	* lib/wcwidth.h, m4/absolute-header.m4, m4/getcwd-abort-bug.m4,
	m4/getndelim2.m4, m4/inttypes-h.m4, m4/lock.m4, m4/ssize_t.m4,
	m4/unistd_h.m4, m4/visibility.m4, m4/wcwidth.m4: New files from
	gnulib

	* ftp/extern.h, ftp/ftp.c, ftp/ftp_var.h, ftp/main.c,
	ftp/ruserpass.c, ftpd/auth.c, ftpd/extern.h, ftpd/ftpcmd.y,
	ftpd/ftpd.c, ftpd/pam.c, ftpd/server_mode.c, glob/fnmatch.h,
	glob/glob.c, glob/glob.h, headers/tftpsubs.h, inetd/inetd.c,
	libicmp/ping.h, libinetutils/argcv.h, libinetutils/des_rw.c,
	libinetutils/kcmd.c, libinetutils/krcmd.c,
	libinetutils/tftpsubs.c, libinetutils/ttymsg.c, libls/extern.h,
	libls/fts.c, libls/fts.h, libls/ls.c, libls/print.c,
	libtelnet/auth-proto.h, libtelnet/misc.c, logger/logger.c,
	ping/ping.c, ping/ping6.c, ping/ping_common.c, rcp/extern.h,
	rcp/rcp.c, rexecd/rexecd.c, rlogin/rlogin.c, rlogind/rlogind.c,
	rsh/rsh.c, rshd/rshd.c, talk/talk.c, talkd/talkd.c,
	telnet/commands.c, telnet/externs.h, telnetd/telnetd.c,
	tftp/extern.h, tftp/main.c, tftp/tftp.c, tftpd/tftpd.c,
	uucpd/uucpd.c: Remove __P wrappers, use program_name instead of
	__progname, define it in main (required by error.c)

	* ifconfig/changeif.c, ifconfig/flags.c, ifconfig/ifconfig.c,
	ifconfig/options.c, ifconfig/options.h, ifconfig/printif.c,
	ifconfig/system/hpux.c, ifconfig/system/linux.c,
	ifconfig/system/osf.c, ifconfig/system/solaris.c: Include
	sys/types.h before sys/socket.h and netinet/in.h before
	arpa/inet.h Use program_name instead of __progname.

	* libicmp/icmp_address.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c: Include sys/types.h before sys/socket.h

	* syslogd/syslogd.c: Use read_utmp instead of manually fiddling
	with utmp(x) subtleties.  Remove __P wrappers, use program_name
	instead of __progname.
	* talkd/process.c: Likewise

2006-07-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	Implement passing client/server data via environment variables,
	based on the patch by Dirk Jagdmann <doj@cubic.org>

	* inetd/inetd.c: New options: --environment, to enable passing
	client/server data via environment variables, and --resolve, to
	resolve IP addresses when doing so.
	(prepenv): New function
	(nextconfig): Allow numeric port values as service names.
	* inetd/inetd.8: Document new options

2006-07-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* THANKS: Add Dirk Jagdmann

2006-07-25  Alfred M. Szmidt  <ams@gnu.org>

	* doc/inetutils.texi: Updated the license to the GNU Free
	Documentation License.
	(GNU Free Documentation License): New node.
	* doc/fdl.texi: New file.

2006-05-12  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (SUBDIRS): Added `ifconfig'.

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* telnet/Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* telnet/commands.c: Include libinetutils.h
	* telnet/telnet.c: Likewise

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* talkd/talkd.c: Include libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* talk/Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* talk/get_names.c: Include libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* syslogd/syslogd.c: Include libinetutils.h

2006-04-20  Samuel Thibault  <samuel.thibault@ens-lyon.org>

	* syslogd/Makefile.am (INCLUDES): Add PATHDEF_KLOG.

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rshd/Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* rshd/rshd.c: Include libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rlogind/Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* rlogind/rlogind.c: Include libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* logger/Makefile.am (LDADD): Add libgnu

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libinetutils/libinetutils.h: New file
	* libinetutils/Makefile.am (noinst_HEADERS): Add libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* inetd/inetd.c (main): Use sigsuspend in favor of sigpause.
	Change proposed by Guillem Jover <guillem@hadrons.org>

2006-04-20  Guillem Jover  <guillem@hadrons.org>

	* ifconfig/Makefile.am (LDADD): Link against gnulib.

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* ftpd/extern.h (logwtmp): Remove prototype
	* ftpd/ftpd.c: Include libinetutils.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftp/main.c [HAVE_READLINE_READLINE_H]: Include
	<readline/readline.h>

	* ftp/Makefile.am (INCLUDES): Add -I$(top_srcdir)/libinetutils
	* ftp/ruserpass.c: Include libinetutils.h and xalloc.h

2006-04-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	* THANKS: Add Guillem Jover
	* configure.ac: Use build-aux as an auxiliary tools directory
	(AC_CHECK_HEADERS): Add readline/readline.h
	* config.rpath: Remove autogenerated file

2006-01-14  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rcp/rcp.c (write_stat_time): Pass modification times first.
	Patch by Tim Adye <T.J.Adye@rl.ac.uk>

2005-12-08  Alfred M. Szmidt  <ams@gnu.org>

	* README: Reformated.  Mention that GNU Inetutils doesn't work on
	Solaris.

2005-12-02  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/localhost.c: Include <stdint.h>

2005-12-02  Alfred M. Szmidt  <ams@gnu.org>

	Imported GNUlib module: stdint.

	* lib/Makefile.am, m4/gnulib-cache.m4, m4/gnulib-comp.m4: Updated.
	* m4/stdint.m4, lib/stdint_.h: New files.

2005-12-02  Alfred M. Szmidt  <ams@gnu.org>

	Update from GNUlib.

	* config.rpath, lib/getdelim.c, lib/getdelim.h, lib/mbchar.c,
	lib/mbchar.h, lib/mbuiter.h, lib/memchr.c, lib/pipe-safer.c,
	lib/stdio--.h, lib/strnlen.h, lib/strnlen1.c, lib/strnlen1.h,
	lib/unistd--.h, m4/getdelim.m4, m4/gnulib-cache.m4,
	m4/gnulib-comp.m4, m4/gnulib-tool.m4, m4/mbchar.m4, m4/mbiter.m4,
	m4/mbrtowc.m4, m4/memchr.m4: New files.
	* lib/Makefile.am, lib/dup-safer.c, lib/exitfail.c,
	lib/fd-safer.c, lib/fopen-safer.c, lib/free.c, lib/getcwd.c,
	lib/getcwd.h, lib/getline.c, lib/getline.h, lib/getopt1.c,
	lib/getopt_.h, lib/getpass.c, lib/getusershell.c, lib/malloc.c,
	lib/memcmp.c, lib/memcpy.c, lib/memmove.c, lib/obstack.c,
	lib/obstack.h, lib/poll.c, lib/readutmp.c, lib/realloc.c,
	lib/regcomp.c, lib/regex.c, lib/regex.h, lib/regex_internal.c,
	lib/regex_internal.h, lib/regexec.c, lib/strcase.h,
	lib/strcasecmp.c, lib/strerror.c, lib/strncasecmp.c,
	lib/strndup.c, lib/strnlen.c, lib/unistd-safer.h,
	lib/xalloc-die.c, lib/xgetcwd.c, lib/xmalloc.c, m4/free.m4,
	m4/getcwd.m4, m4/getline.m4, m4/getopt.m4, m4/getpass.m4,
	m4/lib-link.m4, m4/lib-prefix.m4, m4/minmax.m4,
	m4/onceonly_2_57.m4, m4/regex.m4, m4/stdbool.m4,
	m4/stdio-safer.m4, m4/strcase.m4, m4/strndup.m4, m4/strnlen.m4,
	m4/unistd-safer.m4, m4/xgetcwd.m4: Updated from gnulib.
	* lib/getndelim2.c, lib/getndelim2.h, m4/argp.m4,
	m4/getndelim2.m4, m4/gnulib.m4, m4/ssize_t.m4: Removed files.

2005-12-02  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac (gl_MODULES): Removed call to function.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* uucpd/uucpd.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	* uucpd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* tftpd/tftpd.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	* tftpd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* tftp/main.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	* tftp/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* telnetd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* telnet/commands.c: Remove leftover BSD-isms: err, errx, warn,
	warnx, cast to (void) before function calls.  Use GNU error()
	uniformly.
	* telnet/sys_bsd.c: Likewise
	* telnet/telnet.c: Likewise
	* telnet/tn3270.c: Likewise
	* telnet/Makefile.am: Move defines to AM_CPPFLAGS.  Add INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* talkd/table.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	* talkd/talkd.c: Likewise
	* talkd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* talk/init_disp.c: Remove leftover BSD-isms: err, errx, warn,
	warnx, cast to (void) before function calls.  Use GNU error()
	uniformly.  Signal handlers return RETSIGTYPE.
	* talk/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* syslogd/syslogd.c: Remove leftover BSD-isms: err, errx, warn,
	warnx, cast to (void) before function calls.  Use GNU error()
	uniformly.  Signal handlers return RETSIGTYPE.
	* syslogd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rshd/rshd.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	Signal handlers return RETSIGTYPE.  Add Shishi support.  Patch by
	Simon Josefsson
	* rshd/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rsh/rsh.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	Signal handlers return RETSIGTYPE.  Add Shishi support.  Patch by
	Simon Josefsson
	* rsh/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rlogind/rlogind.c: Signal handlers return RETSIGTYPE.  Add
	Shishi support based on patch by Simon Josefsson
	* rlogind/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rlogin/rlogin.c: Remove leftover BSD-isms: err, errx, warn,
	warnx, cast to (void) before function calls.  Use GNU error()
	uniformly.  Signal handlers return RETSIGTYPE.  Add Shishi support
	based on patch by Simon Josefsson
	* rlogin/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rexecd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rcp/rcp.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly
	* rcp/util.c: Likewise.
	* rcp/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ping/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* logger/logger.c: Remove leftover BSD-isms: err, errx, warn,
	warnx, cast to (void) before function calls.  Use GNU error()
	uniformly
	* logger/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libtelnet/auth.c: Signal handlers return RETSIGTYPE Add Shishi
	support.  Patch by Simon Josefsson.
	* libtelnet/auth-proto.h: Add Shishi support.  Patch by Simon
	Josefsson.
	* libtelnet/auth.h: Likewise.
	* libtelnet/enc_des.c: Likewise.
	* libtelnet/encrypt.c: Likewise.
	* libtelnet/encrypt.h: Define SK_OTHER
	* libtelnet/shishi.c: New file
	* libtelnet/Makefile.am (libtelnet_a_SOURCES): Add shishi.c

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libls/Makefile.am: Remove ansi2knr.  Add copyleft header.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libinetutils/daemon.c: Signal handlers return RETSIGTYPE
	* libinetutils/kcmd.c: Do not include <kerberosIV/kparse.h> Add
	Shishi support based on patch by Simon Josefsson
	* libinetutils/krcmd.c: Add Shishi support.  Patch by Simon
	Josefsson.
	* libinetutils/ttymsg.c: Remove leftover BSD-isms: err, errx,
	warn, warnx, cast to (void) before function calls.  Use GNU
	error() uniformly
	* libinetutils/shishi.c: New file
	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Add shishi.c

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* inetd/inetd.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly.
	* inetd/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ifconfig/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.
	* ifconfig/system/Makefile.am: Remove ansi2knr.  Add copyleft
	header.  Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* headers/shishi_def.h: New file.
	* headers/Makefile.am (noinst_HEADERS): Add shishi_def.h

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* gwhois/whois.c (main): Change --version output.
	* gwhois/whois.h: Signal handlers return RETSIGTYPE
	* gwhois/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* glob/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftpd/conf.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly
	* ftpd/ftpd.c: Likewise
	* ftpd/server_mode.c: Likewise
	* ftpd/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftp/cmds.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly
	* ftp/ftp.c: Likewise.
	* ftp/main.c: Likewise.
	* ftp/ruserpass.c: Likewise.
	* ftp/domacro.c: Likewise.  Use do while loop instead of goto.
	* ftp/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* doc/Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-10-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* acinclude.m4: Properly quote arguments to AC_ARG_ENABLE and
	AC_ARG_WITH.  Use AC_HELP_STRING where appropriate.
	* configure.ac: Likewise.  Add --with-shishi options.  Patch by
	Simon Josefsson
	* THANKS: Add Simon Joseffson
	* lib/getpass.c: Remove leftover BSD-isms: err, errx, warn, warnx,
	cast to (void) before function calls.  Use GNU error() uniformly
	* Makefile.am: Remove ansi2knr.  Add copyleft header.  Update
	INCLUDES.

2005-09-22  Sergey Poznyakoff  <gray@gnu.org.ua>

	* whois/main.c: Changed FSF postal mail address.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* uucpd/uucpd.c: #include <getopt.h>
	(usage): New function.
	(long_options, short_options, usage_str): New variables.
	(main): Added new options `--help' and `--version'.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* tftpd/tftpd.c: (usage): New function.
	(long_options, short_options, usage_str): New variables.
	(main): Added new options `--help' and `--version'.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* talk/talk.c: #include <getopt.h>
	(usage): New function.
	(long_options, short_options, usage_str): New variables.
	(main): Added new options `--help' and `--version'.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* rexecd/rexecd.c: #include <getopt.h>
	(usage): New function.
	(long_options, short_options, usage_str): New variables.
	(main): Added new options `--help' and `--version'.

2005-09-22  Sergey Poznyakoff  <gray@gnu.org.ua>

	* inetd/inetd.c: Updated FSF postal mail address.

2005-09-22  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ifconfig/changeif.c, ifconfig/flags.c, ifconfig/flags.h,
	ifconfig/if_index.c, ifconfig/if_index.h, ifconfig/ifconfig.c,
	ifconfig/ifconfig.h, ifconfig/options.c, ifconfig/options.h,
	ifconfig/printif.c, ifconfig/printif.h, ifconfig/system.h,
	ifconfig/system/generic.c, ifconfig/system/generic.h,
	ifconfig/system/hpux.c, ifconfig/system/hpux.h,
	ifconfig/system/linux.c, ifconfig/system/linux.h,
	ifconfig/system/osf.c, ifconfig/system/osf.h,
	ifconfig/system/qnx.c, ifconfig/system/qnx.h,
	ifconfig/system/solaris.c, ifconfig/system/solaris.h: Updated FSF
	postal mail address.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* gwhois/whois.c (main): Output version information to stdout.
	(usage): Output usage information to stdout.

2005-09-22  Alfred M. Szmidt  <ams@gnu.org>

	* autogen.sh: Don't pass `-s' to autoreconf.

2005-09-08  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftp/main.c (getcmd, help): Moved to cmdtab.c
	* ftp/cmdtab.c (getcmd, help): Moved from main.c
	* ftp/extern.h (cmdtab): Remove declaration

2005-08-27  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/ftp_var.h: #include "extern.h" at the end.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* telnetd/pty.c, telnetd/telnetd.c, telnetd/telnetd.h,
	telnetd/term.c, telnetd/utility.c: Updated FSF postal mail
	address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* talkd/acl.c, talkd/announce.c, talkd/intalkd.h, talkd/print.c,
	talkd/process.c, talkd/table.c, talkd/talkd.c: Updated FSF postal
	mail address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* rlogind/rlogind.c: Updated FSF postal mail address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ping/ping.c, ping/ping6.c, ping/ping6.h, ping/ping_address.c,
	ping/ping_common.c, ping/ping_common.h, ping/ping_echo.c,
	ping/ping_router.c, ping/ping_timestamp.c: Updated FSF postal mail
	address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libtelnet/kerberos5.c: Updated FSF postal mail address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libinetutils/xalloc_die.c: Updated FSF postal mail address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libicmp/icmp.h, libicmp/icmp_address.c, libicmp/icmp_cksum.c,
	libicmp/icmp_echo.c, libicmp/icmp_timestamp.c, libicmp/libping.c,
	libicmp/ping.h: Updated FSF postal mail address.
	* libicmp/Makefile.am: Remove ansi2knr.  Add copyleft header.
	Update INCLUDES.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftpd/logwtmp.c: Updated FSF postal mail address.

2005-07-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* COPYING: Updated FSF postal mail address.
	* lib/Makefile.am: Removed unused argp
	* lib/getcwd.c, lib/getcwd.h, lib/regex.c, lib/regex.h
	m4/getcwd-path-max.m4, m4/getcwd.m4, m4/getopt.m4, m4/gnulib.m4
	m4/poll.m4, m4/regex.m4, m4/size_max.m4: Updated from gnulib
	* lib/dup-safer.c, lib/fd-safer.c, lib/fopen-safer.c,
	lib/regcomp.c, lib/regex_internal.c, lib/regex_internal.h,
	lib/regexec.c, lib/size_max.h, lib/stdio-safer.h,
	lib/unistd-safer.h, m4/glibc2.m4, m4/minmax.m4, m4/stdio-safer.m4,
	m4/unistd-safer.m4: Likewise
	* lib/argp-ba.c, lib/argp-eexst.c, lib/argp-fmtstream.c,
	lib/argp-fmtstream.h, lib/argp-fs-xinl.c, lib/argp-help.c,
	lib/argp-namefrob.h, lib/argp-parse.c, lib/argp-pv.c,
	lib/argp-pvh.c, lib/argp-xinl.c, lib/argp.h: Removed unused files.

2005-07-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ping/ping.c (main, ping_run): Handle ping intervals with
	millisecond precision.

2005-07-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libicmp/libping.c (ping_init): Use PING_DEFAULT_INTERVAL
	* libicmp/ping.h (PING_INTERVAL): Renamed to to
	PING_DEFAULT_INTERVAL
	(PING_PRECISION, PING_SET_INTERVAL): New defines

2005-07-29  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping_common.h (ping_cvt_number): Prototype restored (but
	with updated types).

	* ping/ping_common.c (ping_cvt_number): Changed return type to
	size_t, changed type of argument maxval to size_t.

	* ping/ping.c (ping_cvt_number): Removed (once again).

2005-07-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ping/ping.c (main): Changed types of count and interval
	(ping_cvt_number): Restored function.  atoi should not be used to
	convert to size_t.  According to POSIX "The atoi() function is
	subsumed by strtol() but is retained because it is used
	extensively in existing code.  If the number is not known to be in
	range, strtol() should be used because atoi() is not required to
	perform any error checking.
	* ping/ping_common.h (ping_cvt_number): Remove prototype

2005-07-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libicmp/libicmp/libping.c (ping_set_count, ping_set_interval)
	(ping_set_packetsize): Second argument is size_t
	* libicmp/libicmp/ping.h: Likewise

2005-07-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* ftp/extern.h: Reverted changes made 2005-05-01.  Initializing a
	scalar type (struct cmd *cmdtab) with a vector is an error, which
	leads to coredump when trying to access cmdtab.
	* ftp/cmdtab.c: Likewise

2005-07-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Remove AC_AIX, AC_MINIX, these are called by
	gl_USE_SYSTEM_EXTENSIONS, invoked by gl_EARLY
	* lib/Makefile.am: Updated
	* lib/alloca_.h, lib/allocsa.c, lib/allocsa.h, lib/argp-ba.c,
	lib/argp-eexst.c, lib/argp-fmtstream.c, lib/argp-fmtstream.h,
	lib/argp-fs-xinl.c, lib/argp-help.c, lib/argp-namefrob.h,
	lib/argp-parse.c, lib/argp-pv.c, lib/argp-pvh.c, lib/argp-xinl.c,
	lib/argp.h, lib/asnprintf.c, lib/error.c, lib/error.h, lib/exit.h,
	lib/exitfail.c, lib/exitfail.h, lib/getcwd.c, lib/getcwd.h,
	lib/getline.c, lib/getline.h, lib/getndelim2.c, lib/getndelim2.h,
	lib/getopt.c, lib/getopt1.c, lib/getopt_.h, lib/getopt_int.h,
	lib/getpass.c, lib/getpass.h, lib/gettext.h, lib/getusershell.c,
	lib/malloc.c, lib/memcmp.c, lib/memcpy.c, lib/mempcpy.c,
	lib/mempcpy.h, lib/memset.c, lib/minmax.h, lib/obstack.c,
	lib/obstack.h, lib/poll.c, lib/poll_.h, lib/printf-args.c,
	lib/printf-args.h, lib/printf-parse.c, lib/printf-parse.h,
	lib/readutmp.c, lib/readutmp.h, lib/realloc.c, lib/regex.c,
	lib/regex.h, lib/setenv.c, lib/setenv.h, lib/snprintf.c,
	lib/snprintf.h, lib/stdbool_.h, lib/strcase.h, lib/strcasecmp.c,
	lib/strchrnul.c, lib/strchrnul.h, lib/strdup.c, lib/strdup.h,
	lib/strerror.c, lib/strndup.clib/strndup.h, lib/strnlen.c,
	lib/sysexit_.h, lib/unlocked-io.h, lib/unsetenv.c,
	lib/vasnprintf.c, lib/vasnprintf.h, lib/vsnprintf.c,
	lib/vsnprintf.h, lib/xalloc.h, lib/xgetcwd.c, lib/xgetcwd.h,
	lib/xmalloc.c, lib/xsize.h: Updated from the recent gnulib

	* m4/alloca.m4, m4/argp.m4, m4/d-ino.m4, m4/error.m4,
	m4/exitfail.m4, m4/extensions.m4, m4/getcwd-path-max.m4,
	m4/getcwd.m4, m4/getline.m4, m4/getndelim2.m4, m4/getopt.m4,
	m4/getpass.m4, m4/gettext.m4, m4/getusershell.m4, m4/gnulib.m4,
	m4/intdiv0.m4, m4/intmax.m4, m4/inttypes-pri.m4, m4/inttypes.m4,
	m4/isc-posix.m4, m4/lcmessage.m4, m4/lib-link.m4,
	m4/lib-prefix.m4, m4/memcmp.m4, m4/memcpy.m4, m4/memmove.m4,
	m4/memset.m4, m4/nls.m4, m4/obstack.m4, m4/po.m4, m4/poll.m4,
	m4/printf-posix.m4, m4/progtest.m4, m4/readutmp.m4, m4/regex.m4,
	m4/restrict.m4, m4/snprintf.m4, m4/strchrnul.m4, m4/strdup.m4,
	m4/strerror.m4, m4/strerror_r.m4, m4/strndup.m4, m4/strnlen.m4,
	m4/sysexits.m4, m4/unlocked-io.m4, m4/vsnprintf.m4, m4/xalloc.m4,
	m4/xgetcwd.m4: Updated from the recent gnulib

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* telnetd/telnetd.c (telnetd_setup): Add support for IPv6.

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* telnet/commands.c: Include <arpa/telnet.h>.  Remove variable tos
	and _hostname.
	(tn): Rewritten.  Removed support for source routing and added
	support for IPv6.
	(sourceroute): Function removed.
	* telnet/main.c (help): Add "-4" and "-6", remove "-S".
	(long_options): Add "ipv4" and "ipv6", remove "tos".
	(main): New variable family.  Implement "-4" and "-6" options and
	remove "-S" option.

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* ping/Makefile.am: Add ping6.
	(ping_SOURCES): Add ping_common.c and ping_common.h.
	* ping/ping6.c: New file.
	* ping/ping6.h: Likewise.
	* ping/ping_common.c: Likewise.
	* ping/ping_common.h: Likewise.
	* ping/ping.c: Include "ping_common.h".  Remove __P macro in
	prototypes.
	(ping_cvt_number, init_data_buffer, decode_pattern, show_license):
	Move to ...
	* ping/ping_common.c: ... here.
	* ping/ping_echo.c: Include "ping_common.h".
	(tvsub, nabs, nsqrt): Move to ...
	* ping/ping_common.c: ... here.

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* inetd/inetd.c: Move global variable sp to...
	(nextconfig): Here.  Only use the getservbyname code when
	[!IPV6].  Remove unused variable i.
	(struct servtab): Change type of to pid_t.  Add se_family.
	[IPV6] Add se_v4mapped.  Change se_ctrladdr to struct
	sockaddr_storage.
	(setup): Add support for IPv6.
	(INETD_FIELDS_MIN): Define to 6.
	(getconfigent): Add support for IPv6.  Remove unused variable arg.
	(set_proc_title): Add support for IPv6.
	(echo_dg): Likewise.
	(chargen_dg): Likewise.
	(machtime_dg): Likewise.
	(daytime_dg): Likewise.

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* doc/inetd.texi (inetd): Document IPv6 configuration options.

2005-06-19  Jeroen Dekkers  <jeroen@dekkers.cx>

	* acinclude.m4 (IU_ENABLE_FOO): Use AS_HELP_STRING.

	* configure.ac: Add checks for IPv6.

2005-05-01  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/cmdtab.c (cmdtab): Changed type to pointer.
	* ftp/extern.h (cmdtab): Updated extern declaration.

2005-01-31  Alfred M. Szmidt  <ams@gnu.org>

	* Makefile.am (AUTOMAKE_OPTIONS): Require automake 1.9.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* tftpd/tftpd.c (TIMEOUT) [!HAVE_DECL_STRERROR]: Removed extern
	declaration for strerror.

	* tftpd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* tftp/tftp.c: [!HAVE_DECL_ERRNO]: Removed extern declaration for
	errno.
	[!HAVE_DECL_STRERROR]: Removed extern declaration for strerror.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/utility.c (terminaltypeok): Just do tgetent if
	HAVE_LIBREADLINE is defined.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* telnet/telnet.c (init_term): New variable err.  Only do tgetent
	if we HAVE_LIBREADLINE is defined.
	(termbuf) [!TERMCAP]: Removede termbuf and ttytype.

	* telnet/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* talkd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* syslogd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rshd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rsh/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rlogind/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rlogin/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rexecd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* rcp/rcp.c [!HAVE_DECL_STRERROR]: Removed extern declaration for
	strerror.

	* rcp/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/Makefile.am (noinst_HEADERS, EXTRA_DIST): New
	variables.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* inetd/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* headers/Makefile.am (noinst_HEADERS): New variable.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* gwhois/Makefile.am (LDADD): Added `-L../lib -lgnu'.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/ftpd.c (retrieve): Don't use ST_BLKSIZE.

	* ftpd/extern.h: Include <sys/types.h>

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/ftp.c (recvrequest): Removed unused variable `st'.  Don't
	use ST_BLKSIZE when setting blksiz, just set blksiz to BUFSIZ
	unconditionally.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* configure.ac: Bump version to 1.4.3.

2005-01-22  Alfred M. Szmidt  <ams@gnu.org>

	* lib/.cvsignore: New file.

	* configure.ac: Don't check for __P.  Removed almost all
	references to AH_BOTTOM, the only one that is left is so that we
	don't have to include <confpaths.h> everywhere.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* uucpd/uucpd.c (doit): Use `crypt' instead of `CRYPT'.

	* uucpd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* tftpd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.  Added `-I$(top_srcdir)/headers'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* tftp/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.  Added `-I$(top_srcdir)/headers' and
	`-I$(top_srcdir)/lib'.
	(LDADD): Added `-L../lib -lgnu'.

	* tftp/main.c: Use "xalloc.h" instead of <xalloc.h> when including
	it.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* telnetd/telnetd.h: Include "xalloc.h"

	* telnetd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include', and `-I$(top_srcdir)'.
	(LDADD): Added `-L../lib -lgnu'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* telnet/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* talkd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* talk/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* syslogd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rshd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rsh/Makefile.am (INCLUDES): Removed `-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rlogind/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rlogin/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rexecd/rexecd.c (endpwent): Use `crypt' instead of `CRYPT'.

	* rexecd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* rcp/Makefile.am (INCLUDES): Removed `-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* ping/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.
	(LDADD): Added `-L../lib -lgnu'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* logger/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* libtelnet/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* libls/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* libinetutils/__progname.c, libinetutils/err.c,
	libinetutils/forkpty.c, libinetutils/getopt.c,
	libinetutils/getopt.h, libinetutils/getopt1.c,
	libinetutils/getpass.c, libinetutils/gettext.h,
	libinetutils/getusershell.c, libinetutils/herror.c,
	libinetutils/hstrerror.c, libinetutils/iruserok.c,
	libinetutils/login.c, libinetutils/login_tty.c,
	libinetutils/logout.c, libinetutils/malloc.c,
	libinetutils/memcmp.c, libinetutils/memcpy.c,
	libinetutils/memmove.c, libinetutils/memset.c,
	libinetutils/obstack.c, libinetutils/obstack.h,
	libinetutils/openpty.c, libinetutils/opieclient.c,
	libinetutils/pathmax.h, libinetutils/poll.c,
	libinetutils/readstream.c, libinetutils/realloc.c,
	libinetutils/regex.c, libinetutils/regex.h, libinetutils/revoke.c,
	libinetutils/ruserok.c, libinetutils/setenv.c,
	libinetutils/setenv.h, libinetutils/snprintf.c,
	libinetutils/snprintf.h, libinetutils/strcasecmp.c,
	libinetutils/strdup.c, libinetutils/strerror.c,
	libinetutils/strsignal.c, libinetutils/stub_tgetent.c,
	libinetutils/syslog.c, libinetutils/waitpid.c,
	libinetutils/xalloc.h, libinetutils/xgetcwd.c,
	libinetutils/getcwd.h, libinetutils/xmalloc.c,
	libinetutils/xstrdup.c: Files removed.

	* libinetutils/localhost.c (localhost): Removed extern declaration
	of `xrealloc'.  Use `realloc' instead of `xrealloc'.

	* libinetutils/xalloc_die.c: New file.
	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Added
	`xalloc_die.c'.

	* libinetutils/Makefile.am (libinetutils_a_SOURCES): Removed
	xmalloc.c, xstrdup.c, and xgetcwd.c.
	(libinetutils_a_LIBADD): Removed `@LIBOBJS@'.  Added
	`$(top_builddir)/lib/libgnu.a'.
	(noinst_HEADERS, EXTRA_DIST): Variable removed.
	(INCLUDES): Removed `-I$(top_builddir)/include'.  Added
	`-I$(top_srcdir)/headers', and `-I$(top_srcdir)/lib'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* libicmp/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* inetd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* headers/Makefile.am (dist-hook): Target removed.
	(header_dirs): Variable removed.
	(EXTRA_DIST): Variable removed.

	* headers/confpaths.h.in, headers/crypt.h, headers/err.h,
	headers/getopt.h, headers/obstack.h, headers/osockaddr.h,
	headers/paths.h, headers/poll.h, headers/syslog-int.h,
	headers/arpa/DISTFILES, headers/arpa/ftp.h, headers/arpa/telnet.h,
	headers/arpa/tftp.h, headers/protocols/DISTFILES,
	headers/protocols/talkd.h: Files removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* gwhois/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* glob/Makefile.am (INCLUDES): Variable removed.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/auth.c (auth_pass): Use `crypt' instead of `CRYPT'.

	* ftpd/Makefile.am (INCLUDES): Removed
	`-I$(top_builddir)/include'.
	(LDADD): Added `-L../lib -lgnu'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/Makefile.am (INCLUDES): Removed `-I$(top_builddir)/include'.
	(LDADD): Added `-L../lib -lgnu'.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	Imported files from gnulib.

	* lib/Makefile.am, lib/alloca.c, lib/alloca_.h, lib/allocsa.c,
	lib/allocsa.h, lib/allocsa.valgrind, lib/argp-ba.c,
	lib/argp-eexst.c, lib/argp-fmtstream.c, lib/argp-fmtstream.h,
	lib/argp-fs-xinl.c, lib/argp-help.c, lib/argp-namefrob.h,
	lib/argp-parse.c, lib/argp-pv.c, lib/argp-pvh.c, lib/argp-xinl.c,
	lib/argp.h, lib/asnprintf.c, lib/error.c, lib/error.h, lib/exit.h,
	lib/exitfail.c, lib/exitfail.h, lib/getcwd.c, lib/getcwd.h,
	lib/getline.c, lib/getline.h, lib/getndelim2.c, lib/getndelim2.h,
	lib/getopt.c, lib/getopt1.c, lib/getopt_.h, lib/getopt_int.h,
	lib/getpass.c, lib/getpass.h, lib/gettext.h, lib/getusershell.c,
	lib/malloc.c, lib/memcmp.c, lib/memcpy.c, lib/memmove.c,
	lib/mempcpy.c, lib/mempcpy.h, lib/memset.c, lib/minmax.h,
	lib/obstack.c, lib/obstack.h, lib/poll.c, lib/poll_.h,
	lib/printf-args.c, lib/printf-args.h, lib/printf-parse.c,
	lib/printf-parse.h, lib/readutmp.c, lib/readutmp.h, lib/realloc.c,
	lib/regex.c, lib/regex.h, lib/setenv.c, lib/setenv.h,
	lib/snprintf.c, lib/snprintf.h, lib/stdbool_.h, lib/strcase.h,
	lib/strcasecmp.c, lib/strchrnul.c, lib/strchrnul.h, lib/strdup.c,
	lib/strdup.h, lib/strerror.c, lib/strncasecmp.c, lib/strndup.c,
	lib/strndup.h, lib/strnlen.c, lib/sysexit_.h, lib/unlocked-io.h,
	lib/unsetenv.c, lib/vasnprintf.c, lib/vasnprintf.h,
	lib/vsnprintf.c, lib/vsnprintf.h, lib/xalloc.h, lib/xgetcwd.c,
	lib/xgetcwd.h, lib/xmalloc.c, lib/xsize.h, m4/alloca.m4,
	m4/allocsa.m4, m4/argp.m4, m4/codeset.m4, m4/d-ino.m4,
	m4/eealloc.m4, m4/eoverflow.m4, m4/error.m4, m4/exitfail.m4,
	m4/extensions.m4, m4/getcwd-path-max.m4, m4/getcwd.m4,
	m4/getline.m4, m4/getndelim2.m4, m4/getopt.m4, m4/getpass.m4,
	m4/gettext.m4, m4/getusershell.m4, m4/glibc21.m4, m4/gnulib.m4,
	m4/iconv.m4, m4/intdiv0.m4, m4/intmax.m4, m4/intmax_t.m4,
	m4/inttypes-pri.m4, m4/inttypes.m4, m4/inttypes_h.m4,
	m4/isc-posix.m4, m4/lcmessage.m4, m4/lib-ld.m4, m4/lib-link.m4,
	m4/lib-prefix.m4, m4/longdouble.m4, m4/longlong.m4, m4/memcmp.m4,
	m4/memcpy.m4, m4/memmove.m4, m4/mempcpy.m4, m4/memset.m4,
	m4/nls.m4, m4/obstack.m4, m4/onceonly_2_57.m4, m4/po.m4,
	m4/poll.m4, m4/printf-posix.m4, m4/progtest.m4, m4/readutmp.m4,
	m4/regex.m4, m4/restrict.m4, m4/setenv.m4, m4/signed.m4,
	m4/size_max.m4, m4/snprintf.m4, m4/ssize_t.m4, m4/stdbool.m4,
	m4/stdint_h.m4, m4/strcase.m4, m4/strchrnul.m4, m4/strdup.m4,
	m4/strerror.m4, m4/strerror_r.m4, m4/strndup.m4, m4/strnlen.m4,
	m4/sysexits.m4, m4/uintmax_t.m4, m4/ulonglong.m4,
	m4/unlocked-io.m4, m4/vasnprintf.m4, m4/vsnprintf.m4,
	m4/wchar_t.m4, m4/wint_t.m4, m4/xalloc.m4, m4/xgetcwd.m4,
	m4/xsize.m4: New files.

2005-01-21  Alfred M. Szmidt  <ams@gnu.org>

	* confpaths.h.in: New file.

	* Makefile.am (ACLOCAL_AMFLAGS): New variable.
	(SUBDIRS): Added lib.

	* configure.ac: Moved AC_PROG_CC check up a bit eariler and added
	gl_EARLY directly after it.  Call gl_MODULES and gl_INIT after
	inital program checks.  Removed all usage of AC_LIBOBJ.  Don't
	check for herror, strcasecmp, strsignal, waitpid, and revoke.
	Removed all references to LINK_POLL_H and LINK_SYSLOG_INIT_H.
	Removed checks for verrx, __progname, login, logout, logwtmp,
	openpty, forkpty, ruserok, iruserok, and login_tty.  Removed check
	for libutil.

	* configure.ac: Use <confpaths.h> instead of
	<include/confpaths.h>.
	(AC_CONFIG_FILES): Added lib/Makefile.  Changed
	`include/confpaths.h:headers/confpaths.h.in' to
	`confpaths.h:confpaths.h.in'.

	* acinclude.m4 (IU_CONFIG_LINKS): Function removed.
	* configure.ac: Removed all references to IU_CONFIG_LINKS.

2005-01-20  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping.c: Comply with GCS.
	(init_data_buffer): Use xmalloc().
	(show_usage): Print the "report bugs" string as all other GNU
	programs do.

2005-01-20  Alfred M. Szmidt  <ams@gnu.org>

	* ping/ping.c: Include <stdbool.h>
	(ping_cvt_number): Function removed.
	(main): Store the values for -c, -i and -t in variables, and don't
	use `ping_cvt_number' to check if the arguments to an option are
	valid, do it manually.  Set them accordingly after ping_init() is
	done.

	* ping/ping.c (main): Changed type of `is_root' to `bool'.  Update
	all usage accordingly.

	* ping/ping.c (main): Moved ping startup code to after the parsing
	of the command line.  (and no, this should not be done before any
	command line parsing!)

2005-01-20  Alfred M. Szmidt  <ams@gnu.org>

	* libicmp/libping.c: Comply with GCS.
	(_ping_packetsize): Rewritten.

2005-01-13  Alfred M. Szmidt  <ams@gnu.org>

	* ftp/cmds.c (setpeer): Changed type of PORT to `int'.  Check that
	the port number isn't strictly greater than 65535.

2004-12-28  Simon Josefsson  <jas@extundo.com>

	* inetd/Makefile.am (INCLUDES): Fix typo.

2004-12-28  Alfred M. Szmidt  <ams@gnu.org>

	* ftpd/ftpd.c (off_to_str): Don't write out of bounds.  From
	<uchiyama@s-lab.com>.

2004-12-28  Alfred M. Szmidt  <ams@gnu.org>

	* NEWS: Added news entries for 1.4.3.  Based on suggestions from
	Jeff Bailey and Simon Josefsson.

2004-09-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* tftp/Makefile.am (LDADD): Use `$(top_srcdir)' instead of
	relative path.
	(INCLUDES): Search for headers in `$(top_srcdir)/libinetutils'
	instead of `$(top_builddir)/libinetutils'.

2004-09-23  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* tftp/Makefile.am (INCLUDES): Add libinetutils
	* tftp/main.c: Fixed possible memory overruns.
	(setpeer): Fixed coredump on hitting return after '(to)' prompt.
	Fixed indentation.
	* tftp/tftp.c: Fixed indentation.

2004-08-13  Jeff Bailey  <jbailey@raspberryginger.com>

	* syslogd/syslogd.c: Fix disable forwarding option.

	Patch by Anthony Awtrey.

2004-07-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rshd/rshd.c (doit): Use cached copy of hp->h_name, since it may
	be overwritten by local_domain().  Fix proposed by Andrew Klossner
	<andrew@cesa.opbu.xerox.com> and Martin J.  Evans
	<martin@easysoft.com>.

2004-07-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rexecd/rexecd.c (doit): Added support for shadow suite.
	Proposed by Andrew Klossner <andrew@cesa.opbu.xerox.com>

2004-07-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rcp/Makefile.am: Conditional install-exec-hook

2004-06-16  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rsh/rsh.c (short_options): Prefix with '+' to disable reordering
	by getopt_long.  Proposed by Todd R.  Eigenschink
	<todd@tekinteractive.com>
	* rsh/Makefile.am: Conditional install-exec-hook

2004-06-16  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rlogin/rlogin.c: Handle ^S/^Q without using -8:
	(ixon_state): New variable
	(mode): Save and restore ixon state.  Patch by Todd R.
	Eigenschink <todd@tekinteractive.com>
	* rlogin/Makefile.am: Conditional install-exec-hook

2004-03-03  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/ping.c (ping_cvt_number): Take an additional parameter
	indicating whether zero value is allowed.
	* ping/Makefile.am: Conditional install-exec-hook

2003-11-10  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/ping.c (ping_cvt_number): New function.
	(main): Check numeric options for validity.
	* ping/ping_echo.c: Rewritten diagnostic output.  Use original
	returned IP header.
	* ping/ping_impl.h (PING_MAX_DATALEN): New define.

2003-11-10  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libicmp/libping.c (ping_recv): Check icmp ID only for replies.
	Use more detailed check for other packet types.

2003-11-01  Jeff Bailey  <jbailey@raspberryginger.com>

	* ftp/ftp_var.h (MAXLINE): New define.  Define line and argbuf in
	terms of MAXLINE.

	* ftp/main.c: Make sure line from readline isn't larger than
	MAXLINE.

	Patch from John Hasler.

2003-10-24  Marcus Brinkmann  <marcus@gnu.org>

	* ifconfig/options.c (PARSE_OPT_SET_ADDR): Fix macro for gcc 3.3.
	(PARSE_OPT_SET_INT): Likewise.

2003-09-02  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (init): Fix long line support.  Submitted by
	Julian Gilbey <jdg@debian.org>.

2003-08-29  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (init): Use strchr instead memchr.  Skip
	whitespace at the beginning of the next part of a continued line.

2003-08-29  Jeff Bailey  <jbailey@raspberryginger.com>

	* inetd/inetd.c: Create a PID file.
	(Patch thanks to Robert Millan)

	* inetd/Makefile.am (INCLUDES): Use PATHDEF_INETDPID

2003-11-11  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* inetd/inetd.c: Signal handling rewritten.

2003-11-11  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* inetd/inetd.c: Use argcv_get to parse configuration files.
	Improved config error diagnostics.  Removed obvious bsdisms.

2003-08-29  Jeff Bailey <jbailey@raspberryginger.com>

	* paths: Support PATH_INETDPID.
	(Patch from Robert Millan)

2004-09-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* acinclude.m4 (IU_LIB_NCURSES): Set LIBNCURSES to "" if we didn't
	find any headers for ncurses.

2004-06-16  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* configure.ac: Check for termcap before checking for readline,
	since the latter might depend on the former.  Patch by Todd R.
	Eigenschink <todd@tekinteractive.com>
	* acinclude.m4 (IU_ENABLE_FOO): Define $1_INSTALL_HOOK
	(IU_CHECK_KRB5): Quote the definition

	* THANKS: Added Todd R. Eigenschink

2004-01-30  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* acinclude.m4 (IU_CONFIG_LINKS): New macro
	* configure.ac: Use IU_CONFIG_LINKS.  Raised autoconf requirement
	to 2.59
	* Makefile.am: Require automake 1.8

	* headers/Makefile.am: Fixed disthook
	* headers/arpa/DISTFILES: Added to the repository
	* headers/protocols/DISTFILES: Likewise

2003-09-28  Alfred M. Szmidt  <ams@kemisten.nu>

	* acinclude.m4 (IU_CONFIG_PATHS): New variables `IU_UCASE' and
	`iu_lcase'.

2003-05-24  Alain Magloire

	* libinetutils/snprintf.c: Change to be under LGPL not GPL.
	(vsnprintf): implement "%lld", "%qd", "%Lg"
	* libinetutils/snprintf.h: New macro LONG_LONG, LONG_DOUBLE
	default to long long, long double.

2003-05-24  Alain Magloire

	* configure.ac: New check AC_CHECK_TYPES(long long, long dougle).

2003-05-21  Sergey Poznyakoff

	* syslogd/syslogd.c (main): Call init before opening the sockets.
	(Thanks Peter Rehley <peter@rehley.net> for the patch)
	(logmsg, cfline): Fixed handling of INTERNAL_NOPRI.

2003-05-21  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/libinetutils/ttymsg.c (ttymsg): Bugfix: typecast is
	not a valid lvalue

2003-04-21  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/ping.c (ping_run): Bugfix.  Thanks Jim Balter
	<Jim.Balter@cw.com> for the patch.

2003-04-21  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/setenv.c: Provide an extern declaration of environ
	if necessary
	* libinetutils/xmalloc.c: Use err() instead of error().

2003-04-21  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libicmp/libping.c (ping_recv): Placed checksum and id test
	before the switch.

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* telnetd/telnetd.c (telnetd_setup): Use socklen_t.

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* talk/display.c (display): Allow use of 8-bit ascii.

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* rshd/Makefile.am: Added AUTHLIBS to LDADD

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* rsh/rsh.c (dst_realm_buf): Typo.
	* rsh/Makefile.am: Added AUTHLIBS to LDADD

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* rlogind/Makefile.am: Added AUTHLIBS to LDADD
	* rlogind/rlogind.c: Use KRB5 instead of KERBEROS_V

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* rlogin/rlogin.c (dst_realm_buf): Typo.
	* rlogin/Makefile.am: Added AUTHLIBS to LDADD

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* rcp/Makefile.am: Added AUTHLIBS to LDADD
	* rcp/rcp.c (dst_realm_buf): Typo.

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* ping/ping.c: Bugfix: ping.ping_count means the maximum number of
	packets to send.
	* ping/ping_echo.c (nabs): New function.

2003-04-05  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* libinetutils/Makefile.am: Added malloc.c and realloc.c
	* libinetutils/xmalloc.c: Removed checks for HAVE_MALLOC and
	HAVE_REALLOC: configure takes care that malloc and realloc be
	always POSIX-compliant.

2003-04-05  Sergey Poznyakoff  <gray@gnu.org>

	* acinclude.m4 (IU_CHECK_KRB5): Check for libresolv.  Minor
	bugfix: LIBS and LDFLAGS were not properly restored.
	* configure.ac: Removed KERBEROS_IV and KERBEROS_V defines.  Added
	check for socklen_t.

2003-02-08  Simon Josefsson  <jas@extundo.com>

	* telnet/commands.c (tn): Don't set hostname to DNS canonicalized
	value.  Attackers may control DNS and fool the Kerberos
	authentication code to use the wrong realm for the server, and
	consequently the wrong KDC for the server, which the attackers
	could also control.  Ultimately the attacker can fool the server
	authentication check in the client.

2003-01-15  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/Makefile.am: Removed libm dependency.
	* ping/ping_echo.c: Removed call to sqrt.

2002-12-22  Jeff Bailey  <jbailey@gnu.org>

	* libinetutils/Makefile.am: Include new files in dist rules.

2002-12-22  Jeff Bailey  <jbailey@gnu.org>

	* configure.ac: Bump version to 1.4.2

	* NEWS: Update for inetutils 1.4.2

2002-12-11  Jeff Bailey  <jbailey@gnu.org>

	* libinetutils/getopt.h: New file from Gnulib CVS
	* libinetutils/obstack.h: New file from Gnulib CVS
	* libinetutils/setenv.h: New file from Gnulib CVS
	* libinetutils/gettext.h: New file from Gnulib CVS
	* libinetutils/xalloc.h: New file from Gnulib CVS
	* libinetutils/xgetcwd.h: New file from Gnulib CVS
	* libinetutils/malloc.c: New file from Gnulib CVS
	* libinetutils/realloc.c: New file from Gnulib CVS
	* libinetutils/getopt.c: Update from Gnulib CVS
	* libinetutils/getopt1.c: Update from Gnulib CVS
	* libinetutils/getpass.c: Update from Gnulib CVS
	* libinetutils/getusershell.c: Update from Gnulib CVS
	* libinetutils/memcmp.c: Update from Gnulib CVS
	* libinetutils/memcpy.c: Update from Gnulib CVS
	* libinetutils/memmove.c: Update from Gnulib CVS
	* libinetutils/memset.c: Update from Gnulib CVS
	* libinetutils/obstack.c: Update from Gnulib CVS
	* libinetutils/pathmax.h: Update from Gnulib CVS
	* libinetutils/setenv.c: Update from Gnulib CVS
	* libinetutils/strcasecmp.c: Update from Gnulib CVS
	* libinetutils/strdup.c: Update from Gnulib CVS
	* libinetutils/strerror.c: Update from Gnulib CVS
	* libinetutils/xgetcwd.c: Update from Gnulib CVS
	* libinetutils/xmalloc.c: Update from Gnulib CVS
	* libinetutils/xstrdup.c: Update from Gnulib CVS

2002-12-11  Jeff Bailey  <jbailey@gnu.org>

	* configure.ac: Add AC_FUNC_MALLOC and AC_FUNC_REALLOC calls.

2002-12-06  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnetd/state.c: Fixed indentation.

2002-12-06  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/ping.c (main): Added spaces between cases in a switch to
	conform to the GCS.

2002-12-06  Sergey Poznyakoff

	* libtelnet/auth-proto.h: Renamed Authenticator to
	TN_Authenticator to avoid name collisions when compiling with
	Heimdal implementation of Kerberos.
	* libtelnet/auth.h: Likewise.
	* libtelnet/kerberos.c: Likewise.

	* libtelnet/kerberos5.c: Likewise.  Improved debugging output
	(patch courtesy of Simon Josefsson <jas@extundo.com>)
	* libtelnet/auth.c: Likewise.

	* libtelnet/misc.c: Removed unused variable.

2002-12-06  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/iruserok.c (iruserok): Removed unneded typecasts to
	(void).

2002-11-15  Alfred M. Szmidt  <ams@kemisten.nu>

	* configure.ac (AC_CONFIG_FILES): Removed duplicate entries
	`libicmp/Makefile' and `ping/Makefile' from the list.

2002-10-30  Jeff Bailey  <jbailey@gnu.org>

	* autogen.sh: Just use autoreconf - it's the right tool now.
	* configure.ac: Require autoconf 2.54
	* Makefile.am: Require automake 1.7

2002-09-30  Sergey Poznyakoff

	* syslogd/syslogd.c: Fix processing accumulated messages from
	/proc/kmsg (patch provided by Michael Deutschmann).

2002-09-20 Alain Magloire

	* ftpd/server_mode.c: getservbyname() returns the port number in
	network byte order, use ntohs(sv->s_port) for the conversion.
	Patch From Paul Poh <paul@paulpoh.com>

2002-09-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnet/telnet/Makefile.am: Add LIBAUTH to the list of libraries.

2002-09-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libtelnet/auth.h: Added OPTS_FORWARD.* defines
	* libtelnet/kerberos5.c: Rewritten.

2002-09-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* headers/arpa/telnet.h: Added AUTH_ENCRYPT_ defines

2002-09-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* acinclude.m4 (IU_CHECK_KRB5): Fixed.
	* configure.ac: Define KRB5 as well as KERBEROS_V.  When kerberos
	support is finally rewritten one of these will disappear.

2002-09-09  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rshd/rshd.c: Change to the user's directory after switching to
	the user privileges.  Thanks to Alex Muntada <alexm@ac.upc.es> for
	the idea.  Removed unneded casts to (void).  Create a local copy
	of hostname, lest it be spoiled by a call to localhost().  Thanks
	to Chris Ulherr for reporting.

2002-09-09  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rexecd/rexecd.c: Change to the user's directory after switching
	to the user privileges.  Thanks to Alex Muntada <alexm@ac.upc.es>
	for the idea.  Removed unneded casts to (void).

2002-09-06  Sergey Poznyakoff  <gray@Noldor.runasimi.org>

	* ping/ping.c (main): Removed duplicate startup introduced
	2002-06-24.  Should have been more careful!

2002-09-02  Sergey Poznyakoff

	* syslogd/syslogd.c: '**' extension (Michael Deutschmann
	<michael@talamasca.ocis.net> allows to catch all facilities not
	specified explicitely in the configuration file.

2002-09-02  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rshd/rshd.c: We must not seteuid before we setuid.  If we do, we
	don't have priviledges to complete the second operation.  Thanks
	to Chris Ulherr <chris.ulherr@inet.com> for reporting this.

2002-09-02  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rcp/rcp.c: Add support for rcp -V, Thanks to Chris Ulherr
	<chris.ulherr@inet.com> for reporting this.

2002-09-02  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* doc/doc/syslogd.texi: Documented ** extensions, provided by
	Michael Deutschmann <michael@talamasca.ocis.net>.

2002-09-02  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* configure.ac: Bump version to 1.4.1

2002-09-02  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* THANKS: Added Michael Deutschmann.
	* NEWS: Updated.

2002-09-02  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* ROADMAP: Update

	* NEWS: Update

	* THANKS: Add Chris Ulherr

2002-08-21  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* syslogd/syslogd.c (main): Fixed memory overrun when writing long
	data blocks from /proc/kmsg.  Thanks to Michael Deutschmann
	<michael@talamasca.ocis.net>

2002-08-09  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ping/ping.c (main): Restored ping startup to its right place.

2002-08-04  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnetd/Makefile.am (PATHDEF_DEV): Added to INCLUDES.

2002-08-04  Sergey Poznyakoff  <Mirddin.farlep.net>

	* acinclude.m4 (IU_CHECK_MEMBER, IU_CHECK_MEMBERS): added new
	macros to override the autoconf bug noted on 2002-05-14.  The old
	workaround didn't work for some cases (namely, utmp.ut_exit, whose
	members are named differently on different systems).  When the
	autoconf is updated, the need for these macros will disappear.
	* configure.ac: Use IU_CHECK_MEMBER(S) instead of AC_CHECK_MEMBERS
	throughout the file.

2002-07-31  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* configure.ac: Update version to 1.4

	* ROADMAP: New file

2002-07-27  Marcus Brinkmann  <marcus@gnu.org>

	* NEWS: Update to reflect the recent changes, and change its
	format to match current GNU practice.  Add a copyright statement,
	and some emacs local variables to support editing it.

2002-06-26  Alfred M. Szmidt  <ams@kemisten.nu>

	* .cvsignore (config.h.in): Removed.
	(config.hin, autom4te.cache): Added.

	* configure.ac: Removed erroneous #ifdef's in the checks for __P
	and syslog internal macros.

2002-06-24  Alfred M. Szmidt  <ams@kemisten.nu>

	* ping/ping.c (main): Moved ping startup code to after the parsing
	of the command line.
	(is_root): Variable moved into main().

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* tftp/tftp.c: Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.
	* tftpd/tftpd.c: Likewise.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnet/authenc.c: Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.
	* telnet/commands.c: Likewise.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* talk/ctl.c: Use HAVE_STRUCT_type_member instead of
	HAVE_type_member.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rexecd/rexecd.c: Use HAVE_STRUCT_type_member instead of
	HAVE_type_member.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* rcp/rcp.c: Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.
	  (tolocal): Removed redefinitions of IP_TOS et al.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/herror.c: Checks for HAVE_DECL variables must read
	#if !HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.
	* libinetutils/hstrerror.c: Likewise.
	* libinetutils/logwtmp.c: Likewise.
	* libinetutils/revoke.c: Likewise.
	* libinetutils/setenv.c: Likewise.

	* libinetutils/iruserok.c: Use HAVE_STRUCT_type_member instead of
	HAVE_type_member.
	* libinetutils/logout.c: Likewise.
	* libinetutils/ruserok.c: Likewise.
	* libinetutils/utmp_init.c: Likewise.
	* libinetutils/utmp_logout.c: Likewise.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ifconfig/Makefile.am: Removed obsolete OMIT_DEPENDENCIES.
	* ifconfig/system.h: Use HAVE_STRUCT_type_member instead of
	HAVE_type_member.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* headers/crypt.h: Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ftpd/ftp.c: Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.
	* ftpd/extern.h: Likewise.
	* ftpd/ftpd.c: Likewise.

2002-05-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* configure.ac: AC_CHECK_MEMBERS (as of version 2.53 ) fails to
	recognize the presense of a structure member which is itself of an
	aggregate type.  Thus, tests for struct ifreq.ifr_netmask and
	struct ifreq.ifr_broadaddr always fail.  To work around the bug,
	first check for a non-aggregate sub-member of the member in
	question and then create an appropriate HAVE_ define.

	Use AC_CHECK_DECLS on crypt and errno, as AC_CHECK_DECL does not
	generate HAVE_DECL_ define.

	(AH_BOTTOMs): Checks for HAVE_DECL variables must read #if
	!HAVE_DECL_something, since AC_CHECK_DECLS always declares
	HAVE_DECL, either to 0 or to 1.  The only exception is
	HAVE_DECL_HSTRERROR, whose AC_CHECK_DECLS is under a conditional
	expression, so we have to check for !defined(HAVE_DECL_HSTRERROR)
	first.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* whois/main.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* telnetd/telnetd.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* telnet/main.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* talkd/talkd.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* syslogd/syslogd.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* rshd/rshd.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* rsh/rsh.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* rlogind/rlogind.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* rlogin/rlogin.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* ping/ping_timestamp.c, ping_router.c, ping_echo.c,
	ping_address.c <version.h>: Include removed.

	* ping/ping.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* logger/logger.c: <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* inetd/inetd.c: <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* ifconfig/system/solaris.c, system/qnx.c, system/osf.c,
	system/linux.c, system/hpux.c, system/generic.c, printif.c,
	ifconfig.c, changeif.c, options.c <version.h>: Include removed.

	* ifconfig/options.c (inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* headers/Makefile.am (EXTRA_DIST): Removed version.h.in from the
	list.
	* headers/version.h.in: Removed.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* gwhois/whois.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* ftpd/ftpd.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* ftp/main.c <version.h>: Include removed.
	(inetutils_package): Renamed to PACKAGE_NAME.
	(inetutils_version): Renamed to PACKAGE_VERSION.
	(inetutils_bugaddr): Renamed to PACKAGE_BUGREPORT.

2002-04-29  Alfred M. Szmidt  <ams@kemisten.nu>

	* configure.ac (VERSION): Variable removed.
	(AC_OUTPUT): Removed headers/version.h and headers/version.h.in
	from the list.

2002-04-28  Alfred M. Szmidt  <ams@kemisten.nu>

	* configure.ac: Removed form feeds.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* whois/Makefile.am (bin_PROGRAMS): Use whois_BUILD instead of
	BUILD_WHOIS.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* uucpd/Makefile.am (inetdaemon_PROGRAMS): Use uucpd_BUILD instead
	of BUILD_UUCPD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* tftpd/Makefile.am (inetdaemon_PROGRAMS): Use tftpd_BUILD instead
	of BUILD_TFTPD.
	* tftpd/tftpd.c [HAVE_STRERROR_DECL]: Renamed to
	HAVE_DECL_STRERROR.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* tftp/Makefile.am (inetdaemon_PROGRAMS): Use tftpd_BUILD instead
	of BUILD_TFTPD.
	* tftp/tftp.c [HAVE_STRERROR_DECL]: Renamed to HAVE_DECL_STRERROR.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* telnet/Makefile.am (bin_PROGRAMS): Use telnet_BUILD instead of
	BUILD_TELNET.
	* telnet/authenc.c [HAVE_GETPASS_DECL]: Renamed to
	HAVE_DECL_GETPASS.
	* telnet/commands.c [HAVE_HTONS_DECL]: Renamed to HAVE_DECL_HTONS.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* talkd/Makefile.am (inetdaemon_PROGRAMS): Use talkd_BUILD instead
	of BUILD_TALKD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* talk/Makefile.am (bin_PROGRAMS): Use talk_BUILD instead of
	BUILD_TALK.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* syslogd/Makefile.am (inetdaemon_PROGRAMS): Use syslogd_BUILD
	instead of BUILD_SYSLOGD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rshd/Makefile.am (inetdaemon_PROGRAMS): Use rshd_BUILD instead
	of BUILD_RSHD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rsh/Makefile.am (bin_PROGRAMS): Use rsh_BUILD instead of
	BUILD_RSH.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rlogind/Makefile.am (inetdaemon_PROGRAMS): Use rlogind_BUILD
	instead of BUILD_RLOGIND.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rlogin/Makefile.am (bin_PROGRAMS): Use rlogin_BUILD instead of
	BUILD_RLOGIN.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rexecd/Makefile.am (inetdaemon_PROGRAMS): Use rexecd_BUILD
	instead of BUILD_REXECD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* rcp/Makefile.am (bin_PROGRAMS): Use rcp_BUILD instead of
	BUILD_RCP.
	* rcp/rcp.c [HAVE_STRERROR_DECL]: Renamed to HAVE_DECL_STRERROR.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* ping/Makefile.am (bin_PROGRAMS): Use ping_BUILD instead of
	BUILD_PING.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* logger/Makefile.am (bin_PROGRAMS): Use logger_BUILD instead of
	BUILD_LOGGER.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* libls/Makefile.am (noinst_LIBRARIES): Use libls_BUILD instead of
	BUILD_LIBLS.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* libinetutils/herror.c [HAVE_H_ERRNO_DECL]: Renamed to
	HAVE_DECL_H_ERRNO.
	* libinetutils/hstrerror.c [HAVE_H_ERRLIST_DECL]: Renamed to
	HAVE_DECL_H_ERRLIST.
	* libinetutils/logwtmp.c [HAVE_ERRNO_DECL]: Renamed to
	HAVE_DECL_ERRNO.
	* libinetutils/revoke: Likewise.
	* libinetutils/setenv.c: Likewise.
	[HAVE_ENVIRON_DECL]: Renamed to HAVE_DECL_ENVIRON.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* inetd/Makefile.am (inetdaemon_PROGRAMS): Use inetd_BUILD instead
	of BUILD_INETD.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* ifconfig/Makefile.am (bin_PROGRAMS): Use ifconfig_BUILD instead
	of BUILD_IFCONFIG.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* headers/crypt.h [HAVE_CRYPT_DECL]: Renamed to HAVE_DECL_CRYPT.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* gwhois/Makefile.am (bin_PROGRAMS): Use whois_BUILD instead of
	BUILD_WHOIS.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* glob/Makefile.am (noinst_LIBRARIES) Use libglob_BUILD instead of
	BUILD_LIBGLOB.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* ftpd/Makefile.am (inetdaemon_PROGRAMS): Use ftpd_BUILD instead
	of BUILD_FTPD.
	* ftpd/extern.h [HAVE_GETUSERSHELL_DECL]: Renamed to
	HAVE_DECL_GETUSERSHELL.
	* ftpd/ftpd.c [HAVE_FCLOSE_DECL]: Renamed to HAVE_DECL_FCLOSE.

2002-04-21  Alfred M. Szmidt <ams@kemisten.nu>

	* ftp/Makefile.am (bin_PROGRAMS): Use ftp_BUILD instead of
	BUILD_FTP.
	* ftp/ftp.c [HAVE_FCLOSE_DECL]: Renamed to HAVE_DECL_FCLOSE.
	[HAVE_PCLOSE_DECL]: Renamed to HAVE_DECL_PCLOSE.

2002-04-21  Alfred M. Szmidt  <ams@kemisten.nu>

	* Makefile.am (AUTOMAKE_OPTIONS): Require GNU Automake 1.6.

	* acinclude.m4 (IU_UCASE, iu_lcase): Variables removed.
	(IU_RESULT_ACTIONS, IU_CHECK_WEAK_REFS): Use the new AC_DEFINE
	syntax.
	(IU_CHECK_DECL, IU_CHECK_TYPE, IU_CHECK_STRUCT_FIELD): Functions
	removed.
	(IU_ENABLE_FOO): Use name_BUILD instead of BUILD_NAME.
	(IU_INCLUDED_REGEX): Replaced with..
	(jm_INCLUDED_REGEX): this.
	* acconfig.h: Removed.
	* configure.ac: Rewrite.

2002-04-08  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnetd/Makefile.am: Added @INCAUTH@ and @LIBAUTH@.

	* telnetd/telnetd.c: Fixed to compile with
	AUTHENTICATION/ENCRYPTION on.
	* telnetd/telnetd.h: Likewise.
	* telnetd/utility.c: Likewise.

2002-04-08  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libtelnet/Makefile.am: Added @INCAUTH@ to INCLUDES list

2002-04-08  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* acconfig.h: #undef's for KERBEROS_IV and KERBEROS_V
	* acinclude.m4 (IU_CHECK_KRB5): New macro: check for the presense
	of kerberos v.5
	* configure.ac: New options: --with-krb4[=PATH],
	--with-krb5[=PATH]

2002-04-07  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnetd/telnetd.c (print_hostinfo): Print local host name.
	* telnetd/utility.c: Include <termio.h>

2002-04-07  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* telnetd/telnetd.c: Initialize login_invocation.  Fixed calls to
	inet_ntoa.
	(print_hostinfo): Implemented.
	* telnetd/pty.c: Use new expand_line to create login command line.
	* telnetd/telnetd.h: Added missing prototypes.
	* telnetd/utility.c: Added line expansion code.
	(io_setup): Initialize ptyip.
	(pty_input_putback): new function.

2002-04-07  Sergey Poznyakoff

	* rlogind/rlogind.c: Updated for use with Kerberos V.

2002-04-07  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/utmp_logout.c (utmp_logout): Bugfix: gettimeofday()
	(and time()) was used over a member of utx, instead of ut.
	Consequently, all sessions were recorded in wtmp as having zero
	duration.

2002-04-05  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	Major rewrite of telnetd.

	* telnetd/defs.h: Removed.
	* telnetd/ext.h: Removed.
	* telnetd/global.c: Removed.
	* telnetd/authenc.c: Removed.
	* telnetd/sys_term.c: Removed
	* telnetd/term.c: (new) Terminal-specific functions.
	* telnetd/Makefile.am: Modified.
	* telnetd/telnetd.c: Rewritten.
	* telnetd/telnetd.h: Rewritten.
	* telnetd/utility.c: Rewritten.

	* telnetd/pty.c: Use obstack instead of manually allocating
	memory.

	* telnetd/slc.c: Lots of fixes: Removed conditional dependencies
	on LINEMODE, reduced number of global variables.
	* telnetd/state.c: Likewise.
	* telnetd/termstat.c: Likewise.

2002-04-05  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libinetutils/libinetutils/obstack.c: new
	* libinetutils/libinetutils/Makefile.am: Added obstack.c

	* libinetutils/libinetutils/utmp_init.c: Use ifdef UTMPX, instead
	of HAVE_UTMPX_H.
	* libinetutils/libinetutils/utmp_logout.c: Likewise.
	(utmp_logout): fallback to logwtmp() if updwtmp() is not
	available.

2002-04-05  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* headers/obstack.h: (new)
	* headers/Makefile.am: Added obstack.h

2002-04-05  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* ftp/Makefile.am: Add READLINE variable.

2002-04-05  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* acconfig.h: Removed extra HAVE_UTMPX_H.  Added HAVE_CC_T and
	HAVE_LIBREADLINE.
	* configure.ac: Check for obstack functions.  Modified readline
	check: assign -lreadline to the separate AC_SUBST variable,
	instead of appending it to LIBS.  Check for cc_t type.  Raised
	patchlevel.

2002-03-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	Started fixing horrible mess in telnetd.  To begin with,
	segregated pty-related functions from tty-related ones.  Use
	forkpty instead of manually fiddling with lots of ifdefs.  The
	stuff has been tested on GNU/Linux and Solaris.

	* telnetd/pty.c (new): PTY-related functions.
	* telnetd/Makefile.am: Added pty.c
	* telnetd/ext.h: Changed definition of line.
	* telnetd/sys_term.c: Removed unneeded functions.  Some of them
	are re-implemented in pty.c
	* telnetd/telnetd.c (doit, telnet, readstream): Reorganized.

2002-03-14  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* configure.ac: Added AC_CANONICAL_SYSTEM to set $host properly.
	Additional AC_DEFINEs for Solaris.

2002-03-05  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (main): New variables KLINE and KLINE_LEN, to
	store partial lines from the kernel log device.  Collect partial
	lines until we either have a maximum partial line or a full line.
	Log that, and all following lines collected so far, and in the
	case of the maximum partial line skip the remainder of the current
	line.  Reported by Davin McCall <davmac@iname.com>.

2002-02-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* glob/Makefile.am (INCLUDES): Added -I$(top_builddir)/include
	(needed for fnmatch.h and confpaths.h)

2002-02-12  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* TODO: Remove ping

	* THANKS: Update

	* README-alpha: *Wow* this file was really inaccurate.

	* NEWS: Mention talkd, and ping

	* AUTHORS: Update

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* uucpd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* tftpd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* tftp/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* telnetd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* telnet/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* talkd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* talk/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* syslogd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rshd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rsh/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rlogind/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rlogin/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rexecd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* rcp/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* ping/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* logger/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* libtelnet/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* libls/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* libinetutils/Makefile.am: Add -I$(top_builddir)/include to
	INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* libicmp/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* inetd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* headers/Makefile.am: Don't refer to config.h.in anymore

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* gwhois/.cvsignore: Add Generated headers

	* gwhois/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* ftpd/Makefile.am: Add -I$(top_builddir)/include to INCLUDES

	* ftpd/.cvsignore: Add ftpcmd.c

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* ftp/Makefile.am: Add $(top_builddir)/include to INCLUDES

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* doc/rfc/.cvsignore: New file

	* doc/.cvsignore: New file

2002-02-10  Jeff Bailey  <jbailey@outpost.dnsalias.org>

	* configure.in: Reworked for autoconf 2.52 and renamed to
	* configure.ac: this.

	* autogen.sh: Don't point autoheader to headers/

	* headers/acconfig.h: Move to ...
	* acconfig.h: Here

	* Makefile.am: Require Automake 1.5.  Add doc and doc/rfc to build
	tree.  Don't tell autoheader to look in headers/

	I moved config.h to the top_builddir to overcome a bug in autoconf
	that requires the config.h to be in the same directory as
	aclocal.m4

	This meant that I also had to add
	INCLUDES=-I$(top_builddir)/include.  The upshot is that make
	distcheck now passes, even for $(srcdir)!=$(builddir)

	* .cvsignore: Add files relating moving config.h to
	$(top_builddir)

2001-12-25  Alain Magloire

	* libinetutils/poll.c: Added <time.h>
	* libinetutils/getpass.c: New file, getpass().  Bert De Knuydt
	<Bert.Deknuydt@esat.kuleuven.ac.be>.

2001-12-25  Alain Magloire

	* ftp/cmds.c: Guard HAVE_MKSTEMP and use mktemp() has a fallback
	Note from Bert De Knuydt <Bert.Deknuydt@esat.kuleuven.ac.be>

2001-12-25  Alain Magloire

	* configure.in: Add check for mkstemp ().  Check for getpass().
	Note from Bert De Knuydt <Bert.Deknuydt@esat.kuleuven.ac.be>.

2001-11-22  Sergey Poznyakoff

	* rlogin/rlogin.c: Fixed syntax error: sizeof int.  Should be:
	sizeof(int).

2001-11-22  Sergey Poznyakoff

	* rcp/rcp.c: Fixed syntax error: sizeof int.  Should be:
	sizeof(int).

2001-11-21  Sergey Poznyakoff

	* syslogd/syslogd.c: Removed redeclaration of hstrerror: it is
	provided in include/config.h when missing.

2001-11-21  Sergey Poznyakoff  <gray@farlep.net>

	* ping/Makefile.am: Added $(man_MANS) to EXTRA_DIST.
	* ping/ping.8: Fixed permissions

2001-11-21  Sergey Poznyakoff

	* configure.in: Removed poll.h, sys/poll.h from AC_CHECK_HEADERS.
	Added individual check for poll.h, since syslogd uses it
	unconditionally.

2001-11-10  Alain Magloire

	* rcp/rcp.c (help): New function.  Convert to getopt_long () for
	long options support.

2001-11-10  Alain Magloire

	* doc/ftp.texi: New file.
	* doc/Makefile.am: Added ftp.texi.
	* doc/inetutils.texi: Enable ftp.texi.

	* doc/tftp.texi: New file.
	* doc/Makefile.am: Added tftp.texi.
	* doc/inetutils.texi: Enable tftp.texi.

	* doc/ping.texi: New file.
	* doc/Makefile.am: Added ping.texi.
	* doc/inetutils.texi: Enable ping.texi.

	* doc/talkd.texi: New file.
	* doc/Makefile.am: Added talkd.texi.
	* doc/inetutils.texi: Enable talkd.texi.

	* doc/talk.texi: New file.
	* doc/Makefile.am: Added talk.texi.
	* doc/inetutils.texi: Enable talk.texi.

	* doc/ftpd.texi: New file.
	* doc/Makefile.am: Added ftpd.texi.
	* doc/inetutils.texi: Enable ftpd.texi.

	* doc/inetd.texi: New file.
	* doc/Makefile.am: Added inetd.texi.
	* doc/inetutils.texi: Enable inetd.texi.

	* doc/rexecd.texi: New file.
	* doc/Makefile.am: Added rexecd.texi.
	* doc/inetutils.texi: Enable rexecd.texi.

	* doc/rcp.texi: New file.
	* doc/Makefile.am: Added rcp.texi.
	* doc/inetutils.texi: Enable rcp.texi.

	* doc/rsh.texi: New file.
	* doc/Makefile.am: Added rsh.texi.
	* doc/inetutils.texi: Enable rsh.texi.

2001-11-06  Alain Magloire

	* doc/rshd.texi: New file.
	* doc/Makefile.am: Added rshd.texi.
	* doc/inetutils.texi: Enable rshd.texi.

2001-11-04  Sergey Poznyakoff

	* rlogind/rlogind.c: The second argument for daemon() should be 0:
	close all descriptors and reserve first three ones.  Otherwise
	master/slave ptys could get all messed up.  Also changed first
	argument to 0, i.e. perform chdir("/"), so we don't keep cwd
	used.

2001-11-03  Alain Magloire

	* rsh/rsh.c: Removed copyright and sccsid variable.  Changes to
	follow GNU coding style.  #include <version.h>.  In long_options
	add options from rlogin.
	(help): Put info about rlogin options.
	(main): Change the code to use getop_long() correctly.  Added
	option -V and -h.

2001-11-03  Alain Magloire

	* rlogind/rlogind.c: A little indentation work 8-).
	(rlogin_daemon): Use function daemon(1, 1) to daemonize.  More
	portable and any bug fix will benefit all.

2001-11-03  Alain Magloire

	* rlogin/rlogin.c: Removed copyryght and sccsid.  #include
	<err.h>.  short_options add -V.
	(main): Check if we are setuid root, if not bail out early.
	(usage): Add -l, -V and -h info.

2001-11-03  Alain Magloire

	* rlogin/rlogin.c: #include <version.h> Reindent to comply to GNU
	coding style.  Implemented long version options.  Call seteeuid()
	not only setuid() when rcmd is finish.  Get rid of __STDC__ for
	function prototype, it was not use consistently anyways.  Nuked -L
	option 'litout' the code was commented out and nowadays nobody
	cares.
	(usage): Changed for long option output.

2001-11-03  Alain Magloire

	* libinetutils/daemon.c: GNU coding style changes.
	(waitdaemon): Try to find the number of file descriptor, check
	_SC_OPEN_MAX, getdtablsize() before falling to the default.

2001-11-03  Alain Magloire

	* ftpd/server_mode.c: [DEFPORT] defiine to 21.  Fallback to
	DEFPORT if getservbyname() failed.  Lots of site does not
	configure the /etc/services correctly.

2001-11-03  Alain Magloire

	* doc/rlogind.texi: New file.
	* doc/rlogin.texi: New file.
	* doc/Makefile.am: Add rlogin.texi and rlogind.texi in
	dependencies.  SUBDIRS added rfc.
	* doc/inetutils.texi: Enable rlogin and rlogind.
	* doc/rfc/1282.txt: New file.

2001-11-03  Alain Magloire

	* configure.in: Added doc/rfc/Makefile.

2001-11-02  Marcus Brinkmann  <marcus@212.23.136.22>

	* tftpd/tftpd.c: Prototype send_file, not sendfile.
	(formats): Use send_file, not sendfile.
	(sendfile): Rename to ...
	(send_file): ... this.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	There is a function sendfile() in the FreeBSD system headers, so:
	* tftp/tftp.c (sendfile): Rename to...
	(send_file): ... this.
	* tftp/main.c (put): Call send_file, not sendfile.
	* tftp/extern.h: Prototype send_file, not sendfile.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* libtelnet/getent.c (getent): Move variable declaration to the
	beginning of the function.
	(getstr): Likewise.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/utmp_logout.c (utmp_logout): Add a horde of
	conditionals to get it working on FreeBSD.
	* libinetutils/utmp_init.c (utmp_init): Likewise.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* headers/acconfig.h: Add macros for HAVE_UTMP_UT_PID,
	HAVE_UTMP_UT_ID, HAVE_UTMP_UT_USER.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* ftpd/ftpd.c (complete_login): Add missing `;'.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* doc/inetutils.texi: Fix dir entries and the menu.  Remove all
	those nonexisting nodes, and replace them by include directives.
	Comment out missing nodes.  Fix some minor formatting.
	* doc/syslogd.texi: Add node and chapter directives.
	* doc/logger.texi: Likewise.
	* doc/Makefile.am: New file.
	* doc/version.texi: Remove file (will be generated by automake).

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* doc/syslogd.texi: A lot of small formatting fixes.
	* doc/logger.texi: New file.
	* doc/inetutils.texi: Rename syslog to logger and add entry for
	it.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* configure.in: When checking for utmp structure fields, always
	include sys/types.h [HAVE_SYS_TYPES_H] before utmp.h (for time_t)
	to get it working on FreeBSD.  Add checks for fields pid, id and
	user.

2001-11-02  Marcus Brinkmann  <marcus@gnu.org>

	* configure.in: Add doc/Makefile as output file.

2001-11-01  Alain Magloire

	* ping/ping.8: New file.
	* ping/Makefile.am: man_MANS = ping.8.

2001-11-01  Sergey Poznyakoff

	* libinetutils/ttymsg.c: Added missing %s to format spec

2001-10-30  Alain Magloire

	* talkd/Makefile.am: Add -I ../libinetutils to have the argvc_xx()
	prototypes.
	* talkd/acl.c: Add <ctype.h> we use isdigit().  Add "argv.h" we
	use argv_xx() functions.
	(read_address): Declared static and variable addr unused nuked.
	(netdef_parse): Declared static.
	(open_users_acl): Declared static.
	(netdef_free): Declared static.
	(acl_free): Declared static.
	(discard_acl): Declared static.
	* talkd/announce.c (init_line format_line finish_line print_mesg):
	Declared static.
	* talkd/intalkd.h: Add prototypes for global functions.
	* talkd/print.c (messages_types): Array declared const and static.
	(answers): Array declared const and static.
	(_xlat_num): Declared static.
	(print_request): First argument declared const and should have a
	return value.
	(print_response): First argument declared const and should have a
	return value.
	* talkd/process.c (process_request): Bug, process did not have a
	return value.
	* talkd/table.c (lookup_request): Declared static and function
	pointer with proper prototypes.
	(fuzzy_comp): Declared static.
	(exact_comp): Did not have a return value.
	(delete_invite): Change prototype to correspond to
	include/protocols/talkd.h which wanted an unsinged long.
	* talkd/talkd.c (main): Returned 0 for good measure.
	(alarm_handler): Proper signal handler prototype.

2001-10-29  Sergey Poznyakoff

	* talkd/acl.c: Fixed declaration of read_address().  Bugfix in
	discard_acl(): it was discarding the extra entry.  acl_match():
	Set default action to ACT_ALLOW.
	* talkd/intalkd.h: Macro os2sin_addr: extract struct in_addr from
	struct osockaddr.
	* talkd/process.c: do_announce(): use os2sin_addr for readability.
	* talkd/table.c: Added extra debug info.
	* talkd/talkd.c: Removed `if (getuid ())' block.

2001-10-28  Alain Magloire

	* talkd/talkd/process.c (open_users_acl): free (filename);
	* talkd/talkd/talkd.c (talkd_init): Do not bail out if not root,
	Do we have to be root?

2001-10-28  Alain Magloire

	Unfortunately some platforms, like QNX/Neutrino does not implement
	flow control packet mode TIOCPKT.  If it is not defined, provide
	the constant.  It should not affect the functionnality, but the
	server will not be able to process CTRL-Q CTRL-S.

	* rlogin/rlogin/rlogin.c: Define the macros TIOCPKT_XXX.
	(speed_translate): This did not work on QNX/Neutrino, since we
	were assuming things that does not hold true.  We were assuming
	that B0, B50 etc ..  were ascending constant corresponding to 0,
	1, etc ... This is not portable POSIX only says that
	cfgetispeed() return symbolic functions.  To correct use
	approximatively the same code in telnet/sys_bsd.c.

2001-10-28  Alain Magloire

	Certain programs __MUST__ be install root to work properly.  There
	is a hook in the installation to warn the user.  But maybe in the
	future we should try to install as root and failed the
	installation if it does not work?

	* ping/Makefile.am: Rules to try install setuid root.
	* rcp/Makefile.am: Rules to try install setuid root.
	* rlogin/Makefile.am: Rules to try install setuid root.
	* rsh/Makefile.am: Rules to try install setuid root.

2001-10-27  Sergey Poznyakoff

	* talkd/acl.c: read_acl(): Initialize `head' to NULL (in case the
	acl contains null hostlist).

2001-10-25  Alain Magloire

	* telnetd/telnetd/telnetd.c: Remove stupid/obsolete hack, if an
	array is declare const char *, you can not write(readonly) to it.
	This the way ISO C defines it, even if some compiler let it
	trough.  Do the right thing everytime not only for GCC.

2001-10-25  Alain Magloire

	* telnet/telnet/telnet.c: jmp_buf is an opaque struct/object we
	should not try to initialize it, and in any case globals and
	static variables are initialize to zeros, a prerequesite of ISO C.

2001-10-25  Alain Malgoire

	* talkd/announce.c: Add <sys/uio.h> for "struct iovec" definition.
	#undef MAX before redefining it.  It was set in different system
	includes.

2001-10-25  Sergey Poznyakoff

	Talkd essencially rewritten.  New feature: system-wide and
	user-specific access-control lists allow for controlling who and
	from where is able to request talks.

	* talkd/intalkd.h: (new) Implementation-specific defines.
	* talkd/acl.c: (new) Access-control lists.
	* talkd/Makefile.am: Added new sources.
	* talkd/talkd.c: Completely rewritten.
	* talkd/table.c: Likewise.
	* talkd/announce.c: Likewise.
	* talkd/print.c: Likewise.
	* talkd/process.c: Likewise.

2001-10-25  Alain Magloire

	* syslogd/syslogd.c: Use the same code in talkd/talkd.c to handle
	utmp vs utmpx.
	(wallmesg): Use the macros when manipulating utmp functions.

2001-10-25  Alain Magloire

	* rlogind/rlogind.c (topdomain): In badly configure systems (like
	mine 8), there is no domainame, this case will cause a sigsegv.
	Because, we take for granted that local_domain_name, will be
	initialized correctly: local_domain_name = topdomain() // will
	return NULL.  Change topdomain() to return the original name on
	failure.

2001-10-25  Sergey Poznyakoff

	* libinetutils/argcv.c: (new) Simple string tokenizer.  Needed by
	talkd acls.
	* libinetutils/argcv.h: (new) Definitions for argcv.c
	* libinetutils/regex.c: (new) Regex functions.
	* libinetutils/regex.h: (new) Definitions for regex functions.
	* libinetutils/Makefile.am: Added argcv.[ch], regex.[ch]

2001-10-25  Sergey Poznyakoff

	* gwhois/Makefile.am: Added missing LDADD.

2001-10-25  Sergey Poznyakoff

	* ftpd/pam.c: Provide replacements for PAM_CONV_AGAIN and
	PAM_INCOMPLETE for systems that miss them (e.g.  Solaris)

2001-10-25  Alain Magloire

	* configure.in: Version to 1.3.2g.

2001-10-25  Sergey Poznyakoff

	* acinclude.m4: IU_INCLUDED_REGEX: Check for working regex,
	provide replacement, if necessary.
	* configure.in: Check for regex.

2001-09-06  Alain Magloire

	* configure.in: Check for strsignal().
	* libinetutils/strsignal.c: New file.

2001-09-05  Michael Weiser <mweiser@robin.imn.htwk-leipzig.de>

	* talkd/process.c: merge redundant #ifdef's

2001-09-05 Sergey Poznyakoff

	* gwhois/Makefile.am: List built headers in BUILT_SOURCES so the
	autodependency code works.  Removed $(srcdir)/ prefix from
	targets: the source directory might not be writable, so its better
	to build headers in the build directory if they are not present in
	srcdir.  Restored EXTRA_DIST.

2001-09-04  Michael Weiser <mweiser@robin.imn.htwk-leipzig.de>

	* talkd/process.c: Guard <utmp.h> utmpx.h> properly.
	(find_user): Guard calls to setutent() or setutxent().  Use
	sizeof(PATH_DEV) instead of hardcoded numbers.

2001-08-29  Marcus Brinkmann  <marcus@gnu.org>

	* Makefile.am (SUBDIRS): Remove `ifconfig' for now
	(see ifconfig/TODO for a list of items that need to be resolved).

2001-08-27  Alain Magloire

	* ftpd/Makefile.am: Add EXTRA_DIST = ftpcmd.c.  To force the
	generation of the file when doing the distribution.  This way YACC
	is no longer an requirement.

2001-08-26   Alain Magloire

	* inetd/inetd.c (main): Fixed memory overryn in main 8-).
	config_files is a null terminate array of pointers.

2001-08-26  Sergey Poznyakoff

	* inetd/inetd.c: Fixed memory overrun in main.

2001-08-26  Alain Magloire

	The idea is to provide an easy way to add services without mocking
	around with inetd.conf.  It is possible to just drop a file in
	PATH_INETDDIR, and the file will be pick and merge like if it was
	a configuration file.  For example,

	/etc/inetd.d/telnet
	/etc/inetd.d/ftp
	/etc/inetd.d/login
	/etc/inetd.d/shell

	will contain the entries to start telnet/ftp/rlogin/shell without
	having to put them in /etc/inetd.conf.  The idea was submitted by
	Jakob.

	The code had a face lift to comply with GNU coding style.

	* inetd/inetd.c: prototypes changes:
	void  endconfig __P((FILE *));
	struct servtab *getconfigent __P((FILE *, const char *));
	char  *newstr __P((const char *));
	void  nextconfig __P((const char *));
	void print_service __P((const char *, const char *, struct servtab *));
	FILE           *setconfig __P((const char *));
	char          *sskip __P((char **, FILE *, const char *));
	char          *skip __P((char **, FILE *));
	(usage): Updated.
	(main): Localised the variables.  Read the line configuration
	files in to an array.
	(config): Go through the configuration files arrays and call
	nextconfig on each file for parsing.
	(nextconfig): Parse the configuration file and construct an
	service entry.

	* inetd/inetd.8: Update to document the new PATH_INETDDIR feature.

2001-08-26  Alain Magloire

	* gwhois/ChangeLog: New File.
	* gwhois/Makefile.am: EXTRA_DIST = as_del.h ip_del.h tld_serv.h So
	no need to have PERL in the distribution.  Add missing
	dependencies.
	* gwhois/whois.c: Guard <config.h> with the appropriate
	HAVE_CONFIG_H Remove macors GETOP_LONG and HAVE_GETOPT_LONG.
	inetutils always provide a version even for platforms missing it.

	* gwhois/config.h: remove and merge in whois.h

2001-08-26  Alain Magloire

	Marco D'Itri whois is much more complete then the original one
	provided by Joel N.  Weber II (devnull).  So it is enable.

	* configure.in: use gwhois instead whois
	* Makefile.am: SUBDIRS have gwhois instead of whois.

2001-08-25  Alain Magloire

	* libls/Makefile.am: use BUILD_LS.

2001-08-25  Alain Magloire

	* ftpd/Makefile.am: Check for LIBLS and add it to the link.
	* ftpd/popen.c: WITH_LIBLS check.

2001-08-25  Alain Magloire

	* configure.in: AC_ARG_ENABLE(libls ..) libls will not work on all
	platforms, make it possible to disable it.  LIBLS, BUILD_LIBLS,
	WITH_LIBLS, new variable.s
	* header/acconfig.h: WITH_LIBLS new.

2001-08-17  Marcus Brinkmann  <marcus@gnu.org>

	* telnet/sys_bsd.c (TerminalFlushOutput): New variable FLAGS.
	Pass pointers to it to the ioctls.

2001-08-11  Sergey Poznyakoff  <gray@farlep.net>

	* rlogind/rlogind.c: Use ENCRYPTION instead of CRYPT.

2001-08-11  Sergey Poznyakoff  <gray@farlep.net>

	* ping/ping_echo.c: Removed restriction on hostname lengths in
	ipaddr2str.
	* ping/ping.c: Fixed coding style to comply with GNU.
	* ping/ping_address.c: Likewise.
	* ping/ping_impl.h: Likewise.
	* ping/ping_router.c: Likewise.
	* ping/ping_timestamp.c: Likewise.

2001-08-11  Sergey Poznyakoff  <gray@farlep.net>

	* icmp.h: Fixed coding style to comply with GNU.
	* libicmp/icmp_address.c: Likewise.
	* libicmp/icmp_cksum.c: Likewise.
	* libicmp/icmp_echo.c: Likewise.
	* libicmp/icmp_timestamp.c: Likewise.
	* libicmp/libping.c: Likewise.
	* libicmp/ping.h: Likewise.

2001-07-26  Alain Magloire

	The patch was provided by Eric Gillespie, Jr., it addresses a
	vulnerability in telnetd: TESO Security Advisory 06/10/2001

	Multiple vendor Telnet Daemon vulnerability

	Summary
	===================
	Within most of the current telnet daemons in use today there exist a
	buffer overflow in the telnet option handling. Under certain
	circumstances it may be possible to exploit it to gain root
	priviledges remotely.

	Impact
	===================
	Through sending a specially formed option string to the remote telnet
	daemon a remote attacker might be able to overwrite sensitive
	information on the static memory pages. If done properly this may
	result in arbitrary code getting executed on the remote machine under
	the priviledges the telnet daemon runs on, usually root.

	Explanation
	===================
	Within every BSD derived telnet daemon under UNIX the telnet options
	are processed by the 'telrcv' function. This function parses the
	options according to the telnet protocol and its internal state.
	During this parsing the results which should be send back to the
	client are stored within the 'netobuf' buffer. This is done without
	any bounds checking, since it is assumed that the reply data is
	smaller than the buffer size (which is BUFSIZ bytes, usually).

	However, using a combination of options, especially the 'AYT' Are You
	There option, it is possible to append data to the buffer, usually
	nine bytes long. To trigger this response, two bytes in the input
	buffer are necessary. Since this input buffer is BUFSIZ bytes long,
	you can exceed the output buffer by as much as
	(BUFSIZ / 2) * 9) - BUFSIZ bytes. For the common case that BUFSIZ is
	defined to be 1024, this results in a buffer overflow by up to 3584
	bytes.  On systems where BUFSIZ is defined to be 4096, this is an
	even greater value (14336).
	Due to the limited set of characters an attacker is able to write
	outside of the buffer it is difficult - if not impossible on some
	systems - to exploit this buffer overflow. Another hurdle for a
	possible attacker may be the lack of interesting information to
	modify after the buffer.
	This buffer overflow should be considered serious nevertheless, since
	experience has shown that even complicated vulnerabilities can be
	exploited by skilled attackers, BIND TSIG and SSH deattack come to
	mind.
	We have constructed a working exploit for any version of BSDI, NetBSD
	and FreeBSD. Exploitation on Solaris sparc may be possible but if it
	is, it is very difficult involving lots of arcane tricks. OpenBSD is
	not as easily exploitable as the other BSD's, because they do compile
	with other options by default, changing memory layout.

	* telnetd/ext.h (output_data): Add prototypes for output_data.
	* telnetd/state.c (output_data): Implement output_data().  Patch
	provided by "Eric Gillespie, Jr.".

2001-07-18  Alain Magloire

	Much of the changes where indentation to follow GNU coding style.
	Use of "const" where appropriate.  atoi() is not ANSI C nor POSIX.
	Preferable to use strto(u)l().  The same for bcopy() moving to
	POSIX mem*() functions.

	* rlogind/rlogind.c:#include <sys/stat.h> is needed for chmod ().
	#include <sys/ioctl.h> is needed for the ioctl() calls.  Remove
	the "static" scope since the functions were define whithout the
	static qualificator.
	(main): atoi() replace by strtoul() where needed.
	(rlogind_mainloop): Need to return a value since it is use as an
	argument to exit () add return 0.
	(getstr): argument is now const.
	(protocol): Initialize variables pdp and fpb gcc was complaining
	about it.
	(protocol): n was shadowed by another n previosuly declared rename
	the variable len and change its scope.
	(protocol): bcopy() replace by memmove().
	(control): argument change to size_t.
	(fatal): second argument now is const char *.

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* rlogind/rlogind.c: use regular read() instead of getmsg() on the
	master side of pty.

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* rlogind/rlogind.c: Rewritten from scratch.  Implemented -a
	(verify hostname) option.  Added --reverse-required and --daemon
	options.  Kerberos code is not tested, though.

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* ping/ping.c: Use inetutils_package instead of PACKAGE.  Same for
	VERSION.

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* libinetutils/openpty.c: Set RMSGN|RPROTDAT on master side of pty
	pair, so it can be read using read() call.

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* libinetutils/localhost.c: Return fully qualified domain name.
	* libinetutils/login_tty.c: Rewritten from scratch.  This version
	works on systems lacking TIOCSCTTY ioctl (eg.  Solaris).

2001-07-14  Sergey Poznyakoff  <gray@farlep.net>

	* configure.in: Check for setpgid(), vhangup().
	* ping/ChangeLog: (new)
	* libicmp/ChangeLog: (new)
	* libinetutils: See libinetutils/ChangeLog.
	* rlogind: See rlogind/ChangeLog.
	* ping: See ping/ChangeLog.

2001-07-10  Sergey Poznyakoff

	* ifconfig/if_index.c: Include ifconfig.h instead of if_index.h.
	Reason: ifconfig.h includes system.h which contains definition of
	ifr_index member for systems lacking it.  It also includes
	if_index.h.  Thanks to Alain.

2001-06-30  Sergey Poznyakoff

	* ifconfig/if_index.c: if_nameindex(): Actually fall back :^).
	Besides, the return value was unspecified if socked() failed.
	Removed # define ifr_ifindex ifr_index.  Use ifr_index instead of
	ifr_ifindex throughout the module, since the check for its
	presence is already made in configure.in and appropriate define is
	in system.h.  if_nameindex(): reverted condition on ioctl()
	return.

2001-06-26  Alain Magloire

	* ifconfig/if_index.c: Solaris does not define ifr_index but
	rather ifr_ifindex ... sigh ..  redefine it to ifr_index to be
	consistent.
	(if_indextoname): Typo missing closing bracket.

	* ifconfig/options.c (parse_opt_finalize): The return of getopt()
	should be an int not a char since on many OS for example
	QNX4/Watcomm C char is unsigned.

	* ifconfig/system.c: Use __QNX__
	* ifconfig/system.h: Use __QNX__
	* ifconfig/system/qnx.h: remove qfh_netmask and qfh_brdaddr, the
	generic versions will work fine.

2001-06-25  Alain Magloire

	* ifconfig/if_index.c: Fall back to the generic version if
	SIOCGIFINDEX and SIOCGIFNAME fail.  Note from Sergey.  Define
	BSD_COMP for solaris machines to include the ioctl definitions.

	* ifconfig/options.c (usage): Terminate the string with '\n\'.
	* ifconfig/printif.c (print_interfaceX): Use alloca() instead of
	dynamique allocated arrays, may compiler can not cope with this
	yet.

2001-06-23  Marcus Brinkmann  <marcus@gnu.org>

	* ifconfig/system/qnx.c (qfh_brdaddr, qfh_netmask): Functions
	removed, the generic ones will work fine with the changes to
	system.h.
	* ifconfig/system/qnx.h: Prototypes for these functions removed.

	* ifconfig/system/qnx.h: Do not define ifr_netmask.

	* ifconfig/printif.h: Move check for HAVE_* introduced in last
	change to ...
	* system.h: ... here.

	* ifconfig/options.c: Revert change from Alain.

2001-06-20  Sergey Poznyakoff  <gray@farlep.net>

	Patches by Alain:
	* ping/ping_address.c, ping/ping_echo.c, ping/ping_router.c,
	ping/ping_timestamp.c: <signal.h> -> <sys/signal.h>

2001-06-20  Sergey Poznyakoff  <gray@farlep.net>

	Patches by Alain:
	* libicmp/icmp_cksum.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c, libicmp/libping.c: use <signal.h>
	instead of <sys/signal.h>, truncate pid_t before using as
	ping_ident.

2001-06-20  Sergey Poznyakoff  <gray@farlep.net>

	Patches by Alain:
	* libicmp/icmp_cksum.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c, libicmp/libping.c: use <signal.h>
	instead of <sys/signal.h>, truncate pid_t before using as
	ping_ident.
	* libicmp/ping.h: changed type of ping_datalen to size_t.
	* libicmp/icmp_address.c: icmp was used unitialized.
	* ping/ping_address.c, ping/ping_echo.c, ping/ping_router.c,
	ping/ping_timestamp.c: <signal.h> -> <sys/signal.h>

2001-06-20  Sergey Poznyakoff  <gray@farlep.net>

	Patches by Alain:

	* libicmp/icmp_cksum.c, libicmp/icmp_echo.c,
	libicmp/icmp_timestamp.c, libicmp/libping.c: use <signal.h>
	instead of <sys/signal.h>, truncate pid_t before using as
	ping_ident.
	* libicmp/ping.h: changed type of ping_datalen to size_t.
	* libicmp/icmp_address.c: icmp was used unitialized.
	* ping/ping_address.c, ping/ping_echo.c, ping/ping_router.c,
	ping/ping_timestamp.c: <signal.h> -> <sys/signal.h>

2001-06-19  Sergey Poznyakoff  <gray@farlep.net>

	* ping/Makefile.am: use @BUILD_PING@ instead of directly assigning
	bin_PROGRAMS.
	* ping/ping.h: changed counters in struct PING from int to longs.
	* ping/ping.c, ping/ping_address.c, ping/ping_echo.c,
	ping/ping_impl.h, ping/ping_router.c, ping/ping_timestamp.c: Fixed
	a bunch of inconsistencies (thanks to Alain).  Changes to make gcc
	-Wall less verbose.

2001-06-19  Sergey Poznyakoff  <gray@farlep.net>

	* libicmp/icmp_timestamp.c: forgotten to commit yesterday :^)
	* libicmp/ping.h: changed counters in struct PING from int to
	longs.
	* libicmp/icmp.h, libping.c,

2001-06-19  Sergey Poznyakoff  <gray@farlep.net>

	* configure.in, Makefile.am: added libicmp and ping to build.
	* ping/Makefile.am: use @BUILD_PING@ instead of directly assigning
	bin_PROGRAMS.
	* libicmp/icmp_timestamp.c: forgotten to commit yesterday :^)
	* libicmp/ping.h: changed counters in struct PING from int to
	longs.
	* libicmp/icmp.h, libicmp/libping.c, ping/ping.c,
	ping/ping_address.c, ping/ping_echo.c, ping/ping_impl.h,
	ping/ping_router.c, ping/ping_timestamp.c: Fixed a bunch of
	inconsistencies (thanks to Alain).  Changes to make gcc -Wall less
	verbose.

2001-06-18  Sergey Poznyakoff  <gray@farlep.net>

	* ping/Makefile.am: added OMIT_DEPENDENCIES
	* ping/ping.c, ping/ping_address.c, ping/ping_echo.c,
	ping/ping_impl.h, ping/ping_timestamp.c: Implemented
	ICMP_TIMESTAMP and ICMP_ADDRESSMASK requests.  None of existing
	routers answers the latter, though.

2001-06-18  Sergey Poznyakoff  <gray@farlep.net>

	* libicmp/Makefile.am: added icmp_address.c
	* libicmp/icmp_address.c: added.
	* libicmp/icmp.h: added new protos
	* libicmp/icmp_echo.c: eliminated unused variable
	* libicmp/icmp_timestamp.c: implemented
	* libicmp/libping.c: changes too numerous to mention.
	* libicmp/ping.h: reflect changes to libping.c
	* ping/Makefile.am: added OMIT_DEPENDENCIES
	* ping/ping.c, ping/ping_address.c, ping/ping_echo.c,
	ping/ping_impl.h, ping/ping_timestamp.c: Implemented
	ICMP_TIMESTAMP and ICMP_ADDRESSMASK requests.  None of existing
	routers answers the latter, though.

2001-06-13  Sergey Poznyakoff  <gray@farlep.net>

	* ping/ping.c: implemented
	* ping/ping_address.c, ping/ping_echo.c, ping/ping_impl.h,
	ping/ping_router.c, ping/ping_timestamp.c: added to repository.

2001-06-13  Sergey Poznyakoff  <gray@farlep.net>

	* libicmp/Makefile.am, libicmp/icmp.h, libicmp/icmp_cksum.c,
	libicmp/icmp_echo.c, libicmp/icmp_timestamp.c, libicmp/libping.c,
	libicmp/ping.h: added to repository.  Currently it is more libping
	than libicmp, I will be adding required functionality latter.
	* ping/ping.c: implemented
	* ping/ping_address.c, ping/ping_echo.c, ping/ping_impl.h,
	ping/ping_router.c, ping/ping_timestamp.c: added to repository.
	* paths: PATH_HEQUIV needs search in <netdb.h> (for Solaris)

2001-06-05  Sergey Poznyakoff  <gray@farlep.net>

	* libinetutils/ttymsg.c (normalize_path): Define static and
	provide a prototype and it was call with the wrong number of
	arguments.

2001-06-05  Sergey Poznyakoff  <gray@farlep.net>

	* ftpd/ftpd.c: MAP_FAILED is not defined on some systems
	(e.g.  Solaris, SunOS)
	* headers/paths.h: Added missing _PATH_LOGCONF, _PATH_LOGPID,
	_PATH_LOG
	* libls/print.c: Provided defaults for major() and minor() macros
	for systems lacking them.

2001-06-04  Alain Magloire

	After patches and feedback From Sergey and Marcus.

	* ifconfig/if_index.h: New file, prototypes for if_nameindex().
	* ifconfig/if_index.c: New version base on the one in GLIBC.
	* ifconfig/Makefile.am: Added if_index.c unconditionnaly.
	* ifconfig/changeif.c(configure_if): memset(0) ifr, it helps
	debugging.
	* ifconfig/flags.c: const consistencies.
	* ifconfig/ifconfig.h: include if_index.h
	* ifconfig/options.c: Defined SYSTEM_SHORT_OPTIONS
	SYSTEM_LONG_OPTIONS.
	* ifconfig/options.h: const consistencies.
	* ifconfig/printif.c: const consistencies.
	* ifconfig/printif.h: const consistencies.  Check for
	HAVE_IFREQ_IFR_INDEX HAVE_IFREQ_IFR_NETMASK
	HAVE_IFREQ_IFR_BROADADDR.
	* ifconfig/system.c: Use marcor processor #elif for clarity.
	* ifconfig/system.h: const consistencies.
	* ifconfig/system/qnx.c: New file.
	* ifconfig/system/qnx.h: New file.
	* ifconfig/system/solaris.c: Define system_configure.

2001-06-04  Marcus Brinkmann  <marcus@gnu.org>

	* options.c (long_options): Only add SYSTEM_LONG_OPTIONS if it is
	defined.

	Lots of small fixes submitted Sergey Poznyakoff
	<gray@Mirddin.farlep.net>:

	* ifconfig/ifconfig.h: Do not include <config.h>.
	* ifconfig/printif.h: Likewise.
	* ifconfig/changeif.c: Include <sys/socket.h>.
	* ifconfig/ifconfig.c: Likewise.
	* ifconfig/printif.c: Likewise.
	* ifconfig/system/hpux.c: Don't include <stdint.h>.
	* ifconfig/system/osf.c: Likewise.
	* ifconfig/system/linux.c: Likewise.
	* ifconfig/system/solaris.c: Likewise.
	* ifconfig/printif.c: Likewise.
	* ifconfig/system/generic.c (system_configure): New function.
	* ifconfig/system/osf.c (system_configure): Likewise.
	* ifconfig/system/hpux.c (system_configure): Likewise.
	* ifconfig/system/solaris.c (system_parse_opt_rest): Fix order of
	operators.
	(system_default_format): Fix syntax.  Include <sys/socket.h>,
	<netinet/in.h>, <netinet/if_ether.h>
	(rather than <linux/if_ether.h>).
	* ifconfig/system.h: Change __solaris__ to __sun__.
	* ifconfig/system.c: Likewise.

2001-06-02  Sergey Poznyakoff  <gray@farlep.net>

	* libinetutils/ttymsg.c: Simple check for '/' in the line name is
	way too week: it doesn't work for tty names like pts/2, which are
	perfectly OK.  Changed to more sophisticated one: all "./", "../"
	references in the name are resolved and the resulting name is
	compared with PATH_TTY_PFX.  If it lies under it, everything's Ok.
	Otherwise we just bail out and quit.
	* talk/display.c: Added check for *text == '\a' to produce audible
	bell.
	* talk/io.c: changed \007's in initial message to beep() after
	message().  On solaris's AT386 those \007 just produce ^G on the
	screen.  Changed read(0, buf, nb) to getch() in loop.  Reason:
	read() returns raw data from console, thus pressing <enter>
	returns '\r' which gets displayed on console as ^M, because
	display.c is expecting to get '\n'.  getch() returns '\n' and
	everything goes smooth.
	* talk/announce.c: syslog error message from ttymsg().  One never
	knows...
	* talkd/process.c: changed find_user().  Previous version returned
	first console the remote party was logged onto.  This one returns
	the one where he currently is.  This is a slightly modified
	version of berkeley's find_user() dated 1997/04/06.

2001-05-07  Jeff Bailey  <jbailey@oasis.zugzug.com>

	* ifconfig/system/Makefile.am: New File, for 'make dist' derived
	targets.

	* ifconfig/Makefile.am: Add printif.h and system.h to
	noinst_HEADERS.

2001-05-07  Jeff Bailey  <jbailey@oasis.zugzug.com>

	* Makefile.am: Integrate ifconfig into build

	* configure.in: Integrate ifconfig into build

2001-03-14  Joachim Gabler <joga@sun.com>

	* rlogind/rlogind.c: exec to /bin/login requires additional
	parameters on SOLARIS

2001-02-27  Marcus Brinkmann  <marcus@gnu.org>

	* ifconfig/system/linux.c (system_configure): Move return
	statement outside of if-block.

	* ifconfig/printif.h: Declare had_output.
	* ifconfig/printif.c (had_output): New global variable.
	(many functions): Whereever we output something, set had_output to
	1.
	(join): Remove variable first.  New variable had_output_saved.
	Clear had_output after storing it in had_output_saved.  Use that
	to determine if to print delimiter.  Later on, restore had_output.
	* ifconfig/system/linux.c (some functions): Whereever we output
	something, set had_output to 1.

2001-02-26  Alain Magloire

	* libinetutils/openpty.c (ptys_open) : ioctl of "pckt" should be
	done on the master file descriptor.  Found by Joachim Gabler
	<Joachim.Gabler@germany.sun.com>

2001-02-26  Alain Magloire

	* ftp/domacro.c : Check if the margv is not NULL and return.
	* ftp/ftp.c (login) : The variable "line" is used as a target of
	strcpy.  Unfortunately, the readline() changes cause this to be
	NULL when processing an automatic login via $HOME/.netrc.  Bug and
	patch for ftp.c provided by "B.  D.  Elliott" <bde@nwlink.com>.

2001-02-22  Marcus Brinkmann  <marcus@gnu.org>

	* ifconfig/flags.c: Protect inclusion of config.h.

2001-02-22  Marcus Brinkmann  <marcus@gnu.org>

	* ifconfig/Initial release.

2001-02-09  Jeff Bailey  <jbailey@oasis.zugzug.com>

	* Makefile.am: Use 4 digit year for `make release'

2001-01-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (usage): Add missing parentheses in help text.

2001-01-16  Alain Magloire

	* gwhois/whois.c, gwhois/TODO, gwhois/Makefile: Update from the
	patch send by Marco d'Itri.

2001-01-16  Marcus Brinkmann  <marcus@gnu.org>

	* whois/main.c: Terminate array longopts with an element
	containing all zeros.

2001-01-03  Alain Magloire

	* rcp/rcp.c: GNU coding style changes.

2000-11-25  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (main): Give reason for failure of waitdaemon.
	(add_funix): Print program name and reason for failure in error
	message.

2000-11-25  Marcus Brinkmann  <marcus@gnu.org>

	* README: Uppercase the Hurd, fix comment about long option
	support missing (most -> many).

	* TODO: Update the entry about long options support (we can now
	list those which are missing, instead those which have it).  Add
	internationalization/gettext to the list.  Uppercase the Hurd.

2000-11-03 Alain Magloire

	* rshd/rshd.c: #include <version.h> added.  Removed copyright and
	sccsid variables.
	(help): New function to display info.
	(short_options): New variable.
	(long_options): New variable.
	(main): Implemented long options with getopt_long().

2000-11-03  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/localhost.c (localhost): Make an initial guess of
	256 for the name length: SUSv2 says a hostname is up to 255
	characters long, and doesn't specify any error codes, so stay on
	the safe side.

2000-10-31  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/localhost.c: Prototype xrealloc, not xalloc.
	(localhost): Add missing parenthese.

2000-10-31  Marcus Brinkmann  <marcus@gnu.org>

	* inetd/inetd.c: Remove COPYRIGHT (it's in the header) and "#if
	0"-out SCCSID.  Declare __PROGNAME.  New variables SHORT_OPTIONS
	and LONG_OPTIONS.
	(main): Initialize __progname if not HAVE___PROGNAME.  Rename CH
	to OPTION.  Rework option parsing to use getopt_long.
	(usage): Completely new and conforming to the others.

2000-10-31  Marcus Brinkmann  <marcus@gnu.org>

	* ftpd/ftpd.c: Remove PROGRAM, declare __PROGNAME.  Remove
	COPYRIGHT
	(it's in the header) and "#if 0"-out SCCSID.
	(usage): Replace PROGRAM with __PROGNAME.
	(main): Likewise.  Also initialize __PROGNAME if not
	HAVE___PROGNAME.

2000-10-30  Marcus Brinkmann

	* telnetd/sys_term.c: Add prototype for cleanopen().
	* telnetd/telnetd.c (main): Move assignment outside if condition.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: Remove PROGRAM, declare __PROGNAME.
	Prototype waitdaemon().  Remove COPYRIGHT (it's in the comment at
	the top).  Replace "#ifndef lint" with "#if 0" for SCCSID to avoid
	gcc warning.
	(main): Initialize __PROGNAME if not HAVE___PROGNAME.  Use
	__PROGNAME instead PROGRAM.
	(usage): Likewise.
	(crunch_list): Likewise.
	(die): Likewise.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* rcp/rcp.c (rsource): Don't take the address of a pointer when
	the pointer is what we need, so change &statp to statp.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* logger/logger.c: Declare __PROGNAME.  Remove PROGRAM.  Remove
	COPYRIGHT (it's in the header) and replace "#ifndef lint" with
	"#if 0" for SCCSID.
	(main): Initialize __PROGNAME if not HAVE___PROGNAME.  Use
	__PROGNAME instead PROGRAM.
	(pencode): Likewise.
	(usage): Likewise.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* libtelnet/getent.c: Define AREA only when HAVE_CGETENT, to
	silence compiler warning.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* libls/ls.c (traverse): Fix format of error message.

	* libls/fts.c (fts_stat): Not all systems have S_IFWHT even if
	they have DT_WHT, so check for this.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/utmp_init.c: Define __USE_GNU before including
	utmpx to get prototype of updwtmpx.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* inetd/inetd.c: Include <grp.h> for initgroups().

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* ftpd/ftpd.c: New variable PROGRAM.
	(usage): Frob it to behave like the syslogd usage(), so it gives
	the correct output.
	(main): Beautify option parsing code (more comments, proper use of
	usage).  Reject unknown options instead ignoring them.  Initialize
	PROGRAM and use it instead of argv.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* ftp/main.c: Convert to GNU coding standards.

	* ftp/main.c: Remove COPYRIGHT (it's in the header) and "#if
	0"-out SCCSID.
	(ohelp): Removed.
	(try_help): Removed.
	(usage): Incorporate functionality of ohelp and try_help, and
	accept new argument ERR.

	* ftp/main.c (getcmd): Add parenthese around assignment used as
	truth value to silence gcc warning.
	(makeargv): Likewise.

2000-10-30  Marcus Brinkmann  <marcus@gnu.org>

	* ftp/cmds.c (remglob): New variable fd, use it to create
	temporary file with mkstemp(), and not insecure mktemp().

2000-08-24  Alain Magloire

	* libls/fts.c: Check for HAVE_FCHDIR, and disable fchdir() for OS
	lacking.  bcopy --> memmove, bzero --> memset.

	* libls/fts.c: Include <config.h>.
	* libls/cmp.c: Include <config.h>.
	* libls/ls.c: Include <config.h>.
	* libls/print.c: Include <config.h>.
	* libls/stat_flags.c: Include <config.h>.
	* libls/util.c: Include <config.h>.

2000-08-24  Alain Magloire

	* libinetutils/stub_tgetent.c: Prototype was wrong.
	* libinetutils/openpty.c: Prototype was wrong.

2000-08-22  Alain Magloire

	* rcp/util.c: Define the roundup() macro if not define by the OS.

2000-08-22  Alain Magloire

	* configure.in: Options --with-pam and --with-wrap so far they are
	only usefull for ftpd.
	* Makefile.am: Syslog change for logger.

2000-08-21  Alain Magloire

	The idea is to reduce the number of side effects i.e. reducing
	the number of global variables.  To help we regroup some of them
	in a structure call credentials, that is pass around.  The second
	approach to help detect side effects; when possible the variables
	are pass by parameter.  All the gots of the authentication have
	move out elsewere(auth.c, pam.c) this will save us from the pesky
	#ifdef's.

	* ftpd/ftpd.c: Passwd handling code removed.  PAM code removed.
	Variables guess, pw, logged_in, remotehost part of the credential
	structure.
	(end_login): Take the credential as an argument.
	(dolog): Likewise.
	(user): Call auth_user() to do the job.
	(pass): Call auth_pass() to do the job.
	(complete_login): Draft support for guest chroot.  Do not display
	passwd part of setproctitle() and syslog() messages.
	(main): Remove on anonymous-name, was not use.
	* ftpd/auth.c: New file.
	* ftpd/Makefile.am: PATHDEF_FTPCHROOT in INCLUDES.
	* ftpd/logwtmp.c: bzero replaced by memset.

2000-08-16  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (usage): If err != 0, print Usage: ... line
	to stdout.  Uppercase all sentences.
	(main): Fix indentation in while condition and add a newline after
	a break statement.

2000-08-16  Alain Magloire

	* logger/logger.c: syslog.c rename logger.c
	* logger/logger.1: syslog.1 rename logger.1
	* logger/Makefile.am: bin_LOGGER now.

2000-08-16  Marcus Brinkmann  <marcus@gnu.org>

	* logger/syslog.c: Include version.h.  New global variables
	program, short_options, long_options.
	(usage): New argument err.  Make usage and help message GNU
	compliant.
	(main): Use short_options, long_options, getopt_long instead
	getopt, memcpy instead bcopy.  Add options --help and --version.
	Remove "register" attribute.  Rename ch to option.
	(pencode): Remove "register" attribute, format to GNU coding
	standard.
	(decode): Likewise.

2000-08-16  Alain Magloire

	* syslog: Deleted.
	* logger: New directory, .i.e syslog rename to logger.
	* configure.in: Change name syslog for logger.

2000-08-15  Alain Magloire

	* libinetutils/iruserok.c: use <signal> not <sys/signal.h> Remove
	ruserok().

	* libinetutils/ruserok.c: new funtion.

2000-08-15  Alain Magloire

	* configure.in: Check for fchdir().  Check for ruserok().

2000-08-13  Alain Magloire

	* syslogd/syslogd.c (main): Error in the code the inet file
	descriptor was not initialize correctely.

2000-08-13  Alain Magloire

	* syslogd/syslogd.c (main): New variable short_options.  Removed
	of reap_child() and SIGCHLD signal handler.  ttymsg() now double
	fork() and do itself the waitpid() to clean up.  Remove all those
	little loops that uses tolower() to bring the string to loser case
	for a comparison and use strcasecmp() when comparison are needed.

2000-08-13  Alain Magloire

	* libinetutils/ttymsg.c (fork2): New function, that is doing a
	double fork() when I/O is non-bloclking.

2000-08-11  Alain Magloire

	* syslogd/syslogd.c: Include unconditionnaly <utmpx.h> and
	<poll.h>, we (will) provide a stub when the OS is lacking.

2000-08-11  Alain Magloire

	* libinetutils/poll.c: Update from James Antill.

2000-08-10  Alain Magloire

	* syslogd/syslogd.c (wallmsg): Only check for the type
	USER_PROCESS The others on GNU/Linux generate errors.  And we only
	need to alert legitimate users that are login.
	* syslogd/syslogd.c : New option '-S, --sync' to behave like
	GNU/Linux syslogd that sync on every line.  Syncing on every lines
	can bring a machine to its knees if an application is trying to be
	malicious.

2000-08-10  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (main): When -d option is given, set NoDetach
	to 1.  Only test for !NoDetach when daemonising, and no longer for
	!Debug.

2000-08-09  Marcus Brinkmann  <marcus@gnu.org>

	Fix ChangeLog weirdness.
	* syslogd/syslogd.c: "New" prototype reap_childs.
	(main): Install SIGCHLD handler.
	(reap_childs): Function back.  We do fork for blocking I/O.  This
	time use waitpid unconditionally.

2000-08-09 Alain Magloire

	* rlogind/rlogind.c: Typo utmpx_logout should be utmp_logout.

2000-08-09  Alain Magloire

	* configure.in: Check for poll() and link headers/poll.h to
	include/poll.h if the OS does not have poll.

2000-08-08  Alain Magloire

	* telnetd/extern.h: rename interrupt() to interrupts() since it
	use as a reserve word by the some C compiler.
	* telnetd/state.c: Likewise.
	* telnetd/telnetd.c: Likewise.
	* telnetd/sys_term.c: L_SET rename to SEEK_SET for portability.

2000-08-08 Alain Magloire

	* talkd/announce.c: Uncoditionnaly undef max before use it as a
	macro.

2000-08-08  Alain Magloire

	* syslogd/syslogd.c (dbg_printf): [HAVE_STDARG_H][_STDC__] to
	palliate for OS not having ANSI C.
	[HAVE_UTMPX_H] before including <utmpx.h>.
	(usage): Some of the strings where missing newlines.
	[IOVCNT]: new macro to define the size of the iovec array.
	(fprintlog): Clear the iovec before using it.
	(logmsg): get rid of ugly hardcode and use sizeof (f->f_lastime) -
	1 intead for the len of the f_lastime string.
	(fprintlog): use sizeof(f->lastime) - 1.

2000-08-08  Marcus Brinkmann <marcus@gnu.org>

	* syslogd/syslogd.c: Don't prototype reapchild.
	(main): Don't install SIGCHLD handler.
	(reapchild): Function removed.  It is cruft needed for the linux
	wallmsg implementation, which we don't useb.

2000-08-08 Alain Magloire

	* rshd/rshd.c: [HAVE_INITGROUPS] guard.

2000-08-08  Alain Magloire

	* rsh/rsh.c: <sys/signal> is not portable use <signal.h>.

2000-08-08 Alain Magloire

	* rexecd/rexecd.c: Let ansi2knr take care of the vararg/stdarg
	issues.  Add prototype for error().  Guard [HAVE_INITGROUPS].

2000-08-08  Alain Magloire

	* rcp/rcp.c: Non portable d_ino for the DIR readdir() pointer
	removed.

2000-08-08  Alain Magloire

	* libinetutils/ttymsg.c: Formatting, bcopy() to memcpy().  Just
	check for '/' in the path for security attempts.

	* libinetutils/poll.c: Typo in prototypes.  Not including
	<sys/select.h>
	* libinetutils/poll.h: Typos.

2000-08-08 Alain Magloire

	* ftp/extern.h: Remove empty() declaration, one the arg is fd_set
	and <select.h> is not included in extern.h.

2000-08-08  Marcus Brinkmann <marcus@gnu.org>

	* doc/: Fix some factual errors, and one typo.  We don't have a
	limit on 19 sockets anymore, and we allow many -l and -s options.

2000-08-07  Alain Magloire

	* doc/doc/inetutils.texi doc/syslogd.texi First draft.

2000-08-06 Alain Magloire

	* telnet/ring.h: error in the prototype declarion of ring_mark().

2000-08-05  Alain Magloire

	* libinetutils/daemon.c (waitdaemon): We are using the double
	trick to avoid zombies and control terminals.  So we're going
	simply to pause() to avoid messing with waitpid().

2000-08-05  Alain Magloire

	* libinetutils/localhost.c: No longer use static buffers to cache
	the result.  This cause subtil bugs and make it impossible in
	non-threaded environment if we ever move to it.

2000-08-05 Alain Magloire

	* ftp/ruserpass.c (ruserpass): When calling localhost() make sure
	we free().  Various formating to GNU coding style.

2000-08-05  Alain Magloire

	* configure.in: Remove the check for setlinebuf(), it was for
	syslogd.  We use the more portable: setvbuf (stream, 0, _IOLBF,
	0);
	* header/config.h.in: remove HAVE_SETLINEBUF

2000-08-04  Alain Magloire

	* libinetutils/iruserok.c (iruserok): Typo in prototype.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/daemon.c (waitdaemon): Add comment.
	(waitdaemon_timeout): If child told us to go away, use _exit
	rather than exit.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* libinetutils/daemon.c (waitdaemon): New function from FreeBSD
	syslogd rev 1.66.
	(waitdaemon_timeout): Likewise (but called timedout in FreeBSD
	syslogd).
	(daemon): Redefine in terms of the more generic waitdaemon.

2000-08-03 Jeff Bailey

	* .cvsignore: Add INCLUDE file.  Delete it from repository.

2000-08-02 Jeff Bailey

	* whois/.cvsignore: Add generated file config.c

2000-08-02 Jeff Bailey

	* */.cvsignore: Mass add of .cvsignore files to beat CVS into
	submission.

2000-08-02 Jeff Bailey

	* README-alpha: Advertise the new commit-inetutils@gnu.org mailing
	list.

2000-08-01 Michael Vogt

	* libls/ls.h: Nuke u_quad_t, for unsigned long long.
	* libls/print.c: Use "%*llu" instead of "%*qd".

2000-08-14 Alain Magloire

	* libls/print.c: Define [howmany] macro.
	* libls/bsdport.c: Remove [_XOPEN_SOURCE], [_BSD_SOURCE],
	[_GNU_SOURCE] we have no business defining this.
	* libls/bsdport.h: Do not include <config.h> here.
	* libls/ls.c: Include <termios.h> not <sys/termios.h>

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	Someday I might learn how to use incremental search properly.
	* libls/ls.c (traverse): strerr -> strerror.
	(display): Likewise.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* libls/ls.c (traverse): strerr -> strerror.
	(display): Likewise.
	* libls/print.c (printlink): Likewise.

2000-08-01 Michael Vogt

	* libls/bsdport.h: added dirfd() macro, add _D_EXACT_NAMLEN macro
	* libls/fts.h: minor portability changes
	* libls/ls.c: minor bugfix ( strerr() -> strerror() )
	* libls/print.c: added <sys/mkdev.h> if avaiable

2000-08-01 Michael Vogt

	* configure.in: added checks for mkdev.h, features.h, dirfd()
	* headers/config.h.in: added defines for HABE_SYS_MKDEV
	HAVE_FEATURES_H, HAVE_DIRFD.

2000-07-31 Michael Vogt

	* libls/fts.c, libls/ls.c, libls/print.c: portability changes
	(solaris lacks warn, warnx, err)

2000-07-30 Alain Magloire

	* libls/print.c(printlink): ifdef MAXPATHLEN.

2000-07-30 Michel Vogt

	* libls/fts.c: Change GNU Lib C specifics functions for their
	standard counterpart example: __opendir() --> opendir().

2000-07-30 Alain Magloire

	* headers/config.h.in: new macro HAVE_LIBWRAP.

2000-07-30 Michael Vogt <mvo@debian.org>

	* configure.in: check for libwrap and <tcpd.h>
	* headers/config.h.in: new macros HAVE_TCPD_H

2000-07-27 Michel Vogt

	* libls/fts.c fts.h: new files to support BSD fts_*() functions.

2000-07-26 Alain Magloire

	* configure.in: check for libpam and <security/pam_appl.h>.
	* headers/config.h.in: new marcros HAVE_LIBPAM,
	HAVE_SECURITY_APPL_H.

2000-07-18 Alain Magloire

	* rexecd/rexed.c(error): get rid of the int error() varargs hack.
	and put support for stdarg and vararg correctly.

2000-07-18 Alain Magloire

	* inetd/inetd.c(main): Check for SIGPIPE too.
	* inetd/inetd.c(run_service): New function, This the same code
	when fork()ing in main(), but it put here so it could be reuse for
	tcpmux.
	* inetd/inetd.c(tcpmux): better support and change of prototype.

2000-07-18 Alain Magloire

	* all C files and header files, we make a bold move and translate
	the prototypes to ANSI C, instead of K&R for better compile time
	warnings etc ..  ansi2knr will the massaging for old C compilers.

2000-07-14 Alain Magloire

	* libinetutils/openpty.c: ptys_open() call wrong arguments ...

	* libinetutils/Makefile.am: AUTOMAKE_OPTIONS = ansi2knr all the
	files are now prototype and we rely on ansi2knr to the right
	thing.

2000-07-14 Alain Magloire

	* configure.in: check for initgroups().

2000-07-08 Michael Vogt <mvo@debian.org>

	* ftpd/Makefile.am (INCLUDES): Added $(PATHDEF_FTPDPID)
	* paths: add PATHDEF_FTPDPID

2000-07-07 Alain Magloire

	* glob/Makefile.am: EXTRA_DIST add configure.bat and SMakefile

2000-07-07 Matt Roberds

	* ftp/cmds.c/sethash(): read the optionnal argument for hash.
	* ftp/ftp.1: update man page, hash take optional argument.
	* ftp/ftp.c/sendrequests(): print hasbyte.
	* ftp/ftp_var.h: hashbytes global var: number of bytes per #
	printed.

2000-07-07  Alain Magloire

	* configure.in: check for <shadow.h>

2000-07-06 Alain Magloire

	* whois/Makefile.am : change the rule to generate config.c
	* whois/gen-config-c: removed

2000-07-06 Michel Vogt

	This is a Linux port of the BSD ls program.  You probably aren't
	interested in this, since GNU ls is much better (IMHO).  But this
	port is needed for internal ls on inetutils-ftpd.

2000-07-06  Jeff Bailey  <jbailey@nisa.net>

	* autogen.sh: New file for generating build environment for the
	first time from a CVS checkout.  Not added to Makefile.am for
	distribution.

2000-07-05 Alain Magloire

	* whois/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* uucpd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* tftpd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* tftp/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."
2000-07-05  Alain Magloire

	* telnetd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* telnet/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* talkd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* talk/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* rshd/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05  Alain Magloire

	* rsh/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* rlogind/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* rlogin/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* rexecd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05  Alain Magloire

	* rcp/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* logger/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* libtelnet/*: Clause 3 removed.  excerpt from email with RMS:
	"UCB has agreed to drop the advertising clause from the license
	for all BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* libinetutils/*: Clause 3 removed.  excerpt from email with RMS:
	"UCB has agreed to drop the advertising clause from the license
	for all BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* inetd/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* headers/*: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-07-05 Alain Magloire

	* ftp/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

2000-06-23  Jakob 'sparky' Kaivo  <jkaivo@timothy.nodomainname.net>

	* inetd/inetd.c (main): fix typo in usage

	* inetd/Makefile.am (INCLUDES): add $(PATHDEF_INETDDIR)

	* inetd/inetd.c (config): use nextconfig()
	(nextconfig): new function

2000-06-23  Jakob 'sparky' Kaivo  <jkaivo@timothy.nodomainname.net>

	* paths: add PATH_INETDDIR

2000-06-15 David O'Shea

	* rlogin/rlogin.c (speed): the fd may not be associated with a
	terminal, when checking for speed(), take appropriate actions to
	handle the error case.

2000-06-14 Joachim Gabler

	* configure.in: add check for element ut_exit in struct utmp
	* lininetutils/utmp_logout: check for HAVE_UTMP_UT_EXIT
	* libinetutils/openpty.c: smaller fixes (missing ';', structure
	element gr_pid of struct group replaced by gr_gid

2000-03-28  Alain Magloire

	* telnetd/sys_term.c: STREAMSPTY change for HAVE_STREAMSPTY UTMPX
	change for HAVE_UTMPX.
	* telnetd/sys_term.c: modutx() change for updwtmpx().
	* telnetd/telnetd: STREAMSPTY change to HAVE_STREAMSPTY

2000-03-28  Alain Magloire

	* libinetutils/Makefile.am : added PATHDEF_WTMPX in INCLUDES.
	* libinetutils/libinetutils/utmp_logout.c: WTMPX_FILE change for
	PATH_WTMPX.

Adding poll() bring to light that we do the creation of sockets
inside init(), this has the unfortunate side effect of close()ing
and  recreating the sockets at every SIGHUP.  This was done to
speedup initialization of syslogd, since on GNU/Linux the rc.*
files would start klogd also.  This is also the reason for a waitdaemon():
"Wed Feb 14 12:42:09 CST 1996: Dr. Wettstein
Parent process of syslogd does not exit until child process has
finished initialization process.  This allows rc.* startup to
pause until syslogd facility is up and operating."

	* syslogd/syslogd.c (init): Remove call to creation of sockets and
	move it to the main() before going in the loop.

2000-08-06  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (add_funix): New function to add new unix
	sockets.

2000-08-06  Alain Magloire

	* syslogd/syslogd.c (init): Remove restriction of LINE_MAX by
	reallocating the buffer when the line is too long, by doing this
	the continuation line feature was more straightforward.  The
	downfall is dealing with out of memory errors.  But the code, so
	far, does not deal with this anywhere.
	(domark): signo ignored.
	(init): signo ignored.
	(dbg_toggle): signo ignored.
	(trigger_restart): signo ignored.  Remove superfluous
	initializations of global and static variables.

2000-08-05  Alain Magloire

Remove restrictions on options -l, -s, better compliance to GNU
coding rules .i.e no limits in the number of possible open sockets.
Code indenting to conform to GNU style.

	* syslogd/syslogd.c: Use ``const'' consistenly for readonly
	strings; cfline(), dbg_printf(), logerror(), etc ...
	Prototypes/declarations use ``void'' for consistency.  Standardise
	all function definitions, so ansi2knr could do its job properly.
	(create_inet_socket): Variable ``on'' unuse.
	(usage): try_help() and help() merge to usage (int).  usage() is
	pass an integer and exit(err);
	(main): Remove setlinebuf() use setvbuf() only.
	(main): Regroup unix sockets and fd's into the same structure
	easier to carry.  Remove restriction on 19 + 1 possible open unix
	sockets.
	(crunch_list): Take one more argument, the oldlist so it can be
	reallocated for new entries.  This removed the restrictions of the
	number of LocalHosts and StripDomains.

2000-08-05  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (help): --no-forward does not override -r, but
	-h.
	(init): Create inet socket if either AcceptRemote or Forwarding is
	true, but with Forwarding only if not --no-forward was provided.
	This is less restrictive than before, where --no-forward would
	prevent incoming messages allowed with -r, which was documented
	but not intended.
	* syslogd/syslogd.8: Document (badly) all the new options from
	last change.

2000-08-04  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: In the whole file, change the formatting to
	conform to the GNU coding standards.  Also clean up some debug and
	error messages.  All further functional changes are listed below.

	Initialize finet and fklog to -1.  New variables NoKLog, NoUnixAF,
	NoForward, long_options, program_name.  New symbols USAGE,
	TTYMSGTIME.
	(help): New function.
	(try_help): New function.
	(usage): Use try_help.
	(main): Don't initialize finet, fklog here.  Initialize
	program_name.  Use getopt_long instead getopt.  Handle option '&'
	(--help).  Handle unknown options with try_help and usage.  Handle
	long options 'P' (--pidfile), 'F' (--no-foward), 'K' (--no-klog),
	'U' (--no-unixaf).  Move initialization of tv into the main loop.
	select meddles with the timeval on some systems (Linux) and we
	don't want to take any risk.
	(init): (Re-) Initialize fklog here if not NoKLog.  Only open unix
	sockets if not NoUnixAF.  Failing to open the primary socket is
	fatal.  Only open inet socket if not NoForward.
	(fprintlog): More diagnostic in case F_FORW: Show debug info when
	forwarding is disabled or finet is invalid for other reasons.
	(wallmsg): Use TTYMSGTIME instead hard coded default.
	(cfline): In case '|' fix nasty bug in if clause.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (waitdaemon): Removed.
	(timedout): Removed.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: If HAVE_SYS_TYPES_H, include <sys/types> for
	pid_t.  New global variable fklog.
	(main): Fix comment.  Remove local variables fklog, sunx, sin.
	(die): Close fklog if open.
	(waitdaemon): Ansify.
	(timedout): Likewise.  Drop __unused attribute.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (waitdaemon, timedout): New prototype and
	functions from FreeBSD syslogd (rev 1.66).
	(main): Remove conditional MSG_BSIZE on line variable.  New
	variables tv, tvp, ppid.  Call waitdaemon instead daemon to fork
	into background.  Before main loop, initialize tv and tvp to zero.
	In main loop, pass tvp to select.  This will make syslogd return
	immediately until we set tvp to NULL.  Check return value of
	select.  If it is zero (no messages), and tvp is not NULL, set it
	to NULL and send parent a SIGALRM.  This will be its signal to
	terminate.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: Include <stdarg.h>.
	(struct msg_part): Fix type declaration.
	(main): Rename variable c to l.  Initialize all of funix, finet to
	-1.  Remove dangling closing brace.  Main loop: Declare variable
	nfds.  Pass argument to init.  Add missing parentheses to
	if-clause.  Back out from using printchopped in unix and inet
	socket handling, not only because it doesn't work, but also
	because it is utterly nonsense without the S_STREAM patch.
	(make_part): Add missing brace.
	(die): Add missing variable i.

2000-08-03  Marcus Brinkmann  <marcus@gnu.org>

This covers the following Linux changes:
Thu Jan  6 12:07:36 CST 1994: Dr. Wettstein
Also thanks to Juha for a patch to exclude users with a class
of LOGIN from receiving messages.
Mon Oct 12 20:22:59 CEST 1998: Martin Schulze <joey@infodrom.north.de>
Added support for setutent()/getutent()/endutend() instead of
binary reading the UTMP file.  This is the the most portable
way.  This allows /var/run/utmp format to change, even to a
real database or utmp daemon.  Also if utmp file locking is
implemented in libc, syslog will use it immediately.  Thanks
to Topi Miettinen <tom@medialab.sonera.net>.

	* syslogd/syslogd.c: Include <utmpx.h> instead <utmp.h>.
	(wallmsg): Use pointer to struct utmpx, not struct utmp.  Fix the
	size of line accoridngly.  Use setutxent instead opening the utmp
	file ourself.  Use getutxent instead fread.  Don't log to ut_type
	LOGIN_PROCESS, and don't log to ut_user LOGIN (paranoia check).
	Use ut_user instead ut_name.  Use endutxent instead fclose.

2000-08-02  Marcus Brinkmann  <marcus@gnu.org>

This is among others the equivalent to the following Linux change:
Thu Jan  6 12:07:36 CST 1994: Dr. Wettstein
Added support for proper decomposition and re-assembly of
fragment messages on UNIX domain sockets.  Lack of this capability
was causing 'partial' messages to be output.  Since facility and
priority information is encoded as a leader on the messages this
was causing lines to be placed in erroneous files.

	* syslogd/syslogd.c: New symbol INITIAL_PARTS.  New struct
	msg_part, new global variables parts, nparts.
	(get_part): New prototype, new function.
	(free_part): Likewise.
	(make_part): Likewise.
	(printchopped): Likewise.
	(main): New variable c.  Allocate initial parts table after
	installing signal handlers.  In main loop, use c instead i to
	count through funices.  If a read from a unx domain socket returns
	0, close this fd.  Use printchopped instead printline to support
	partial messages (a bit messy though).

2000-08-02  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: Remove global variable InetInuse.
	(main): Check finet instead InetInuse.
	(fprintlog): Case F_FORW: Only try to forward message when finet
	is valid.
	(die): Check finet instead InetInuse.
	(init): Don't fiddle InetInuse.
	(cfline): Case '@': Don't check InetInuse (instead we check finet
	in fprintlog, see above).

2000-08-02  Marcus Brinkmann  <marcus@gnu.org>

	Merged from the Linux source (sysklogd 1.3):
	* syslogd/syslogd.c: New global variable restart.
	(main): Main loop: If restart is set, call init() and reset
	restart.  Install sighup_handler as SIGHUP handler.
	(sighup_handler): New prototype, new function.

2000-08-02  Marcus Brinkmann  <marcus@gnu.org>

I think this is among others the equivalent to the following Linux change:
Mon Feb 23 23:32:35 CET 1998: Topi Miettinen <Topi.Miettinen@ml.tele.fi>
Re-worked handling of Unix and UDP sockets to support closing /
opening of them in order to have it open only if it is needed
either for forwarding to a remote host or by receiption from
the network.

	* syslogd/syslogd.c (FDMASK): Removed.
	(create_unix_socket): New prototype, new function.
	(create_inet_socket): Likewise.
	(main): Remove variables funix, inetm, klogm.  Move SUN_LEN and
	creation of unix domaim sockets/inet socket to create_*_socket and
	init().  When opening PATH_KLOG, use fklog to store result.  Main
	loop: Rediddle code to use a fd_set and FD_* operations instead an
	int and bit operations.  New variable maxfds to store highest fd.
	Check fklog before checking fklog fd bit.  Check InetInuse before
	checking inet fd bit.  Clear buffer line before reading inet
	message.
	(die): Close inet socket.
	(init): New variable Forwarding and sp.  Check here for service
	syslog/udp instead in main.  Set Forwarding when appropriate (one
	of F_FORW* types).  Looping over funix here, closing and
	(re)opening unix sockets using create_unix_socket.  Closing and
	opening inet socet as appropriate.

2000-08-02  Marcus Brinkmann  <marcus@gnu.org>

This is the equivalent to the following Linux change:
Mon Oct 12 14:02:51 CEST 1998: Martin Schulze <joey@infodrom.north.de>
Applied patch provided vom Topi Miettinen with regard to the
people from OpenBSD.  This provides the additional '-a'
argument used for specifying additional UNIX domain sockets to
listen to.  This is been used with chroot()'ed named's for
example.  See for http://www.psionic.com/papers/dns.html

	* syslogd/Note: The above link is actually ".../papers/dns/".
	* syslogd/syslogd.c (LogName): Remove global variable.
	(nfunix, funixn, funix): New global variables.
	(MAXFUNIX): New symbol.
	(main): Add option '-a' to getopt() invocation.  Learn the
	alphabet.  Add '-a' option processing.  Convert '-p' option to
	funixn.  Don't unlink LogName (doesn't exist anymore).  Create
	nfunix unix sockets in funix (using funixn)
	(also unlink funixn here).  Main loop: Diddle the readfds
	initialization a bit.  Initialize nfds on the way.  Loop over all
	funix sockets and add their descriptors.  In select call, use
	nfds+1 and not arbitrary 20.  Later, check all funix for available
	reads.
	(usage): Document '-a' option.
	(die): Don't unlink LogName, instead close and unlink all unix
	sockets in funix.

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

This is the equivalent to the following Linux change:
Mon Oct 12 20:49:18 MET DST 1998: Martin Schulze <joey@infodrom.north.de>
Avoid logging of SIGCHLD when syslogd is in the process of
exiting and closing its files.  Again thanks to Topi.

	* syslogd/syslogd.c (init): New variable was_initialized.  Set
	Initialize to 0 temporarily to avoid logging of SIGCHLD.

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (main): Really fix getopt argument this time.
	Break after acting on option '-n'.
	(crunch_list): Remove semicolon that makes a prototype from the
	implementation (doh!).

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (usage): Beautify with package name and
	version number.

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (cvthname): Fix some really stupid errors in
	last change.

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (domark): Don't log mark if MarkInterval is <=
	0.
	* syslogd/syslogd.8 (SYNOPSIS): Add '-l', '-r', '-n' and '-s'
	(oops).  Document behaviour of '-m 0'.

2000-08-01  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c: Fix prototype of debug_switch.
	(cfline): In case '|', check for terminal and console.  In case
	'/', rearrange this very check.
	(debug_switch): Fix parameter list to match prototype.  Don't
	install signal handler here.

	* syslogd/syslogd.c (repeatinterval): Shorten from 30, 120, 600 to
	30, 60.  This is what Linux sysklogd 1.3 uses.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

This is the equivalent to the following Linux change:
Mon Feb 10 00:09:11 MET DST 1997: Martin Schulze
Improved debug code to decode the numeric facility/priority
pair into textual information.

	* syslogd/syslogd.c (textpri): New prototype and function.
	(logmsg): Use textpri in log message.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (cfline): Instead number 0 use char '\0'.
	Make debug output nicer by better alignment.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (init): Replace hard coded "/dev/console" by
	PATH_CONSOLE.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (cfline): Fix off-by-one error.  We have to
	take into account "LOG_MARK" which has facility number
	LOG_NFACILITIES.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (main): Add "-s" option to getopt invocation.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

This is based on the equivalent Linux change:
Thu Oct 19 00:02:07 MET 1995: Martin Schulze
The default behavior has changed for security reasons.  The
syslogd will not receive any remote message unless you turn
reception on with the "-r" option.

	* syslogd/syslogd.c (AllowRemote): New global variable.
	(main): New option "-r" to set AllowRemote.  Only if AllowRemote
	is true add inetm to readfds and check for messages from there.
	(usage): Document new option "-r".
	(init): In start-up message, show if we allow remote messages.
	* syslogd/syslogd.8: Document new option "-r".

	(init): In start-up message, show package name and version number
	(like: "GNU inetutils 1.3.2c").

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

This is the equivalent to the following Linux changes:
Audit: Coding style to comply to GNU style, cleanup the code
to be ANSI C, provide the necessary prototypes, reinforce const
policy for strings, move functions definitions only where
they are use and make them static scope if possible, variables
not exported are change to static scope, all function declarations
are ANSI C and rely on ansi2knr for OS lacking, nuke non-portable
semantics, POSIX functions/behaviour are followed intead of BSD.
The definition for setproctitle is remove, this function is to
machine dependant and we did not get it right, if the OS supplies
we'll use it.  The approach later will be to provide a fairly
portable of setproctitle() and get configure to the rigth thing, with
AC_REPLACE_FUNC (setproctitle).

	* ftpd/ftpd.c: allow_severity, deny_severity should be guarded
	with [HAVE_TCPD_H].  Move all globals to <extern.h>.  Remove
	[SETPROCTITLE] add [HAVE_SETPROCTITLE]
	[HAVE_INITSETPROCTITLE], remove setproctitle () definition.
	(main): SA_LEN () macro not portable remove.  Variable "quiet"
	change for "no_version".
	(reapchild): Use waitpid ().
	(user): Remove previous code handling of PAM.  and move the
	relevant pieces to sgetpwnam ().
	(user): when strncpy ()ing curname make sure we null terminate the
	string.
	(user): complete_login () call removed form user ().
	(delete): Use the portable S_ISDIR () marcro.
	(main): Don't typecast signal () use SIG_ERR.
	(display_file): New function.
	(statcmd): Global variable mode, rename to the more informative
	stru_mode, it was also shadowing a lot of local variable mode, for
	fopen ().
	(main): Remove initialization of global variables and initialize
	when defined.
	(main): New option '-p' to override pid file.
	(main): Adding SO_KEEPALIVE, to let the tcp/ip stack detect when
	the connection been drop, IPTOS_LOWDELAY for the control
	connection and IPTOS_THROUGHPUT for the data connection.

	* ftpd/ftpcmd.y: Remove definition of yyerror () from ftpd.c and
	move it to ftpcmd.y, result "cbuf" static scope.  Move all globals
	to <extern.h>.  Move declaration of cmdtab[] and sitetab[] to
	<extern.h>.

	* ftpd/conf.c: New file, define checkuser () and display_file ().

	* ftpd/pam.c: New file, define PAM related functions.

	* ftpd/wrap.c: New file, define TCPD related functions.

	* ftpd/server.c: New file, move all related standalone function to
	this module reapchild (), server_mode () and tcpd wrapper
	handling.

2000-08-10  Michael Vogt <mvo@debian.org>

	* ftpd/ftpd.c: cleaned up PAM code.

2000-07-30  Alain Magloire

	* ftpd/ftpd.c: protect initgroups() with HAVE_INITGROUPS.

2000-07-30  Michael Vogt <mvo@debian.org>

	* ftpd/ftpd.c (main): added TCP_WRAPPER support for daemon mode.

2000-07-26  Michael Vogt  <mvo@debian.org>

	* ftpd/ftpd.c (pass): added pam support.

2000-07-08  Michael Vogt  <mvo@debian.org>

	* ftpd/ftpd.c (main): added new option "-A" anonymous login only
	added new option "-q" quiet to do not print ftpd version.

2000-07-08  Michael Vogt  <mvo@debian.org>

	* ftpd/ftpd.c (main): added new option "-D" for daemon-mode, ftpd
	can now run without inetd.

2000-07-07 Alain Magloire

	* ftpd/ftpd.c (sgetpwnam): if HAVE_GETSPNAM && HAVE_SHADOW_H, call
	getspnam() to get the encrypted passwd.

2000-07-06 Michel Vogt

	* ftpd/popen.c: Instead of spwaning "/bin/ls" use the internal ls
	from libls.a.

	* ftpd/ftpd.c: use setproctitle ("%s", protittle);

2000-07-05 Alain Magloire

	* ftpd/*: Clause 3 removed.  excerpt from email with RMS: "UCB has
	agreed to drop the advertising clause from the license for all BSD
	software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of this
	     software must display the following acknowledgement: This product
	     includes software developed by the University of California,
	     Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

1999-17-02 Alain Magloire

	* tftpd/It has to do with handling of files with more than 32766
	blocks.  The TFTP packets should be able to handle up to 65535
	blocks.  But many tftpd's seem to treat the block# as a short
	instead of an unsigned short.  This appears to be caused by the
	arpa/tftp.h header declaring it as a short.  The relevant RFC's do
	not indicate that this is supposed to be the case.  Patch and
	Email exchange from Nathan Neulinger.

1999-17-02 Alain Magloire

	* rexecd/rexecd.c : check HAVE_SOCKADDR_IN_SIN_LEN before doing
	static initialization.

	* rexecd/Use STD{IN, OUT, ERR}_FILENO.

	* rexecd/Set also sete{g, u}id(pw->{g, u}id).

	* rexecd/Set the number of file desc. for select() correctly.

	* rexecd/Initialize pid to 0;

	* rexecd/Use FD_ISSET/FD_CLR/FD_SET macros instead.

1999-10-03  Jeff Bailey

	* README-alpha: Update with CVS info and mailing list info.

	* THANKS: Add Marcus Brinkmann.

1999-09-13  Jeff Bailey

	* COPYING, INSTALL, aclocal.m4, install-sh, missing,
	mkinstalldirs: Remove from CVS repository - They are automatically
	generated.

1999-06-12 Jeff Smith

	* ftp/cmds.c/getit(): Y2K problem with MDTM.
	* ftp/cmds.c/{setntrans, dotrans}(): use
	sizeof(ntin)/sizeof(ntout) instead of hardcoded numbers(was 16).
	* ftp/cmds.c/account(): occurences of 49 change for sizeof(acct) -
	1
	* ftp/cmds.c: Typos in comments corrected.

1999-05-19  Jeff Bailey

	* uucpd/Makefile.am : add LIBUTIL, needed for the Hurd.

1999-05-19 Alain Magloire

	* telnetd/telnetd.h: If HAVE_PTSNAME is defined, we assume that
	the platform can handle SYSVR4 pseudo ttys and define STREAMSPTY.

1999-05-19 Alain Magloire

	* rlogind/rlogind.c : make an utmp entry before exec(login);
	remove entry in cleanup().

1999-05-19  Jeff Bailey

	* rlogind/Makefile.am : add LIBUTIL, needed for the Hurd.

1999-05-19  Alain Magloire

	* ftp/ruserpass.c: MACH was define on Hurd.  We protect the
	defines before using them, MACH was change to MACHINE.  Noted by
	the Hurd people (Jeff Bailey, Marcus Brinkmann)
	* cmds.c: use xgetcwd().

1999-05-19 Alain Magloire

	* configure.in : check for ptsname(), this will give a hint to use
	SYSVR4 pseudo ptys handling.  particularly for telnetd and
	rlogind.
	* libinetutls/utmp_{init, logout} : new files.
	* libinetutils/openpty.c : a new version that should be compatible
	with SYSV STREAM.
	* paths : add check for PATH_UTMPX and PATH_WTMPX
	* configure.in : add check for getcwd, since we use xgetcwd.

1999-05-18 Dan Stromberg

	* headers/arpa/tftp.h : changing tu_clock to be unsigned to handle
	larger files (twice as big), without sacrificing anything.  We
	need this to allow sgis to roboinst from a sun tftp server.

1999-05-16 Alain Magloire

	* config.guess, config.sub: files removed from the repository.  We
	let automake -a create a newer version when releasing From Jeff
	Bailey.
	* Makefile.am : added ChangeLog.0 in EXTRA_DIST Noted by Jeff
	Bailey.

1999-05-14 Alain Magloire

	* libinetutils/opentty.c : writing on a constant string
	"/dev/ptyXX" would cause the server to sigsegv.  Change to be an
	array.  Problem first noted by Frederic Goudal.

1999-04-18 Alain Magloire

	* whois/main.c : protect FN_* defines.

1999-04-18 Alain Magloire

	* configure.in: ping disable.
	* configure.in: make links for fnmatch
	* libinetutils/snprintf.[ch] : support for "%ul".  patch from
	Gerald Combs <gerald@unicom.net>

1999-03-13 Alain Magloire

	* rshd/ChangeLog : New file.

	* rshd/Use STD{IN, OUT, ERR}_FILENO.

	* rshd/Use memcmp() instead of bcmp().

	* rshd/Add LOGNAME to environment variable exported to child.

	* rshd/Restricted port to > IPPORT_RESERVED/2 && >=
	IPPORT_RESERVED

	* rshd/Set also sete{g, u}id(pwd->{g, u}id).

	* rshd/change doit() signature to pass the socket.  It was done in
	case we change and the server is not started via inetd.

	* rshd/initialise s(socket descriptor) s = (sockfd).

	* rshd/Add more comments.

1999-03-13 Alain Magloire

	* rsh/ChangeLog : New file.

	* rsh/Before doing an exec revert euid to real uid.

	* rsh/Use the right maxfd in select().

1999-02-26 Alain Magloire

	The security fixes are gather from different sources: folks of
	OpenBSD, FreeBSD, Debian, Redhat and wu-ftpd.  Heads-up for their
	nice work.

	* ftpd/popen.c : overflow in argv[] and gargv[] fix.

1999-02-17 Alain Magloire

	* telnetd/rexecd.c : check HAVE_SOCKADDR_IN_SIN_LEN before doing
	static initialization.

1999-02-17 Alain Magloire

	* ftpd/ftpd.c(send_data): Use mmap() if possible, HAVE_MMAP.
	* ftpd/extern.h : Add toolong() to be exported.
	* ftpd/ftpcmnd.y : toolong() no longer a static function.
	* ftpd/ftpd.c : Set the alarm(timeout) when doing an accept() for
	the data port and use signal(SIGALRM, toolong).
	* ftpd/ftpd.c(maing): tzset(), in case no timezone database in
	~ftp.
	* ftpd/ftpd.c(datacon) : Use snprintf() instead of sprintf() for
	fix array buffers.  Assign *sizebuf ='\0' instead of strcpy
	(sizebuf, "");
	* ftpd/Use xgetcwd() from libinetutils instead of getcwd();

1999-02-17 Alain Magloire

	* configure.in: Force the check of HAVE_SOCKADDR_IN_SIN_LEN all
	the time not just for talk.
	* configure.in: Check for mmap(), HAVE_MMAP.
	* configure.in: Check for tzset(), HAVE_TZSET.
	* configure.in: Check for strcasecmp().
	* libinetutils/strcasecmp.c: New file.
	* libinetutils/xgetcwd.c: New file.
	* libinetutils/pathmax.h: New file.

1999-02-13 Alain Magloire

	* ftpd/ftpcmd.y : PORT command disallow PORT if: - port <= 1023 ||
	data_addr.sin_addr != his_addr.sin_addr This will take care of FTP
	bounce.  See README.sec
	* ftpd/ftpcmd.y : PASS clear passwd var(memset) asap.
	* ftpd/ftpcmd.y : PASV check if loggin.
	* ftpd/ftpcmd.y : RNTO check loggin and free $4 pointer.
	* ftpd/ftpcmd.y : HELP free $3 pointer.
	* ftpd/ftpcmd.y : SITE free $5 pointer.
	* ftpd/ftpcmd.y : RNFR free $4 pointer.
	* ftpd/ftpcmd.y : MDTM year 2000 compliant use %04d (tm_year +
	1900).
	* ftpd/ftpcmd.y : SITE IDLE not permit to disable timeout and
	check login.

1999-02-13 Alain Magloire

	* ChangeLog.0 : New file, mv ChangeLog ChangeLog.0.  Since
	inetutils is such an heteroclite package, it is more manageable
	for each utility to have their own ChangLog.

	* */ChangeLog : New files.

Sat Jul 20 21:55:31 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	Win32 hacks from <Rob_Tulloh@tivoli.com>.
	* glob/posix/glob.c [WIN32]: Don't include <pwd.h>; don't use
	d_ino; use void * for my_realloc; include <malloc.h> for alloca.
	(glob) [WIN32]: Use "c:/users/default" for ~ if no HOME variable.
	* glob/posix/fnmatch.h [WIN32]: Use prototypes even if
	[!__STDC__].
	* glob/posix/glob.h: Likewise.

Fri Jul 19 16:56:41 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* glob/posix/glob.h [!_AMIGA && !VMS]: Check this instead of just
	[!_AMIGA] for `struct stat;' forward decl.

Sat Jun 22 10:44:09 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* glob/posix/glob.c: Include <alloca.h> only [HAVE_ALLOCA_H], not
	[sparc].

Fri Jun 21 00:27:51 1996  Roland McGrath  <roland@delasyd.gnu.ai.mit.edu>

	* glob/posix/fnmatch.c (fnmatch): Fix \*[*?]+ case to increment
	name ptr only for ?s, not for *s.  Fix from Chet Ramey.

Wed Nov 22 22:32:55 1995  Martin Schulze

Added the fabulous strip-domain feature that allows us to
strip off (several) domain names from the fqdn and only log
the simple hostname.  This is useful if you're in a LAN that
has a central log server and also different domains.

I have also also added the -l switch do define hosts as
local.  These will get logged with their simple hostname, too.

	* syslogd/syslogd.c (LIST_DELIMITER): New symbol.
	(StripDomains, LocalHosts): New variables.
	(crunch_list): New prototype and function.
	(main): New options "-s" and "-l".
	(usage): Document "-s" and "-l".
	(cvthname): Use StripDomains and LocalHosts to frob the hostname
	before returning.
	* syslogd/syslogd.8: Document new options "-s" and "-l".

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	Merged from the Linux source (sysklogd 1.3):
	* syslogd/syslogd.c (F_FORW_SUSP): New symbol.
	(F_FORW_UNKN, F_PIPE): Increment value, to make space for
	F_FORW_SUSP.
	(TypeNames): Insert name for F_FORW_SUSP.
	(fprintlog): Add case for F_FORW_SUSP.  In case F_FORW use
	F_FORW_SUSP on error (and not F_FORW_UNKN).  Add debug message.
	(init): Handle case F_FORW_SUSP in debug output like F_FORW.

2000-07-31  Marcus Brinkmann  <marcus@gnu.org>

	* syslogd/syslogd.c (NoDetach): New global variable.
	(main): New option "-n".  If NoDetach is true, don't background
	and detach from controlling terminal.
	(usage): Document new option n.
	* syslogd/syslogd.8: Document new option "-n".

2000-07-05 Alain Magloire

	*syslogd/: Clause 3 removed.  excerpt from email with RMS: "UCB
	has agreed to drop the advertising clause from the license for all
	BSD software.  The advertising clause is this one:

	  3. All advertising materials mentioning features or use of
	     this software must display the following acknowledgement:
	     This product includes software developed by the
	     University of California, Berkeley and its contributors.

	This means that we can delete that paragraph from all files which
	give the University of California as the only copyright holder."

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

	* syslogd/syslogd.c (main): Type of len changed from int to
	size_t.
	(usage): Add -V option, make output consistent with other GNU
	tools.

	* syslogd/syslogd.8: Document "-V" option.

	* syslogd/syslogd.c (logmsg): Only accept priority if the exact
	bit is set (instead of an inequality).
	(cfline): negate_pri, excl_pri, pri_set, pri_clear: New variables.
	Allow '!' and '=' prepended to priority specification to exclude
	these resp.  higher priorities.

	* syslogd/syslogd.c (printline): Add SYNC_FILE to logmsg
	invocation for more reliability.
	(struct filed): New member f_flags to hold new macro OMIT_SYNC.
	(logmsg): Only fsync if OMIT_SYNC is not set.
	(cfline): Clear f_flags at initialization.  Set OMIT_SYNC in
	f_flags if action is prepended by `-' in the conf file.

	* syslogd/syslog.conf.5: Document level modifiers '!' and '='.
	Add `-' rule.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:

Wed Feb 14 12:42:09 CST 1996: Dr. Wettstein
Allowed forwarding of messages received from remote hosts to
be controlled by a command-line switch.  Specifying -h allows
forwarding.  The default behavior is to disable forwarding of
messages which were received from a remote host.

	* syslogd/syslogd.c: New global variable "NoHops".
	(main): New option "-h" to clear NoHops.
	(usage): Document new "-h" option.
	(fprintlog): New argument (char *) from.  If from != LocalHostName
	and NoHops set, don't forward message.
	(logmsg): Add from argument to fprintlog invocation.
	(domark): Likewise.
	(die): Likewise.
	(init): Likewise.

	* syslogd/syslogd.8: Document new "-h" option.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Wed Jul 26 18:57:23 MET DST 1995: Martin Schulze
The 'LocalDomain' and the hostname of a remote machine is
converted to lower case, because the original caused some
inconsistency, because the (at least my) nameserver did respond an
fqdn containing of upper- _and_ lowercase letters while
'LocalDomain' consisted only of lowercase letters and that didn't
match.

	* syslogd/syslogd.c (main): Try harder to get the FQDN of
	localhost and convert LocalDomain to lowercase.  (This should
	probably be in libinetutils).
	(cvthname): Add "." to output strings.  Convert hostname to
	lowercase before comparing with LocalDomain.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Tue May 28 00:58:45 MET DST 1996: Martin Schulze
Corrected behaviour of blocking pipes - i.e. the whole system
hung.  Michael Nonweiler <mrn20@hermes.cam.ac.uk> has sent us
a patch to correct this.  A new logfile type F_PIPE has been
introduced.

	* syslogd/syslogd.c: New macro F_PIPE.
	(TypeNames): New logfile type PIPE.
	(fprintlog): Support for F_PIPE added.
	(init): Likewise.
	(cfline): Likewise, use '|' in conf file.
	(cfline): Open log files with O_CREAT and permission 0644.

	* syslogd/syslog.conf.5: Add documentation for new logfile type
	PIPE.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Mon May 20 13:29:32 MET DST 1996: Miquel van Smoorenburg <miquels@cistron.nl>
Added continuation line support.

	* syslogd/syslogd.c (init): Add support for continuated lines
	  (implemented by Miquel van Smoorenburg <miquels@cistron.nl>).

	* syslogd/syslog.conf.5: Mention continuated line feature.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Mon Aug 21 22:10:35 MET DST 1995: Martin Schulze
Corrected a strange behavior during parsing of configuration
file.  The original BSD syslogd doesn't understand spaces as
separators between specifier and action.  This syslogd now
understands them.  The old behavior caused some confusion over
the Linux community.

	* syslogd/syslogd.c (cfline): Allow space as delimiter.

	* syslogd/syslog.conf.5: Seperator can now be a space, too.

1999-10-01  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Thu Oct 26 13:14:06 MET 1995: Martin Schulze
Added another logfile type F_FORW_UNKN.  The problem I ran into
was a name server that runs on my machine and a forwarder of
kern.crit to another host.  The hosts address can only be
fetched using the nameserver.  But named is started after
syslogd, so syslogd complained.
This logfile type will retry to get the address of the
hostname ten times and then complain.  This should be enough to
get the named up and running during boot sequence.
Sat Jan 10 01:33:06 CET 1998: Martin Schulze <joey@infodrom.north.de>
Fixed small bugs in F_FORW_UNKN meachanism.  Thanks to Torsten
Neumann <torsten@londo.rhein-main.de> for pointing me to it.

	* syslogd/syslogd.c: INET_SUSPEND_TIME, INET_RETRY_MAX,
	F_FORW_UNKN: New macros.  TypeNames: Add "FORW(UNKNOWN)".  If
	gethostbyname fails for some host, this type will retry
	INET_RETRY_TIMES times before it finally fails.
	(fprintlog): New variable hp.  Move clearing f_time inside every
	case it is appropriate for.  Add new case F_FORW_UNKN.  New goto
	target f_forw.  Only clear f_prevcount if appropriate.
	(init): Do not close f_file for F_FORW.  Add debug output for
	F_FORW_UNKN.
	(cfline): If gethostbyname fails, set f_type to F_FORW_UNKN
	instead giving up instantly.

1999-06-08  Marcus Brinkmann  <brinkmd@debian.org>

	* syslogd/syslogd/syslogd.c (MAXSVLINE): Increase number.
	(cfline): Double size of ebuf.

	* syslogd/syslogd/syslogd.c (decode): Double buffer size.

199-08-07  Marcus Brinkmann  <brinkmd@debian.org>

	* syslogd/syslogd/syslogd.c (usage): Add -V option, make output
	consistent with other GNU tools.

1999-08-07  Marcus Brinkmann  <brinkmd@debian.org>

This is the equivalent to the following Linux change:
Mon Oct 12 22:18:34 CEST 1998: Martin Schulze <joey@infodrom.north.de>
Modified printline() to support 8bit characters - such as
russion letters.  Thanks to Vladas Lapinskas <lapinskas@mail.iae.lt>.

	* syslogd/syslogd/syslogd.c (printline): Make eight bit clean for
	our friends in Russia (and other).

1999-06-08  Marcus Brinkmann  <brinkmd@debian.org>

	* syslogd/syslogd/syslogd.c (fprintlog): Use snprintf instead of
	sprintf.
	* syslogd/syslogd/syslogd.c: Fixed typo in comment.
	* syslogd/syslogd/syslogd.c: Include <version.h>.
	(main): Add option -V (version).

    Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007,
    2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018,
    2019, 2020, 2021 Free Software Foundation, Inc.

  This file is part of GNU Inetutils.

  GNU Inetutils is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or (at
  your option) any later version.

  GNU Inetutils is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see `http://www.gnu.org/licenses/'.
